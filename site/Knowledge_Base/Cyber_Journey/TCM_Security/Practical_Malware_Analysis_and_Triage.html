
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/icons/xor.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26+insiders-4.53.11">
    
    
      
        <title>Practical Malware Analysis and Triage - BitwiseOperator XOR_</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.c0d16a3a.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13.274 9.537v-.001l-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074ZM4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75Z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.484 4.484 0 0 1-.563-1.191 3.835 3.835 0 0 1-.05-2.063 4.647 4.647 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .748.748 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.425 2.425 0 0 1-.507-.441 3.075 3.075 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19a.884.884 0 0 1 .01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.737 3.737 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353V.75Z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343h-.001a8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746Zm1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275ZM6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L6.94 8 4.97 6.03a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018Z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.249 1.249 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429Zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006a.036.036 0 0 0-.004-.009l-.006-.006-.008-.001c-.003 0-.006.002-.009.004Z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.488 3.488 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.036 5.036 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.677 1.677 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06Zm.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.172.172 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173Z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5Zm4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0Z"/></svg>');}</style>



    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: gray; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-safety-always-building-your-malware-analysis-lab-malware-safety" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://xor.bitwiseoperator.net/home.html" title="BitwiseOperator XOR_" class="md-header__button md-logo" aria-label="BitwiseOperator XOR_" data-md-component="logo">
      
  <img src="../../../assets/icons/xor.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BitwiseOperator XOR_
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Practical Malware Analysis and Triage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M1 10V2l9 3v2l-9 3m7 0V8h5V4H8V3l4-2 4 2v1h-1v4h1v2h-1.26l-6.3 3.64L9 10H8M7 23l.04-.24 9.11-5.26.52 3.38L13 23H7m1.05-6.83L15.31 12l.52 3.37-8.4 4.85.62-4.05Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 10V8h1V4H8V3l4-2 4 2v1h-1v4h1v2h-1.26l-6.3 3.64L9 10H8m5-2V4h-2v4h2M7 23l.04-.24 9.11-5.26.52 3.38L13 23H7m1.05-6.83L15.31 12l.52 3.37-8.4 4.85.62-4.05Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../home.html" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Cyber_Offensive.html" class="md-tabs__link">
          
  
    
  
  Cyber Offensive

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../knowledge_base.html" class="md-tabs__link">
          
  
    
  
  Knowledge Base

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../whoami.html" class="md-tabs__link">
        
  
    
  
  whoami

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://xor.bitwiseoperator.net/home.html" title="BitwiseOperator XOR_" class="md-nav__button md-logo" aria-label="BitwiseOperator XOR_" data-md-component="logo">
      
  <img src="../../../assets/icons/xor.png" alt="logo">

    </a>
    BitwiseOperator XOR_
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../home.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Cyber Offensive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cyber Offensive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    File Transfers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    File Transfers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/File_Transfers/FTP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    FTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/File_Transfers/ftpd.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ftpd
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/File_Transfers/scp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    scp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/File_Transfers/SMB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SMB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/File_Transfers/Telnet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Telnet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/File_Transfers/windows_certutil.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    windows certutil
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/File_Transfers/windows_cscript.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    windows cscript
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/File_Transfers/Windows_mshta_wmic_regsvr32.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Windows mshta wmic regsvr32
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Initial_Enumeration/Initial_Enumeration.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Initial Enumeration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Lock_Picking/Lock_Picking.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Lock Picking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Password Attacks, Cracking & Decoding
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Password Attacks, Cracking & Decoding
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Argon2_cracker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Argon2 cracker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Cracking_Files.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cracking Files
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Decoding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Decoding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hashcat.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Hashcat
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Hydra.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Hydra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Medusa.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Medusa
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Ncrack.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Ncrack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Passing_the_hash.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Passing the hash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/Wordlists.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Wordlists
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_10" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_10" id="__nav_2_2_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    JohnTheRipper
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    JohnTheRipper
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Basic_Usage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Basic Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Cracking_modes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cracking modes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Misc_%26_Tricks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Misc & Tricks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Rules.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Rules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Password_Attacks%2C_Cracking_%26_Decoding/JohnTheRipper/Wordlists_%26_Incremental.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Wordlists & Incremental
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_5" id="__nav_2_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Privilege Escalation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Privilege Escalation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Privilege_Escalation/Linux_Privilege_Escalation/Linux_Privilege_Escalation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Linux Privilege Escalation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Privilege_Escalation/Windows_Privilege_Escalation/Windows_Privilege_Escalation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Windows Privilege Escalation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_6" id="__nav_2_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Recon
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Recon
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Recon/DNSLookup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    DNSLookup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Recon/Dorking.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Dorking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Recon/recon.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    recon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Recon/shodan.io.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    shodan.io
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_2_7" id="__nav_2_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Remote connection & execution
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Remote connection & execution
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Remote_connection_%26_execution/atexec.py.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    atexec.py
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Remote_connection_%26_execution/dcomexec.py.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    dcomexec.py
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Remote_connection_%26_execution/evil-winrm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    evil-winrm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Remote_connection_%26_execution/psexec.py.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    psexec.py
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Remote_connection_%26_execution/Remote_connection_%26_execution.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Remote connection & execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Remote_connection_%26_execution/smbexec.py.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    smbexec.py
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Remote_connection_%26_execution/winrm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    winrm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Remote_connection_%26_execution/wmiexec.py.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    wmiexec.py
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Reverse_shell/Reverse_shell.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Reverse shell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_2_9" id="__nav_2_2_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Services/FTP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    FTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Services/IMAP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    IMAP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Services/MSSQL.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    MSSQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Services/POP3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    POP3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Services/SMTP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SMTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_9_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_9_6" id="__nav_2_2_9_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Samba SMB
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_9_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Samba SMB
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Services/Samba_SMB/SAMBA_-_SMB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SAMBA - SMB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Services/Samba_SMB/SMB_Client.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SMB Client
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Services/Samba_SMB/Tools.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_2_10" id="__nav_2_2_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Web
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Web
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/RFI-LFI_File_Inclusion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    RFI-LFI File Inclusion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/SQL_Injection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SQL Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/SSRF.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SSRF
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/XSS_%28Cross-Site_Scripting%29.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    XSS (Cross-Site Scripting)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_10_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_10_5" id="__nav_2_2_10_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Command Injection
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_10_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Command Injection
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Command_Injection/IDOR.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    IDOR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_10_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_10_6" id="__nav_2_2_10_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Enumeration & Content Discovery
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_10_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Enumeration & Content Discovery
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_10_6_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_10_6_1" id="__nav_2_2_10_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Directory Busting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_10_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_10_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Directory Busting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_10_6_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_10_6_1_1" id="__nav_2_2_10_6_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Content Discovery Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_2_2_10_6_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_10_6_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Content Discovery Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Cansina.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cansina
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Chameleon.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Chameleon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/froxbuster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    froxbuster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/fuff.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    fuff
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/General_Content_Discovery.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    General Content Discovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/gobuster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    gobuster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Katana.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Katana
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Kiterunner.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Kiterunner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/Content_Discovery_Tools/Wfuzz.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Wfuzz
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_10_6_1_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_10_6_1_2" id="__nav_2_2_10_6_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    File and Directory Enumeration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_2_2_10_6_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_10_6_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    File and Directory Enumeration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/Dictionaries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Dictionaries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    dirb
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirbuster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    dirbuster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_%26_Content_Discovery/Directory_Busting/File_and_Directory_Enumeration/dirsearch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    dirsearch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_10_6_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_10_6_2" id="__nav_2_2_10_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    User Enumeration & Content Discovery
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_2_10_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_10_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Enumeration & Content Discovery
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Cyber_Offensive/Web/Enumeration_&_Content_Discovery/User_Enumeration_&_Content_Discovery/Authentication_Bypass_&_User_enumeration.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Authentication Bypass & User enumeration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Knowledge Base
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Knowledge Base
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../knowledge_base.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Coding & Coding_&_Scripting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Coding & Coding_&_Scripting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Ansible.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Ansible
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Assembly.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Assembly
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Bash.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Bash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/C%23.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    C#
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/C_C%2B%2B.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    C C++
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Github_Git.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Github Git
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Linux_Bash.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Linux Bash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Python.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Python
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Visual_Studio.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Visual Studio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/vsCode.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    vsCode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Windows_CMD.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Windows CMD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/Powershell.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Powershell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Coding_%26_Scripting/YAML.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    YAML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Home Lab
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home Lab
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Docker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Esxi.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Esxi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Hak5_WiFi_Pineapple.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Hak5 WiFi Pineapple
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Heimdall_Dashboard_Portainer_Docker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Heimdall Dashboard Portainer Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Homepage_Dashboard.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Homepage Dashboard
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Homer_Dashboard_Portainer_Docker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Homer Dashboard Portainer Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Install_InfluxDB%2C_Telegraf_%26_Grafana_with_Docker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Install InfluxDB, Telegraf & Grafana with Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Kasm_Workspaces.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Kasm Workspaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/NGINX_Server_Engine-X.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    NGINX Server Engine-X
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/pfSense.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    pfSense
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Portainer_Docker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Portainer Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Home_Lab/Wazuh_SEIM.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Wazuh SEIM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Network
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Network
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/ARP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ARP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Cabling_Fiber.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cabling Fiber
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Cabling_Fiber_SFPs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cabling Fiber SFPs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/DHCP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    DHCP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/DNS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    DNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/IGMP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    IGMP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Network_Fundamentals.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Network Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/OUI_Device_MAC_Addresses.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    OUI Device MAC Addresses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Radius.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Radius
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/SNMP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SNMP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Subnetting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Subnetting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/VPN.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    VPN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_13" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_13" id="__nav_3_2_3_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Email
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_3_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Email
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Email/DKIM_DomainKeys_Identified_Mail.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    DKIM DomainKeys Identified Mail
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Email/DMARC_Domain-based_Message_Authentication_Reporting_and_Conformance.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    DMARC Domain-based Message Authentication Reporting and Conformance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Email/IMAP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    IMAP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Email/POP3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    POP3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Email/SMTP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SMTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Email/SPF_Sender_Policy_Framework.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SPF Sender Policy Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Ethernet_802.3/Ethernet_802.3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Ethernet 802.3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_15" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_15" id="__nav_3_2_3_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Packet Capture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_3_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    Packet Capture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Packet_Capture/TCP_Dump.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    TCP Dump
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_15_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_15_2" id="__nav_3_2_3_15_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Wireshark
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_3_15_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_15_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Wireshark
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Packet_Capture/Wireshark/Wireshark_Filters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Wireshark Filters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Packet_Capture/Wireshark/Wireshark_Profiles.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Wireshark Profiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Packet_Capture/Wireshark/Wireshark_Summary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Wireshark Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16" id="__nav_3_2_3_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Vendor
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_3_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16">
            <span class="md-nav__icon md-icon"></span>
            
  
    Vendor
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_1" id="__nav_3_2_3_16_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Aruba HPE
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_3_16_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aruba HPE
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_1_1" id="__nav_3_2_3_16_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Aruba Central Instant Cluster
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_3_16_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Aruba Central Instant Cluster
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/AP_Configuration_Sync_issues_Aruba_Central_and_Instant.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    AP Configuration Sync issues Aruba Central and Instant
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Aruba_MTU.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Aruba MTU
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Aruba_HPE/Aruba_Central_Instant_Cluster/Upgrade_Procedure_Aruba_Central_and_Instant.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Upgrade Procedure Aruba Central and Instant
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_1_2" id="__nav_3_2_3_16_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Switches
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_3_16_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Switches
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Aruba_HPE/Switches/Aruba_HPE_SFPs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Aruba HPE SFPs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Aruba_HPE/Switches/Switch_enable_CLI_Aruba_Central.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Switch enable CLI Aruba Central
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_2" id="__nav_3_2_3_16_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Cisco
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_3_16_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cisco
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Cisco/CISCO_WLC_Handshake_Failure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    CISCO WLC Handshake Failure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_3" id="__nav_3_2_3_16_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Juniper
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_3_16_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Juniper
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_3_1" id="__nav_3_2_3_16_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    SRX
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_3_16_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    SRX
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_Add_VLAN_Ethernet_Switching_irb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper Add VLAN Ethernet Switching irb
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_JNCIA_study_notes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper JNCIA study notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_Add_VLAN_Ethernet_Switching_VLAN.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX Add VLAN Ethernet Switching VLAN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_Configuration_rescue_and_Auto_recovery.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX Configuration rescue and Auto recovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_dhcp-service_subsystem_is_not_responding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX dhcp-service subsystem is not responding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_firmware_upgrade.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX firmware upgrade
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_flow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_FTP_CLI.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX FTP CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_Loader_Recovery.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX Loader Recovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_1TO1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX NAT 1TO1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Destination.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX NAT Destination
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Source.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX NAT Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_NAT_Troubleshooting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX NAT Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_packet_capture_pcap.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX packet capture pcap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_redundancy_cluster_failover_troubleshooting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX redundancy cluster failover troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_srx_troubleshooting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper srx troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_Troubleshoot_restart_IPSEC_VPN.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX Troubleshoot restart IPSEC VPN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_BOOTED_BACKUP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX WARNING BOOTED BACKUP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Juniper/SRX/Juniper_SRX_WARNING_REMOTE_HOST_IDENTIFICATION_HAS_CHANGED.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Juniper SRX WARNING REMOTE HOST IDENTIFICATION HAS CHANGED
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_4" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_4" id="__nav_3_2_3_16_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Meraki
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_3_16_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Meraki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Meraki/Meraki_SFP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Meraki SFP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_5" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_5" id="__nav_3_2_3_16_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Ruckus
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_3_16_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ruckus
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_5_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_5_1" id="__nav_3_2_3_16_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Access Points
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_3_16_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Access Points
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/Access_Points/AP_CLI_Setup_Support_Config_Flow_Ruckus_SZ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    AP CLI Setup Support Config Flow Ruckus SZ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/Access_Points/AP_Firmware_Recovery_CLI_Ruckus_SZ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    AP Firmware Recovery CLI Ruckus SZ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/Access_Points/AP_TX_Power_EIRP_Ruckus_SZ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    AP TX Power EIRP Ruckus SZ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/Access_Points/CLI_General_Commands_Ruckus_SZ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    CLI General Commands Ruckus SZ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_5_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_5_2" id="__nav_3_2_3_16_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Switches
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_3_16_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Switches
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/Switches/Console_Settings_Ruckus_Brocade_ICX.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Console Settings Ruckus Brocade ICX
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/Switches/Firmware_upgrade_with_USB_Ruckus_Brocade_ICX.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Firmware upgrade with USB Ruckus Brocade ICX
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/Switches/SFP_Brocade_ICX-7250_ds_Ruckus_Brocade_ICX.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SFP Brocade ICX-7250 ds Ruckus Brocade ICX
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/Switches/SFP_RUCKUS_Optics_Ruckus_Brocade_ICX.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SFP RUCKUS Optics Ruckus Brocade ICX
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../docs/Knowledge_Base/Network/Vendor/Ruckus/Switches/Brocade_ICX_Broadcast_&_Multicast.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Brocade ICX Broadcast & Multicast
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_5_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_5_3" id="__nav_3_2_3_16_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    WLC
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_3_16_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    WLC
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_5_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_5_3_1" id="__nav_3_2_3_16_5_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    SZ SmartZone
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_3_2_3_16_5_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_5_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    SZ SmartZone
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/WLC/SZ_SmartZone/AP_Management_MGMT_Control_Data_Plane_Ports_Ruckus_SmartZone_SZ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    AP Management MGMT Control Data Plane Ports Ruckus SmartZone SZ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/WLC/SZ_SmartZone/Firmware_upgrade_Ruckus_SmartZone_SZ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Firmware upgrade Ruckus SmartZone SZ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/WLC/SZ_SmartZone/General_Cluster_Upgrade_and_backup_Ruckus_SmartZone_SZ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    General Cluster Upgrade and backup Ruckus SmartZone SZ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_5_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_5_3_2" id="__nav_3_2_3_16_5_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Unleashed
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_3_2_3_16_5_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_5_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Unleashed
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/WLC/Unleashed/Ruckus_Unleashed.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Ruckus Unleashed
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_16_5_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_16_5_3_3" id="__nav_3_2_3_16_5_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    ZD ZoneDirector
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_3_2_3_16_5_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_16_5_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    ZD ZoneDirector
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/Channelization_Ruckus_ZoneDirector_ZD_.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Channelization Ruckus ZoneDirector ZD 
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/Vendor/Ruckus/WLC/ZD_ZoneDirector/CLI_Ruckus_ZoneDirector_ZD.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    CLI Ruckus ZoneDirector ZD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network/WiFi_802.11/WiFi_802.11.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    WiFi 802.11
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    OS
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    OS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1" id="__nav_3_2_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Linux
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_1" id="__nav_3_2_4_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Arch
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Arch
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Arch/Arch_Openvpn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Arch Openvpn
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Arch/virt-manager.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    virt-manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Arch/xrandr_changing_primary_display.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    xrandr changing primary display
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2" id="__nav_3_2_4_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Debian
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Debian
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_1" id="__nav_3_2_4_1_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Backup and Restore
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Backup and Restore
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Backup_and_Restore/Timeshift_system_snapshots.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Timeshift system snapshots
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Backup_and_Restore/Undo_Deleted_Files.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Undo Deleted Files
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_2" id="__nav_3_2_4_1_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/Autostart_apps_scripts_on_startup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Autostart apps scripts on startup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/curl.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    curl
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/DNS_Lookup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    DNS Lookup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/environment_keys.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    environment keys
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/Find_Search_Locate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Find Search Locate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/Linux_Clearing_Storage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Linux Clearing Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/Linux_date_time.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Linux date time
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/Networking_VLAN_and_Route.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Networking VLAN and Route
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/SSL_Cert_end_date_check.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SSL Cert end date check
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/System_Commands.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    System Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Commands/wget.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    wget
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Desktop_Environment/dekstop_environment.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Desktop Environment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_4" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_4" id="__nav_3_2_4_1_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Fixes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Fixes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Fixes/FIX-speedtest-cli_apt_update_error.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    FIX-speedtest-cli apt update error
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Fixes/FIX_DNS_resolv.conf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    FIX DNS resolv.conf
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Fixes/FIX_sources_repos_list_DNS_Linux.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    FIX sources repos list DNS Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Fixes/Ubuntu_update_error_waiting_for_unattended-upgrade_to_exit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Ubuntu update error waiting for unattended-upgrade to exit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_5" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_5" id="__nav_3_2_4_1_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Kali
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Kali
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Kali/Issues_fixes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Issues fixes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Kali/kali_setup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    kali setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Kali/Proxychains.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Proxychains
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Kali/SSH_Server.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SSH Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Kali/VNC_over_SSH.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    VNC over SSH
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Kali/Wireless_Adapter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Wireless Adapter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_6" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_6" id="__nav_3_2_4_1_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Linux Directories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux Directories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Linux_Directories/Hierarchy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Hierarchy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Linux_Directories/Tree-Directory_Browsing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Tree-Directory Browsing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_7" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_7" id="__nav_3_2_4_1_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Misc
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Misc
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Misc/Crontab_cronjob.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Crontab cronjob
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Misc/File_Permissions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    File Permissions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Misc/Linux_Kernal.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Linux Kernal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Misc/OS_Upgrade.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    OS Upgrade
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Misc/Users_and_Groups.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Users and Groups
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Misc/X_Symbolic_Links.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    X Symbolic Links
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_8" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_8" id="__nav_3_2_4_1_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Package Management
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Package Management
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Package_Management/apt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    apt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Package_Management/dpkg.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    dpkg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Package_Management/other.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    other
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_9" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_9" id="__nav_3_2_4_1_2_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Securing Linux
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Securing Linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Securing_Linux/Disable_Root_account.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Disable Root account
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Securing_Linux/SSH_2FA.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SSH 2FA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Securing_Linux/Viewing_and_monitoring_log_files.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Viewing and monitoring log files
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_1_2_10" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_1_2_10" id="__nav_3_2_4_1_2_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Services and applications
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_2_4_1_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_1_2_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services and applications
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Linux/Debian/Services_and_applications/vnc_install.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    vnc install
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_2" id="__nav_3_2_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Windows
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Windows
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Windows/applications.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    applications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_2_2" id="__nav_3_2_4_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Windows/Commands/PowerShell_file_operation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    PowerShell file operation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Windows/Commands/Removing_Edge_Browser.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Removing Edge Browser
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Windows/Commands/routes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    routes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Windows/Commands/Windows_Start-up.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Windows Start-up
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Windows/Commands/WSL_Windows_Subsystem_Linux.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    WSL Windows Subsystem Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4_2_3" id="__nav_3_2_4_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_2_4_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Troubleshooting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OS/Windows/Troubleshooting/ERR_SSL_VERSION_OR_CIPHER_MISMATCH.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ERR SSL VERSION OR CIPHER MISMATCH
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_5" >
        
          
          <label class="md-nav__link" for="__nav_3_2_5" id="__nav_3_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Privacy
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Privacy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Privacy/Privacy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Privacy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_6" >
        
          
          <label class="md-nav__link" for="__nav_3_2_6" id="__nav_3_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    News
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    News
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../News/News.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    News
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../whoami.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    whoami
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-safety-always-building-your-malware-analysis-lab-malware-safety" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Safety Always! Building Your Malware Analysis Lab &amp; Malware Safety
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Safety Always! Building Your Malware Analysis Lab & Malware Safety">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#virtualbox" class="md-nav__link">
    <span class="md-ellipsis">
      
        Virtualbox
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remnum" class="md-nav__link">
    <span class="md-ellipsis">
      
        REMnum
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-install-windows-10" class="md-nav__link">
    <span class="md-ellipsis">
      
        Download &amp; Install Windows 10
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flare-vm" class="md-nav__link">
    <span class="md-ellipsis">
      
        FLARE-VM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FLARE-VM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-terminal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Windows Terminal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-proxy-auto-detect-setting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Disable proxy auto detect setting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-tamper-protection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Disable Tamper Protection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-avdefender-in-gpo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Disable AV/Defender in GPO
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-windows-firewall" class="md-nav__link">
    <span class="md-ellipsis">
      
        Disable Windows Firewall
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#take-vm-snapshot" class="md-nav__link">
    <span class="md-ellipsis">
      
        TAKE VM SNAPSHOT!
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-and-install-flare-vm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Download and install FLARE-VM
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analysis-network-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analysis Network Setup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inetsim-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        INetSim Setup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-only-safety-internal-networks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Host-only Safety &amp; Internal Networks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Host-only Safety & Internal Networks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host-only-safety" class="md-nav__link">
    <span class="md-ellipsis">
      
        Host-Only Safety
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safety-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Safety Test
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nix-and-macos" class="md-nav__link">
    <span class="md-ellipsis">
      
        *nix and MacOS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal-networks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Internal Networks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-remnux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting Up REMnux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remnux-static-ip-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        REMnux Static IP Assignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-flarevm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting Up FLAREVM
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing &amp; Troubleshooting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-connectivity-between-vms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test Connectivity Between VMs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-outbound-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test Outbound Connections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-inetsim" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test INetSim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusion
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-vm-repo-link" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lab VM Repo Link
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rapid-deployable-cloud-malware-analysis-lab-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rapid-deployable Cloud Malware Analysis Lab Setup
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rapid-deployable Cloud Malware Analysis Lab Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warning-you-need-permission-to-do-this" class="md-nav__link">
    <span class="md-ellipsis">
      
        WARNING: You need permission to do this
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warning-some-assembly-required" class="md-nav__link">
    <span class="md-ellipsis">
      
        WARNING: Some Assembly Required
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#warning-this-stuff-aint-free" class="md-nav__link">
    <span class="md-ellipsis">
      
        WARNING: This Stuff Ain’t Free
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first-credit" class="md-nav__link">
    <span class="md-ellipsis">
      
        First, Credit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Requirements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-your-terraform-iam-user" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create your terraform IAM User
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-awscli" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure awscli
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-lab" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating the Lab
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-workstation-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lab Workstation Images
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pmat-cloud-amis-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      
        PMAT Cloud AMIs &amp; Credentials
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-provisioning-with-terraform" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lab Provisioning With Terraform
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clone-the-pmat-lab-repository-to-your-workstation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clone the PMAT-lab repository to your workstation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-the-terraform-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure the Terraform files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-terraform-launch-the-lab" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure Terraform &amp; Launch the Lab
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-configure-apache-guacamole" class="md-nav__link">
    <span class="md-ellipsis">
      
        Access &amp; Configure Apache Guacamole
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-configure-remnux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Access &amp; Configure REMnux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-vnc-on-remnux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure VNC on REMNux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switching-flare-vm-back-to-internet-access" class="md-nav__link">
    <span class="md-ellipsis">
      
        Switching FLARE-VM Back to Internet Access
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverting-flare-vm-after-detonation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reverting FLARE-VM After Detonation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destroy-the-lab" class="md-nav__link">
    <span class="md-ellipsis">
      
        Destroy the Lab
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-cloud-malware-analysis-safety" class="md-nav__link">
    <span class="md-ellipsis">
      
        On Cloud Malware Analysis Safety
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#costs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Costs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#course-lab-repo-link" class="md-nav__link">
    <span class="md-ellipsis">
      
        Course Lab Repo Link
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#taking-a-snapshot-before-first-detonation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Taking a Snapshot Before First Detonation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detonating-our-first-sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detonating Our First Sample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#course-tool-list-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Course Tool List &amp; Resources
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-malware-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic Malware Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safe-malware-sourcing-additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Safe Malware Sourcing &amp; Additional Resources
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-basic-static-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Basic Static Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Basic Static Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hashing-malware-samples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hashing Malware Samples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#malware-repositories-virustotal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Malware Repositories: VirusTotal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strings-floss-static-string-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Strings &amp; FLOSS: Static String Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-the-import-address-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analyzing the Import Address Table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-to-the-windows-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction to the Windows API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#malapiio" class="md-nav__link">
    <span class="md-ellipsis">
      
        MalAPI.io
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-pack-or-not-to-pack-packed-malware-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        To Pack Or Not To Pack: Packed Malware Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combining-analysis-methods-pestudio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Combining Analysis Methods: PEStudio
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#identifying-malware-capabilities-intro-to-mitre-attck" class="md-nav__link">
    <span class="md-ellipsis">
      
        Identifying Malware Capabilities &amp; Intro to MITRE ATT&amp;CK
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#capa-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Capa Output
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-basic-dynamic-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Basic Dynamic Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Basic Dynamic Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-basic-dynamic-analysis-intro-host-and-network-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Basic Dynamic Analysis Intro: Host and Network Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-initial-detonation-triage-hunting-for-network-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Initial Detonation &amp; Triage: Hunting for Network Signatures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-host-based-indicators-procmon-part-i" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Host-Based Indicators: Procmon Part I
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-host-based-indicators-procmon-part-ii" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Host-Based Indicators: Procmon Part II
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-dynamic-analysis-of-unknown-binaries-part-i-analyzing-wireshark" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Dynamic Analysis of Unknown Binaries Part I: Analyzing Wireshark
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-dynamic-analysis-of-unknown-binaries-part-ii-host-based-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Dynamic Analysis of Unknown Binaries Part II: Host-Based Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-analyzing-a-reverse-shell-part-i-correlating-iocs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Analyzing a Reverse Shell Part I: Correlating IOCs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-analyzing-a-reverse-shell-part-ii-parent-child-process-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Analyzing a Reverse Shell Part II: Parent-Child Process Analysis
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-challenge-1-sillyputty" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Challenge 1: SillyPutty
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Challenge 1: SillyPutty">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-challenge-1-sillyputty-intro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Challenge 1: SillyPutty Intro
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-challenge-1-sillyputty-walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Challenge 1: SillyPutty Walkthrough
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-advanced-static-analysis-assembly-language-decompiling-disassembling-malware" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Advanced Static Analysis: Assembly Language, Decompiling, &amp; Disassembling Malware
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Advanced Static Analysis: Assembly Language, Decompiling, & Disassembling Malware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-intro-to-advanced-analysis-assembly-language" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Intro to Advanced Analysis &amp; Assembly Language
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-disassembling-decompiling-a-malware-dropper-intro-to-cutter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Disassembling &amp; Decompiling a Malware Dropper: Intro to Cutter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-x86-cpu-instructions-memory-registers-the-stack-a-closer-look" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start x86 CPU Instructions, Memory Registers, &amp; the Stack: A Closer Look
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-revisiting-the-dropper-assembly-instructions-and-the-windows-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Revisiting the Dropper: Assembly Instructions and the Windows API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-hello-world-under-a-microscope-part-i" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Hello, World! Under a Microscope Part I
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-advanced-analysis-of-a-process-injector" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Advanced Analysis of a Process Injector
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-advanced-dynamic-analysis-debugging-malware" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Advanced Dynamic Analysis: Debugging Malware
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Advanced Dynamic Analysis: Debugging Malware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-getting-comfortable-in-x32dbg-flow-control-breakpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Getting Comfortable in x32dbg: Flow Control &amp; Breakpoints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-debugging-the-dropper-dynamic-analysis-of-x86-instructions-api-calls" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Debugging the Dropper: Dynamic Analysis of x86 Instructions &amp; API Calls
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-hello-world-under-a-microscope-part-ii" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Hello, World! Under a Microscope Part II
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-challenge-2-sikomode" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Challenge 2: SikoMode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Challenge 2: SikoMode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-challenge-2-sikomode-intro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Challenge 2: SikoMode Intro
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-challenge-2-sikomode-walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Challenge 2: SikoMode Walkthrough
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-bonus-lecture-live-analysis-of-challenge-2-sikomode-twitch-stream-with-taggart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Bonus Lecture: Live Analysis of Challenge 2 SikoMode Twitch Stream with Taggart
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-binary-patching-anti-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Binary Patching &amp; Anti-analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Binary Patching & Anti-analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-patch-it-out-patching-x86-binaries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Patch it out: Patching x86 Binaries
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Start Patch it out: Patching x86 Binaries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting Up
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simplepatchme-source-code-mainnim" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimplePatchMe Source Code - main.nim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ok-so-what-does-this-actually-do" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ok, so what does this actually do?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-problem-here" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Problem Here
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-patch" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Patch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-and-patching-the-exe" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running and Patching the Exe
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-identifying-defeating-anti-analysis-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Identifying &amp; Defeating Anti-analysis Techniques
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Start Identifying & Defeating Anti-analysis Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anti-analysis-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      
        Anti-analysis Techniques
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isdebuggerpresent-api-call" class="md-nav__link">
    <span class="md-ellipsis">
      
        IsDebuggerPresent() API Call
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defeating-simple-anti-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defeating Simple Anti-analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-specialty-malware-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Specialty Malware Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Specialty Malware Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-specialty-malware-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Specialty Malware Classes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-gone-phishing-maldoc-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Gone Phishing: Maldoc Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. Gone Phishing: Maldoc Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-analyzing-excel-maldocs-oledump" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Analyzing Excel Maldocs: OLEdump
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-analyzing-word-maldocs-remote-template-macro-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Analyzing Word Maldocs: Remote Template Macro Injection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-what-the-shell-shellcode-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. What The Shell? Shellcode Analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#start-analyzing-shellcode-carving-shellcode-scdbg" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Analyzing Shellcode: Carving Shellcode &amp; scdbg
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Start Analyzing Shellcode: Carving Shellcode & scdbg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-carving-shellcode-from-memory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start Carving Shellcode from Memory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-off-script-scripted-malware-delivery-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. Off-Script: Scripted Malware Delivery Mechanisms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="12. Off-Script: Scripted Malware Delivery Mechanisms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-powershell-analyzing-obfuscated-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Start PowerShell: Analyzing Obfuscated Scripts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Start PowerShell: Analyzing Obfuscated Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vbscript-analyzing-a-multi-stage-msbuild-dropper" class="md-nav__link">
    <span class="md-ellipsis">
      
        VBScript: Analyzing a Multi-Stage MSBuild Dropper
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#html-applications-hta-wrapped-payloads-scripted-delivery-wmi" class="md-nav__link">
    <span class="md-ellipsis">
      
        HTML Applications (HTA): Wrapped Payloads, Scripted Delivery, &amp; WMI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-offensive-potential-of-html" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Offensive Potential of HTML
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript-is-dangerous" class="md-nav__link">
    <span class="md-ellipsis">
      
        JavaScript Is Dangerous
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enter-html-applications" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enter, HTML Applications
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-htas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analyzing HTAs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invoking-wmi-executing-powershell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Invoking WMI &amp; Executing PowerShell
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamic Analysis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reversing-c-malware" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reversing C# Malware
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reversing C# Malware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#intro-to-reversing-c-the-net-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intro to Reversing C# &amp; the .NET Framework
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reversing-an-encrypted-c2-dropper-dll-with-dnspy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reversing an Encrypted C2 Dropper DLL with dnSpy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-go-malware" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analyzing Go Malware
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analyzing Go Malware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#programming-language-recognition-analyzing-a-go-service-backdoor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Programming Language Recognition &amp; Analyzing a Go Service Backdoor
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mobile-malware-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mobile Malware Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mobile Malware Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lab-update-installing-mobsf" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lab Update: Installing MobSF
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intro-to-mobsf" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intro to MobSF
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-real-world-malware-samples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analyzing Real-World Malware Samples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analyzing Real-World Malware Samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wannacryexe-introduction-walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      
        WannaCry.exe Introduction &amp; Walkthrough
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automation-sandboxes-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automation: Sandboxes &amp; Pipelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automation: Sandboxes & Pipelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bluejupyter-automating-triage-with-jupyter-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      
        BlueJupyter: Automating Triage with Jupyter Notebooks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anyrun-malware-sandboxing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Any.Run: Malware Sandboxing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-script-analysis-with-chatgpt" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Script Analysis with ChatGPT
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-writing-report-publishing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rule Writing &amp; Report Publishing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rule Writing & Report Publishing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#writing-yara-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Writing YARA Rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecting-malware-with-yara" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detecting Malware with YARA
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-publishing-a-malware-analysis-report" class="md-nav__link">
    <span class="md-ellipsis">
      
        Writing &amp; Publishing a Malware Analysis Report
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mindmaps" class="md-nav__link">
    <span class="md-ellipsis">
      
        mindmaps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional resources
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                




              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Practical Malware Analysis and Triage</h1>

<div class="admonition info">
<h2 id="1-safety-always-building-your-malware-analysis-lab-malware-safety">1. Safety Always! Building Your Malware Analysis Lab &amp; Malware Safety</h2>
<div class="admonition info">
<h3 id="virtualbox">Virtualbox</h3>
<p><a href="https://www.virtualbox.org/wiki/Downloads">Download VirtualBox</a>
<a href="https://cs.hofstra.edu/docs/pages/guides/vbox_mac.html">Install VirtualBox on Mac</a>
<a href="https://phoenixnap.com/kb/install-virtualbox-on-ubuntu">Install VirtualBox on Linux</a></p>
</div>
<div class="admonition info">
<h3 id="remnum">REMnum</h3>
<p>Download the <a href="https://docs.remnux.org/install-distro/get-virtual-appliance">VirtualBox OVA</a></p>
<p>import into VirtualBox &gt; start &gt; take snapshot</p>
</div>
<div class="admonition info">
<h3 id="download-install-windows-10">Download &amp; Install Windows 10</h3>
<p><a href="https://www.microsoft.com/en-us/evalcenter/download-windows-10-enterprise">Download WIndows 10 Enterprise</a></p>
<p>After installing Windows &gt; VirtualBox &gt; Devices &gt; Insert guest additions cd image &gt; Install it &gt; Reboot</p>
<p><strong>Take a snapshot</strong></p>
</div>
<div class="admonition info">
<h3 id="flare-vm"><a href="https://github.com/mandiant/flare-vm">FLARE-VM</a></h3>
<p>We will get quality of life and necessary applications installed.</p>
<div class="admonition info">
<h4 id="windows-terminal">Windows Terminal</h4>
<p>Download the VCLibs package. In a PowerShell window</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">wget </span><span class="p">-</span> <span class="n">https</span><span class="p">://</span><span class="n">aka</span><span class="p">.</span><span class="n">ms</span><span class="p">/</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">VCLibs</span><span class="p">.</span><span class="n">x64</span><span class="p">.</span><span class="n">14</span><span class="p">.</span><span class="n">00</span><span class="p">.</span><span class="n">Desktop</span><span class="p">.</span><span class="n">appx</span> <span class="n">-usebasicparsing</span> <span class="n">-o</span> <span class="n">VCLibs</span><span class="p">.</span><span class="n">appx</span>
</code></pre></div>
<p>Download the Windows Terminal MSIX bundle from the provided link</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">wget </span><span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">microsoft</span><span class="p">/</span><span class="n">terminal</span><span class="p">/</span><span class="n">releases</span><span class="p">/</span><span class="n">download</span><span class="p">/</span><span class="n">v1</span><span class="p">.</span><span class="n">15</span><span class="p">.</span><span class="n">3465</span><span class="p">.</span><span class="n">0</span><span class="p">/</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">WindowsTerminal_Win10_1</span><span class="p">.</span><span class="n">15</span><span class="p">.</span><span class="n">3465</span><span class="p">.</span><span class="n">0_8wekyb3d8bbwe</span><span class="p">.</span><span class="n">msixbundle</span> <span class="n">-UseBasicParsing</span> <span class="n">-o</span> <span class="n">winterminal</span><span class="p">.</span><span class="n">msixbundle</span>
</code></pre></div>
<p>In a PowerShell admin window, add the VCLibs package</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">Add-AppxPackage</span> <span class="p">[</span><span class="n">C</span><span class="p">:\</span><span class="n">path</span><span class="p">\</span><span class="n">to</span><span class="p">\</span><span class="n">downloaded</span><span class="p">\</span><span class="n">VCLibs</span><span class="p">.</span><span class="n">appx</span><span class="p">]</span>
</code></pre></div>
In a PowerShell admin window</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">Add-AppxPackage</span> <span class="p">-</span> <span class="p">[</span><span class="n">C</span><span class="p">:\</span><span class="n">path</span><span class="p">\</span><span class="n">to</span><span class="p">\</span><span class="n">downloaded</span><span class="p">\</span><span class="n">winterminal</span><span class="p">.</span><span class="n">msixbundle</span><span class="p">]</span>
</code></pre></div>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA_t65a_1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/PMA_t65a_1.png" /></a></p>
<ul>
<li>notes <ul>
<li>(Optional) Pin Windows Terminal to the task bar</li>
<li>If above not working make sure Windows is updated build 1809 or - later, you can use https://github.com/microsoft/terminal</li>
</ul>
</li>
</ul>
</div>
<div class="admonition info">
<h4 id="disable-proxy-auto-detect-setting">Disable proxy auto detect setting</h4>
<p>In the Windows search bar, search <code>proxy settings</code></p>
<p>Switch "Automatically detect settings" button off</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA_t65a_0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/PMA_t65a_0.png" /></a></p>
</div>
<div class="admonition info">
<h4 id="disable-tamper-protection">Disable Tamper Protection</h4>
<ul>
<li>Search <code>Defender</code>, open Defender settings &gt; Home &gt; Virus &amp; threat - protection &gt; Virus &amp; threat protection settings</li>
<li>set all - Defender Settings to off</li>
</ul>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA_t65a_2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/PMA_t65a_2.png" /></a></p>
</div>
<div class="admonition info">
<h4 id="disable-avdefender-in-gpo">Disable AV/Defender in GPO</h4>
<p>In Windows search bar, search <code>group policy</code></p>
<p>In GPO, navigate to → Administrative Templates → Windows Components - → Microsoft Defender Antivirus → Enable “Turn off Microsoft Defender - Antivirus”</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA_t65a_3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/PMA_t65a_3.png" /></a></p>
</div>
<div class="admonition info">
<h4 id="disable-windows-firewall">Disable Windows Firewall</h4>
<p>GPO → Administrative Templates → Network → Network Connections → - Windows Defender Firewall → Domain Profile → Disable  ``Protect All - Network Connections```</p>
<p><strong>Do the same but for the Standard profile</strong></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA_t65a_4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/PMA_t65a_4.png" /></a></p>
</div>
<div class="admonition warning">
<h4 id="take-vm-snapshot">TAKE VM SNAPSHOT!</h4>
</div>
<div class="admonition info">
<h4 id="download-and-install-flare-vm">Download and install <a href="https://github.com/mandiant/flare-vm">FLARE-VM</a></h4>
<p>In PowerShell Admin prompt</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">(</span>New-Object<span class="w"> </span>net.webclient<span class="o">)</span>.DownloadFile<span class="o">(</span><span class="s1">&#39;https://raw.githubusercontent.com/mandiant/flare-vm/main/install.ps1&#39;</span>,<span class="s2">&quot;</span><span class="k">$(</span><span class="o">[</span>Environment<span class="o">]</span>::GetFolderPath<span class="o">(</span><span class="s2">&quot;Desktop&quot;</span><span class="k">)</span><span class="s2">)\install.ps1&quot;</span><span class="o">)</span>
</code></pre></div>
<p>Change directories to the Desktop</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Unblock-File<span class="w"> </span>.<span class="se">\i</span>nstall.ps1
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>Set-ExecutionPolicy<span class="w"> </span>Unrestricted
</code></pre></div>
<p>Accept the prompt to set the ExecPol to unrestricted if one appears</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>.<span class="se">\i</span>nstall.ps1<span class="w"> </span>-customConfig<span class="w"> </span>https://raw.githubusercontent.com/HuskyHacks/PMAT-labs/main/config.xml
</code></pre></div>
<p>Follow the rest of the prompts (answer Y to all) and continue with the installation.</p>
<p>When the installation is done, <strong>TAKE ANOTHER SNAPSHOT!</strong></p>
</div>
<div class="admonition info">
<h4 id="analysis-network-setup">Analysis Network Setup</h4>
<p>In Virtualbox &gt; Tools &gt; Network</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-98hs-0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-98hs-0.png" /></a></p>
<p>Under Host-only Networks &gt; Create
Make sure teh subnet is set different than your own home Network and enable DHCP Server</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-98hs-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-98hs-1.png" /></a></p>
<p>Now we need to the VMs settings then Network</p>
<p>Make sure you only have one Adapter enabled. That one adapter should be configured for Host-only Adapter and select the Adapter name you created earlier</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-98hs-2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-98hs-2.png" /></a></p>
</div>
</div>
<div class="admonition info">
<h3 id="inetsim-setup">INetSim Setup</h3>
<p>INetSim Internet Simulator and Analysis</p>
<p>to start INetSIm</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>inetsim
</code></pre></div>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-0.png" /></a></p>
<p>We need to quit the inetsim and make some changes</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/inetsim/inetsim.conf
</code></pre></div>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-1.png" /></a></p>
<p>locate and uncomment dns service (remove the #)</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-2.png" /></a></p>
<p>removed the # for dns service</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-3.png" /></a></p>
<p>Now locate <code>service_bind_address</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-4.png" /></a></p>
<p>change it to <code>0.0.0.0</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-5.png" /></a></p>
<p>Now locate <code>dns_default_ip</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-6.png" /></a></p>
<p>uncomment it and change the ip address to the same ip of the Remnux box</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-7.png" /></a></p>
<p>If you don't know the ip then run 'ip a' in a separate terminal and check the ip address</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-8.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-8.png" /></a></p>
<p>Now we need to save the changes <code>CTRL + X</code> save changes</p>
<p>Start <code>inetsim</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-9.png" /></a></p>
<p>To test this out open browser session to the Remnux ip address</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-10.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-10.png" /></a></p>
<p>Go to the adapter settings on the Windows machine and set the DNS to the Remnux IP</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tgs-asd-11.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tgs-asd-11.png" /></a></p>
</div>
<div class="admonition info">
<h3 id="host-only-safety-internal-networks">Host-only Safety &amp; Internal Networks</h3>
<h4 id="introduction">Introduction</h4>
<p>Safety is taught from the beginning of this course and underpins every single activity that we conduct. One of the most critical pieces of the malware analysis puzzle is the lab setup. Isolating a malware analysis lab is incredibly important to reduce the risk to your physical host and surrounding network.</p>
<p>So far, we've learned how to create a malware analysis lab network that uses a Host-Only network adapter to facilitate communication between lab hosts. Over time, other PMAT students have approached me with a reasonable concern regarding the lab network setup. Their concern usually goes like this:</p>
<blockquote>
<p>If Host-Only mode allows a VM to route to the physical host in some circumstances, can it really be considered safe for malware analysis?</p>
</blockquote>
<p>I applaud my students for approaching me about this because it means they are thinking critically about safety during malware analysis. While we can never truly eliminate the risk incurred during malware analysis, we must make every effort to mitigate the risk as much as possible wherever it exists.</p>
<p>In this section, I’d like to cover some of the safety considerations for the Host-Only network setup to assuage these concerns. I’d also like to walk you through an additional, optional lab network setup for those looking for an extra degree of security.</p>
<h4 id="host-only-safety">Host-Only Safety</h4>
<p>First thing’s first. I’d like to get this out of the way immediately:</p>
<blockquote>
<p>The PMAT course’s Host-Only lab network setup, when followed to the letter, is safe, has been safe, and will always be safe for malware analysis during this course! There is no need to setup an Internal Network to complete the course safely. The malware in the course has been designed and/or chosen to be as safe as possible in tandem with this lab set up.</p>
</blockquote>
<p>In most circumstances, a Host-Only setup effectively mitigates the risk of a malware sample being able to route out to the greater internet to download second stages or call back to a C2. This comes standard with the design of a Host-Only network.</p>
<p>Consider the following table of VirtualBox network configurations:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_2.png" /></a></p>
<p>https://www.virtualbox.org/manual/ch06.html</p>
<p>In Host-Only mode, a guest VM does not know and cannot see the outer LAN. That’s good ✅</p>
<p>But it’s the VM→ Host and Host → VM communication capability represented in the first two columns of the table that tends to concern students. Let’s examine how this functions and some of the mitigating factors at play.</p>
<h4 id="safety-test">Safety Test</h4>
<p>Assume that for the following section, I am using the FLAREVM host with a Host-Only network adapter with a configuration that mirrors the course’s lab network setup configuration. FLAREVM is the host that is used to detonate malware in the course, so we need to make sure it’s safe for our analysis efforts.</p>
<p>Our first experiment is to start a listening socket in our FLAREVM machine and attempt to reach it with our physical host. For simplicity sake, I’ll use port 80.</p>
<p>On FLAREVM:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ncat<span class="w"> </span>-nvlp<span class="w"> </span><span class="m">80</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>Ncat:<span class="w"> </span>Version<span class="w"> </span><span class="m">5</span>.59BETA1<span class="w"> </span><span class="o">(</span><span class="w"> </span>http://nmap.org/ncat<span class="w"> </span><span class="o">)</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>Ncat:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:80
</code></pre></div>
<p>From my physical host:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\M</span>att&gt;<span class="w"> </span>ncat<span class="w"> </span>-nv<span class="w"> </span><span class="m">10</span>.0.0.4<span class="w"> </span><span class="m">80</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>Ncat:<span class="w"> </span>Version<span class="w"> </span><span class="m">7</span>.92<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org/ncat<span class="w"> </span><span class="o">)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>Ncat:<span class="w"> </span>Connected<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.0.0.4:80.
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>hello!
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ncat<span class="w"> </span>-nvlp<span class="w"> </span><span class="m">80</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>Ncat:<span class="w"> </span>Version<span class="w"> </span><span class="m">5</span>.59BETA1<span class="w"> </span><span class="o">(</span><span class="w"> </span>http://nmap.org/ncat<span class="w"> </span><span class="o">)</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>Ncat:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:80
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>Ncat:<span class="w"> </span>Connection<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.1:1343.
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>hello!
</code></pre></div>
<p>Just like the table depicts, we can route from our physical host to our guest VM.</p>
<p>But now, let’s attempt to do this in reverse. Note that I use a Windows OS for my physical host with a default set of host firewall configuration rules.</p>
<p>On my physical host:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\M</span>att&gt;<span class="w"> </span>ncat.exe<span class="w"> </span>-nvlp<span class="w"> </span><span class="m">80</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>Ncat:<span class="w"> </span>Version<span class="w"> </span><span class="m">7</span>.92<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org/ncat<span class="w"> </span><span class="o">)</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>Ncat:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span>:::80
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>Ncat:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:80
</code></pre></div>
<p>From FLAREVM, I can try to access my physical host through its Host-Only adapter IP address, which is 10.0.0.1:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ncat<span class="w"> </span>-nv<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">80</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>Ncat:<span class="w"> </span>Version<span class="w"> </span><span class="m">5</span>.59BETA1<span class="w"> </span><span class="o">(</span><span class="w"> </span>http://nmap.org/ncat<span class="w"> </span><span class="o">)</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>Ncat:<span class="w"> </span>.
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\M</span>att&gt;<span class="w"> </span>ncat.exe<span class="w"> </span>-nvlp<span class="w"> </span><span class="m">80</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>Ncat:<span class="w"> </span>Version<span class="w"> </span><span class="m">7</span>.92<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org/ncat<span class="w"> </span><span class="o">)</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>Ncat:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span>:::80
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>Ncat:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:80
</code></pre></div>
<p>No connection is established. We can repeat this with our physical host’s LAN IP and the same thing happens. The Windows host firewall has prevented this from occurring. As long as the default firewall settings are configured, no connection will traverse from the guest VM to the host.</p>
<p>So when we think about the risk displayed in the previous test, what do we see? Our physical host can route into our guest VM, but our guest VM cannot route to our physical host because it is blocked by the host firewall.</p>
<p>Is there much risk in our physical host being able to initiate a connection and reach our guest VM? I would say no. Our physical host’s hypervisor is how we interact with the guest VM, so this represents another way that the hypervisor host can access the guest. If the opposite were true and the guest VM could initiate a connection to our physical host, it would be riskier.</p>
<p>If we imagine any malware sample that detonates in FLAREVM and tries to traverse out to our physical host, this traffic will now either:</p>
<div class="highlight"><pre><span></span><code>be handled and routed to INetSim,
or, be dropped by the physical host’s firewall.
</code></pre></div>
<h4 id="nix-and-macos">*nix and MacOS</h4>
<p>Now, that works well for Windows hosts, but what about a physical host running <em>nix or MacOS? While it’s true that these OS do not come standard with a host firewall, the malware in the PMAT course is not designed to be compatible with </em>nix operating systems. The one exception here is the Android malware sample, but this sample is only examined with static analysis methodology, meaning it is never executed. There are no malware propagation mechanisms in the malware in this course that can infect a *nix/MacOS host.</p>
<p>Additionally, <em>nix and MacOS can use the venerable iptables utility to drop traffic that is inbound from the guest VMs. iptables is built into the </em>nix OS and serves as a host firewall:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># iptables -A INPUT -s [IP ADDRESS] -j DROP</span>
</code></pre></div>
<p>If you are using <em>nix/MacOS for your physical host’s OS, it may be a good idea (though is not necessary for this course) to implement iptables rules for future analysis, especially if you want to analyze malware that is built for </em>nix. Please see the man page for iptables and this site for more information.</p>
<h4 id="internal-networks">Internal Networks</h4>
<p>For the final part of this section, I’d like to offer the steps for how to make an Internal Network for our malware analysis lab. This is completely optional and you cannot have an Internal Network and a Host-Only network configured at the same time, so please pick one to configure.</p>
<p>Again, Host-Only is sufficient for this course. The Internal Network provides an additional level of safety that removes the reliance on a host firewall to protect our physical host, so if you are more comfortable implementing it, please feel free to do so.</p>
<p>I want to teach this because it is likely that, during your lucrative career as the world’s preeminent malware analyst, you’ll be faced with a situation where the risk calculus is such that an Internal Network is the only safe option. In truth, all of my malware analysis work is done with VMworkstation Pro and an Internal Network. While VMworkstation Pro is not available for free, the VirtualBox Internal Network is now sufficiently stable and usable that we can use it in the course.</p>
<h4 id="setting-up-remnux">Setting Up REMnux</h4>
<p>We need to create an Internal Network and associate both VMs to it. We’ll start with REMnux. Perform the following steps to do so.
- Right-click on the REMnux VM and select Settings
- Click on Network
- In the Attached To dropdown menu, select Internal Network
- In VirtualBox, Internal Networks are associated by name. Add a name to the new Internal Network, like “pmat-internalnet”
- Click the drop down arrow next to Advanced to expand the advanced settings
- In the Promiscuous Mode drop down menu, select “Allow VMs”</p>
<p>Your settings should now look like this:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_3.png" /></a></p>
<p>Click OK. Then, power on the REMnux guest host by clicking the Start button.</p>
<h4 id="remnux-static-ip-assignment">REMnux Static IP Assignment</h4>
<p>There is no DHCP server in the Internal Network, so we need to manually define a static IP address for the REMnux host. We will use the netplan utility to do so. The netplan utility uses a YAML config file to control the host’s adapter settings. This YAML config file lives in /etc/netplan/</p>
<p>Open the netplan conf file in nano with sudo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>remnux@remnux:~$<span class="w"> </span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/netplan/01-netcfg.yaml
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># This file describes the network interfaces available on your system</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="c1"># For more information, see netplan(5).</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>network:
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">  </span>version:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">  </span>renderer:<span class="w"> </span>networkd
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">  </span>ethernets:
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span>enp0s3:
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">      </span>dhcp4:<span class="w"> </span>yes
</code></pre></div>
<p>We want to remove this from DHCP and assign all network information statically. YAML syntax requires specific code indentation to be processed correctly. Please pay attention to the amount of spaces for each YAML object.</p>
<p>Change <code>dhcpv4</code> to <code>no</code>, add the <code>addresses</code> and <code>gateway4</code> objects, and configure them with the following values:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="l l-Scalar l-Scalar-Plain">yaml</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="l l-Scalar l-Scalar-Plain"># This file describes the network interfaces available on your system</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="l l-Scalar l-Scalar-Plain"># For more information, see netplan(5).</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="l l-Scalar l-Scalar-Plain">network</span><span class="p p-Indicator">:</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">  </span><span class="nt">renderer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networkd</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="nt">ethernets</span><span class="p">:</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">    </span><span class="nt">enp0s3</span><span class="p">:</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="w">     </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="w">     </span><span class="nt">addresses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">10.0.0.3/24</span><span class="p p-Indicator">]</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="w">     </span><span class="nt">gateway4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.1</span>
</code></pre></div>
<p>Now, we apply the configuration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>remnux@remnux:~$<span class="w"> </span>sudo<span class="w"> </span>netplan<span class="w"> </span>apply
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>remnux@remnux:~$
</code></pre></div>
<p>If no output returns after the netplan apply command, the YAML file is formatted correctly and has been processed.</p>
<p>If you get the following error:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>remnux@remnux:~$<span class="w"> </span>sudo<span class="w"> </span>netplan<span class="w"> </span>apply
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>/etc/netplan/01-netcfg.yaml:10:10:<span class="w"> </span>Invalid<span class="w"> </span>YAML:<span class="w"> </span>inconsistent<span class="w"> </span>indentation
</code></pre></div>
<p>… or:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>Invalid<span class="w"> </span>YAML<span class="w"> </span>at<span class="w"> </span>//etc/netplan/01-netcfg.yaml<span class="w"> </span>line<span class="w"> </span><span class="m">7</span><span class="w"> </span>column<span class="w"> </span><span class="m">6</span>:<span class="w"> </span>did<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>expected<span class="w"> </span>key
</code></pre></div>
<p>… that means your YAML syntax is off somewhere. It will show you the line that you need to fix.</p>
<p>We can now inspect the adapter settings on REMnux:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>remnux@remnux:~$<span class="w"> </span>ip<span class="w"> </span>-br<span class="w"> </span>-c<span class="w"> </span>a
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>lo<span class="w">               </span>UNKNOWN<span class="w">        </span><span class="m">127</span>.0.0.1/8<span class="w"> </span>::1/128<span class="w"> </span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>enp0s3<span class="w">           </span>UP<span class="w">             </span><span class="m">10</span>.0.0.3/24<span class="w"> </span>fe80::a00:27ff:feef:67e4/64
</code></pre></div>
<h4 id="setting-up-flarevm">Setting Up FLAREVM</h4>
<p>FLAREVM is, believe it or not, a bit more straightforward than REMnux for this setup.
- Right-click on the FLAREVM host and select Settings
- Click on Network
- In the Attached To dropdown menu, select Internal Network
- Associate FLAREVM to the same Internal Network that we made earlier in the setup for REMnux by selecting it from the Name dropdown: “pmat-internalnet”
- Click the drop down arrow next to Advanced to expand the advanced settings
- In the Promiscuous Mode drop down menu, select “Allow VMs”</p>
<p>Your settings should now look like this:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_4.png" /></a></p>
<p>Click OK. Then, power on the FLAREVM guest host by clicking the Start button.</p>
<p>Once you have logged in and are at the FLAREVM desktop, go to the Windows button and enter <code>View Network Connections</code> in the search to get to the Network Connection Adapter settings.</p>
<p>Two adapters are present: an <code>Ethernet Adapter</code> and the <code>Npcap Loopback Adapter</code>. Right click on the Ethernet adapter and select <code>Properties → IPv4 Properties</code>.</p>
<p>We will now statically define our IPv4 settings to mirror the Host-Only setup. This means that at the end of the day, we want:
- The IPv4 address of FLARE to be set to something. It doesn’t matter what it’s set to as long as it’s a valid address in the <code>10.0.0.0/24</code> network and we keep track of it.
- The Subnet Mask to configure a <code>/24</code> network.
- Our Default Gateway to be the REMnux host so we can make use of INetSim.
- Our DNS server to be the REMnux host so we can make use of INetSim.</p>
<p>The correct settings look something like this:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_5.png" /></a>     </p>
<p>Once this looks good, select OK and then select OK in the adapter settings window.</p>
<p>Now, examine the IP settings in a cmd prompt:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ipconfig<span class="w"> </span>/all
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>Windows<span class="w"> </span>IP<span class="w"> </span>Configuration
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">   </span>Host<span class="w"> </span>Name<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>DESKTOP-M87PSAK
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">   </span>Primary<span class="w"> </span>Dns<span class="w"> </span>Suffix<span class="w">  </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">   </span>Node<span class="w"> </span>Type<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>Hybrid
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">   </span>IP<span class="w"> </span>Routing<span class="w"> </span>Enabled.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>No
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">   </span>WINS<span class="w"> </span>Proxy<span class="w"> </span>Enabled.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>No
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>Ethernet<span class="w"> </span>adapter<span class="w"> </span>Ethernet:
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="w">   </span>Connection-specific<span class="w"> </span>DNS<span class="w"> </span>Suffix<span class="w">  </span>.<span class="w"> </span>:
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="w">   </span>Description<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>PRO/1000<span class="w"> </span>MT<span class="w"> </span>Desktop<span class="w"> </span>Adapter
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="w">   </span>Physical<span class="w"> </span>Address.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span><span class="m">08</span>-00-27-55-06-07
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="w">   </span>DHCP<span class="w"> </span>Enabled.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>No
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="w">   </span>Autoconfiguration<span class="w"> </span>Enabled<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>Yes
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="w">   </span>Link-local<span class="w"> </span>IPv6<span class="w"> </span>Address<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>fe80::f4fb:f210:ea5a:478f%4<span class="o">(</span>Preferred<span class="o">)</span>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="w">   </span>IPv4<span class="w"> </span>Address.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span><span class="m">10</span>.0.0.4<span class="o">(</span>Preferred<span class="o">)</span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="w">   </span>Subnet<span class="w"> </span>Mask<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span><span class="m">255</span>.255.255.0
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="w">   </span>Default<span class="w"> </span>Gateway<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span><span class="m">10</span>.0.0.3
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="w">   </span>DHCPv6<span class="w"> </span>IAID<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span><span class="m">101187623</span>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="w">   </span>DHCPv6<span class="w"> </span>Client<span class="w"> </span>DUID.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span><span class="m">00</span>-01-00-01-28-B4-6C-F2-08-00-27-55-06-07
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="w">   </span>DNS<span class="w"> </span>Servers<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span><span class="m">10</span>.0.0.3
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="w">   </span>NetBIOS<span class="w"> </span>over<span class="w"> </span>Tcpip.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>.<span class="w"> </span>:<span class="w"> </span>Enabled
</code></pre></div>
<p>Note the entries for the IP address, subnet mask, default gateway, and DNS server.</p>
<h4 id="testing-troubleshooting">Testing &amp; Troubleshooting</h4>
<p>Now, let’s test our network. Ideally, our network now facilitates communication between FLAREVM and REMnux while also denying traffic to our physical host and beyond. And unlike a Host-Only network, we don’t need to rely on a host firewall to drop traffic heading for our physical host.</p>
<h4 id="test-connectivity-between-vms">Test Connectivity Between VMs</h4>
<p>The old ping test. Ping the other VM.</p>
<p>On FLAREVM:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ping<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">10</span>.0.0.3
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>Pinging<span class="w"> </span><span class="m">10</span>.0.0.3<span class="w"> </span>with<span class="w"> </span><span class="m">32</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data:
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>Reply<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.3:<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">32</span><span class="w"> </span>time&lt;1ms<span class="w"> </span><span class="nv">TTL</span><span class="o">=</span><span class="m">64</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>Reply<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.3:<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">32</span><span class="w"> </span>time&lt;1ms<span class="w"> </span><span class="nv">TTL</span><span class="o">=</span><span class="m">64</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>Ping<span class="w"> </span>statistics<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.0.0.3:
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span>Packets:<span class="w"> </span><span class="nv">Sent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="nv">Received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="nv">Lost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>%<span class="w"> </span>loss<span class="o">)</span>,
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>Approximate<span class="w"> </span>round<span class="w"> </span>trip<span class="w"> </span><span class="nb">times</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>milli-seconds:
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">    </span><span class="nv">Minimum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0ms,<span class="w"> </span><span class="nv">Maximum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0ms,<span class="w"> </span><span class="nv">Average</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0ms
</code></pre></div>
<p>On REMnux:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>remnux@remnux:~$<span class="w"> </span>ping<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">10</span>.0.0.4
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>PING<span class="w"> </span><span class="m">10</span>.0.0.4<span class="w"> </span><span class="o">(</span><span class="m">10</span>.0.0.4<span class="o">)</span><span class="w"> </span><span class="m">56</span><span class="o">(</span><span class="m">84</span><span class="o">)</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data.
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.4:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">128</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">0</span>.308<span class="w"> </span>ms
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="m">64</span><span class="w"> </span>bytes<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.4:<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="nv">ttl</span><span class="o">=</span><span class="m">128</span><span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="m">0</span>.321<span class="w"> </span>ms
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>---<span class="w"> </span><span class="m">10</span>.0.0.4<span class="w"> </span>ping<span class="w"> </span>statistics<span class="w"> </span>---
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="m">2</span><span class="w"> </span>packets<span class="w"> </span>transmitted,<span class="w"> </span><span class="m">2</span><span class="w"> </span>received,<span class="w"> </span><span class="m">0</span>%<span class="w"> </span>packet<span class="w"> </span>loss,<span class="w"> </span><span class="nb">time</span><span class="w"> </span>1020ms
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>rtt<span class="w"> </span>min/avg/max/mdev<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.308/0.314/0.321/0.006<span class="w"> </span>ms
</code></pre></div>
<h4 id="test-outbound-connections">Test Outbound Connections</h4>
<p>Ensure that our Internal Network is truly isolated with a few tests. Each of these tests should fail which indicates that our network is not routable to our physical host and beyond.</p>
<p>On REMnux:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>remnux@remnux:~$<span class="w"> </span>ping<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">8</span>.8.8.8
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>PING<span class="w"> </span><span class="m">8</span>.8.8.8<span class="w"> </span><span class="o">(</span><span class="m">8</span>.8.8.8<span class="o">)</span><span class="w"> </span><span class="m">56</span><span class="o">(</span><span class="m">84</span><span class="o">)</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data.
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>From<span class="w"> </span><span class="m">10</span>.0.0.3<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>Destination<span class="w"> </span>Host<span class="w"> </span>Unreachable
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>From<span class="w"> </span><span class="m">10</span>.0.0.3<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span><span class="w"> </span>Destination<span class="w"> </span>Host<span class="w"> </span>Unreachable
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>---<span class="w"> </span><span class="m">8</span>.8.8.8<span class="w"> </span>ping<span class="w"> </span>statistics<span class="w"> </span>---
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="m">2</span><span class="w"> </span>packets<span class="w"> </span>transmitted,<span class="w"> </span><span class="m">0</span><span class="w"> </span>received,<span class="w"> </span>+2<span class="w"> </span>errors,<span class="w"> </span><span class="m">100</span>%<span class="w"> </span>packet<span class="w"> </span>loss,<span class="w"> </span><span class="nb">time</span><span class="w"> </span>1026ms
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>pipe<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>remnux@remnux:~$<span class="w"> </span>nslookup<span class="w"> </span>google.com
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>Server:<span class="w">     </span><span class="m">127</span>.0.0.53
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>Address:<span class="w">    </span><span class="m">127</span>.0.0.53#53
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>**<span class="w"> </span>server<span class="w"> </span>can<span class="s1">&#39;t find google.com: SERVFAIL</span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="s1">remnux@remnux:~$ ping -c 2 [your physical host&#39;</span>s<span class="w"> </span>IP<span class="w"> </span>address/Wifi<span class="w"> </span>address<span class="o">]</span>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>PING<span class="w"> </span>x.x.x.x<span class="w"> </span><span class="o">(</span>x.x.x.x<span class="o">)</span><span class="w"> </span><span class="m">56</span><span class="o">(</span><span class="m">84</span><span class="o">)</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data.
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>From<span class="w"> </span><span class="m">10</span>.0.0.3<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>Destination<span class="w"> </span>Host<span class="w"> </span>Unreachable
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>From<span class="w"> </span><span class="m">10</span>.0.0.3<span class="w"> </span><span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span><span class="w"> </span>Destination<span class="w"> </span>Host<span class="w"> </span>Unreachable
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a>---<span class="w"> </span>x.x.x.x<span class="w"> </span>ping<span class="w"> </span>statistics<span class="w"> </span>---
<a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="m">2</span><span class="w"> </span>packets<span class="w"> </span>transmitted,<span class="w"> </span><span class="m">0</span><span class="w"> </span>received,<span class="w"> </span>+2<span class="w"> </span>errors,<span class="w"> </span><span class="m">100</span>%<span class="w"> </span>packet<span class="w"> </span>loss,<span class="w"> </span><span class="nb">time</span><span class="w"> </span>1001ms
<a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a>pipe<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<p>On FLAREVM, repeat the previous steps.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ping<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">8</span>.8.8.8
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>Pinging<span class="w"> </span><span class="m">8</span>.8.8.8<span class="w"> </span>with<span class="w"> </span><span class="m">32</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data:
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>Request<span class="w"> </span>timed<span class="w"> </span>out.
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>Request<span class="w"> </span>timed<span class="w"> </span>out.
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>Ping<span class="w"> </span>statistics<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8</span>.8.8.8:
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">    </span>Packets:<span class="w"> </span><span class="nv">Sent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="nv">Received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">Lost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span><span class="m">100</span>%<span class="w"> </span>loss<span class="o">)</span>,
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ping<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span>google.com
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>Ping<span class="w"> </span>request<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>host<span class="w"> </span>google.com.<span class="w"> </span>Please<span class="w"> </span>check<span class="w"> </span>the<span class="w"> </span>name<span class="w"> </span>and<span class="w"> </span>try<span class="w"> </span>again.
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ping<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">[</span>your<span class="w"> </span>physical<span class="w"> </span>host<span class="err">&#39;</span>s<span class="w"> </span>IP<span class="w"> </span>address/Wifi<span class="w"> </span>address<span class="o">]</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>Pinging<span class="w"> </span>x.x.x.x<span class="w"> </span>with<span class="w"> </span><span class="m">32</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data:
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>Request<span class="w"> </span>timed<span class="w"> </span>out.
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>Request<span class="w"> </span>timed<span class="w"> </span>out.
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>Ping<span class="w"> </span>statistics<span class="w"> </span><span class="k">for</span><span class="w"> </span>x.x.x.x:
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a><span class="w">    </span>Packets:<span class="w"> </span><span class="nv">Sent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="nv">Received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="nv">Lost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span><span class="m">100</span>%<span class="w"> </span>loss<span class="o">)</span>,
</code></pre></div>
<p>Under certain circumstances, you may see a ping response when pinging a DNS record. Depending on if you have been using the lab and INetSim, this response may be coming from the INetSim DNS resolver. Stopping INetSim, flushing the DNS cache on FLAREVM, and attempting to ping again should fix this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ping<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span>google.com
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>Pinging<span class="w"> </span>google.com<span class="w"> </span><span class="o">[</span><span class="m">10</span>.0.0.3<span class="o">]</span><span class="w"> </span>with<span class="w"> </span><span class="m">32</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>data:
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>Reply<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.3:<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">32</span><span class="w"> </span>time&lt;1ms<span class="w"> </span><span class="nv">TTL</span><span class="o">=</span><span class="m">64</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>Reply<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.0.0.3:<span class="w"> </span><span class="nv">bytes</span><span class="o">=</span><span class="m">32</span><span class="w"> </span>time&lt;1ms<span class="w"> </span><span class="nv">TTL</span><span class="o">=</span><span class="m">64</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>Ping<span class="w"> </span>statistics<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.0.0.3:
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">    </span>Packets:<span class="w"> </span><span class="nv">Sent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="nv">Received</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="nv">Lost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>%<span class="w"> </span>loss<span class="o">)</span>,
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>Approximate<span class="w"> </span>round<span class="w"> </span>trip<span class="w"> </span><span class="nb">times</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>milli-seconds:
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">    </span><span class="nv">Minimum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0ms,<span class="w"> </span><span class="nv">Maximum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0ms,<span class="w"> </span><span class="nv">Average</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0ms
</code></pre></div>
<p>[On REMnux, stop INetSim wih Ctl+C]</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ipconfig<span class="w"> </span>/flushdns
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>Windows<span class="w"> </span>IP<span class="w"> </span>Configuration
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>Successfully<span class="w"> </span>flushed<span class="w"> </span>the<span class="w"> </span>DNS<span class="w"> </span>Resolver<span class="w"> </span>Cache.
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;ping<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span>google.com
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>Ping<span class="w"> </span>request<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>host<span class="w"> </span>google.com.<span class="w"> </span>Please<span class="w"> </span>check<span class="w"> </span>the<span class="w"> </span>name<span class="w"> </span>and<span class="w"> </span>try<span class="w"> </span>again
</code></pre></div>
<h4 id="test-inetsim">Test INetSim</h4>
<p>Use the configuration details from the INetSim setup from PMAT and test to make sure FLAREVM can still access arbitrary DNS records.</p>
<p>Start INetSim on REMnux:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>remnux@remnux:~$<span class="w"> </span>inetsim
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>INetSim<span class="w"> </span><span class="m">1</span>.3.2<span class="w"> </span><span class="o">(</span><span class="m">2020</span>-05-19<span class="o">)</span><span class="w"> </span>by<span class="w"> </span>Matthias<span class="w"> </span>Eckert<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>Thomas<span class="w"> </span>Hungenberg
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>Using<span class="w"> </span>log<span class="w"> </span>directory:<span class="w">      </span>/var/log/inetsim/
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>Using<span class="w"> </span>data<span class="w"> </span>directory:<span class="w">     </span>/var/lib/inetsim/
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>Using<span class="w"> </span>report<span class="w"> </span>directory:<span class="w">   </span>/var/log/inetsim/report/
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>Using<span class="w"> </span>configuration<span class="w"> </span>file:<span class="w"> </span>/etc/inetsim/inetsim.conf
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>Parsing<span class="w"> </span>configuration<span class="w"> </span>file.
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>Configuration<span class="w"> </span>file<span class="w"> </span>parsed<span class="w"> </span>successfully.
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="o">===</span><span class="w"> </span>INetSim<span class="w"> </span>main<span class="w"> </span>process<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1902</span><span class="o">)</span><span class="w"> </span><span class="o">===</span>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>Session<span class="w"> </span>ID:<span class="w">     </span><span class="m">1902</span>
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>Listening<span class="w"> </span>on:<span class="w">   </span><span class="m">10</span>.0.0.3
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>Real<span class="w"> </span>Date/Time:<span class="w"> </span><span class="m">2022</span>-09-12<span class="w"> </span><span class="m">06</span>:48:40
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>Fake<span class="w"> </span>Date/Time:<span class="w"> </span><span class="m">2022</span>-09-12<span class="w"> </span><span class="m">06</span>:48:40<span class="w"> </span><span class="o">(</span>Delta:<span class="w"> </span><span class="m">0</span><span class="w"> </span>seconds<span class="o">)</span>
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="w"> </span>Forking<span class="w"> </span>services...
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="w">  </span>*<span class="w"> </span>dns_53_tcp_udp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1906</span><span class="o">)</span>
<a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a><span class="w">  </span>*<span class="w"> </span>smtp_25_tcp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1909</span><span class="o">)</span>
<a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a><span class="w">  </span>*<span class="w"> </span>pop3_110_tcp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1911</span><span class="o">)</span>
<a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a><span class="w">  </span>*<span class="w"> </span>pop3s_995_tcp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1912</span><span class="o">)</span>
<a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a><span class="w">  </span>*<span class="w"> </span>smtps_465_tcp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1910</span><span class="o">)</span>
<a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a><span class="w">  </span>*<span class="w"> </span>ftp_21_tcp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1913</span><span class="o">)</span>
<a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a><span class="w">  </span>*<span class="w"> </span>https_443_tcp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1908</span><span class="o">)</span>
<a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a><span class="w">  </span>*<span class="w"> </span>http_80_tcp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1907</span><span class="o">)</span>
<a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a><span class="w">  </span>*<span class="w"> </span>ftps_990_tcp<span class="w"> </span>-<span class="w"> </span>started<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">1914</span><span class="o">)</span>
<a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a><span class="w"> </span><span class="k">done</span>.
<a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>Simulation<span class="w"> </span>running.
</code></pre></div>
<p>Use nslookup from FLAREVM for an arbitrary DNS record:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;nslookup<span class="w"> </span>asdasdasd.com
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>Server:<span class="w">  </span>www.inetsim.org
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>Address:<span class="w">  </span><span class="m">10</span>.0.0.3
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>Name:<span class="w">    </span>asdasdasd.com
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>Address:<span class="w">  </span><span class="m">10</span>.0.0.3
</code></pre></div>
<p>Use a browser to browse to an arbitrary site name:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_6.png" /></a></p>
<h4 id="conclusion">Conclusion</h4>
<p>That concludes this section on Host-Only network safety and creating an Internal Network for our malware analysis lab. You have learned more about the safety considerations of the Host-Only network setup and how to make an Internal Network to apply a greater degree of safety to the lab setup.</p>
<p>Remember, both of these lab network setups are sufficiently safe for this course. Please consider each type of network and what your needs are as a malware analyst for analysis beyond the PMAT course.</p>
</div>
<div class="admonition info">
<h3 id="lab-vm-repo-link">Lab VM Repo Link</h3>
<p>Update 11/13/2021</p>
<p>Hello!</p>
<p>A few students have approached me about their lab installations and some issues they have encountered. I'd like to explain a little about my thought process for the lab in this course and offer a solution for those having issues creating the lab.</p>
<p>In Instructional Design theory, there is a concept called "cognitive load." Basically, the instructor of a course should do as much as possible to limit the number of extra activities a student completes to learn a concept. I take a lot of care to make sure I'm never overloading my students with meaningless activities!</p>
<p>In a lot of cybersecurity training courses, there is a lot of lab setup before you get to do the fun stuff. In most of those other courses, the lab is just a lot of work upfront until you can learn the concepts taught in the course.</p>
<p>But with malware analysis, creating a lab is a skill in and of itself. It is incredibly important to learn how to set up and maintain a lab during analysis because the safety of your data is at stake!</p>
<p>So I ask you, please put an honest effort into making sure you set up your lab correctly so that you are safe. This skill is critical for any malware analyst.</p>
<p>That having been said, if you are having serious issues with your lab build and can't seem to get it to work (or need a clean state to revert back to), please feel free to use the VM images located at the GDrive link below. It has both FLAREVM and REMnux in clean, known-good states and should work for the remainder of the course.</p>
<p>Link: https://drive.google.com/drive/folders/11-d9MfCbitiyt4OmT-oP-vSeR9viUuRn</p>
</div>
<div class="admonition info">
<h3 id="rapid-deployable-cloud-malware-analysis-lab-setup">Rapid-deployable Cloud Malware Analysis Lab Setup</h3>
<p><strong>I don't give a rats behind about this atm.</strong></p>
<h4 id="introduction_1">Introduction</h4>
<p>This section is optional. If you already have your local lab environment set up and have no interest in building a cloud malware analysis lab, please feel free to skip this section.</p>
<p>For those of you who are looking for a cloud lab setup, this section is for you!</p>
<p>There are many reasons why a cloud lab set up can be ideal for malware analysis. It transfers the risk of malware analysis to ephemeral assets. It keeps your own physical host safe. And it can be a great option for analysts who do not have the compute power necessary to run several local VMs.</p>
<p>The following section outlines how to set up a rapid-deployable cloud malware analysis lab in Amazon Web Services (AWS). We will walk through how to leverage Terraform to make the process of provisioning and tearing down the lab as easy as running a set of simple commands. By the end of this section, you will have the capability to spin up and tear down cloud lab hosts within minutes.</p>
<p>But first, a few warnings.</p>
<h4 id="warning-you-need-permission-to-do-this">WARNING: You need permission to do this</h4>
<p>AWS permits malware analysis on provisioned instances on a case-by-case basis. To engage in malware analysis on AWS infrastructure, you must fill out and submit a Simulated Events form for review. Fill the form out to the best of your ability and submit it prior to analyzing malware. The form can be found at the link below (you must be logged in to view this form)</p>
<p>https://console.aws.amazon.com/support/contacts#/simulated-events</p>
<h4 id="warning-some-assembly-required">WARNING: Some Assembly Required</h4>
<p>Provisioning cloud resources can be tricky if you are not familiar with the process. I will do my best to lay out a crash course in how to work within AWS, but unfortunately the topic is too grand to do it justice in a single section of a course. This is not an AWS course, after all!</p>
<p>The goal for this section is not to give you a comprehensive understanding of how to provision cloud assets. The goal is to get to the point where we can lean on Terraform to do most of the heavy lifting for us.</p>
<p>If you are choosing to build a cloud lab environment, I assume that you are either already familiar with AWS or you are confident enough in your abilities to troubleshoot issues on your own. The potential for issues to arise during this section of the course is far too high and I can’t help everyone with every issue, every time.</p>
<p>Please anticipate that you may need to troubleshoot your own set up and research the specifics of working in AWS if you elect to use a cloud lab. I will do my best to assist but I can't fix everything!</p>
<h4 id="warning-this-stuff-aint-free">WARNING: This Stuff Ain’t Free</h4>
<p>Cloud assets cost money.</p>
<p>My philosophy for this course has always been that the initial sticker price is everything the student will ever have to pay. I can adhere to that philosophy when it comes to things like open source tools, free software, etc. But this is the one area of the course where you will pay more money to do the activities and you should know that ahead of time.</p>
<p>How much more money, exactly? The good news is, not much. AWS cloud assets are very cheap and cost cents (US) per hour of run time. I do some rough calculations at the end of this section to show you how much you could reasonably expect to pay if you used the lab to do all of PMAT. TL;DR: with liberal estimates of usage, you should expect to pay somewhere between $3 and $9 USD if you use the cloud lab during the practical portions of this course.</p>
<p><strong>I disclaim responsibility if you leave your instances running and forget to terminate them and rack up a huge AWS bill!</strong></p>
<h4 id="first-credit">First, Credit</h4>
<p>I give the credit for this section squarely to PMAT student Adan Alvarez (@Flekyy90), who created the GitHub repository that contained the original code that I modified to use in this section. I used the code in his repository as a skeleton and made some tweaks to fit the PMAT lab environment. He did outstanding work on the original repo and deserves tons of credit for it. Thank you, Adan!</p>
<p>https://twitter.com/Flekyy90/status/1594390758010015744</p>
<p>Please go show him some love!</p>
<p>adanalvarez - Overview</p>
<h4 id="requirements">Requirements</h4>
<p>To build a cloud lab, you need the following:</p>
<div class="highlight"><pre><span></span><code>A workstation with a terminal where you’ll run your cloud provisioning commands.
I recommend the Windows Subsystem for Linux (WSL) for this purpose.
Alternatively, any Ubuntu host will work.
</code></pre></div>
<ul>
<li>Terraform</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>wget<span class="w"> </span>-O-<span class="w"> </span>https://apt.releases.hashicorp.com/gpg<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/hashicorp-archive-keyring.gpg
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com </span><span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span><span class="s2"> main&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/hashicorp.list
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>terraform<span class="w"> </span>-y
</code></pre></div>
<ul>
<li>jq</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>jq<span class="w"> </span>-y
</code></pre></div>
<ul>
<li>awscli</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>awscli<span class="w"> </span>-y
</code></pre></div>
<div class="highlight"><pre><span></span><code>An AWS account. Go to the main AWS page and click “Create an AWS Account” to get started.
A way to pay for the compute that you will use.
</code></pre></div>
<h4 id="create-your-terraform-iam-user">Create your terraform IAM User</h4>
<p>We will now use the AWS Identity and Account Management service (IAM) to create a user. This user’s job is to spin up and tear down cloud VMs on our behalf. We will use it in conjunction with Terraform to build our lab.</p>
<ul>
<li>Go to https://console.aws.amazon.com/iam/ and sign in.</li>
<li>In the IAM resources table, click on Users.</li>
<li>Click Add User<ul>
<li>Name: terraform</li>
<li>Click Next</li>
<li>Keep the Permissions Options as “As user to group”</li>
<li>Under User Groups, check the box for EC2FullAccess</li>
<li>Click next.</li>
<li>Review the options and click Create User</li>
</ul>
</li>
<li>Back in the IAM &gt; Users section, click on the name of the new terraform user</li>
<li>Go to the Security Credentials tab</li>
<li>Scroll down to the Access keys section</li>
<li>Click “Create Access Key”</li>
<li>From the options on the “Access key best practices &amp; alternatives” section, select “Command Line Interface”</li>
<li>Check the box for “I understand the above recommendation and want to proceed to create an access key.” and select Next.</li>
<li>Select “Create Access Key“</li>
<li>When your new access key is created, you can click on the key and click “Show” to view the access key’s secret.</li>
</ul>
<p><strong>THE ACCESS KEY SECRET IS A PASSWORD. KEEP IT SAFE.</strong>
<a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_7.png" /></a></p>
<h4 id="configure-awscli">Configure awscli</h4>
<p>We will set up awscli to use our access key securely.</p>
<ul>
<li>In your Linux terminal, after installing <code>awscli</code>, enter: <code>aws configure</code></li>
<li>For each prompt, enter the following:<ul>
<li>AWS Access Key ID: [enter the terraform user’s access key ID]</li>
<li>AWS Secret Access Key: [enter the terraform user’s secret key]</li>
<li>Default region name: [enter your desired default region. If you plan on using the PMAT AMIs, enter us-east-1]</li>
<li>Default output format: <code>json</code></li>
</ul>
</li>
</ul>
<p>Now, <code>awscli</code> has securely configured our credentials so Terraform can use them to provision cloud hosts.</p>
<h4 id="creating-the-lab">Creating the Lab</h4>
<p>High-level Network Architecture</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_8.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_8.png" /></a></p>
<p>The architecture for the cloud analysis lab network accomplishes a few things:</p>
<ul>
<li>It allows our two analysis workstations to communicate on a Virtual Private Cloud (VPC) network (10.0.0.0/24)</li>
<li>It blocks all ingress traffic unless it originates from within the analysis VPC, with one exception (our Apache Guacamole jump-box).</li>
<li>By default, the security groups prevent our analysis workstations from accessing anything outside of this VPC. We will also have the option to change the security groups to allow outbound internet access.</li>
<li>It allows any PMAT student anywhere in the world to access an Apache Guacamole jump-box that can use RDP, SSH, and VNC to access the isolated analyst workstations.</li>
<li>It enforces a security group rule that only allows the public IP address of a PMAT student to access the public IP of Apache Guacamole on port 443. This rule is dynamically generated when the network is created.</li>
</ul>
<h4 id="lab-workstation-images">Lab Workstation Images</h4>
<p>For this course, I have made two Amazon Machine Images (AMIs) for use in this section. These two AMIs are pre-fabricated images of FLARE-VM and REMnux for use during the course. They are both publicly available.</p>
<p>I will consider the creation of AMIs to be out of scope for this section. Do note that if you want to make your own FLARE-VM and/or REMnux AMI and use them, AWS allows you to do so. The process for creating a FLARE-VM and REMnux AMI is basically the same as when you do it in a local lab. The only difference is that you run the FLARE-VM installation scripts on a running instance of Windows Server 2019/2022 on AWS and then save that instance as your AMI.</p>
<p>Adan’s walkthrough has more information about how to do this process:</p>
<p>https://github.com/adanalvarez/AWS-malware-lab</p>
<h4 id="pmat-cloud-amis-credentials">PMAT Cloud AMIs &amp; Credentials</h4>
<div class="highlight"><pre><span></span><code>PMAT-FLAREVM-BASE AMI: `ami-0432b4a6451f79442`
Username: `Administrator`
Password: `PLEASEchangeThisPassword123`
PMAT-REMNUX-BASE AMI: `ami-0e17adcda27f0edf2`
Username: `remnux`
Password: `malware`
</code></pre></div>
<p><strong>The PMAT AMIs are only available in the AWS us-east-1 region</strong>. You must use this region if you want to use the PMAT AMIs.</p>
<h4 id="lab-provisioning-with-terraform">Lab Provisioning With Terraform</h4>
<p>We will use Apache Guacamole as our jump-point to access the isolated lab. As such, we need to subscribe to the Apache Guacamole AMI that is maintained by Bitnami. The AMI itself is free and only costs the compute to run it while it is provisioned.</p>
<p>The AMI is available here:</p>
<p>Apache Guacamole packaged by Bitnami https://aws.amazon.com/marketplace/pp?sku=6sq2ud425j12tj4didc8xzf6m</p>
<p>After subscribing, you can go to your AWS Subscriptions to recover the AMI number.</p>
<h4 id="clone-the-pmat-lab-repository-to-your-workstation">Clone the PMAT-lab repository to your workstation</h4>
<p>Clone the PMAT-labs repository to your host:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/HuskyHacks/PMAT-labs
</code></pre></div>
<p>Change directories into the <code>PMAT-labs/aws-lab/</code> directory and examine the contents.</p>
<h4 id="configure-the-terraform-files">Configure the Terraform files</h4>
<p>The code in this directory sets up the skeleton of the AWS malware analysis lab. We have to make a few tweaks before it will run.</p>
<ul>
<li>In the aws-lab directory, create a file called shared.auto.tfvars.json and copy in the following, making alterations when necessary:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="o">{</span><span class="w"> </span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">    </span><span class="s2">&quot;environment&quot;</span>:<span class="w"> </span><span class="s2">&quot;pmat-lab&quot;</span>,
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="s2">&quot;flarevm-ami&quot;</span>:<span class="w"> </span><span class="s2">&quot;ami-0432b4a6451f79442&quot;</span>,
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span><span class="s2">&quot;guacamole-ami&quot;</span>:<span class="w"> </span><span class="s2">&quot;ami-XXXXXXXXXXXXXXXXX&quot;</span>,
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="w">    </span><span class="s2">&quot;remnux-ami&quot;</span>:<span class="w"> </span><span class="s2">&quot;ami-0e17adcda27f0edf2&quot;</span>,
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w">    </span><span class="s2">&quot;account&quot;</span>:<span class="w"> </span><span class="s2">&quot;############&quot;</span>,
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w">    </span><span class="s2">&quot;region&quot;</span>:<span class="w"> </span><span class="s2">&quot;us-east-1&quot;</span>,
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="w">    </span><span class="s2">&quot;availability_zone&quot;</span>:<span class="w"> </span><span class="s2">&quot;us-east-1a&quot;</span>,
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="w">    </span><span class="s2">&quot;enable_guacamole&quot;</span>:<span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="o">}</span>
</code></pre></div>
<p>… where:</p>
<ul>
<li>'flarevm-ami': this is the public AMI for the PMAT-FLAREVM-BASE image.</li>
<li>'guacamole-ami': Use the AMI string that you get after you subscribe to the Bitnami Apache Guacamole AMI.</li>
<li>'remnux-ami': this is the public AMI for the PMAT-REMNUX-BASE image.</li>
<li>'account': this is your own IAM account number for the 'terraform' user that you created. Go to the IAM section in AWS and look at the “Account ID” field on the right side. The 'account' number is that 12 digit number.</li>
<li>'region': the PMAT AMIs are only available in us-east-1. If you build your own AMIs, you build them in any region you want.</li>
<li>'availability_zone': the PMAT AMIs are only available in us-east-1a. If you build your own AMIs, you build them in any region you want.</li>
<li>'enable_guacamole': leave as 'true' to use Apache Guacamole</li>
</ul>
<p>Once the 'shared.auto.tfvars.json' is set, we can initialize, plan, and apply our Terraform configuration.</p>
<h4 id="configure-terraform-launch-the-lab">Configure Terraform &amp; Launch the Lab</h4>
<p>The Terraform code in the aws-lab directory does most of the heavy lifting here. Make sure you are in the aws-labs directory. Now, all we have to do is run the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>terraform<span class="w"> </span>init
</code></pre></div>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_9.png" /></a></p>
<p>The <code>init</code> command initializes the working directory where all of the files that will make up our Terraform lab will reside.</p>
<p>Following the <code>init</code> command, we run the Terraform <code>plan</code> command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>terraform<span class="w"> </span>plan
</code></pre></div>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_10.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_10.png" /></a></p>
<p>The <code>plan</code> command creates an execution plan, which lets you preview the changes that Terraform plans to make to your infrastructure. We can see exactly what Terraform is going to provision for us.</p>
<p>Finally, if we don’t have any errors, we can run the <code>apply</code> command to provision our lab:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>terraform<span class="w"> </span>apply
</code></pre></div>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_11.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_11.png" /></a></p>
<p>Once you input "yes", Terraform goes to work:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_12.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_12.png" /></a></p>
<p>The provisioning will continue for about 6 minutes. If you look in your AWS EC2 dashboard panel, you will see your lab spring to life!</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_13.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_13.png" /></a></p>
<p>At the end of the provisioning, you will see the username, password, and public IP address of the Guacamole server.</p>
<p>Important Note: The security groups are configured to only allow your own public IP address to connect to the Guacamole server on HTTPS to keep our lab secure. It is generally not a good idea to leave your instances open to the internet. Wherever you can, make sure to lock down your firewall rules so only your IP address can access your instances!</p>
<p>The username for our Guacamole server is always <code>guacadmin</code>. The password is randomly generated each time. The public IP address of the Guacamole server is assigned at provisioning and will also change between deployments:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_14.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_14.png" /></a></p>
<p>The two IP addresses in the <code>10.0.0.0/24</code> network are for FLARE-VM and REMnux. The two hosts are located on an isolated AWS subnet. These two hosts are accessible via Apache Guacamole but do not have any connectivity to the rest of the world.</p>
<h4 id="access-configure-apache-guacamole">Access &amp; Configure Apache Guacamole</h4>
<p>We will use the Guacamole server for our jump-point into our analysis network.</p>
<p>Go to <code>https://[guacamole IP address]</code> to access the Guacamole server and accept the insecurity warning.</p>
<p>Sign in with the credentials from the Terraform output. Then, on the main Guacamole page, go to the guacadmin drop down and select Settings:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_15.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_15.png" /></a></p>
<p>Click on Connections and click New Connection:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_16.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_16.png" /></a></p>
<p>First, we will input the connection information for FLARE-VM.</p>
<ul>
<li>In the Name field, enter: flarevm</li>
<li>In the Protocol field, change it to RDP.</li>
<li>Scroll down to the Parameters section. In the Network fields, enter 10.0.0.4 for the Hostname and 3389 for the port.</li>
<li>Enter Administrator for the username and PLEASEchangeThisPassword123 for the password.</li>
<li>Check the box for Ignore Server Certificate</li>
</ul>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_17.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_17.png" /></a></p>
<p>Once these options are set, scroll down and select Save.</p>
<p>Check the connection by returning to the main page and selecting the <code>flarevm</code> connection that is now available. After a brief moment, the FLARE-VM desktop should render in the browser.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_18.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_18.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_19.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_19.png" /></a></p>
<p>Note that the FLARE-VM logo will not be present as we are currently in an RDP session.</p>
<h4 id="access-configure-remnux">Access &amp; Configure REMnux</h4>
<p>Return to the configuration section and add a new connection as we did before. This time, name it <code>remnux-ssh</code> and set the protocol to SSH.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_20.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_20.png" /></a></p>
<p>In the parameters section, set the Hostname field to <code>10.0.0.6</code> and the Port to 22.</p>
<p>Set the Username and Password fields to <code>remnux</code> and <code>malware</code>, respectively.</p>
<p>Click Save once the options are set.</p>
<p>Return to the Home page and select the <code>remnux-ssh</code> connection to start an SSH session on REMnux:</p>
<h4 id="configure-vnc-on-remnux">Configure VNC on REMNux</h4>
<p>There is also a VNC server available on REMnux for those that want GUI access. Simply run the <code>vncRun.sh</code> script located in the <code>remnux</code> user’s home directory.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_21.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_21.png" /></a></p>
<p>Once the VNC server is running, make a new connection in the Guacamole connections section to use VNC:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_22.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_22.png" /></a></p>
<p>Now, VNC Desktop view is available for REMnux:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_23.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_23.png" /></a></p>
<h4 id="switching-flare-vm-back-to-internet-access">Switching FLARE-VM Back to Internet Access</h4>
<p>If you need FLARE-VM to access the internet to download the PMAT-lab repo or a tool that didn’t install correctly, the <code>security_group_flarevm outbound_internet</code> security group allows outbound access to all IP addresses on all ports/protocols. It is configured as a security group for the lab VPC.</p>
<p>To switch over, go to the FLARE-VM instance from within EC2:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_24.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_24.png" /></a></p>
<p>Then click <code>Actions -&gt; Security → Change Security Groups</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_25.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_25.png" /></a></p>
<p>Then remove the <code>no_internet</code> security group and add the <code>outbound_internet</code> security group and click Save.</p>
<p>https://cdn.fs.teachablecdn.com/ADNupMnWyR7kCWRvm76Laz/https://www.filepicker.io/api/file/SruXHjwySAuhp48HeH2l</p>
<p>Then remove the no_internet security group and add the outbound_internet security group and click Save.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_26.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_26.png" /></a></p>
<p>After you’re done, remember to remove the <code>outbound_internet</code> security group and re-add the <code>no_internet</code> security group.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_27.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_27.png" /></a></p>
<h4 id="reverting-flare-vm-after-detonation">Reverting FLARE-VM After Detonation</h4>
<p>To revert FLARE-VM to a clean state after detonation, we can issue the Terraform <code>apply</code> command and specify to replace the FLARE-VM host.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>terraform<span class="w"> </span>apply<span class="w"> </span>-replace<span class="o">=</span>aws_instance.flarevm
</code></pre></div>
<h4 id="destroy-the-lab">Destroy the Lab</h4>
<p>Please, please, PLEASE remember to destroy your lab when you are done using it.</p>
<p>The destroy command will stop and terminate all running instances in the Terraform config. This prevents you from burning compute and racking up a bill!</p>
<p>To destroy the instances of the lab entirely, we can issue the Terraform <code>destroy</code> command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>terraform<span class="w"> </span>destroy
</code></pre></div>
<p>Note that the Terraform configuration can still pull from the specified AMIs to make new instances. You will, however, need to configure the Guacamole server and download any additional tools that you want.</p>
<h4 id="on-cloud-malware-analysis-safety">On Cloud Malware Analysis Safety</h4>
<p>The differences between a local malware analysis lab and a cloud-based lab are worth discussing. In some ways, analysis is identical no matter where you perform it. But in other ways, analyzing malware in the cloud has stipulations.</p>
<p>If we examine the AWS security groups present in the Terraform documents, we can see how the cloud lab network is set up.</p>
<p>Each instance in the lab has specific security group configurations that are added to the instance when it provisions. For example, examine the FLARE-VM instance configuration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c1"># Create Security groups FlareVM - no internet</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>resource<span class="w"> </span><span class="s2">&quot;aws_security_group&quot;</span><span class="w"> </span><span class="s2">&quot;security_group_flarevm_no_internet&quot;</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">  </span><span class="nv">count</span><span class="w">       </span><span class="o">=</span><span class="w"> </span>var.enable_guacamole<span class="w"> </span>?<span class="w"> </span><span class="m">1</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">  </span><span class="nv">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;security_group_flarevm no_internet&quot;</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">  </span><span class="nv">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allow inbound from local subnet&quot;</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">  </span><span class="nv">vpc_id</span><span class="w">      </span><span class="o">=</span><span class="w"> </span>aws_vpc.lab_vpc.id
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="w">  </span>ingress<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="w">    </span><span class="nv">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allow inbound traffic from local subnet&quot;</span>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="w">    </span><span class="nv">from_port</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="w">    </span><span class="nv">to_port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="w">    </span><span class="nv">protocol</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-1&quot;</span>
<a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a><span class="w">    </span><span class="nv">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;10.0.0.0/24&quot;</span><span class="o">]</span>
<a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a>
<a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a>
<a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a><span class="w">  </span>egress<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a><span class="w">    </span><span class="nv">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allow outbound to local subnet&quot;</span>
<a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a><span class="w">    </span><span class="nv">from_port</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a><span class="w">    </span><span class="nv">to_port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a><span class="w">    </span><span class="nv">protocol</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-1&quot;</span>
<a id="__codelineno-41-23" name="__codelineno-41-23" href="#__codelineno-41-23"></a><span class="w">    </span><span class="nv">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;10.0.0.0/24&quot;</span><span class="o">]</span>
<a id="__codelineno-41-24" name="__codelineno-41-24" href="#__codelineno-41-24"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-41-25" name="__codelineno-41-25" href="#__codelineno-41-25"></a>
<a id="__codelineno-41-26" name="__codelineno-41-26" href="#__codelineno-41-26"></a>
<a id="__codelineno-41-27" name="__codelineno-41-27" href="#__codelineno-41-27"></a><span class="w">  </span><span class="nv">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-41-28" name="__codelineno-41-28" href="#__codelineno-41-28"></a><span class="w">    </span><span class="nv">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">var</span><span class="p">.environment</span><span class="si">}</span><span class="s2">-flarevm-no-internet&quot;</span>
<a id="__codelineno-41-29" name="__codelineno-41-29" href="#__codelineno-41-29"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-41-30" name="__codelineno-41-30" href="#__codelineno-41-30"></a><span class="o">}</span>
</code></pre></div>
<p>This security group restricts the FLARE-VM instance from accessing anything outside the lab subnet (10.0.0.0/24). Traffic within the local subnet is not restricted. Malware that detonates on FLARE-VM can access any endpoint in the analysis network on any port. But it cannot traverse from the analysis subnet to the outside world because the egress rule is limited to the CIDR block of the analysis network. REMnux has a similar configuration.</p>
<p>Conversely, the alternate security group that allows internet access opens the egress subnet to all addresses (0.0.0.0/0):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c1"># Create Security groups FlareVM - with outbound internet</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>resource<span class="w"> </span><span class="s2">&quot;aws_security_group&quot;</span><span class="w"> </span><span class="s2">&quot;security_group_flarevm_outbound_internet&quot;</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">  </span><span class="nv">count</span><span class="w">       </span><span class="o">=</span><span class="w"> </span>var.enable_guacamole<span class="w"> </span>?<span class="w"> </span><span class="m">1</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">  </span><span class="nv">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;security_group_flarevm outbound_internet&quot;</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">  </span><span class="nv">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allow outbound internet access&quot;</span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">  </span><span class="nv">vpc_id</span><span class="w">      </span><span class="o">=</span><span class="w"> </span>aws_vpc.lab_vpc.id
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>ingress<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">    </span><span class="nv">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allow RDP inbound traffic&quot;</span>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">    </span><span class="nv">from_port</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">3389</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="w">    </span><span class="nv">to_port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="m">3389</span>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="w">    </span><span class="nv">protocol</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tcp&quot;</span>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="w">    </span><span class="nv">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;10.0.0.5/32&quot;</span><span class="o">]</span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="w">  </span>egress<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="w">    </span><span class="nv">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allow all protocols outbound to any subnet&quot;</span>
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="w">    </span><span class="nv">from_port</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a><span class="w">    </span><span class="nv">to_port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a><span class="w">    </span><span class="nv">protocol</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-1&quot;</span>
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a><span class="w">    </span><span class="nv">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;0.0.0.0/0&quot;</span><span class="o">]</span>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a>
<a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a><span class="w">  </span><span class="nv">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a><span class="w">    </span><span class="nv">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">var</span><span class="p">.environment</span><span class="si">}</span><span class="s2">-flarevm-internet&quot;</span>
<a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a><span class="o">}</span>
</code></pre></div>
<p>When this security group is applied, the instances can reach the open internet. Consider this to be the same thing as putting a local VM back on the NAT network to download a tool or malware sample.</p>
<p>The only instance that is different here is Apache Guacamole, which is our jump-box that allows us to access the isolated malware analysis lab without exposing our own physical host to the analysis endpoints. Guacamole acts as a proxy for our access into the network. We access it via HTTPS and it, in turn, accesses each instance via SSH, RDP, and/or VNC.</p>
<p>The Guacamole server limits the ingress traffic to only allow a single IP address on port 443. The only allowed IP address is dynamically assigned from the output of checking <code>http://ipv4.icanhazip.com</code> and returning the result. This recovers your own public-facing IP address and adds it in as the allowed IP address for this security group rule in the line <code>["${chomp(data.http.myip.response_body)}/32"]</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c1"># Create Security Group for Guacamole</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>resource<span class="w"> </span><span class="s2">&quot;aws_security_group&quot;</span><span class="w"> </span><span class="s2">&quot;security_group_guacamole&quot;</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">  </span><span class="nv">count</span><span class="w">       </span><span class="o">=</span><span class="w"> </span>var.enable_guacamole<span class="w"> </span>?<span class="w"> </span><span class="m">1</span><span class="w"> </span>:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">  </span><span class="nv">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;security_group_guacamole&quot;</span>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">  </span><span class="nv">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allow HTTPS from the Internet&quot;</span>
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">  </span><span class="nv">vpc_id</span><span class="w">      </span><span class="o">=</span><span class="w"> </span>aws_vpc.lab_vpc.id
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">  </span>ingress<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">    </span><span class="nv">description</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Allow HTTPS inbound traffic&quot;</span>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="w">    </span><span class="nv">from_port</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="m">443</span>
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">    </span><span class="nv">to_port</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="m">443</span>
<a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="w">    </span><span class="nv">protocol</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tcp&quot;</span>
<a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="w">    </span><span class="nv">cidr_blocks</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">chomp</span><span class="p">(data.http.myip.response_body)</span><span class="si">}</span><span class="s2">/32&quot;</span><span class="o">]</span>
<a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a>
<a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="w">  </span>egress<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a><span class="w">    </span><span class="nv">from_port</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a><span class="w">    </span><span class="nv">to_port</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a><span class="w">    </span><span class="nv">protocol</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-1&quot;</span>
<a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a><span class="w">    </span><span class="nv">cidr_blocks</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;0.0.0.0/0&quot;</span><span class="o">]</span>
<a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a><span class="w">    </span><span class="nv">ipv6_cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;::/0&quot;</span><span class="o">]</span>
<a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a>
<a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a><span class="w">  </span><span class="nv">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a><span class="w">    </span><span class="nv">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">var</span><span class="p">.environment</span><span class="si">}</span><span class="s2">-guacamole&quot;</span>
<a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a><span class="w">  </span><span class="o">}</span>
<a id="__codelineno-43-27" name="__codelineno-43-27" href="#__codelineno-43-27"></a><span class="o">}</span>
</code></pre></div>
<p>All things considered, we now have:</p>
<ul>
<li>A private AWS malware analysis subnet (10.0.0.0/24)</li>
<li>FLARE-VM that can talk to everything on our private malware analysis subnet but cannot talk to the outside world by default</li>
<li>REMnux that has the same configuration as FLARE-VM</li>
<li>Apache Guacamole that can communicate with the two internal hosts to start connection sessions but also allows your specific IP address to connect to it via HTTPS</li>
<li>A set of other security group rules that allow the hosts to talk to the outside world should we need them.</li>
</ul>
<h4 id="costs">Costs</h4>
<p>Cloud resources are not free, but we do benefit from the smaller scale and overall simplicity of this setup.</p>
<p>Normally, storing AMIs will cost about $3/month for a 60GB AMI. I am storing the AMIs and have made them available to the public, so you will not incur any cost for that. However, if you decide to build your own AMIs, that is the approximate cost.</p>
<p>For the instances of the lab, each student will run three t2.medium servers for the duration of their practical work in the labs. AWS does not charge a user for instances unless those instances are actively running.</p>
<p>A single t2.medium asset, at the time of writing this, costs about $0.04/hour to run. Let’s use a liberal estimate and say that our three t2.medium servers will cost $.20/hour to run. PMAT has over 9 hours of content, plus an additional 10 or so hours of labs and challenges. If we assume a student runs this lab for the entire time, our numbers work out to .20 * 20 hours = $4 USD to run the lab.</p>
<p>If we extrapolate that out, if a student were to let this lab run for an entire month straight without shutting the lab instances off, it would be $144 for the entire month. This should highlight the importance of shutting off your instances when you are not using them. But even though that seems expensive, the entire PMAT course will not take a straight month.</p>
<p>I anticipate that the average amount of usage for a PMAT student to complete the labs, if they turn the labs on while using them and shut them off when they are done, would be between $3 and $9.</p>
<h4 id="summary">Summary</h4>
<p>We now have a rapid-deployable, pre-configured malware analysis cloud lab! We can use this lab to carry out all of the analysis in this course and beyond.</p>
<p>Bonus: Cloudy with a Chance of Malware</p>
<p>This is a talk that I gave at the Cloud Security Alliance of Southern California about the cloud lab infrastructure in this course. It covers the architecture of the lab and how we apply layered security to our cloud resources. It's a great place to reference when building your cloud lab.</p>
<p><a href="https://www.youtube.com/watch?v=GBMb18aSZkQ"> Cloudy with a Chance of Malware: Moving Malware Analysis to the Cloud </a></p>
</div>
<div class="admonition info">
<h3 id="course-lab-repo-link">Course Lab Repo Link</h3>
<p>The labs for this course are available here: <code>https://github.com/HuskyHacks/PMAT-labs</code></p>
<p>This repo has all of the malware needed to complete this course. Please use this link and view the next video, "Course Lab Repo Download &amp; Lab Orientation" for instructions on how to get started with the repo.</p>
</div>
<div class="admonition info">
<h3 id="taking-a-snapshot-before-first-detonation">Taking a Snapshot Before First Detonation</h3>
<p>Sample for this section <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//4-1.Bossfight-wannacry.exe/Ransomware.wannacry.exe.malz.7z">Ransomware.wannacry.exe.malz.7z</a></p>
</div>
<div class="admonition info">
<h3 id="detonating-our-first-sample">Detonating Our First Sample</h3>
<p>Sample for this section:</p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//4-1.Bossfight-wannacry.exe/Ransomware.wannacry.exe.malz.7z">Lab file(s)</a></p>
<p>Please Note: For this detonation, turn off INetSim before detonating. WannaCry will not detonate if INetSim is running.</p>
<p>Why, you ask? You'll find that out at the end of the course!</p>
</div>
<div class="admonition info">
<h3 id="course-tool-list-resources">Course Tool List &amp; Resources</h3>
<p>The following list is the full set of tools used in PMAT and their associated download resources. Please reference this list for any tools that fail to install or are no longer installed during the setup.</p>
<p><strong>FLARE-VM Tool List</strong>
- <a href="https://github.com/mandiant/flare-floss">strings/FLOSS</a>
- <a href="http://wjradburn.com/software/">PEView</a>
- <a href="https://upx.github.io/">upx (not used but referenced)</a>
- <a href="https://www.winitor.com/download">PEStudio</a>
- <a href="https://github.com/mandiant/capa">Capa</a>
- <a href="https://www.wireshark.org/">Wireshark</a>
- <a href="https://learn.microsoft.com/n-us/sysinternals/downloads/">Sysinternals (Procmon, TCPView)</a>
- <a href="https://nmap.org/download">nc/ncat</a>
- <a href="https://github.com/rizinorg/cutter">Cutter</a>
- <a href="https://x64dbg.com/">x32/x64dbg</a>
- <a href="https://ysteminformer.sourceforge.io/">Process Hacker 2 (now known as System Informer)</a>
- <a href="https://github.com/dzzie/SCDBG">scdbg</a>
- <a href="https://github.com/dnSpyEx/dnSpy">dnSpy/dnSpyEx</a>
- <a href="https://hshrzd.wordpress.com/pe-bear/">PEBear</a>
- <a href="https://github.com/VirusTotal/yara">YARA</a></p>
<p><strong>REMnux Tool List</strong>
- base64 (built in Linux bin)
- <a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py">OLEdump</a>
- <a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF">MobSF github</a> | <a href="https://hub.docker.com/r/opensecurity/mobile-security-framework-mobsf/">(Docker Container)</a>
- <a href="https://www.inetsim.org/">INetSim</a></p>
</div>
<div class="admonition info">
<h3 id="basic-malware-handling">Basic Malware Handling</h3>
<p>Sample for this section:</p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//0-1.HandlingAndSafety/Malware.Calc.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/0-1.HandlingAndSafety">Lab file(s)</a></p>
</div>
<div class="admonition info">
<h3 id="safe-malware-sourcing-additional-resources">Safe Malware Sourcing &amp; Additional Resources</h3>
<p>References:</p>
<ul>
<li><a href="https://github.com/HuskyHacks/PMAT-labs">PMAT Labs</a></li>
<li><a href="https://github.com/ytisf/theZoo">theZoo</a></li>
<li><a href="https://www.vx-underground.org/">vx-underground main site</a></li>
<li><a href="https://github.com/vxunderground/MalwareSourceCode">vx-underground GitHub repo</a></li>
<li><a href="https://zeltser.com/malware-sample-sources/">Zeltser Resources</a></li>
<li><a href="https://bazaar.abuse.ch/">MalwareBazaar</a></li>
</ul>
</div>
</div>
<div class="admonition info">
<h2 id="2-basic-static-analysis">2. Basic Static Analysis</h2>
<div class="admonition info"></div>
<h3 id="hashing-malware-samples">Hashing Malware Samples</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="malware-repositories-virustotal">Malware Repositories: VirusTotal</h3>
<p>https://www.virustotal.com/gui/home/upload</p>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="strings-floss-static-string-analysis">Strings &amp; FLOSS: Static String Analysis</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<p>Tip: FLOSS can be run with the "-n" argument to specify your desired minimum string length. Sometimes, longer strings can be more useful to an analyst than your standard string of len(4).</p>
<p>For example, if I want to pull all strings of length 6 or greater, I can issue the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>floss.exe<span class="w"> </span>-n<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">[</span>malware_name.exe<span class="o">]</span>
</code></pre></div>
<div class="admonition info"></div>
<h3 id="analyzing-the-import-address-table">Analyzing the Import Address Table</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<p><strong>Errata</strong></p>
<p>As of December 2022, the new FLARE-VM installation script does not contain all of the tools that are depicted in the course. Never fear! All of the tools in this course are available free and open source.</p>
<p>The tool in this video, PEView, is available here: http://wjradburn.com/software/</p>
<p>Click on that link and download PEView (http://wjradburn.com/software/PEview.zip) and add it to the FLARE-VM host.</p>
<div class="admonition info"></div>
<h3 id="introduction-to-the-windows-api">Introduction to the Windows API</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="malapiio">MalAPI.io</h3>
<p>Researcher @mrd0x released MalAPI.io, an online catalog of Windows APIs that are commonly used in malware. This is an incredible resource that helps to discern which APIs are worth scrutiny when performing analysis of the IAT.</p>
<p>Site: https://malapi.io</p>
<div class="admonition info"></div>
<h3 id="to-pack-or-not-to-pack-packed-malware-analysis">To Pack Or Not To Pack: Packed Malware Analysis</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.PackedAndNotPacked.exe.malz/Malware.PackedAndNotPacked.exe.zip">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="combining-analysis-methods-pestudio">Combining Analysis Methods: PEStudio</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="identifying-malware-capabilities-intro-to-mitre-attck">Identifying Malware Capabilities &amp; Intro to MITRE ATT&amp;CK</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<p>Our goal during basic static analysis is to triage correctly and as quickly as possible. Now that we've learned a bit about how to perform basic static analysis and how to correlate static indicators, let's deploy another tool that can assist in this phase and hopefully speed things up.</p>
<p>Introducing, Capa: https://github.com/mandiant/capa</p>
<p><a class="glightbox" href="Practical_Malware_Analysis_Triage_img0_0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="Practical_Malware_Analysis_Triage_img0_0.png" /></a></p>
<p>Capa is a program that detects malicious capabilities in suspicious programs by using a set of rules. These rules are meant to be as high-level and human readable as possible. For example, Capa will examine a binary, identify an API call or string of interest, and match this piece of information against a rule that is called "receive data" or "connect to a URL". It translates the technical information in a binary into a simple, human-readable piece of information.</p>
<p>The program's primary strength is how it leverages rules. Capa has a default rule set, but also has an open-source repository of rules where anyone can contribute. You can see the Capa rule repository here: https://github.com/mandiant/capa-rules</p>
<p>Let's learn more about this tool by using it on the binary we've already performed static analysis on, <code>Malware.Unknown.exe.malz</code>.</p>
<p>On FLAREVM, run <code>capa -h</code> to see the usage menu:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky<span class="se">\D</span>esktop
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>λ<span class="w"> </span>capa<span class="w"> </span>-h
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>usage:<span class="w"> </span>capa.exe<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>--version<span class="o">]</span><span class="w"> </span><span class="o">[</span>-v<span class="o">]</span><span class="w"> </span><span class="o">[</span>-vv<span class="o">]</span><span class="w"> </span><span class="o">[</span>-d<span class="o">]</span><span class="w"> </span><span class="o">[</span>-q<span class="o">]</span><span class="w"> </span><span class="o">[</span>--color<span class="w"> </span><span class="o">{</span>auto,always,never<span class="o">}]</span><span class="w"> </span><span class="o">[</span>-f<span class="w"> </span><span class="o">{</span>auto,pe,sc32,sc64,freeze<span class="o">}]</span><span class="w"> </span><span class="o">[</span>-b<span class="w"> </span><span class="o">{</span>vivisect,smda<span class="o">}]</span><span class="w"> </span><span class="o">[</span>-r<span class="w"> </span>RULES<span class="o">]</span><span class="w"> </span><span class="o">[</span>-t<span class="w"> </span>TAG<span class="o">]</span><span class="w"> </span><span class="o">[</span>-j<span class="o">]</span><span class="w"> </span>sample
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>The<span class="w"> </span>FLARE<span class="w"> </span>team<span class="s1">&#39;s open-source tool to identify capabilities in executable files.</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="s1">positional arguments:</span>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="s1">sample                path to sample to analyze</span>
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a>
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="s1">optional arguments:</span>
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="s1">-h, --help            show this help message and exit</span>
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="s1">--version             show program&#39;</span>s<span class="w"> </span>version<span class="w"> </span>number<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span>
<a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>-v,<span class="w"> </span>--verbose<span class="w">         </span><span class="nb">enable</span><span class="w"> </span>verbose<span class="w"> </span>result<span class="w"> </span>document<span class="w"> </span><span class="o">(</span>no<span class="w"> </span>effect<span class="w"> </span>with<span class="w"> </span>--json<span class="o">)</span>
<a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>-vv,<span class="w"> </span>--vverbose<span class="w">       </span><span class="nb">enable</span><span class="w"> </span>very<span class="w"> </span>verbose<span class="w"> </span>result<span class="w"> </span>document<span class="w"> </span><span class="o">(</span>no<span class="w"> </span>effect<span class="w"> </span>with<span class="w"> </span>--json<span class="o">)</span>
<a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>-d,<span class="w"> </span>--debug<span class="w">           </span><span class="nb">enable</span><span class="w"> </span>debugging<span class="w"> </span>output<span class="w"> </span>on<span class="w"> </span>STDERR
<a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a>-q,<span class="w"> </span>--quiet<span class="w">           </span>disable<span class="w"> </span>all<span class="w"> </span>output<span class="w"> </span>but<span class="w"> </span>errors
<a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a>--color<span class="w"> </span><span class="o">{</span>auto,always,never<span class="o">}</span>
<a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a><span class="w">                        </span><span class="nb">enable</span><span class="w"> </span>ANSI<span class="w"> </span>color<span class="w"> </span>codes<span class="w"> </span><span class="k">in</span><span class="w"> </span>results,<span class="w"> </span>default:<span class="w"> </span>only<span class="w"> </span>during<span class="w"> </span>interactive<span class="w"> </span>session
<a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a>-f<span class="w"> </span><span class="o">{</span>auto,pe,sc32,sc64,freeze<span class="o">}</span>,<span class="w"> </span>--format<span class="w"> </span><span class="o">{</span>auto,pe,sc32,sc64,freeze<span class="o">}</span>
<a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="w">                        </span><span class="k">select</span><span class="w"> </span>sample<span class="w"> </span>format,<span class="w"> </span>auto:<span class="w"> </span><span class="o">(</span>default<span class="o">)</span><span class="w"> </span>detect<span class="w"> </span>file<span class="w"> </span><span class="nb">type</span><span class="w"> </span>automatically,<span class="w"> </span>pe:<span class="w"> </span>Windows<span class="w"> </span>PE<span class="w"> </span>file,<span class="w"> </span>sc32:<span class="w"> </span><span class="m">32</span>-bit<span class="w"> </span>shellcode,<span class="w"> </span>sc64:<span class="w"> </span><span class="m">64</span>-bit<span class="w"> </span>shellcode,<span class="w"> </span>freeze:<span class="w"> </span>features<span class="w"> </span>previously<span class="w"> </span>frozen<span class="w"> </span>by<span class="w"> </span>capa
<a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a>-b<span class="w"> </span><span class="o">{</span>vivisect,smda<span class="o">}</span>,<span class="w"> </span>--backend<span class="w"> </span><span class="o">{</span>vivisect,smda<span class="o">}</span>
<a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a><span class="w">                        </span><span class="k">select</span><span class="w"> </span>the<span class="w"> </span>backend<span class="w"> </span>to<span class="w"> </span>use
<a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a>-r<span class="w"> </span>RULES,<span class="w"> </span>--rules<span class="w"> </span>RULES
<a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a><span class="w">                        </span>path<span class="w"> </span>to<span class="w"> </span>rule<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory,<span class="w"> </span>use<span class="w"> </span>embedded<span class="w"> </span>rules<span class="w"> </span>by<span class="w"> </span>default
<a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a>-t<span class="w"> </span>TAG,<span class="w"> </span>--tag<span class="w"> </span>TAG<span class="w">     </span>filter<span class="w"> </span>on<span class="w"> </span>rule<span class="w"> </span>meta<span class="w"> </span>field<span class="w"> </span>values
<a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a>-j,<span class="w"> </span>--json<span class="w">            </span>emit<span class="w"> </span>JSON<span class="w"> </span>instead<span class="w"> </span>of<span class="w"> </span>text
<a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a>
<a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a>By<span class="w"> </span>default,<span class="w"> </span>capa<span class="w"> </span>uses<span class="w"> </span>a<span class="w"> </span>default<span class="w"> </span><span class="nb">set</span><span class="w"> </span>of<span class="w"> </span>embedded<span class="w"> </span>rules.
<a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a>You<span class="w"> </span>can<span class="w"> </span>see<span class="w"> </span>the<span class="w"> </span>rule<span class="w"> </span><span class="nb">set</span><span class="w"> </span>here:
<a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a>&lt;https://github.com/fireeye/capa-rules&gt;
<a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a>
<a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a>To<span class="w"> </span>provide<span class="w"> </span>your<span class="w"> </span>own<span class="w"> </span>rule<span class="w"> </span>set,<span class="w"> </span>use<span class="w"> </span>the<span class="w"> </span><span class="sb">`</span>-r<span class="sb">`</span><span class="w"> </span>flag:
<a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a>capa<span class="w">  </span>--rules<span class="w"> </span>/path/to/rules<span class="w">  </span>suspicious.exe
<a id="__codelineno-45-34" name="__codelineno-45-34" href="#__codelineno-45-34"></a>capa<span class="w">  </span>-r<span class="w">      </span>/path/to/rules<span class="w">  </span>suspicious.exe
<a id="__codelineno-45-35" name="__codelineno-45-35" href="#__codelineno-45-35"></a>
<a id="__codelineno-45-36" name="__codelineno-45-36" href="#__codelineno-45-36"></a>examples:
<a id="__codelineno-45-37" name="__codelineno-45-37" href="#__codelineno-45-37"></a>identify<span class="w"> </span>capabilities<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>binary
<a id="__codelineno-45-38" name="__codelineno-45-38" href="#__codelineno-45-38"></a><span class="w">    </span>capa<span class="w"> </span>suspicious.exe
<a id="__codelineno-45-39" name="__codelineno-45-39" href="#__codelineno-45-39"></a>
<a id="__codelineno-45-40" name="__codelineno-45-40" href="#__codelineno-45-40"></a>identify<span class="w"> </span>capabilities<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">32</span>-bit<span class="w"> </span>shellcode,<span class="w"> </span>see<span class="w"> </span><span class="sb">`</span>-f<span class="sb">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>all<span class="w"> </span>supported<span class="w"> </span>formats
<a id="__codelineno-45-41" name="__codelineno-45-41" href="#__codelineno-45-41"></a><span class="w">    </span>capa<span class="w"> </span>-f<span class="w"> </span>sc32<span class="w"> </span>shellcode.bin
<a id="__codelineno-45-42" name="__codelineno-45-42" href="#__codelineno-45-42"></a>
<a id="__codelineno-45-43" name="__codelineno-45-43" href="#__codelineno-45-43"></a>report<span class="w"> </span>match<span class="w"> </span>locations
<a id="__codelineno-45-44" name="__codelineno-45-44" href="#__codelineno-45-44"></a><span class="w">    </span>capa<span class="w"> </span>-v<span class="w"> </span>suspicious.exe
<a id="__codelineno-45-45" name="__codelineno-45-45" href="#__codelineno-45-45"></a>
<a id="__codelineno-45-46" name="__codelineno-45-46" href="#__codelineno-45-46"></a>report<span class="w"> </span>all<span class="w"> </span>feature<span class="w"> </span>match<span class="w"> </span>details
<a id="__codelineno-45-47" name="__codelineno-45-47" href="#__codelineno-45-47"></a><span class="w">    </span>capa<span class="w"> </span>-vv<span class="w"> </span>suspicious.exe
<a id="__codelineno-45-48" name="__codelineno-45-48" href="#__codelineno-45-48"></a>
<a id="__codelineno-45-49" name="__codelineno-45-49" href="#__codelineno-45-49"></a>filter<span class="w"> </span>rules<span class="w"> </span>by<span class="w"> </span>meta<span class="w"> </span>fields,<span class="w"> </span>e.g.<span class="w"> </span>rule<span class="w"> </span>name<span class="w"> </span>or<span class="w"> </span>namespace
<a id="__codelineno-45-50" name="__codelineno-45-50" href="#__codelineno-45-50"></a><span class="w">    </span>capa<span class="w"> </span>-t<span class="w"> </span><span class="s2">&quot;create TCP socket&quot;</span><span class="w"> </span>suspicious.exe
</code></pre></div>
<p>Note: if Capa is not installed and accessible by running <code>capa</code> from the command line, please install the release binary for the program located at https://github.com/mandiant/capa/releases/tag/v4.0.1</p>
<p>Capa has lots of command line options, but let's run it against Malware.Unknown.exe.malz with no arguments to see what the program looks like by default.</p>
<p>Run capa <code>C:\path\to\Malware.Unknown.exe.malz</code> to execute the program. Because I am in the Desktop directory, the command is <code>capa Malware.Unknown.exe.malz</code> in my example below:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_1.png" /></a></p>
<p>Let's examine the results. Immediately, we see some boiler-plate information about the binary, like its hashes. But then, we get some interesting high-level information about the program.</p>
<p>The first block in the output labeled "ATT&amp;CK Tactic - ATT&amp;CK Technique" is worth examining in depth.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_2.png" /></a></p>
<p><strong>What is ATT&amp;CK?</strong></p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_3.png" /></a></p>
<p>https://attack.mitre.org/</p>
<p>The MITRE ATT&amp;CK Framework is a standard knowledge base of adversary tactics, techniques, and procedures (TTPs). MITRE ATT&amp;CK seeks to define and classify cyber adversary activity into groups based on what the activity seeks to accomplish and how the activity is carried out.</p>
<p>In my professional life, no other standard set of definitions has seen more use than MITRE ATT&amp;CK. It is an industry standard just about everywhere you go.</p>
<p>For example, let's say you want high-level information about the types of tactics that adversaries use to gain initial access to a target network. The MITRE ATT&amp;CK Framework has a grouped list of items classified under TA0001 - Initial Access, that you can view in list form:</p>
<p>https://attack.mitre.org/tactics/TA0001/</p>
<p>Then, if you want more information about a specific initial access technique, like phishing, you can view the technique page for T1566 - Phishing:</p>
<p>https://attack.mitre.org/techniques/T1566/</p>
<p>And then, if you want an example of a more specific sub-technique of phishing, like spearphishing with an attachment, you can view the subtechnique T1566.001 - Spearphisning Attachment:</p>
<p>https://attack.mitre.org/techniques/T1566/001/</p>
<p>The pages in the ATT&amp;CK matrix have information about the specific tactic/technique, tools that can deploy this technique, mitigations, and detections. For example, T1566.001 - Spearphishing Attachments lists the known adversary groups that use this technique (which, for Spearphishing, is probably most adversaries!):</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_8.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_8.png" /></a></p>
<p>I highly recommend perusing the MITRE ATT&amp;CK matrix items. I can get lost in that website for hours learning about new tactics, techniques, and procedures. I also highly recommend becoming fluent in the ATT&amp;CK framework for report writing as it can be an exceptionally useful way to frame findings and information in industry common terms.</p>
<h3 id="capa-output">Capa Output</h3>
<p>Now, back to Capa! Capa has examined the binary, pulled out interesting information from the binary, matched it against its default rule set, and matched some suspected capabilities to items from the MITRE ATT&amp;CK Framework. This time, we don't have much to go on. We get a match for the ATT&amp;CK item "T1129 - Shared Modules".</p>
<p>If we examine the matrix item for Shared Modules, we don't get a lot of useful information:</p>
<p>https://attack.mitre.org/techniques/T1129/</p>
<blockquote>
<p>Adversaries may execute malicious payloads via loading shared modules. The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides in NTDLL.dll and is part of the Windows Native API which is called from functions like CreateProcess, LoadLibrary, etc. of the Win32 API.</p>
</blockquote>
<p>This basically means that the malware is loading DLLs to perform malicious activity. That's not particularly revealing! Let's keep moving.</p>
<p>Instructor's Note: it seems that the Shared Modules technique wasn't too useful at all and the Capa developers have removed the default rule for it! If you run Capa against this sample, there's a chance you will not see this as a listed technique. It's not particularly useful for our analysis, so please feel free to move on to the next section.</p>
<p>If you want to see an example of how Capa can identify techniques, also feel free to run Capa against the WannaCry sample that we detonated earlier in the course.</p>
<p><strong>Malware Behavioral Catalog (MBC)</strong></p>
<p>The next output is the Malware Behavioral Catalog (MBC) Objectives and Behaviors. This is a similar classification system to MITRE ATT&amp;CK but focuses on malware specifically.</p>
<p>The full MBC Matrix can be found here: https://github.com/MBCProject/mbc-markdown#malware-objective-descriptions</p>
<p>MBC translates MITRE ATT&amp;CK items into terms that focus on the malware analysis use case. So understandably, we do get some useful output from this section:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_4.png" /></a></p>
<p>Here, Capa has identified items of interest in the binary, matched them to rules based on MBC items, and returned the results. We've accurately identified that the Malware.Unknown.exe.malz sample has the capability to</p>
<ul>
<li>Send and receive data</li>
<li>Do so over HTTP</li>
<li>Create and terminate processes</li>
</ul>
<p>For a preliminary round of triage, that's pretty good! But let's keep going; the best is yet to come.</p>
<p><strong>Capa Rule Output</strong></p>
<p>The final block identifies Capa rule matches against the default Capa rule set. This is the most specific of the three outputs and gives us the best information for triage:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_5.png" /></a></p>
<p>Like in the MBC output, the Capa rule output identifies that the malware can connect to a URL, send and receive data, and manipulate processes. At surface, there isn't much more information here than what we already have. But we do see the number of matches and the namespace for the rules in this output.</p>
<p>Is there more going on under the hood of Capa? Yes, yes there is!</p>
<p>Let's rerun Capa with the verbose flag <code>capa [C:\path\to\Malware.Unknown.exe.malz] -v</code> and examine the output:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_6.png" /></a></p>
<p>There's a lot more output here! Capa identifies the rule that is triggered for the binary, the type of rule, and even the location in the binary where the rule is triggered in hex form! We can start to see the mechanism here for how Capa identifies things that trigger the rules - it uses the Vivisect parser to examine interesting strings and byte patterns and matches them against the rules.</p>
<p>Finally, let's run Capa one more time with a double verbose output <code>capa [C:\path\to\Malware.Unknown.exe.malz] -vv</code> and examine the output:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img0_7.png" /></a></p>
<p>There is tons of incredible information here and we can clearly see how Capa is now triggering the rules for this binary. For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>download<span class="w"> </span>URL<span class="w"> </span>to<span class="w"> </span>file
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>namespace<span class="w">  </span>communication/http/client
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>author<span class="w">     </span>matthew.williams@fireeye.com
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>scope<span class="w">      </span><span class="k">function</span>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>mbc<span class="w">        </span>Communication::HTTP<span class="w"> </span>Communication::Download<span class="w"> </span>URL<span class="w"> </span><span class="o">[</span>C0002.006<span class="o">]</span>
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>examples<span class="w">   </span>F5C93AC768C8206E87544DDD76B3277C:0x100020F0,<span class="w"> </span>Practical<span class="w"> </span>Malware<span class="w"> </span>Analysis<span class="w"> </span>Lab<span class="w"> </span><span class="m">20</span>-01.exe_:0x401040
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="k">function</span><span class="w"> </span>@<span class="w"> </span>0x401080
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>or:
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="w">    </span>api:<span class="w"> </span>urlmon.URLDownloadToFile<span class="w"> </span>@<span class="w"> </span>0x4010D9
</code></pre></div>
<p>The output for the "download URL to file" rule indicates that this rule triggers when the <code>urlmon.URLDownloadToFile</code> API call is located in the binary. It has identified this API call, provides the location in the binary where it is called, and provides some examples of where this kind of malware behavior has been seen before.</p>
<p>Notice that for some rules, there are conditionals that can trigger the rule based on multiple criteria. For example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>create<span class="w"> </span>process<span class="w"> </span><span class="o">(</span><span class="m">2</span><span class="w"> </span>matches<span class="o">)</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>namespace<span class="w">  </span>host-interaction/process/create
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>author<span class="w">     </span>moritz.raabe@fireeye.com
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>scope<span class="w">      </span>basic<span class="w"> </span>block
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>mbc<span class="w">        </span>Process::Create<span class="w"> </span>Process<span class="w"> </span><span class="o">[</span>C0017<span class="o">]</span>
<a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>examples<span class="w">   </span>9324D1A8AE37A36AE560C37448C9705A:0x406DB0,<span class="w"> </span>Practical<span class="w"> </span>Malware<span class="w"> </span>Analysis<span class="w"> </span>Lab<span class="w"> </span><span class="m">01</span>-04.exe_:0x4011FC
<a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>basic<span class="w"> </span>block<span class="w"> </span>@<span class="w"> </span>0x4010E3
<a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a>or:
<a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="w">    </span>api:<span class="w"> </span>shell32.ShellExecute<span class="w"> </span>@<span class="w"> </span>0x401128
<a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a>basic<span class="w"> </span>block<span class="w"> </span>@<span class="w"> </span>0x401142
<a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a>or:
<a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a><span class="w">    </span>api:<span class="w"> </span>kernel32.CreateProcess<span class="w"> </span>@<span class="w"> </span>0x4011AD
</code></pre></div>
<p>This rule identifies process creation based on the existence of the <code>ShellExecute</code> API call located in <code>shell32.dll</code> or the <code>CreateProcess</code> API call located in kernel32.dll.</p>
<p>The documentation on Capa rule generation is located here: https://github.com/mandiant/capa-rules/blob/master/doc/format.md</p>
<p><strong>Summary</strong>
Now that we understand the specifics of basic static analysis, we can turn to a tool like Capa to do a lot of the heavy lifting for us during triage. Capa can give us high-level information about what may be going on in the sample of interest. It's usually never enough information to draw a definitive conclusion, but it's a start! More analysis is necessary to uncover the ground truth for any given sample.</p>
</div>
<div class="admonition info">
<h2 id="3-basic-dynamic-analysis">3. Basic Dynamic Analysis</h2>
<div class="admonition info"></div>
<h3 id="start-basic-dynamic-analysis-intro-host-and-network-indicators">Start Basic Dynamic Analysis Intro: Host and Network Indicators</h3>
<div class="admonition info"></div>
<h3 id="start-initial-detonation-triage-hunting-for-network-signatures">Start Initial Detonation &amp; Triage: Hunting for Network Signatures</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<p>(Note: we are still using the sample from the Basic Static Analysis section even though we are now in the Basic Dynamic section!)</p>
<div class="admonition info"></div>
<h3 id="start-host-based-indicators-procmon-part-i">Start Host-Based Indicators: Procmon Part I</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<p>(Note: we are still using the sample from the Basic Static Analysis section even though we are now in the Basic Dynamic section!)</p>
<div class="admonition info"></div>
<h3 id="start-host-based-indicators-procmon-part-ii">Start Host-Based Indicators: Procmon Part II</h3>
<p>Sample for this section:
<a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-1.BasicStaticAnalysis/Malware.Unknown.exe.malz/Malware.Unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-1.BasicStaticAnalysis">Lab file(s)</a></p>
<p>(Note: we are still using the sample from the Basic Static Analysis section even though we are now in the Basic Dynamic section!)</p>
<div class="admonition info"></div>
<h3 id="start-dynamic-analysis-of-unknown-binaries-part-i-analyzing-wireshark">Start Dynamic Analysis of Unknown Binaries Part I: Analyzing Wireshark</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-2.BasicDynamicAnalysis/RAT.Unknown.exe.malz/RAT.Unknown.exe.malz.7z">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-dynamic-analysis-of-unknown-binaries-part-ii-host-based-indicators">Start Dynamic Analysis of Unknown Binaries Part II: Host-Based Indicators</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-2.BasicDynamicAnalysis/RAT.Unknown.exe.malz/RAT.Unknown.exe.malz.7z">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-analyzing-a-reverse-shell-part-i-correlating-iocs">Start Analyzing a Reverse Shell Part I: Correlating IOCs</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-2.BasicDynamicAnalysis/RAT.Unknown2.exe.malz/RAT.Unknown2.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-2.BasicDynamicAnalysis">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-analyzing-a-reverse-shell-part-ii-parent-child-process-analysis">Start Analyzing a Reverse Shell Part II: Parent-Child Process Analysis</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-2.BasicDynamicAnalysis/RAT.Unknown2.exe.malz/RAT.Unknown2.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/1-2.BasicDynamicAnalysis">Lab file(s)</a></p>
</div>
<div class="admonition info">
<h2 id="4-challenge-1-sillyputty">4. Challenge 1: SillyPutty</h2>
<div class="admonition info"></div>
<h3 id="start-challenge-1-sillyputty-intro">Start Challenge 1: SillyPutty Intro</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//1-3.Challenge-SillyPutty/putty.7z">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-challenge-1-sillyputty-walkthrough">Start Challenge 1: SillyPutty Walkthrough</h3>
</div>
<div class="admonition info">
<h2 id="5-advanced-static-analysis-assembly-language-decompiling-disassembling-malware">5. Advanced Static Analysis: Assembly Language, Decompiling, &amp; Disassembling Malware</h2>
<div class="admonition info"></div>
<h3 id="start-intro-to-advanced-analysis-assembly-language">Start Intro to Advanced Analysis &amp; Assembly Language</h3>
<div class="admonition info"></div>
<h3 id="start-disassembling-decompiling-a-malware-dropper-intro-to-cutter">Start Disassembling &amp; Decompiling a Malware Dropper: Intro to Cutter</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//2-1.AdvancedStaticAnalysis/Dropper.DownloadFromURL.exe.malz/Dropper.DownloadFromURL.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-1.AdvancedStaticAnalysis">Lab file(s)</a></p>
<p><strong>Errata</strong>
Please note that, depending on when you installed FLARE-VM, the installed tools may or may not include Cutter. If you don't see it when searching in the task bar, please download it from the official site here: https://cutter.re/</p>
<div class="admonition info"></div>
<h3 id="start-x86-cpu-instructions-memory-registers-the-stack-a-closer-look">Start x86 CPU Instructions, Memory Registers, &amp; the Stack: A Closer Look</h3>
<div class="admonition info"></div>
<h3 id="start-revisiting-the-dropper-assembly-instructions-and-the-windows-api">Start Revisiting the Dropper: Assembly Instructions and the Windows API</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//2-1.AdvancedStaticAnalysis/Dropper.DownloadFromURL.exe.malz/Dropper.DownloadFromURL.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-1.AdvancedStaticAnalysis">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-hello-world-under-a-microscope-part-i">Start Hello, World! Under a Microscope Part I</h3>
<p>Samples for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-1.AdvancedStaticAnalysis/helloWorld-c">Lab File(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-advanced-analysis-of-a-process-injector">Start Advanced Analysis of a Process Injector</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//2-1.AdvancedStaticAnalysis/Malware.stage0.exe.malz/Malware.stage0.exe.malz.7z">Lab file(s)</a></p>
<p><strong>Errata</strong>
At about 8:30 in this video, I made an error regarding different values that are moved in and out of EAX during the set up for the process injection. In short, I say that PID of an injected process is stored in EAX first, then moved into EDI after the call to OpenProcess returns. This is not technically true: what is returned to EAX after the OpenProcess call is not the PID of the process, but the handle to that process. This seems like a minor difference but handles are a completely different data type within the Windows OS and are used to interact with an instance of a process. TL;DR: once a process injector can get a handle to a process, it can use the handle with all of its remaining API calls to perform the injection.</p>
</div>
<div class="admonition info">
<h2 id="6-advanced-dynamic-analysis-debugging-malware">6. Advanced Dynamic Analysis: Debugging Malware</h2>
<div class="admonition info"></div>
<h3 id="start-getting-comfortable-in-x32dbg-flow-control-breakpoints">Start Getting Comfortable in x32dbg: Flow Control &amp; Breakpoints</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//2-2.AdvancedDynamicAnalysis/Dropper.DownloadFromURL/Dropper.DownloadFromURL.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-2.AdvancedDynamicAnalysis">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-debugging-the-dropper-dynamic-analysis-of-x86-instructions-api-calls">Start Debugging the Dropper: Dynamic Analysis of x86 Instructions &amp; API Calls</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//2-2.AdvancedDynamicAnalysis/Dropper.DownloadFromURL/Dropper.DownloadFromURL.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-2.AdvancedDynamicAnalysis">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-hello-world-under-a-microscope-part-ii">Start Hello, World! Under a Microscope Part II</h3>
<p>Samples for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//2-2.AdvancedDynamicAnalysis/helloWorld-c">Lab file(s)</a></p>
</div>
<div class="admonition info">
<h2 id="7-challenge-2-sikomode">7. Challenge 2: SikoMode</h2>
<div class="admonition info"></div>
<h3 id="start-challenge-2-sikomode-intro">Start Challenge 2: SikoMode Intro</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//2-3.Challenge-SikoMode/unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-3.Challenge-SikoMode">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-challenge-2-sikomode-walkthrough">Start Challenge 2: SikoMode Walkthrough</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs//2-3.Challenge-SikoMode/unknown.exe.7z">Lab file(s)</a></p>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-3.Challenge-SikoMode">Lab file(s)</a></p>
<div class="admonition info"></div>
<h3 id="start-bonus-lecture-live-analysis-of-challenge-2-sikomode-twitch-stream-with-taggart">Start Bonus Lecture: Live Analysis of Challenge 2 SikoMode Twitch Stream with Taggart</h3>
<p>Check out a Twitch stream that I did with Michael Taggart where we walk through a full analysis of Challenge 2: SikoMode. This stream is a crash course in everything that we have covered up to this point, including the philosophy of malware analysis and a brief overview of each phase of technical analysis.</p>
<p>The analysis portion begins at 30:45.</p>
<p>Link: https://youtu.be/noLjgnoKRLU?t=1841</p>
</div>
<div class="admonition info">
<h2 id="8-binary-patching-anti-analysis">8. Binary Patching &amp; Anti-analysis</h2>
<div class="admonition info"></div>
<h3 id="start-patch-it-out-patching-x86-binaries">Start Patch it out: Patching x86 Binaries</h3>
<p>Sample for this section: <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-4.BinaryPatching/SimplePatchMe">Lab File(s)</a></p>
<h4 id="introduction_2">Introduction</h4>
<p>Our job as malware analysts is to discern what a malware specimen is doing. Sometimes, the malware is designed to prevent us from accomplishing that goal. We need to outsmart the malware when this is the case. Binary patching is one example of how we can outsmart the malware specimen!</p>
<p>Let’s examine a very simple binary patching technique. More importantly, I will walk through the methodology at the Assembly level so it’s clear why binary patching even works in the first place.</p>
<h4 id="setting-up">Setting Up</h4>
<p>On FLAREVM, make a copy of main.exe called main2.exe:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;<span class="w"> </span>cp<span class="w"> </span>.<span class="se">\m</span>ain.exe<span class="w"> </span>.<span class="se">\m</span>ain_2.exe
</code></pre></div>
<p>On FLAREVM, open Cutter and open main2.exe up in Cutter. Make sure to click the 
“Load in write mode” box</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_0.png" /></a></p>
<p>Let’s examine the source code of this program so we have a strong reference point for when we dive into the ASM insanity.</p>
<h4 id="simplepatchme-source-code-mainnim">SimplePatchMe Source Code - main.nim</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="kn">import</span> <span class="nn">std</span><span class="o">/</span><span class="n">httpclient</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="kn">import</span> <span class="nn">nimcrypto</span>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="n">proc</span> <span class="n">evaluate_http_body</span><span class="p">():</span> <span class="nb">bool</span> <span class="o">=</span>
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>        <span class="c1"># Download key from endpoint</span>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>        <span class="n">var</span> <span class="n">client</span> <span class="o">=</span> <span class="n">newHttpClient</span><span class="p">()</span>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>        <span class="n">var</span> <span class="n">res</span> <span class="o">=</span>  <span class="n">client</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&quot;http://freetshirts.local/key.crt&quot;</span><span class="p">)</span>
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>        <span class="n">let</span> <span class="n">key_contents</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">body</span>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>        <span class="c1"># Compute SHA256 of body of response</span>
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a>        <span class="n">let</span> <span class="n">sha256sum</span> <span class="o">=</span> <span class="n">sha256</span><span class="o">.</span><span class="n">digest</span><span class="p">(</span><span class="n">key_contents</span><span class="p">)</span>
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a>
<a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a>        <span class="k">return</span> <span class="err">$</span><span class="n">sha256sum</span> <span class="o">==</span> <span class="s2">&quot;221E8347990B3F77531D55AA7B11969A47DBF53ACDEDD611EFD4D12112F352D3&quot;</span>
<a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a>
<a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a>        <span class="n">echo</span> <span class="s2">&quot;[-] Error: &quot;</span> <span class="o">&amp;</span> <span class="n">e</span><span class="o">.</span><span class="n">msg</span>
<a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a>        <span class="k">return</span> <span class="n">false</span>
<a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a>
<a id="__codelineno-49-20" name="__codelineno-49-20" href="#__codelineno-49-20"></a><span class="n">proc</span> <span class="n">run_payload</span><span class="p">():</span> <span class="n">void</span> <span class="o">=</span>
<a id="__codelineno-49-21" name="__codelineno-49-21" href="#__codelineno-49-21"></a>    <span class="n">echo</span> <span class="s2">&quot;[!] Boom!&quot;</span>
<a id="__codelineno-49-22" name="__codelineno-49-22" href="#__codelineno-49-22"></a>
<a id="__codelineno-49-23" name="__codelineno-49-23" href="#__codelineno-49-23"></a>
<a id="__codelineno-49-24" name="__codelineno-49-24" href="#__codelineno-49-24"></a><span class="n">when</span> <span class="n">isMainModule</span><span class="p">:</span>
<a id="__codelineno-49-25" name="__codelineno-49-25" href="#__codelineno-49-25"></a>    <span class="n">var</span> <span class="n">res</span> <span class="o">=</span> <span class="n">evaluate_http_body</span><span class="p">()</span>
<a id="__codelineno-49-26" name="__codelineno-49-26" href="#__codelineno-49-26"></a>    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
<a id="__codelineno-49-27" name="__codelineno-49-27" href="#__codelineno-49-27"></a>        <span class="n">run_payload</span><span class="p">()</span>
<a id="__codelineno-49-28" name="__codelineno-49-28" href="#__codelineno-49-28"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-49-29" name="__codelineno-49-29" href="#__codelineno-49-29"></a>        <span class="n">echo</span> <span class="s2">&quot;[-] No dice, sorry :(&quot;</span>
</code></pre></div>
<p>The program performs a GET request to http://freetshirts.local/key.crt and writes the body of the response to a variable. Then, it calculates the SHA256sum of the body of the response and compares it to a preset value. If the two values are the same, it executes the <code>run_payload()</code> procedure, which simply prints <code>[+] Boom!</code>. If the SHA256sum does not match the preset value, it says <code>[-] No dice, sorry :(</code>. This program is extremely simple to allow for better clarity when we get into the ASM and decompiled output in Cutter.</p>
<p>In Cutter, we open the <code>main()</code> function in the Decompiler panel:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_1.png" /></a></p>
<p>Recall that a Nim compiled program will have a few wrapper functions around the true <code>main()</code> function, so we will need to drill down a few levels. Double click on <code>_NimMain()</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_2.png" /></a></p>
<p>We can ignore <code>_PreMain()</code> and <code>_initStackBottomWith()</code> for now. These two functions are boilerplate for Nim compiled binaries. We can click on the <code>_NimMainInner</code> value to jump to the <code>NimMainInner()</code> function:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_3.png" /></a></p>
<p>And finally, we get to the true main() of a Nim
program: <code>NimMainModule()</code> </p>
<p>The <code>main()</code> module of a Nim program is nested this far down because the source code for a typical Nim binary looks like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>proc<span class="w"> </span>do_a_thing<span class="o">()</span>:<span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[+] Thing is now done!&quot;</span>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>when<span class="w"> </span>isMainModule:
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w">    </span>do_a_thing<span class="o">()</span>
</code></pre></div>
<p>Double click on the <code>NimMainModule()</code> function to go to the real heart of the program:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_4.png" /></a></p>
<p>What are we working with here? The symbols of this binary have been left in, so the function names are nice and easy to read. Two of them are interesting here: <code>evaluate_http_body()</code> and <code>run_payload()</code>. Graph view may help us understand what is going on:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_5.png" /></a></p>
<p>The call to <code>evaluate_http_body()</code> splits this graph into two paths. One path runs the <code>run_payload()</code> function that we saw in the source code <code>[+] Boom!</code>. The other path echoes the other string <code>[-] No dice, sorry :(</code> </p>
<p>The <code>jne 0x43f1c0</code> instruction splits the program into two paths. Let’s start at this split and work our way upwards.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_6.png" /></a></p>
<p><code>jne</code> stands for <code>(J)ump if (N)ot (E)qual</code> to, which really means “Jump if the condition is not met.” What condition, exactly? The one on the previous instruction, which is <code>test al,al</code></p>
<p><code>test</code> is used to perform the logical <strong><code>bitwise AND</code></strong> operation on two operands. In this case, we are <code>AND</code>’ing the contents of al against itself. <code>al</code> is the lower 8 bits of the <code>eax</code> register. Basically, when a function is executed, its return value will be stored in <code>eax</code> for comparison and evaluation. If it’s small enough, it can be stored in al because <code>al</code> is only 8 bits.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_7.png" /></a></p>
<p>Source: https://www.cs.virginia.edu/</p>
<p>Now, the result of test al, al instruction sets the Zero Flag (ZF), Sign Flag (SF), and Parity Flag (PF) registers to certain values. For the purpose of this demonstration, we can ignore Sign Flag and Parity Flag and focus on Zero Flag.</p>
<p>The Zero Flag can be either “1” or “0” (imagine that) and is set based on the result of the previous test instruction. test will set the ZF to one value or the other based on the result of the bitwise AND.</p>
<p>If the Zero Flag is equal to 0, the JNE instruction will be taken. If the Zero flag is equal to 1, the JNE instruction will not be taken. When you see the program splitting to one path or the other because of a JNE instruction, it’s going one way or the other way depending on if the Zero Flag is set (equal to zero).</p>
<p>One instruction higher than the <code>test al, al</code> is <code>xor eax,1</code>. This is the true deciding point in the program, because the value of eax has been set by the <code>evaluate_http_body()</code> function:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_8.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_8.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_9.png" /></a></p>
<p>We know from the source code that the <code>evaluate_http_body()</code> function returns a Boolean value. So let’s examine the result of XORing a 1 against a resulting TRUE and FALSE value:</p>
<p><strong>True Case</strong></p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_10.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_10.png" /></a></p>
<p><strong>False Case</strong></p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_11.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_11.png" /></a></p>
<p>So depending on if the returned value from <code>evaluate_http_body()</code> is TRUE or FALSE, our XOR operation returns either a 1 or a 0. If the result was TRUE, our XOR returns a 0. If FALSE, it returns a 1.</p>
<p>This is then evaluated by test al, al where the Zero Flag will be set to 0 or 1 depending on the result. Finally, the <code>jne [location]</code> instruction sends us to one side of the graph or the other.</p>
<h4 id="ok-so-what-does-this-actually-do">Ok, so what does this actually do?</h4>
<p>So let’s back up for a second. So far, we are:</p>
<ul>
<li>Doing a thing (<code>evaluate_http_body()</code>)</li>
<li>Writing the return value of the thing to a variable (TRUE or FALSE)</li>
<li>XOR this result against the value of 1 (<code>xor eax,1</code>)</li>
<li>TEST the resulting value of the eax register and set the Zero Flag based on the - result of this TEST (<code>test al, al</code>).</li>
<li>Jump to one side of the code path if ZF == 0, and jump to the other side if ZF == 1 (<code>jne [memory address]</code>).</li>
</ul>
<h4 id="the-problem-here">The Problem Here</h4>
<p>Let’s assume for this example that this is a piece of malware that calls to http://freetshirts.local and grabs the body of the endpoint at <code>key.crt</code>. And let’s assume that this endpoint is now offline, or has been changed.</p>
<p>We know the payload triggers if the SHA256 sum of the contents of <code>key.crt</code> equals a pre-defined SHA256 in the binary. We can even see this in plain text in the binary itself. So what’s the issue?</p>
<p>The issue is that <strong>there is no possible way we could know the contents of that endpoint</strong> at this point. We have a SHA256 hash, but it is basically impossible to reverse the SHA256 sum back into its original contents. </p>
<p>So if we ever want this binary to trigger and get to the <code>run_payload()</code> code path, we’re basically out of luck.</p>
<p>Or, are we?</p>
<h4 id="the-patch">The Patch</h4>
<p>We’re going to <strong>patch this binary so it will run the payload regardless of the result of the evaluate_http_body() function</strong>.</p>
<p>This binary exists on our machine. We have full control over it. Who says we can’t write new instructions inside of it? Who says we can’t manipulate the bytes themselves to bend them to our will? We can and we will do just that.</p>
<p>The basic idea here is to insert or alter instructions into the binary so it will reach our intended code path, regardless of how the program is supposed to run. There are plenty of ways to do this, but let’s keep it very simple for this run.</p>
<h4 id="running-and-patching-the-exe">Running and Patching the Exe</h4>
<p>On FLAREVM, add freetshirts.local to your <code>hosts</code> file and have it point to <code>127.0.0.1</code></p>
<p>The binary throws an exception if there is no webserver to talk to at all:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;<span class="w"> </span>.<span class="se">\m</span>ain.exe
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Error:<span class="w"> </span>No<span class="w"> </span>connection<span class="w"> </span>could<span class="w"> </span>be<span class="w"> </span>made<span class="w"> </span>because<span class="w"> </span>the<span class="w"> </span>target<span class="w"> </span>machine<span class="w"> </span>actively<span class="w"> </span>refused<span class="w"> </span>it.
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>dice,<span class="w"> </span>sorry<span class="w"> </span>:<span class="o">(</span>
</code></pre></div>
<p>So if we stand up a webserver, we can run the binary again and get a different result. Remember, we need a <code>key.crt</code> file, though we don’t know what the contents would have been:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_12.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_12.png" /></a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;python<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">80</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>Serving<span class="w"> </span>HTTP<span class="w"> </span>on<span class="w"> </span>::<span class="w"> </span>port<span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="o">(</span>http://<span class="o">[</span>::<span class="o">]</span>:80/<span class="o">)</span><span class="w"> </span>...
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;<span class="w"> </span>.<span class="se">\m</span>ain.exe
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>dice,<span class="w"> </span>sorry<span class="w"> </span>:<span class="o">(</span>
</code></pre></div>
<p>This is still not the result that we want, so we must patch!</p>
<p>Back in Cutter, go to the <code>jne</code> instruction and open it up in the Disassembler:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_13.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_13.png" /></a></p>
<p>To patch this, we have tons of options. We can make sure that the value is different by the time it hits this XOR instruction. Or we could insert a JMP to jump over this code block completely. But why not keep it simple?</p>
<p>The opposite of jne is je, which is Jump if Equal To. This does the exact opposite of jne: if the Zero Flag is set to 1, the jump will be taken. So let’s patch this by changing the jne instruction to a je. What will that do?</p>
<p>Well, let’s see!</p>
<p>Right click on the jne instruction and select “Edit → Reverse Jump”:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_14.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="/Knowledge_Base/images/Practical_Malware_Analysis_Triage_img_s_14.png" /></a></p>
<p>Now, save and close out of Cutter. We should still have our two binaries and our Rizin database file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;<span class="w"> </span>ls<span class="w"> </span>main*
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w">    </span>Directory:<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>usky
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>Mode<span class="w">                 </span>LastWriteTime<span class="w">         </span>Length<span class="w"> </span>Name
<a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>----<span class="w">                 </span>-------------<span class="w">         </span>------<span class="w"> </span>----
<a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a>-a----<span class="w">         </span><span class="m">7</span>/30/2022<span class="w">   </span><span class="m">2</span>:23<span class="w"> </span>PM<span class="w">         </span><span class="m">634150</span><span class="w"> </span>main.exe
<a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a>-a----<span class="w">         </span><span class="m">7</span>/30/2022<span class="w">   </span><span class="m">2</span>:23<span class="w"> </span>PM<span class="w">         </span><span class="m">634150</span><span class="w"> </span>main2.exe
<a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a>-a----<span class="w">         </span><span class="m">7</span>/30/2022<span class="w">   </span><span class="m">2</span>:29<span class="w"> </span>PM<span class="w">        </span><span class="m">6277600</span><span class="w"> </span>main2.exe.rzdb
</code></pre></div>
<p>Now we test our patched binary:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;<span class="w"> </span>.<span class="se">\m</span>ain.exe
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>dice,<span class="w"> </span>sorry<span class="w"> </span>:<span class="o">(</span>
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>usky&gt;<span class="w"> </span>.<span class="se">\m</span>ain2.exe
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Boom!
</code></pre></div>
<p>…and it woks!</p>
<h4 id="summary_1">Summary</h4>
<p>In this section, we examined a simple binary patching technique. The malicious program was designed to only trigger if it met a certain condition, but we rewrote the bytes of the binary to coerce it to trigger anyway. This technique is simple but extremely powerful. Next, we will iterate on this technique to learn how to defeat more complex forms of anti-analysis.</p>
<div class="admonition info"></div>
<h3 id="start-identifying-defeating-anti-analysis-techniques">Start Identifying &amp; Defeating Anti-analysis Techniques</h3>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-5.AntiAnalysis/1.simpleAntiAnalysis">simpleAntiAnalysis Lab</a></p>
<p>Let’s pivot the concept of binary patching into one of its adjacent and practical use cases: defeating anti-analysis techniques.</p>
<h4 id="anti-analysis-techniques">Anti-analysis Techniques</h4>
<p>Anti-analysis is the broad term for a multitude of techniques that malware authors use to disrupt the malware analysis process. Anti-analysis can be as general as obfuscation, where malware samples are filled with junk strings, null byte overlays, and other random detritus.</p>
<p>But more specifically, anti-analysis also means when a malware author puts special code in a malware sample to detect when it is being examined and deter the examination. Malware authors may code their malware to identify when it is being debugged, identify if it is in a virtual machine, and even identify if it is in a specific environment like FLARE-VM! Malware analysis is always a cat-and-mouse game when it comes to identifying and outsmarting the bad guys.</p>
<p>The pertinent MITRE ATT&amp;CK Matrix items for anti-analysis include T1497 - Virtualization/Sandbox Evasion and its sub-techniques, and T1622 - Debugger Evasion, among others. Additionally, the use of execution guardrails (T1480 and its sub-techniques) can be considered anti-analysis. All of these techniques belong to the Defense Evasion tactic:</p>
<ul>
<li><a href="https://attack.mitre.org/techniques/T1497/">Virtualization/Sandbox Evasion</a></li>
<li><a href="https://attack.mitre.org/techniques/T1622/">Debugger Evasion</a></li>
<li><a href="https://attack.mitre.org/techniques/T1480/">Execution Guardrails</a></li>
</ul>
<h4 id="isdebuggerpresent-api-call">IsDebuggerPresent() API Call</h4>
<p>Let’s begin by examining the quintessential anti-analysis technique: the IsDebuggerPresent() API call. This technique is a naïve form of anti-analysis in which the malware sample detects the presence of a debugger that is attached to its process. It will alter the flow of the program in response to the debugger and exit from the program without triggering its payload.</p>
<p>This technique is quite easy to detect and defeat, but it is an excellent introduction to the anti-analysis methodology and how to counter it.</p>
<p>Locate the executable sample in <a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/2-5.AntiAnalysis/1.simpleAntiAnalysis">simpleAntiAnalysis Lab</a> and copy it to the FLARE-VM Desktop. For the purpose of this lab, we will skip right to the Advanced Static Analysis portion. Open the simpleAntiAnalysis-cpp.exe binary in Cutter to begin analysis.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-3.png" /></a></p>
<p>This sample is a 64-bit binary written in C++ and weighs in at a whopping 313KB. String analysis indicates that this sample has been cross-compiled from Linux using the Minimum GNU Compiler for Windows (mingw).</p>
<p>In Cutter, locate the WinMain method within the binary and double click to load into that method:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-4.png" /></a></p>
<p>Then, switch to the Graph View:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-5.png" /></a></p>
<p>The sample performs its main work here in this method. The first interesting thing here is the presence of the <code>IsDebuggerPresent()</code> API call. Let’s examine the Microsoft documentation for this API call:</p>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/debugapi/nf-debugapi-isdebuggerpresent">IsDebuggerPresent function (debugapi.h) - Win32 apps</a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-6.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-7.png" /></a></p>
<p>The API call is quite straightforward. This returns a Win BOOL value depending on if the program detects an attached debugger.</p>
<p>The core of the logic of the debugger check exists in these instructions:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-8.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-8.png" /></a></p>
<p>First, the <code>IsDebuggerPresent()</code> API call occurs. The specifics of how a debugger is detected is not particularly interesting for our purposes. What is interesting, however, is the return value that is loaded into <code>EAX</code> after this call returns. Like the documentation says, the program sets the value of EAX to 1 if a debugger is detected and sets the value of EAX to 0 if a debugger is not detected. </p>
<p>Then, the program performs a bitwise <code>AND</code> of the value of <code>EAX</code>. We’ve seen this before in the Binary Patching section (https://notes.huskyhacks.dev/notes/on-patching-binaries). The bitwise <code>AND</code> of <code>EAX</code> will set the Zero Flag (ZF) to 1 or 0. This effectively means the Zero Flag is set depending on if a debugger is detected or not.</p>
<p>Note: though this binary is 64-bit, EAX is used here to perform the <code>TEST</code> instruction. This is because in 64-bit architecture, the smaller registers can still be used if the values are small enough to fit in them. That’s why you see values moving in and out of AL, EAX, and the like.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-9.png" /></a></p>
<p>Then the program performs a <code>SETNE</code> <code>AL</code> (SET If Not Equal To) instruction call. We have not seen this instruction before, but it is quite simple:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>SETNE/SETNZ<span class="w"> </span>-<span class="w"> </span>Set<span class="w"> </span><span class="k">if</span><span class="w"> </span>Not<span class="w"> </span>Equal<span class="w"> </span>/<span class="w"> </span>Set<span class="w"> </span><span class="k">if</span><span class="w"> </span>Not<span class="w"> </span>Zero<span class="w"> </span><span class="o">(</span><span class="m">386</span>+<span class="o">)</span>
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>Usage:<span class="w">  </span>SETNE<span class="w">   </span>dest
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">        </span>SETNZ<span class="w">   </span>dest
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>Modifies<span class="w"> </span>flags:<span class="w"> </span>none
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>Sets<span class="w"> </span>the<span class="w"> </span>byte<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>operand<span class="w"> </span>to<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span>the<span class="w"> </span>Zero<span class="w"> </span>Flag<span class="w"> </span>is<span class="w"> </span>clear,<span class="w"> </span>otherwise<span class="w"> </span>sets<span class="w"> </span>the<span class="w"> </span>operand<span class="w"> </span>to<span class="w"> </span><span class="m">0</span>.
</code></pre></div>
<p>Simply put, <code>SETNE</code> <code>AL</code> sets the value of <code>AL</code> (the lower bits of <code>EAX</code>) to 1 or 0 depending on if the Zero Flag is clear or not. Here, the program has determined if a debugger is present based on the return value of the <code>IsDebuggerPresent()</code> call and is now prepping the memory registers to jump to another set of instructions.</p>
<p>Finally, the value of <code>AL</code> is <code>TEST</code>ed against itself. This is again similar to what we saw in the Binary Patching sample. This <code>TEST</code> instruction sets the Zero Flag to 1 or 0 depending on the contents of <code>AL</code>.</p>
<p>In the previous section on Binary Patching , we saw the <code>JNE</code>(Jump If Not Equal To) instruction. <code>JNE</code> controlled the flow of the program based on if the Zero Flag was set to 1 or 0. In this program, we have a similar instruction, which is <code>JE [Memory Location]</code> (Jump if Equal To). JE evaluates the Zero Flag and acts as the inverse instruction: if the Zero Flag is equal to 1, the jump is taken. If the Zero Flag is equal to 0, the jump is not taken.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-10.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-10.png" /></a></p>
<p>In this case, the Jump here directs the program to the proper detonation of the malware, where a simple message box pops up and says that the coast is clear!</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-11.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-11.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-12.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-12.png" /></a></p>
<p>However, the opposite code path pops up a message box that identifies that a debugger is present. We can load this program into x64dbg and run the program (F9) until we see the message box:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-13.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-13.png" /></a></p>
<p><strong>Ok, So What Does This Actually Do?</strong></p>
<ul>
<li>The program calls <code>IsDebuggerPresent()</code>. If a debugger is present, a 1 is stored in EAX. Otherwise, a 0 is stored in <code>EAX</code>.</li>
<li>This value is <code>TEST</code>ed against itself. The value undergoes a bitwise <code>AND</code> operation. Bitwise <code>AND</code> of a two values result in a value of 0 if the operands are both 0. If this value ends up being 0, the Zero Flag is set.</li>
<li><code>SETNE</code> <code>AL</code> evaluates the Zero Flag. If the Zero Flag is clear, <code>SETNE</code> sets the value of <code>AL</code> to 1. In the opposite case, it sets the value of <code>AL</code> to 0.</li>
<li>Whatever value is placed in <code>AL</code> is <code>TEST</code>ed against itself, and the Zero Flag is set to 1 or 0 again.</li>
<li>The <code>JE [memory address]</code> evaluates the Zero Flag and jumps to the memory location if it equals 1 and proceeds to the other code path if the Zero Flag is 0.</li>
</ul>
<p>If a debugger is attached:</p>
<ul>
<li>IsDebuggerPresent() = 1 -&gt; EAX = 1</li>
<li>TEST EAX, EAX (bitwise AND of 1 and 1) -&gt; 1</li>
<li>Zero Flag = 0 (Zero Flag is cleared because the TEST result was not 0)</li>
<li>SETNE AL = 1</li>
<li>TEST AL, AL -&gt; 1</li>
<li>Zero Flag = 0</li>
<li>JE goes to "No Soup For You!"</li>
</ul>
<p>And in the opposite case:</p>
<ul>
<li>IsDebuggerPresent() = 0 -&gt; EAX = 0</li>
<li>TEST EAX, EAX (bitwise AND of 0 and 0) -&gt; 0</li>
<li>Zero Flag = 1 (Zero Flag is set because the TEST result was 0)</li>
<li>SETNE AL = 0</li>
<li>TEST AL, AL -&gt; 0</li>
<li>Zero Flag = 1</li>
<li>JE goes to "Boom!"</li>
</ul>
<p>This is the low-level equivalent of a conditional statement that would say something like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="k">if</span><span class="w"> </span><span class="o">(</span>isDebuggerPresent<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="w">        </span>MessageBox<span class="o">(</span>GetForegroundWindow<span class="o">()</span>,<span class="w"> </span><span class="s2">&quot;Oh, you think you&#39;re slick, huh? I see your debugger over there. No soup for you!&quot;</span>,<span class="w"> </span><span class="s2">&quot;MEGASUSBRO&quot;</span>,MB_OK<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="w">        </span><span class="nb">exit</span><span class="w"> </span><span class="o">(</span>EXIT_FAILURE<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="o">}</span>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="k">else</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="w">        </span>MessageBox<span class="o">(</span>GetForegroundWindow<span class="o">()</span>,<span class="w"> </span><span class="s2">&quot;No debugger detected! Cowabunga, dudes!&quot;</span>,<span class="w"> </span><span class="s2">&quot;COAST IS CLEAR&quot;</span>,MB_OK<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="w">        </span>MessageBox<span class="o">(</span>GetForegroundWindow<span class="o">()</span>,<span class="w"> </span><span class="s2">&quot;Boom!&quot;</span>,<span class="w"> </span><span class="s2">&quot;PAYLOAD&quot;</span>,MB_OK<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="w">        </span><span class="nb">exit</span><span class="w"> </span><span class="o">(</span>EXIT_SUCCESS<span class="o">)</span><span class="p">;</span>
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="o">}</span>
</code></pre></div>
<p>Note: if the minutia details here are confusing, don’t worry! Low level languages like ASM can be tough to wrap your head around and, in truth, that is the reason why high level languages even exist! Just remember that these low level instructions are really only more primitive, basic versions of the higher level code like you see above. You do not need to know exactly what every instruction is doing in order to identify and defeat anti-analysis techniques.</p>
<p>The crux of the matter here is this: if we can find the place where the program evaluates for the debugger and sets values as a result, we can patch or alter the instruction to get it to trigger even in the presence of a debugger. Let’s find out how!</p>
<h4 id="defeating-simple-anti-analysis">Defeating Simple Anti-analysis</h4>
<p>In the Binary Patching section, we used static patching in Cutter to patch out the instructions. Here, let’s use dynamic patching within the debugger itself to show an alternative method of binary patching.</p>
<p>In the Binary Patching section, we saved a new copy of the sample binary and overwrote an instruction to alter the code path to our liking. In the method we’ll use for this sample, we can patch the program’s logic without altering its on-disk structure. The patch will be done entirely in the running process memory.</p>
<p>First, let’s execute the program in a debugger and see how it functions. Exit out of Cutter and load the program into x64dbg. Run the program (F9) until the message box triggers:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-14.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-14.png" /></a></p>
<p>Let’s find the instruction that performs the <code>IsDebuggerPresent()</code> check. It should be close to the start of the WinMain function, which we saw in Cutter.</p>
<p>Restart the program (Ctl+F2) and return to the entry point of the program. Right Click inside the CPU section and select “Search For → All Modules → String References”</p>
<p>In the String search panel, enter: <code>IsDebuggerPresent</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-15.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-15.png" /></a></p>
<p>The string “IsDebuggerPresent” is passed to the <code>LoadLibrary</code> and <code>GetProcAddress</code> functions so it can be resolved and used when the program runs. This is useful to us to get us in the vicinity of where the debugger check is performed in the program. Set a breakpoint on this string reference (F2).</p>
<p>Return to the CPU panel and continue the execution of the program by pressing F9. We eventually hit out breakpoint:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-16.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-16.png" /></a></p>
<p>The string reference for “IsDebuggerPresent” is currently being resolved, so we’re close to where we want to be. Continue to step through the program with F8 until you return from this call:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-17.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-17.png" /></a></p>
<p>After returning from this call, we are here in the program (I recommend setting a breakpoint here!):</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-18.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-18.png" /></a></p>
<p>This should look familiar! <code>TEST EAX,EAX</code>, then <code>SETNE AL</code>, then <code>TEST AL,AL</code>, then <code>JE</code> to a location in the program. In fact, this is exactly what we saw earlier in Cutter:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-19.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-19.png" /></a></p>
<p>To perform the patch, we need to change the flow of the program. Just like with static patching in the previous section, there are a few ways to do this.</p>
<p>Notice how when RIP is on the jump instruction, the Zero Flag is cleared (set to 0). This means that a debugger has been detected and this jump will go to the message box that says “I see your debugger over there!”</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-20.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-20.png" /></a></p>
<p>The running process memory is ours to modify to our liking. Hey, if the malware is running on our computer and we’re the administrator, who says we can’t modify the runtime values in memory? No one says that, so we will do just that! Why don’t we change the Zero Flag to a 1? That way, we will jump to the other code path!</p>
<p>Double click on the Zero Flag to flip it to a 1:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-21.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-21.png" /></a></p>
<p>Now, the program proceeds to the code path that spawns two message boxes that indicate the coast is clear to run the payload. Continue execution with F8 to see the parameters for each message box get loaded into the registers and then the CALL EAX instructions which spawn the message boxes:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-22.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-22.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-23.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/HTA-img-0s9ujsj-23.png" /></a></p>
<p>Even with an attached debugger, we have detonation! We have successfully identified and defeated an anti-analysis technique!</p>
<h4 id="summary_2">Summary</h4>
<p>The example in this section is simple but should illustrate the point: anti-analysis measures are meant to slow down the analysis process, but if we are clever and crafty, we can counter these anti-analysis techniques.</p>
</div>
<div class="admonition info">
<h2 id="9-specialty-malware-classes">9. Specialty Malware Classes</h2>
<p>The next section of this course broadens the scope of malware analysis and explores specialty classes of malware. In this next section, you will explore different types of malware and malicious delivery mechanisms like maldocs, shellcode injection, PowerShell and VBS! Use this opportunity to explore different malware mechanisms and learn more about the many different forms a piece of malware can take.</p>
<div class="admonition info">
<h3 id="start-specialty-malware-classes">Start Specialty Malware Classes</h3>
</div>
</div>
<div class="admonition info">
<h2 id="10-gone-phishing-maldoc-analysis">10. Gone Phishing: Maldoc Analysis</h2>
<div class="admonition info">
<h3 id="start-analyzing-excel-maldocs-oledump">Start Analyzing Excel Maldocs: OLEdump</h3>
</div>
<div class="admonition info">
<h3 id="start-analyzing-word-maldocs-remote-template-macro-injection">Start Analyzing Word Maldocs: Remote Template Macro Injection</h3>
</div>
</div>
<div class="admonition info">
<h2 id="11-what-the-shell-shellcode-analysis">11. What The Shell? Shellcode Analysis</h2>
<div class="admonition info">
<h2 id="start-analyzing-shellcode-carving-shellcode-scdbg">Start Analyzing Shellcode: Carving Shellcode &amp; scdbg</h2>
</div>
<div class="admonition info">
<h3 id="start-carving-shellcode-from-memory">Start Carving Shellcode from Memory</h3>
</div>
</div>
<div class="admonition info">
<h2 id="12-off-script-scripted-malware-delivery-mechanisms">12. Off-Script: Scripted Malware Delivery Mechanisms</h2>
<div class="admonition info">
<h3 id="start-powershell-analyzing-obfuscated-scripts">Start PowerShell: Analyzing Obfuscated Scripts</h3>
</div>
<details class="info">
<summary>VBScript</summary>
<h4 id="vbscript-analyzing-a-multi-stage-msbuild-dropper">VBScript: Analyzing a Multi-Stage MSBuild Dropper</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/3-3.OffScript-ScriptMalware/VBScript">VBScript Lab</a></p>
<p>The script will decode both cert files and send them to a location, the output files are one.vbs &amp; xml.xml, it will then wait 100 ms and will run one.vbs afterwards.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-0.png" /></a></p>
<p>If we read the code we will see that it's replacing all vVv with nothing ""</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-2.png" /></a></p>
<p>If we do that, now we see what's going on. The GetObject here contains a COM Class (Component Model Object). COM is one of the most abusable features of the Windows OS.</p>
<p>This COM is invoking ShellBrowserWindow to run a Shell command, it will do in a hiden window <code>that's the 0 value</code> and it will try to <code>runas</code> Administrator and will run the contents of the <code>xml.xml</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-1.png" /></a></p>
<p>We can run the sample to see what it's doing, well in the first run since we didn't run as Admin, nothing happened</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-3.png" /></a></p>
<p>Lets see what happens if we run it as Admin.
Creating adding a user to the remote desktop User Group, adding that user to the Administrator's Group then opening up a port on the Firewall to open RDP if not already open up.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-4.png" /></a></p>
<p>All of that is obfuscated in this Hex</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-5.png" /></a></p>
<p>The user is <code>wdsadmin</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-6.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-7.png" /></a></p>
</details>
<details class="info">
<summary>HTML Applications (HTA)</summary>
<h4 id="html-applications-hta-wrapped-payloads-scripted-delivery-wmi">HTML Applications (HTA): Wrapped Payloads, Scripted Delivery, &amp; WMI</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/3-3.OffScript-ScriptMalware/HTA/Dropper.hta.7z">Lab File(s)</a></p>
<details class="info">
<summary>Introduction</summary>
<h4 id="introduction_3">Introduction</h4>
<p>On the subject of scripted malware delivery mechanisms, let’s examine a curious class of malware called the HTML Application (HTA) file. HTAs are commonly used as the payload of phishing attacks. By the end of this section, you’ll see why this is the case.</p>
<p>Extract the sample and let’s get going!</p>
</details>
<details class="info">
<summary>The Offensive Potential of HTML</summary>
<h4 id="the-offensive-potential-of-html">The Offensive Potential of HTML</h4>
<p>It is no secret that HTML can be weaponized. Every time you visit a website, your web browser downloads and renders the code that is served out by that website. Your browser is really just an interpreter for the technologies that power the web: HTML, CSS, and JavaScript.</p>
<p>HTML provides the structure of the website. CSS applies color, fonts, presentation, and layouts of the website. And JavaScript can dynamically control behavior of elements of the website.</p>
<p>It’s that last one that we need to watch out for.</p>
</details>
<details class="info">
<summary>JavaScript Is Dangerous</summary>
<h4 id="javascript-is-dangerous">JavaScript Is Dangerous</h4>
<p>You may be familiar with the classic Cross-Site Scripting test that pops an alert box by injecting the <code>&lt;script&gt;</code> block into an HTML page. If you’ve seen this test before, you may have wondered “what is actually going on when this happens?”</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-8.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-8.png" /></a></p>
<p>HTML pages can define the <code>&lt;script&gt;</code> tag to include code that can run different scripting languages. In most cases, the language is JavaScript. JavaScript can execute code within the browser to move components around on the page, change colors and fonts, pop that alert box, and do many other functions. Think of JavaScript as the programmatic engine of HTML.</p>
<p>The <a href="https://www.w3schools.com/jsref/met_win_alert.asp">W3 Schools demo for JavaScript’s alert() box method</a> demonstrates this well.</p>
<p>Try saving this code to <code>index.html</code> and running it locally by opening it in a web browser</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="o">&lt;!</span><span class="nx">DOCTYPE</span><span class="w"> </span><span class="nx">html</span><span class="o">&gt;</span>
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">The</span><span class="w"> </span><span class="nx">Window</span><span class="w"> </span><span class="nb">Object</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">The</span><span class="w"> </span><span class="nx">alert</span><span class="p">()</span><span class="w"> </span><span class="nx">Method</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Click</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">button</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">display</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">alert</span><span class="w"> </span><span class="nx">box</span><span class="p">.</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a>
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">onclick</span><span class="o">=</span><span class="s2">&quot;myFunction()&quot;</span><span class="o">&gt;</span><span class="nx">Try</span><span class="w"> </span><span class="nx">it</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a>
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a><span class="kd">function</span><span class="w"> </span><span class="nx">myFunction</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hello! I am an alert box!&quot;</span><span class="p">);</span>
<a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a><span class="p">}</span>
<a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a><span class="o">&lt;</span><span class="err">/script&gt;</span>
<a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a>
<a id="__codelineno-57-18" name="__codelineno-57-18" href="#__codelineno-57-18"></a><span class="o">&lt;</span><span class="err">/body&gt;</span>
<a id="__codelineno-57-19" name="__codelineno-57-19" href="#__codelineno-57-19"></a><span class="o">&lt;</span><span class="err">/html&gt;</span>
</code></pre></div>
<p>The takeaway here is that <strong>JavaScript executes code within the browser</strong>. But when JavaScript executes within a web browser, the code execution is confined to the web browser itself. That is to say, the code runs in the context of the browser, manipulates the document model of the web page, and can manipulate cookies, but can’t reach the operating system of the host unless there is some kind of browser based code execution vulnerability.</p>
<p>When used in an offensive capacity, JavaScript can perform activities like hooking the client’s browser (see the <a href="https://beefproject.com/">BeEF Framework</a> for an example of this) and downloading files via <a href="https://attack.mitre.org/techniques/T1027/006/">HTML Smuggling</a>. The offensive potential of JavaScript is apparent, but if it’s usually limited to the browser of the victim, then that doesn’t sound so bad, right?</p>
<p>Wrong!</p>
</details>
<details class="info">
<summary>Enter, HTML Applications</summary>
<h4 id="enter-html-applications">Enter, HTML Applications</h4>
<p>Imagine that a developer needs to design a compact, portable HTML site that can be easily sent to anyone who needs it. Maybe it’s a company survey. Maybe it’s a presentation of some sort. The developer can create an HTML Application (HTA) file for this purpose.</p>
<p>HTAs are Windows-executable, packaged HTML files that run HTML, CSS, and Windows native scripting languages from a single file outside of the context of the web browser. The last part of that sentence is the really scary thing here: <strong>HTAs do not run in the context of the Windows web browser, but instead run as a trusted application on the operating system</strong>.</p>
<p>An HTML Application is not much different from a normal HTML page in terms of construction. In fact, you can use the exact same code from an HTML page to make an HTA.</p>
<p>Try it out yourself — take the W3 Schools code for the JavaScript alert() method that we just used, open a new text file, write that HTML code into the file, and save it as <code>test.hta</code> on your FLARE-VM host. Then, double click on the file</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-9.png" /></a></p>
<p>The window that spawns is a self contained Windows application that renders and runs the HTML, CSS, and/or scripting code that is packaged inside of it. If we click on the Try it button, we see that this application can execute the embedded JavaScript code</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-10.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-10.png" /></a></p>
<p>The scripting languages we can use here are not limited to JavaScript (or JScript in the context of Windows). We can embed any Windows-native scripting language inside of an HTA and it will execute the provided code. This includes JavaScript/JScript, VBScript, and both together in the same file.</p>
<p>In the previous section, we saw how VBScript can be weaponized. So the thought of a self contained HTML application that can execute code dynamically and have it run on the operating system of the victim should spark our concern.</p>
</details>
<details class="info">
<summary>Analyzing HTAs</summary>
<h4 id="analyzing-htas">Analyzing HTAs</h4>
<p>Let’s examine a weaponized HTA and unravel its functionality to demonstrate how to analyze these files.</p>
<p>The sample archive is called <code>Dropper.hta.malz</code>. Let’s rename this to <code>Dropper.hta</code>. When we do this, notice that Windows changes the file icon to an application icon</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-11.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-11.png" /></a></p>
</details>
<details class="info">
<summary>Static Analysis</summary>
<h4 id="static-analysis">Static Analysis</h4>
<p>Recall that an HTA is still, under the hood, HTML in a single file. Let’s open this file in Visual Studio Code to examine the HTML located within it:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;&lt;</span><span class="err">/title&gt;</span>
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="o">&lt;</span><span class="nx">script</span><span class="w"> </span><span class="nx">language</span><span class="o">=</span><span class="s2">&quot;JavaScript&quot;</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">unescape</span><span class="p">(</span><span class="s1">&#39;%3c%68%74%6d%6c....[snip]......&#39;</span><span class="p">));</span>
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="o">&lt;</span><span class="err">/script&gt;</span>
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="o">&lt;</span><span class="err">/body&gt;</span>
<a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a><span class="o">&lt;</span><span class="err">/html&gt;</span>
</code></pre></div>
<p>Take note of the contents of this file. The actual HTML of the application is barren but has one notable feature. The <code>&lt;script&gt;</code> tag wraps a call to the JavaScript <code>document.write()</code> method. This call to <code>document.write()</code> has a block of characters that are delimited by percent signs inside of the <code>unescape()</code> method. Let’s examine both methods to identify what they do:</p>
<div class="highlight"><pre><span></span><code>- `document.write()`: The `write()` method writes directly to an open (HTML) document stream.
- `unescape()`: The `unescape()` function computes a new string in which hexadecimal escape sequences are replaced with the characters that they represent.
</code></pre></div>
<p>Immediately, we have an idea of what’s going on here:</p>
<div class="highlight"><pre><span></span><code>- The block of characters inside the `unescape()` method is a bunch of hexadecimal bytes that are interpreted and replaced by the character that they represent.
- Then, the interpreted characters are written to the document of the page.
</code></pre></div>
<p>We can decode the block of hex characters in CyberChef by using the <code>From Hex</code> item and delimiting by percent sign. FLARE-VM installs a local instance of CyberChef in the <code>C:\Tools\cyberchef directory</code>. An online instance of CyberChef is also running at the following link <a href="https://gchq.github.io/CyberChef/">CyberChef</a></p>
<p>Using CyberChef, we add the <code>From Hex</code> decoder and change the delimiter to <code>Percent</code>. Then, we copy the block of hex bytes into the Input section:</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-12.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-12.png" /></a></p>
<p>The Output section now contains the following</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-13.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-13.png" /></a></p>
<p>Several things are concerning about this!</p>
<p>When the HTA is executed, it decodes and writes this HTML to the page. This block of HTML contains another script block that invokes VBScript to run code. But what does the code do?</p>
</details>
<details class="info">
<summary>Invoking WMI &amp; Executing PowerShell</summary>
<h4 id="invoking-wmi-executing-powershell">Invoking WMI &amp; Executing PowerShell</h4>
<p>The VBScript code starts by setting up the required parameters to invoke Windows Management Instrumentation (WMI) to execute a process. WMI is a part of the Windows operating system that acts as an interface for management purposes. It is extremely powerful and complicated and most of its functionality is outside the scope of this course, but it can do a few things that make it relevant for malware analysis.</p>
<p>WMI can start and run processes through the Win32_Process namespace. Effectively, this means that anything that can access WMI can execute a process.</p>
<p>In our sample, the VBScript code is setting WMI up to be able to execute a process</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-14.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-14.png" /></a></p>
<p>The VBScript then performs the following</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-15.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-15.png" /></a></p>
<p>This line executes a process through the WMI service and returns the results to the <code>Error</code> variable.</p>
<p>The process argument here runs a command shell which, in turn, runs PowerShell in a hidden window. When PowerShell is executed, it performs the following</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-16.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-16.png" /></a></p>
<p>The VBScript then calls <code>window.close()</code> to close out of the HTA window.</p>
<p>If we take a step back, we now have a clear idea of the execution chain here:</p>
<div class="highlight"><pre><span></span><code>- HTA is opened and runs the embedded JavaScript.
- The JavaScript decodes the hex bytes of an inner HTML document and writes it into the HTA.
- The inner HTML document invokes VBScript to execute WMI.
- WMI runs a process to call a command shell.
- The command shell, in turn, runs PowerShell in a hidden window.
- PowerShell runs a download cradle command to reach out to `http://tailofawhale.local/TellAndSentFor.exe`, write it to the %temp% directory as jLoader.exe and then execute `jLoader.exe`.
</code></pre></div>
<p>With a good understanding of the payload, let’s move onto dynamic analysis to see it in action!</p>
</details>
<details class="info">
<summary>Dynamic Analysis</summary>
<h4 id="dynamic-analysis">Dynamic Analysis</h4>
<p>When we open the HTA program, a window flashes for a moment and then disappears. If we are running INetSim at the time of detonation, we see the default INetSim binary spawn. Take note of the location where the binary is running from</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-17.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-17.png" /></a></p>
<p>Dropper.hta has clearly succeeded in downloading and executing something. Let’s examine the network signatures.</p>
<p>In Wireshark, we see the outbound DNS request for <code>tailofawhale.local</code> and its DNS resolution</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-18.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-18.png" /></a></p>
<p>We can also see the HTTP request to the malicious domain and response in Wireshark</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-19.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-19.png" /></a></p>
<p>If we go to examine host-based indicators, we run into a small snag. There is no process called “Dropper.hta” anywhere in the list of running processes on the host. Where does this process execute?</p>
<p>HTAs do not execute directly. When double-clicked, they are passed to the native Windows binary <code>mshta.exe</code> which executes them on its behalf. <code>mshta.exe</code> acts as an HTML interpreter and loads the HTML from the HTA along with any DLLs that deal with script execution and then executes the program all at once.</p>
<p>If we look in the Procmon process tree after detonation, we see an invocation of <code>mshta.exe</code> that takes the path to our HTA sample as its argument</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-20.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-20.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-21.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-21.png" /></a></p>
<p>We’ve accounted for the execution of the HTA, but we haven’t accounted for the other parts of the payload yet. Where is the call to PowerShell and the command shell?</p>
<p>Higher up in the process list, there is an instance of svchost.exe that is executing a process called wmiprvse.exe. This is the way that Windows invokes WMI to execute processes</p>
<p><a class="glightbox" href="/Knowledge_Base/images/HTA-img-0s9ujsj-22.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/HTA-img-0s9ujsj-22.png" /></a></p>
<p>We can follow the <code>wmiprvse.exe</code> process all the way down through the call to PowerShell and, eventually, the execution of the <code>jLoader.exe</code> program. In this case, this was our INetSim default binary that spawned the message box, but in real life this is likely a second stage payload.</p>
<p>After annotating these details, we have effectively analyzed the HTA dropper sample.</p>
</details>
<details class="info">
<summary>Summary</summary>
<h4 id="summary_3">Summary</h4>
<p>This section covered the analysis methodology of the HTA, a curious little file format that wraps all of the functionality of HTML into a single file and executes it directly on the Windows OS. It also covered a bit about how WMI can execute processes.</p>
</details>
</details>
</div>
<div class="admonition info">
<h3 id="reversing-c-malware">Reversing C# Malware</h3>
<details class="info">
<summary>Reversing C# &amp; the .NET Framework</summary>
<h4 id="intro-to-reversing-c-the-net-framework">Intro to Reversing C# &amp; the .NET Framework</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/3-4.StaySharp-CSharpMalware/Malware.cryptlib64.dll.malz/Malware.cryptlib64.dll.malz.7z">Lab File(s)</a></p>
<p>Floss the sample &gt; we see mscorlib so it's C#, also another clue is the .NETFramework version</p>
<p><strong>How Does C# Code Get Compiled and Executed?</strong></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-0.png" /></a></p>
<ul>
<li><strong>Compiling C# Code</strong></li>
<li>Once the code is written, it needs to be compiled into MSIL code using the C# compiler.</li>
<li>This creates an assembly that contains the compiled code and any metadata that describes the code.</li>
<li><strong>Loading the Assembly</strong></li>
<li>The assembly is loaded into the CLR, which loads the code into memory and performs a number of checks to ensure that the code is safe to execute.</li>
<li>This includes verifying that the code has not been tampered with and that it is signed with a valid digital signature.</li>
<li><strong>JIT Compilation</strong></li>
<li>The MSIL code is then compiled by the Just-In-Time (JIT) compiler into native machine code that can be executed on the computer’s processor.</li>
<li>This code is generated dynamically at runtime and is optimized for the specific hardware and operating system on which it is running.</li>
<li><strong>Execution</strong></li>
<li>The native machine code can now be executed by the computer’s processor, which runs the C# application.</li>
<li>During execution, the CLR manages the memory and resources used by the application, including performing garbage collection to free up memory that is no longer being used.</li>
</ul>
<p>Language C#
C# Compiler translate language to IL &gt; so compiles into an Assembly such as .exe
IL (Intermediate Language) Creation
CLR (Common Language Runtime) This is how a C# program is execution
OS</p>
</details>
<details class="info">
<summary>Reversing an Encrypted C2 Dropper</summary>
<h4 id="reversing-an-encrypted-c2-dropper-dll-with-dnspy">Reversing an Encrypted C2 Dropper DLL with dnSpy</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/3-4.StaySharp-CSharpMalware/Malware.cryptlib64.dll.malz/Malware.cryptlib64.dll.malz.7z">Lab File(s)</a></p>
<div class="admonition warning">
<p><strong>Errata</strong>
Note: dnSpy is available at the following <a href="https://github.com/dnSpy/dnSpy/releases/download/v6.1.8/dnSpy-net-win64.zip">GitHub repository</a></p>
<p><mark>Note</mark> The tool I use at the 12:15 mark is <strong>Fakenet-NG</strong>, which is a built-in network simulator on FLARE-VM. It is basically the same as INetSim, but runs on the FLARE-VM host instead of on REMnux. I left it out of the course because it tends to be very buggy and mess up the networking stack on the FLARE-VM host, but it helps to set up a quick network simulator on FLARE-VM.</p>
<p>The important part is that it catches the callback domain name for this C2 dropper, which can also be identified with INetSim.</p>
</div>
<p>load the sample into dnSpy</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-1.png" /></a></p>
<p>dnSpy will reassemble the binary code. In this sample it seems when the program was compiled it was named <code>EmbedDLL</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-2.png" /></a></p>
<p>This program loads up a base64 into memory which it will decrypt with provided password, it will also end up with creating a registry file</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-5.png" /></a></p>
<p><strong>How to run dlls?</strong></p>
<p>In order to run a dll you need to know the functions it has defined so you can call the dll and its function, in this case the function is called <code>embed</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-3.png" /></a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>rundll32<span class="w"> </span>&lt;sample_dll&gt;,&lt;<span class="k">function</span>&gt;
</code></pre></div>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-4.png" /></a></p>
<p>If we check the location of the files as stated in the code we will see them</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-6.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-7.png" /></a></p>
<p>Check registry as well</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-8.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-8.png" /></a></p>
<p>So the registry is calling to the VBS script which is calling the xml script, it's runs when someone logs in</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-11.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-11.png" /></a></p>
<p>Checking the XML</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-9.png" /></a></p>
<p>Seems to be using an Evasion Technique by loading Reflection Assembly</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-10.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-10.png" /></a></p>
<p>If we run the VBScript we will see the DNS call in <code>fakenet.exe</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-12.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-12.png" /></a></p>
</details>
</div>
<div class="admonition info">
<h3 id="analyzing-go-malware">Analyzing Go Malware</h3>
<details class="info">
<summary>Programming Language</summary>
<h4 id="programming-language-recognition-analyzing-a-go-service-backdoor">Programming Language Recognition &amp; Analyzing a Go Service Backdoor</h4>
<div class="admonition info">
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/3-5.GoTime-GoMalware/Backdoor.srvupdat.exe.malz.7z">Lab File(s)</a></p>
<p><strong>References</strong></p>
<ul>
<li><a href="https://unit42.paloaltonetworks.com/the-gopher-in-the-room-analysis-of-golang-malware-in-the-wild/"><strong>Unit42 The Gopher</strong></a></li>
<li><a href="https://github.com/Ne0nd0g/merlin">Merlin C2 Agent written in Go</a></li>
</ul>
</div>
<p>Notice that the binary size for <code>Go</code> is huge, almost 7MB for about 20 lines of code</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-14.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-14.png" /></a></p>
<p>floss the sample</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-13.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-13.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-15.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-15.png" /></a></p>
<p>We can also try something like this</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-16.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-16.png" /></a></p>
<p>References for golang</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-17.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-17.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-18.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-18.png" /></a></p>
<p>.symtab showed up when loading the sample into PEbear</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-19.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-19.png" /></a></p>
</details>
</div>
<div class="admonition info">
<h3 id="mobile-malware-analysis">Mobile Malware Analysis</h3>
<details class="info">
<summary>Lab Update: Installing MobSF</summary>
<h4 id="lab-update-installing-mobsf">Lab Update: Installing MobSF</h4>
<p><a href="https://mobsf.github.io/docs/#/docker">MobSF Docker Install Instructions</a></p>
<p>In order for us to install the tool we need, we need to change the Network to NAT on the Remnux vm then reboot the vm.</p>
<p>Installing MobSF on docker, we won't be able to do Dynamic Analysis but we can do Static Analysis</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>docker<span class="w"> </span>pull<span class="w"> </span>opensecurity/mobile-security-framework-mobsf
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8000</span>:8000<span class="w"> </span>opensecurity/mobile-security-framework-mobsf:latest
</code></pre></div>
<p>Now after install is completed, we need to switch back the Network adapter on the vm to <code>Host-only Adapter</code> then reboot the vm.</p>
<p>execute this</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8000</span>:8000<span class="w"> </span>opensecurity/mobile-security-framework-mobsf:latest
</code></pre></div>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-20.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-20.png" /></a></p>
<p>You should be able to use it now.</p>
</details>
<details class="info">
<summary>MobSF</summary>
<h4 id="intro-to-mobsf">Intro to MobSF</h4>
<div class="admonition info">
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/3-6.Mobile-Malware/Android/Malware.android.apk.malz.7z">Lab File(s)</a></p>
<p>Update 11/13/21: A few weeks after the release of this course, <a href="https://www.linkedin.com/in/wilson-security/">Aaron Wilson</a> released the <a href="https://academy.tcm-sec.com/courses/mobile-pentesting?affcode=770707_i1eilqya">Mobile Application Penetration Testing</a> course here at TCM Academy. While this part of the course scratches the surface of reverse engineering Android applications, Aaron's course is a full, in-depth look at mobile application pentester methodology. The skill overlap between RE and pentesting mobile applications is significant, so check his course out if you're hungry for more mobile app security!</p>
<p>(Aaron's affiliate link is used in the hyperlink above for full disclosure. I make nothing off the purchase of the course, I'm simply a big fan of what he's put together!)</p>
</div>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-21.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-21.png" /></a></p>
<p>Rename the sample to APK then upload it</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-22.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-22.png" /></a></p>
<p>We can see the Java source code</p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-23.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-23.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-24.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-24.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-25.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-25.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-26.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-26.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-img-s98nsxz-27.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-img-s98nsxz-27.png" /></a></p>
</details>
</div>
<div class="admonition info">
<h3 id="analyzing-real-world-malware-samples">Analyzing Real-World Malware Samples</h3>
<details class="info">
<summary>WannaCry.exe</summary>
<h4 id="wannacryexe-introduction-walkthrough">WannaCry.exe Introduction &amp; Walkthrough</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/4-1.Bossfight-wannacry.exe/Ransomware.wannacry.exe.malz.7z">Lab File(s)</a></p>
<p><a href="https://www.youtube.com/watch?v=Sv8yu12y5zM">GhidraNinja: Reversing Wannacry Part 1</a></p>
<details class="info">
<summary>floss</summary>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-0.png" /></a></p>
<p>We see the DOS message multiple times which could indicate multiple excutables, multiple stages. We also see a lot of API calls</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-1.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-2.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-3.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-4.png" /></a></p>
</details>
<details class="info">
<summary>PEStudio</summary>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-5.png" /></a>            </p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-6.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-7.png" /></a></p>
</details>
<details class="info">
<summary>INetSim</summary>
<p>So if we have INetSim running and trying to get a packet capture going we will see that the url is gets a <code>200 ok</code>, it will stop executing the malware.</p>
<p>So for our case we will need to have INetSim (disabled/not running) and we can use some of the other local tools</p>
</details>
<details class="info">
<summary>TCPView</summary>
<p>We will see the APIPA address being called, which isn't really pointing anywhere. APIPA [Automatic Private IP Addressing] range is [169.254.0.0 TO 169.254.255.255].</p>
<p>The port it's trying however is the SMB port of 445. ALso it's seems to be trying different IPs on the Network to spread itself (has worm capabilities)</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-8.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-8.png" /></a></p>
<p>Attempting to open a listener on port <code>9050</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-9.png" /></a></p>
</details>
<details class="info">
<summary>Procmon</summary>
<p>Host indicators</p>
<p>setup thefilters</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-10.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-10.png" /></a></p>
<p>Run the binary as admin and see what happens</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-12.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-12.png" /></a></p>
<p>We find some task scheduler activities going on</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-13.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-13.png" /></a></p>
<p>Process tree </p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-15.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-15.png" /></a></p>
<p>So we know the parent PID is <code>3336</code>, we can filter on that as Parent PID</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-14.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-14.png" /></a></p>
<p>We see the beginning of the exection of second stage</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-18.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-18.png" /></a></p>
<p>Filter for <code>Operation</code> <code>CreateFile</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-17.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-17.png" /></a></p>
<p>We see that it's creating a directory in <code>c:\ProgramData\</code></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-19.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-19.png" /></a></p>
<p>The staging area</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-20.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-20.png" /></a></p>
<p>We see a service created with the same name as the weird folder name. So this will be the service that will re-encrypt everything once you restart your computer</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-21.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-21.png" /></a></p>
</details>
<details class="info">
<summary>Cutter</summary>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-23.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-23.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-22.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-22.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-24.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-24.png" /></a></p>
</details>
<details class="info">
<summary>Debugger x32dbg</summary>
<p>Search for string reference the url</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-25.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-25.png" /></a></p>
<p>We want to set a breakpoint at that address location (F2)</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-26.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-26.png" /></a></p>
<p>Hit F9 until you see the URL</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-27.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-27.png" /></a></p>
<p>We keep stepping over and we see the next call</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-28.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-28.png" /></a></p>
<p>We check the <code>test edi, edi</code>, this is teh result of the <code>InternetOpenUrl</code> Call. We see that the EDI value isn't cleared out, it's <code>00CC000C</code>.</p>
<p>If we hit <code>F8</code> we will see the test result shown in next figure</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-29.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-29.png" /></a></p>
<p>So the test result reflected in <code>ZF</code> is <code>0</code>, which means the flag was cleared due to API call <code>InternetOpenUrl</code> returning a result</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-30.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-30.png" /></a></p>
<p>So now the <code>jne</code> will evaluate the <code>ZF</code> result. If the <code>ZF</code> flag is set to <code>0</code> take the jump to exit the program, if not then continue to the next Call.</p>
<p>This is the kill switch that stops the Malware from running.</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-34.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-34.png" /></a></p>
<p>So if we change the <code>ZF</code> value to '1', the program will not jump and will insteadcontinue to the next API Call</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-35.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-35.png" /></a></p>
<p>Now we will see that the call was made and the Malware started doing it's file Encryption magic</p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-36.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-36.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/pma-img-8y9sh-s7hu-37.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/pma-img-8y9sh-s7hu-37.png" /></a></p>
</details>
</details>
</div>
<div class="admonition info">
<h3 id="automation-sandboxes-pipelines">Automation: Sandboxes &amp; Pipelines</h3>
<details class="info">
<summary>BlueJupyter</summary>
<h4 id="bluejupyter-automating-triage-with-jupyter-notebooks">BlueJupyter: Automating Triage with Jupyter Notebooks</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/5-1.Automation-BlueJupyter/FORTRIAGE.7z">Lab File(s)</a></p>
<div class="admonition warning">
<p><mark><strong>Note</strong></mark?> For this section of the course, I am working on my Linux development workstation. This is outside of my lab environment. I confirmed that Blue-Jupyter functions as intended if you install it on REMnux, so feel free to <strong>carefully add REMnux back onto a NAT adapter</strong> and follow the install instructions for Blue-Jupyter.</p>
</div>
<p>Update 2/18/22: Dockerized Blue-Jupyter Installation Instructions</p>
<p>I have Dockerized the <a href="https://github.com/HuskyHacks/blue-jupyter">Blue-Jupyter</a> application to cut down on the number of poetry and pip errors that were plaguing the code! Please follow these instructions to install and run the Dockerized version of the app. Note that these instructions are different than what you see in the video:</p>
<p>Clone the PMAT-lab branch of the code repository and change directories into it:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>remnux@remnux:~$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>--branch<span class="w"> </span>PMAT-lab<span class="w"> </span>https://github.com/HuskyHacks/blue-jupyter.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>blue-jupyter
</code></pre></div>
<p>Run the following Docker build command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>remnux@remnux:~/blue-jupyter$<span class="w"> </span>sudo<span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bluejupyter<span class="w"> </span>.
</code></pre></div>
<p>When the image is finished building, run the following command to launch the notebook with a published port of 8888 and a mounted volume to the dropbox directory:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>remnux@remnux:~/blue-jupyter$<span class="w"> </span>sudo<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>-p<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span>-v<span class="w"> </span>/home/remnux/blue-jupyter:/src<span class="w"> </span>bluejupyter
</code></pre></div>
<p>Now, if you want to add malware to the dropbox, copy it from the PMAT-labs repository into the <code>/home/remnux/blue-jupyter/malware-analysis/dropbox/</code> directory and it will also copy into the container.</p>
<p>You can then proceed to follow the instructions from the video.</p>
<p>Please note that you need to be connected to the internet and must use a valid VirusTotal API key to get the API results. VirusTotal Public API keys are free and you can sign up for one here <a href="https://www.virustotal.com/gui/join-us">VirusTotal API Key Signup</a></p>
<p>Once you are done, make sure to <mark><strong>remove REMnux from the NAT adapter</strong></mark> and double-check that it is back in the isolated lab environment.</p>
<p><strong>References</strong>:</p>
<ul>
<li><a href="https://www.youtube.com/c/TaggartTech">Taggart Tech Youtube Channel</a></li>
<li><a href="https://www.twitch.tv/mttaggart">Taggart Tech Twitch</a></li>
<li><a href="https://twitter.com/malwareunicorn">@MalwareUnicorn</a></li>
<li><a href="https://www.youtube.com/watch?v=rX7lIfQlqOo">Referenced ShellCon talk</a></li>
<li><a href="https://neon.kde.org/">Linux Dev Workstation</a></li>
</ul>
</details>
<details class="info">
<summary>Any.Run</summary>
<h4 id="anyrun-malware-sandboxing">Any.Run: Malware Sandboxing</h4>
<p>Update 11/8/22</p>
<p>It appears that ANY.RUN now requires you to provide a business email to sign up for an account.</p>
<p>I will not fault anyone for not wanting to provide a business email for this purpose. Feel free to skip the practical portion of this section and simply watch the video. Alternatively, another sandbox site called <a href="https://tria.ge">Hatching Triage</a> offers free personal use accounts and does not require a business email. I love Triage and use them for my personal and professional research and recommend their services for this purpose. Please note that their account creation process does take some time due to their verification process. </p>
</details>
<details class="info">
<summary>ChatGPT Script Analysis</summary>
<h4 id="advanced-script-analysis-with-chatgpt">Advanced Script Analysis with ChatGPT</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/5-1.Automation/chatGPT-script-analysis">Lab File(s)</a></p>
</details>
</div>
<div class="admonition info">
<h3 id="rule-writing-report-publishing">Rule Writing &amp; Report Publishing</h3>
<details class="info">
<summary>YARA Rules</summary>
<h4 id="writing-yara-rules">Writing YARA Rules</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/5-2.RuleWriting/Malware.yara1.exe.malz.7z">Lab File(s)</a></p>
<p><a href="https://yara.readthedocs.io/en/stable/">YARA Documentation</a></p>
</details>
<details class="info">
<summary>Detection with YARA</summary>
<h4 id="detecting-malware-with-yara">Detecting Malware with YARA</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/tree/main/labs/5-2.RuleWriting/Malware.yara1.exe.malz.7z">Lab File(s)</a></p>
<p><strong>Errata</strong>
YARA is now invoked with the command <code>yara64</code> in the newer version of FLARE-VM. If you can't run YARA by running <code>yara32</code>, try <code>yara64</code> instead!</p>
</details>
<details class="info">
<summary>Writing &amp; Publishing Analysis Report</summary>
<h4 id="writing-publishing-a-malware-analysis-report">Writing &amp; Publishing a Malware Analysis Report</h4>
<p><a href="https://github.com/HuskyHacks/PMAT-labs/blob/main/labs/5-3.ReportWriting/ReportTemplate.docx">Report Template</a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tS-0.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tS-0.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tS-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tS-1.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tS-2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tS-2.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tS-3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tS-3.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tS-4.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tS-4.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tS-5.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tS-5.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tS-6.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tS-6.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA-apo-87tS-7.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="/Knowledge_Base/images/PMA-apo-87tS-7.png" /></a></p>
</details>
</div>
<hr />
<details class="info">
<summary>Mindmaps</summary>
<h4 id="mindmaps">mindmaps</h4>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA_Summary_20.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/PMA_Summary_20.png" /></a></p>
<p><a class="glightbox" href="/Knowledge_Base/images/PMA_Summary_21.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="img" src="/Knowledge_Base/images/PMA_Summary_21.png" /></a></p>
</details>
<details class="info">
<summary>Extras</summary>
<h4 id="additional-resources">Additional resources</h4>
<ul>
<li>SANS Malware Analysis and Reverse-Engineering Cheat Sheet <a href="/Knowledge_Base/images/SANS_Malware_Analysis_&amp;_Reverse_Engineering_Cheat_Sheet.pdf">click to open PDF in new tab</a></li>
<li><a href="https://fareedfauzi.github.io/2022/08/08/Malware-analysis-cheatsheet.html#ransomware-flow-101">fareedfauzi</a></li>
<li><a href="https://exploit-notes.hdks.org/exploit/malware/malware-analysis/">Malware Analysis - Exploit Notes</a></li>
<li><a href="https://exploit-notes.hdks.org/exploit/malware/malware-static-analysis/">Malware Static Analysis</a></li>
<li><a href="https://dft.wiki/?p=2587">Reverse Engineering / Binary Exploitation Cheat Sheet</a></li>
<li><a href="https://fareedfauzi.github.io/2022/08/08/Malware-analysis-cheatsheet.html">Cheatsheet: Windows Malware Analysis and Reversing</a></li>
</ul>
</details>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 8, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2024 bitwiseoperator.net
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/584F525F/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:contact@bitwiseoperator.net" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.select", "content.tabs.link", "navigation.tracking", "navigation.path", "navigation.top", "navigation.tabs", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.sections", "search.highlight", "search.suggest", "search.share", "toc.follow"], "search": "../../../assets/javascripts/workers/search.1e90e0fb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.6e7f53b1.min.js"></script>
      
        <script src="../../../js/open_in_new_tab.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>